import{w as u,d as i}from"./index.yFpBwehi.js";import{U as a,g as C}from"./app.state.DF7-kV0C.js";import{l as f}from"./scheduler.CfCKMTS5.js";import{s as _}from"./index.VHDdmGKB.js";var T=(t=>(t.EditSacramentProgram="edit-sacrament-program",t.EditDBCalendarEvent="edit-calendar-events",t.EditMemberListItem="edit-member-list-item",t.ViewDBMemberListItem="view-db-member-list-item",t.UseCallings="use-callings",t))(T||{});const E=[{name:"edit-sacrament-program",roles:[a.Root,a.Admin],turnedOn:!0},{name:"edit-calendar-events",roles:[a.Root,a.Admin,a.Primary,a.ReliefSociety,a.EldersQuorum,a.YoungWomen,a.SundaySchool],turnedOn:!0},{name:"view-db-member-list-item",roles:[a.Root,a.Admin],turnedOn:!0},{name:"edit-member-list-item",roles:[a.Root,a.Admin],turnedOn:!0},{name:"use-callings",roles:[a.Root],turnedOn:!0}],{stores:{currentUser:M}}=C();let c=null;const R=()=>{const t=u(E);return c={stores:{featureFlags:t},actions:{featureIsEnabled:s=>{const l=f(t).find(d=>d.name===s);if(!l)return!1;const A=f(M).role;return!!l.roles.find(d=>d===A)&&l.turnedOn}}},c},P=()=>c?.stores&&Object.keys(c.stores).length>0&&c?.actions&&Object.keys(c.actions).length>0?c:R(),m={AdvancementsForAaronicPriesthood:{label:"Aaronic Priesthood Advancements",key:"advancements-for-aaronic-priesthood"},AdvancementsForYoungWomen:{label:"Young Women Advancement Acknowledgement",key:"advancements-for-young-women"},BabyBlessing:{label:"Baby Blessing",key:"baby-blessing"},Baptisms:{label:"Baptisms",key:"baptisms"},CallingsToBeAcknowledgeInSacrament:{label:"Callings to be Acknowledged in Sacrament",key:"callings-to-acknowledge-in-sacrament"},CallingsToBeAcknowledgeInClass:{label:"Callings to be Acknowledged in Class",key:"callings-to-acknowledge-in-class"},CallingsToBeReleasedInSacrament:{label:"Callings to Release in Sacrament",key:"callings-to-be-released-in-sacrament"},CallingsToBeReleasedInClass:{label:"Callings to Release in Class",key:"callings-to-be-released-in-class"},CallingsToBeSustainedInSacrament:{label:"Callings to Sustain in Sacrament",key:"callings-to-be-sustained-in-sacrament"},CallingsToBeSustainedInClass:{label:"Callings to Sustain in Class",key:"callings-to-be-sustained-in-class"},MovedIn:{label:"Move In Members",key:"moved-in-members"}},$={name:"",description:"",list_name:"",sort_order:0},S=u([]);let I=!1;async function y(){if(I)return f(S);I=!0;const{data:t,error:o}=await _.from("member_list_items").select("*");if(o)throw o;const s=t||[];return S.set(s),setTimeout(()=>I=!1,800),s}async function x(t){const{data:o,error:s}=await _.from("member_list_items").insert([t]).select();if(s)throw s;return await y(),o[0]}async function W(t,o){const{error:s}=await _.from("member_list_items").update(o).eq("id",t).select();if(s)throw s;await y();const l=f(S).find(b=>b.id===t);return l||void 0}async function Y(t){const{error:o}=await _.from("member_list_items").delete().eq("id",t);if(o)throw o;await y()}let g=null;const h=()=>{const t=u(!1),o=u([]),s=u([]),k=i([s],([r])=>r.filter(e=>e.list_name===m.CallingsToBeReleasedInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),l=i([s],([r])=>r.filter(e=>e.list_name===m.CallingsToBeSustainedInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),b=i([s],([r])=>r.filter(e=>e.list_name===m.CallingsToBeAcknowledgeInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),A=i([s],([r])=>r.filter(e=>e.list_name===m.AdvancementsForAaronicPriesthood.key).sort((e,n)=>e.sort_order-n.sort_order)),w=i([s],([r])=>r.filter(e=>e.list_name===m.AdvancementsForYoungWomen.key).sort((e,n)=>e.sort_order-n.sort_order)),d=i([s],([r])=>r.filter(e=>e.list_name===m.MovedIn.key).sort((e,n)=>e.sort_order-n.sort_order)),B=i([s],([r])=>r.filter(e=>e.list_name===m.Baptisms.key).sort((e,n)=>e.sort_order-n.sort_order)),p=i([s],([r])=>r.filter(e=>e.list_name===m.BabyBlessing.key).sort((e,n)=>e.sort_order-n.sort_order)),v=r=>r.length?r:[];return g={stores:{ready:t,data:o,dbData:s,membersToRelease:k,membersToSustain:l,membersToAcknowledgeInSacrament:b,membersToAdvanceInAaronicPriesthood:A,membersToAdvanceInYoungWomen:w,membersMoveIn:d,membersToBeBaptised:B,membersForBabyBlessing:p},actions:{reload:async()=>{t.set(!1);const r=await y();s.set(v(r)),t.set(!0)}}},g},j=()=>g?.stores&&Object.keys(g.stores).length>0?g:h();export{$ as B,T as F,m as M,j as a,x as c,Y as d,P as g,W as u};
