import{w as u,d as i}from"./index.Dbn8irzZ.js";import{U as o,g as C}from"./app.state.C6Ny-fdb.js";import{l as f}from"./scheduler.BKEM4_Ql.js";import{s as _}from"./supabase-config.CfWUfwF8.js";var T=(t=>(t.EditSacramentProgram="edit-sacrament-program",t.EditDBCalendarEvent="edit-calendar-events",t.EditMemberListItem="edit-member-list-item",t.ViewDBMemberListItem="view-db-member-list-item",t.UseCallings="use-callings",t))(T||{});const M=[{name:"edit-sacrament-program",roles:[o.Root,o.Admin],turnedOn:!0},{name:"edit-calendar-events",roles:[o.Root,o.Admin,o.SundaySchool],turnedOn:!0},{name:"view-db-member-list-item",roles:[o.Root,o.Admin],turnedOn:!0},{name:"edit-member-list-item",roles:[o.Root,o.Admin],turnedOn:!0},{name:"use-callings",roles:[o.Root],turnedOn:!0}],{stores:{currentUser:E}}=C();let c=null;const h=()=>{const t=u(M);return c={stores:{featureFlags:t},actions:{featureIsEnabled:s=>{const l=f(t).find(d=>d.name===s);if(!l)return!1;const A=f(E).role;return!!l.roles.find(d=>d===A)&&l.turnedOn}}},c},$=()=>c?.stores&&Object.keys(c.stores).length>0&&c?.actions&&Object.keys(c.actions).length>0?c:h(),m={AdvancementsForAaronicPriesthood:{label:"Aaronic Priesthood Advancements",key:"advancements-for-aaronic-priesthood"},AdvancementsForYoungWomen:{label:"Young Women Advancement Acknowledgement",key:"advancements-for-young-women"},BabyBlessing:{label:"Baby Blessing",key:"baby-blessing"},Baptisms:{label:"Baptisms",key:"baptisms"},CallingsToBeAcknowledgeInSacrament:{label:"Callings to be Acknowledged in Sacrament",key:"callings-to-acknowledge-in-sacrament"},CallingsToBeAcknowledgeInClass:{label:"Callings to be Acknowledged in Class",key:"callings-to-acknowledge-in-class"},CallingsToBeReleasedInSacrament:{label:"Callings to Release in Sacrament",key:"callings-to-be-released-in-sacrament"},CallingsToBeReleasedInClass:{label:"Callings to Release in Class",key:"callings-to-be-released-in-class"},CallingsToBeSustainedInSacrament:{label:"Callings to Sustain in Sacrament",key:"callings-to-be-sustained-in-sacrament"},CallingsToBeSustainedInClass:{label:"Callings to Sustain in Class",key:"callings-to-be-sustained-in-class"},MovedIn:{label:"Move In Members",key:"moved-in-members"}},x={name:"",description:"",list_name:"",sort_order:0},w=u([]);let I=!1;async function y(){if(I)return f(w);I=!0;const{data:t,error:a}=await _.from("member_list_items").select("*");if(a)throw a;const s=t||[];return w.set(s),setTimeout(()=>I=!1,800),s}async function P(t){const{data:a,error:s}=await _.from("member_list_items").insert([t]).select();if(s)throw s;return await y(),a[0]}async function W(t,a){const{error:s}=await _.from("member_list_items").update(a).eq("id",t).select();if(s)throw s;await y();const l=f(w).find(g=>g.id===t);return l||void 0}async function Y(t){const{error:a}=await _.from("member_list_items").delete().eq("id",t);if(a)throw a;await y()}let b=null;const R=()=>{const t=u(!1),a=u([]),s=u([]),k=i([s],([r])=>r.filter(e=>e.list_name===m.CallingsToBeReleasedInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),l=i([s],([r])=>r.filter(e=>e.list_name===m.CallingsToBeSustainedInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),g=i([s],([r])=>r.filter(e=>e.list_name===m.CallingsToBeAcknowledgeInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),A=i([s],([r])=>r.filter(e=>e.list_name===m.AdvancementsForAaronicPriesthood.key).sort((e,n)=>e.sort_order-n.sort_order)),B=i([s],([r])=>r.filter(e=>e.list_name===m.AdvancementsForYoungWomen.key).sort((e,n)=>e.sort_order-n.sort_order)),d=i([s],([r])=>r.filter(e=>e.list_name===m.MovedIn.key).sort((e,n)=>e.sort_order-n.sort_order)),S=i([s],([r])=>r.filter(e=>e.list_name===m.Baptisms.key).sort((e,n)=>e.sort_order-n.sort_order)),p=i([s],([r])=>r.filter(e=>e.list_name===m.BabyBlessing.key).sort((e,n)=>e.sort_order-n.sort_order)),v=r=>r.length?r:[];return b={stores:{ready:t,data:a,dbData:s,membersToRelease:k,membersToSustain:l,membersToAcknowledgeInSacrament:g,membersToAdvanceInAaronicPriesthood:A,membersToAdvanceInYoungWomen:B,membersMoveIn:d,membersToBeBaptised:S,membersForBabyBlessing:p},actions:{reload:async()=>{t.set(!1);const r=await y();s.set(v(r)),t.set(!0)}}},b},j=()=>b?.stores&&Object.keys(b.stores).length>0?b:R();export{x as B,T as F,m as M,j as a,P as c,Y as d,$ as g,W as u};
