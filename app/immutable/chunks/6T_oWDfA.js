import{w as g,d as i}from"./wlhN6vKE.js";import{U as a,g as C}from"./xlZ0IkP9.js";import{l as f}from"./DZwCP9x3.js";import{s as _}from"./DsH82brL.js";var v=(t=>(t.EditSacramentProgram="edit-sacrament-program",t.EditDBCalendarEvent="edit-calendar-events",t.EditMemberListItem="edit-member-list-item",t.ViewDBMemberListItem="view-db-member-list-item",t.UseCallings="use-callings",t))(v||{});const h=[{name:"edit-sacrament-program",roles:[a.Root,a.Admin],turnedOn:!0},{name:"edit-calendar-events",roles:[a.Root,a.Admin,a.Primary,a.ReliefSociety,a.EldersQuorum,a.YoungWomen,a.SundaySchool],turnedOn:!0},{name:"view-db-member-list-item",roles:[a.Root,a.Admin],turnedOn:!0},{name:"edit-member-list-item",roles:[a.Root,a.Admin],turnedOn:!0},{name:"use-callings",roles:[a.Root],turnedOn:!0}],{stores:{currentUser:T}}=C();let m=null;const E=()=>{const t=g(h);return m={stores:{featureFlags:t},actions:{featureIsEnabled:s=>{const l=f(t).find(d=>d.name===s);if(!l)return!1;const B=f(T).role;return!!l.roles.find(d=>d===B)&&l.turnedOn}}},m},P=()=>m?.stores&&Object.keys(m.stores).length>0&&m?.actions&&Object.keys(m.actions).length>0?m:E(),c={AdvancementsForAaronicPriesthood:{label:"Aaronic Priesthood Advancements",key:"advancements-for-aaronic-priesthood"},BabyBlessing:{label:"Baby Blessing",key:"baby-blessing"},Baptisms:{label:"Baptisms",key:"baptisms"},CallingsToBeReleasedInSacrament:{label:"Callings to Release in Sacrament",key:"callings-to-be-released-in-sacrament"},CallingsToBeReleasedInClass:{key:"callings-to-be-released-in-class"},CallingsToBeApproved:{label:"Callings that need Bishopric Approval",key:"callings-to-be-approved"},CallingsToExtend:{label:"Callings that need Bishopric Extension",key:"callings-to-extend"},CallingsToRelease:{label:"Callings that need Bishopric Formal Releasing via Interview or Phone",key:"callings-to-release"},CallingsToBeSustainedInSacrament:{label:"Callings to Sustain in Sacrament",key:"callings-to-be-sustained-in-sacrament"},CallingsToBeSustainedInClass:{label:"Callings to Sustain in Class",key:"callings-to-be-sustained-in-class"},CallingsToBeAcknowledgeInSacrament:{label:"Callings to be Acknowledged in Sacrament",key:"callings-to-acknowledge-in-sacrament"},CallingsToBeAcknowledgeInClass:{label:"Callings to be Acknowledged in Class",key:"callings-to-acknowledge-in-class"},MovedIn:{label:"Move In Members",key:"moved-in-members"}},U={name:"",description:"",list_name:"",sort_order:0},I=g([]);let k=!1;async function y(){if(k)return f(I);k=!0;const{data:t,error:o}=await _.from("member_list_items").select("*");if(o)throw o;const s=t||[];return I.set(s),setTimeout(()=>k=!1,800),s}async function F(t){const{data:o,error:s}=await _.from("member_list_items").insert([t]).select();if(s)throw s;return await y(),o[0]}async function $(t,o){const{error:s}=await _.from("member_list_items").update(o).eq("id",t).select();if(s)throw s;await y();const l=f(I).find(u=>u.id===t);return l||void 0}async function j(t){const{error:o}=await _.from("member_list_items").delete().eq("id",t);if(o)throw o;await y()}let b=null;const M=()=>{const t=g(!1),o=g([]),s=g([]),p=i([s],([r])=>r.filter(e=>e.list_name===c.CallingsToBeReleasedInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),l=i([s],([r])=>r.filter(e=>e.list_name===c.CallingsToBeSustainedInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),u=i([s],([r])=>r.filter(e=>e.list_name===c.CallingsToBeAcknowledgeInSacrament.key).sort((e,n)=>e.sort_order-n.sort_order)),B=i([s],([r])=>r.filter(e=>e.list_name===c.AdvancementsForAaronicPriesthood.key).sort((e,n)=>e.sort_order-n.sort_order)),S=i([s],([r])=>r.filter(e=>e.list_name===c.MovedIn.key).sort((e,n)=>e.sort_order-n.sort_order)),d=i([s],([r])=>r.filter(e=>e.list_name===c.Baptisms.key).sort((e,n)=>e.sort_order-n.sort_order)),w=i([s],([r])=>r.filter(e=>e.list_name===c.BabyBlessing.key).sort((e,n)=>e.sort_order-n.sort_order)),A=r=>r.length?r:[];return b={stores:{ready:t,data:o,dbData:s,membersToRelease:p,membersToSustain:l,membersToAcknowledgeInSacrament:u,membersToAdvanceInAaronicPriesthood:B,membersMoveIn:S,membersToBeBaptised:d,membersForBabyBlessing:w},actions:{reload:async()=>{t.set(!1);const r=await y();s.set(A(r)),t.set(!0)}}},b},V=()=>b?.stores&&Object.keys(b.stores).length>0?b:M();export{U as B,v as F,c as M,P as a,F as c,j as d,V as g,$ as u};
