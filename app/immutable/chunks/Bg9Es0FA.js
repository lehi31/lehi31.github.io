import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{o as dt}from"./DHXte27T.js";import{p as Qe,E as u,ai as $,w as I,g as e,aj as Ve,c as s,t as M,a as Xe,s as d,D as n,u as T,r,as as _e,f as We}from"./CPOcesE7.js";import{p as l,i as D,e as S,s as y,b as qe,a as ct}from"./opPvMm1W.js";import{e as Re,i as Ue}from"./DAwrR-3T.js";import{f,a as m,c as mt}from"./YsHTGu5k.js";import{r as Ae,s as B}from"./leomWik6.js";import{i as Ze}from"./C2Q_9cr2.js";import{S as $e}from"./DdxfA9bk.js";import{c as Se,g as vt,P as ut}from"./DTfTc-Am.js";import{b as Je}from"./QDlYjqxz.js";import{b as Ge}from"./DLuN8Kcu.js";import{t as Te}from"./r7-tBYgy.js";import{c as ft}from"./BUThaZcy.js";import{B as Ye,g as et,u as _t,c as pt,d as gt}from"./CDZez2SM.js";import{D as bt}from"./DVIMrSXx.js";var xt=f('<span class="badge me-2 cursor-pointer text-bg-warning"> </span>'),ht=f('<div class="d-flex flex-column gap-2"><em> </em> <div></div></div>'),yt=f('<span class="badge me-2 cursor-pointer text-bg-warning"> </span>'),wt=f('<div class="d-flex flex-column gap-2"><em> </em> <div></div></div>'),Pt=f('<div class="d-flex flex-column gap-3"><!> <div class="d-flex flex-column gap-2"><div> </div> <input type="text"/> <small class="fw-lighter fst-italic"> </small></div></div>'),Lt=f('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),St=f("<span>Save</span>"),Tt=f("<span>Create</span>"),It=f('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),Mt=f('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-3"><!> <div class="d-flex flex-column gap-2"><div> </div> <input type="text" required/> <small class="fw-lighter fst-italic"> </small></div></div> <!> <div class="d-flex flex-column gap-2"><div>Sort Order*</div> <input type="number" class="form-control" required/></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span> <!> <button class="btn btn-primary position-relative"><!> <!></button></div></div>');function Dt(Ie,i){Qe(i,!1);const J=u(),N=u(),j=u(),R=u();let ee=l(i,"name",8,""),k=l(i,"drawerId",8,""),U=l(i,"listName",8,""),a=l(i,"member",12,Ye),pe=l(i,"nameLabel",8,"Member"),Me=l(i,"namePlaceholder",8,"Member name"),De=l(i,"nameHelperText",8,"Members full name pre-pended by Brother, Sister or calling title where relevant. i.e. Brother John Smith, Sister Jane Smith, Bishop John Smith"),te=l(i,"namePresets",24,()=>[]),E=l(i,"descriptionExcluded",8,!1),ge=l(i,"descriptionLabel",8,"Description"),ke=l(i,"descriptionHelperText",8,""),ae=l(i,"descriptionPresets",24,()=>[]);const{actions:{reload:be}}=et();let _=u(!1),g=u(a().id),re=u(),Y=u(),v=u({message:"",type:"info"}),w=u({name:"",description:"",list_name:"",sort_order:0}),b=u({name:!1,description:!1});const se=()=>{const t=`[data-bs-target="#${k()}"]`,o=document.querySelector(t);o&&o.click()},z=()=>{n(b,{name:!1,description:!1}),a({...Ye,list_name:U()}),n(_,!1)},P=(t,o=0,H="info")=>{_e(v,e(v).message=t),_e(v,e(v).type=H),o&&setTimeout(()=>{_e(v,e(v).message="")},o)},xe=async()=>{if(!e(g)){P("ID is not defined",0,"danger");return}try{await gt(e(g)),await be(),Te("set_member_list_item_success","interaction","Delete Member List Successful",1),setTimeout(()=>{n(_,!1),n(w,{...a(),id:e(g)}),P("Event Deleted",3e3,"success"),se()},800)}catch(t){Te("set_member_list_item_failed","interaction","Delete Member List Failed",1),setTimeout(()=>{n(_,!1),console.error("Save failed:",t),P("Failed to save event. Please try again.",7e3,"danger")},800)}},ie=()=>{n(_,!0),ft({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:t=>{t&&xe(),z()}})},le=async()=>{if(!e(J)){P("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!e(R)){let t=[];e(N)&&t.push("Title is invalid"),e(j)&&t.push("Description is invalid"),P(t.join(". ")+".  Please address accordingly.",0,"danger");return}if(!e(_)){P("Saving ..."),n(_,!0);try{const t={name:a().name,description:E()?"":a().description,list_name:a().list_name,sort_order:a().sort_order};e(g)?await _t(e(g),t):await pt(t),await be(),Te("set_member_list_item_success","interaction",`Set Member List Successful ${a().name}`,1),setTimeout(()=>{n(_,!1),n(w,{...a(),id:e(g)}),P("Saved",3e3,"success"),e(g)||z(),se()},800)}catch(t){Te("set_member_list_item_failed","interaction",`Set Member List Failed ${a().name}`,1),setTimeout(()=>{n(_,!1),console.error("Save failed:",t),P("Failed to save event. Please try again.",7e3,"danger"),e(g)||z()},800)}}},Ee=t=>{a(a().name=t.value,!0)},He=t=>{a(a().description=t.value,!0)};$(()=>(e(w),I(a()),I(E())),()=>{n(J,e(w)?.name!==a().name||(E()?!1:e(w)?.description!==a().description)||e(w)?.list_name!==a().list_name||e(w)?.sort_order!==a().sort_order)}),$(()=>I(a()),()=>{n(g,a().id)}),$(()=>(e(b),I(a())),()=>{n(N,e(b).name&&a().name==="")}),$(()=>(I(E()),e(b),I(a())),()=>{n(j,E()?!1:e(b).name&&a().description==="")}),$(()=>(e(N),e(j)),()=>{n(R,!e(N)&&!e(j))}),Ve(),Ze();var ne=Mt(),c=s(ne),x=s(c);{var K=t=>{var o=ht(),H=s(o),Ne=s(H);r(H);var ve=d(H,2);Re(ve,5,te,Ue,(ue,fe)=>{var p=xt(),Pe=s(p,!0);r(p),M(()=>y(Pe,(e(fe),T(()=>e(fe).key)))),S("click",p,()=>Ee(e(fe))),m(ue,p)}),r(ve),r(o),M(()=>y(Ne,`${pe()??""} - Presets`)),m(t,o)};D(x,t=>{I(te()),T(()=>te().length)&&t(K)})}var O=d(x,2),C=s(O),oe=s(C);r(C);var h=d(C,2);Ae(h);let L;Ge(h,t=>n(re,t),()=>e(re));var W=d(h,2),he=s(W,!0);r(W),r(O),r(c);var G=d(c,2);{var de=t=>{var o=Pt(),H=s(o);{var Ne=A=>{var je=wt(),Ce=s(je),lt=s(Ce);r(Ce);var Oe=d(Ce,2);Re(Oe,5,ae,Ue,(nt,Fe)=>{var Le=yt(),ot=s(Le,!0);r(Le),M(()=>y(ot,(e(Fe),T(()=>e(Fe).key)))),S("click",Le,()=>He(e(Fe))),m(nt,Le)}),r(Oe),r(je),M(()=>y(lt,`${ge()??""} - Presets`)),m(A,je)};D(H,A=>{I(ae()),T(()=>ae().length)&&A(Ne)})}var ve=d(H,2),ue=s(ve),fe=s(ue);r(ue);var p=d(ue,2);Ae(p);let Pe;Ge(p,A=>n(Y,A),()=>e(Y));var Ke=d(p,2),it=s(Ke,!0);r(Ke),r(ve),r(o),M(()=>{y(fe,`${ge()??""}*`),B(p,"name",`${ee()??""}-description`),Pe=Se(p,1,"form-control",null,Pe,{"is-invalid":e(j)}),p.disabled=e(_),y(it,ke())}),S("focus",p,()=>e(Y).select()),S("keyup",p,()=>_e(b,e(b).description=!0)),Je(p,()=>a().description,A=>a(a().description=A,!0)),m(t,o)};D(G,t=>{E()||t(de)})}var F=d(G,2),Q=d(s(F),2);Ae(Q),r(F);var ce=d(F,2),V=s(ce),ye=s(V,!0);r(V);var X=d(V,2);let we;var Be=s(X);$e(Be,{size:"xs"}),r(X);var Z=d(X,2);{var me=t=>{var o=Lt();S("click",o,ie),m(t,o)};D(Z,t=>{e(g)&&t(me)})}var q=d(Z,2),ze=s(q);{var tt=t=>{var o=St();m(t,o)},at=t=>{var o=Tt();m(t,o)};D(ze,t=>{e(g)?t(tt):t(at,!1)})}var rt=d(ze,2);{var st=t=>{var o=It();m(t,o)};D(rt,t=>{e(J)&&t(st)})}r(q),r(ce),r(ne),M(()=>{y(oe,`${pe()??""}*`),B(h,"name",`${ee()??""}-name`),L=Se(h,1,"form-control",null,L,{"is-invalid":e(N)}),B(h,"placeholder",Me()),h.disabled=e(_),y(he,De()),B(Q,"name",`${ee()??""}-sort-order`),Q.disabled=e(_),Se(V,1,`fw-lighter fst-italic text-${e(v),T(()=>e(v).type)??""}`),y(ye,(e(v),T(()=>e(v).message))),we=Se(X,1,"",null,we,{"d-none":!e(_)})}),S("focus",h,()=>e(re).select()),S("keyup",h,()=>_e(b,e(b).name=!0)),Je(h,()=>a().name,t=>a(a().name=t,!0)),Je(Q,()=>a().sort_order,t=>a(a().sort_order=t,!0)),S("click",q,le),m(Ie,ne),Xe()}var kt=f('<div><button class="btn btn-sm btn-secondary" type="button" data-bs-toggle="offcanvas" aria-label="Edit member"><i class="bi bi-pencil-square"></i></button></div>'),Et=f('<li class="list-group-item px-0 py-2"><div class="d-flex justify-content-between align-items-center"><div class="d-sm-block d-md-flex d-lg-flex d-lg-flex flex-grow-1 justify-content-between me-3 flex-sm-column flex-md-row flex-xl-row flex-lg-row gap-3"><div class="d-flex align-items-center gap-2"><small class="text-muted sort-index justify-content-end d-flex svelte-9cb968"> </small> <span> </span></div> <div class="fw-lighter"> </div></div> <!></div></li>'),Ht=f('<ul class="list-group list-group-flush"></ul>'),Bt=f('<ul class="list-group list-group-flush"><li class="list-group-item px-0 py-2"><!></li></ul>'),Nt=f('<!> <div class="d-flex flex-column gap-2"><div class="d-flex justify-content-end align-items-center"><button class="btn btn-sm btn-secondary" type="button" data-bs-toggle="offcanvas">Add Member <i class="bi bi-plus"></i></button></div> <!></div>',1);function Zt(Ie,i){Qe(i,!1);const J=()=>qe(re,"$dbData",R),N=()=>qe(_,"$currentUserHasPermission",R),j=()=>qe(g,"$ready",R),[R,ee]=ct();let k=l(i,"name",8,""),U=l(i,"listName",8,""),a=l(i,"nameLabel",8,""),pe=l(i,"namePlaceholder",8,""),Me=l(i,"nameHelperText",8,""),De=l(i,"namePresets",24,()=>[]),te=l(i,"descriptionExcluded",8,!1),E=l(i,"descriptionLabel",8,""),ge=l(i,"descriptionHelperText",8,""),ke=l(i,"descriptionPresets",24,()=>[]),ae=l(i,"newItemDrawerTitle",8,""),be=l(i,"editItemDrawerTitle",8,"");const{stores:{currentUserHasPermission:_}}=vt(),{stores:{ready:g,dbData:re}}=et();let Y=u(!1),v=u([]),w=u(),b=u("");const se=(c=void 0)=>{c?(n(b,be()),n(w,c)):(n(b,ae()),n(w,{...Ye,list_name:U()}))};dt(()=>{n(Y,N()(ut.ManageWardBusiness))}),$(()=>(J(),I(U())),()=>{n(v,J().filter(c=>c.list_name===U()).sort((c,x)=>c.sort_order-x.sort_order))}),Ve(),Ze();var z=Nt(),P=We(z);bt(P,{get title(){return e(b)},get id(){return k()},children:(c,x)=>{Dt(c,{name:"member-list-item-form-new",get drawerId(){return k()},get listName(){return U()},get member(){return e(w)},get nameLabel(){return a()},get namePlaceholder(){return pe()},get nameHelperText(){return Me()},get namePresets(){return De()},get descriptionExcluded(){return te()},get descriptionHelperText(){return ge()},get descriptionLabel(){return E()},get descriptionPresets(){return ke()}})},$$slots:{default:!0}});var xe=d(P,2),ie=s(xe),le=s(ie);r(ie);var Ee=d(ie,2);{var He=c=>{var x=mt(),K=We(x);{var O=C=>{var oe=Ht();Re(oe,5,()=>e(v),Ue,(h,L)=>{var W=Et(),he=s(W),G=s(he),de=s(G),F=s(de),Q=s(F,!0);r(F);var ce=d(F,2),V=s(ce,!0);r(ce),r(de);var ye=d(de,2),X=s(ye,!0);r(ye),r(G);var we=d(G,2);{var Be=Z=>{var me=kt(),q=s(me);r(me),M(()=>{B(q,"data-bs-target",`#${k()??""}`),B(q,"aria-controls",k())}),S("click",q,()=>se(e(L))),m(Z,me)};D(we,Z=>{e(Y)&&Z(Be)})}r(he),r(W),M(()=>{y(Q,(e(L),T(()=>e(L).sort_order))),y(V,(e(L),T(()=>e(L).name))),y(X,(e(L),T(()=>e(L).description)))}),m(h,W)}),r(oe),m(C,oe)};D(K,C=>{e(v),T(()=>e(v).length)&&C(O)})}m(c,x)},ne=c=>{var x=Bt(),K=s(x),O=s(K);$e(O,{}),r(K),r(x),m(c,x)};D(Ee,c=>{j()?c(He):c(ne,!1)})}r(xe),M(()=>{B(le,"data-bs-target",`#${k()??""}`),B(le,"aria-controls",k())}),S("click",le,()=>se()),m(Ie,z),Xe(),ee()}export{Zt as M};
