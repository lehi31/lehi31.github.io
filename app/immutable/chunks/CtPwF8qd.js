const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{_ as Lt}from"./CmsKOCeN.js";import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{c as Mr,o as zn,w as Cr,g as un,a as Fr}from"./WW5OsAH7.js";import{p as dt,ah as Be,ai as It,B as ye,c as L,s as W,a as ut,m as i,E as de,n as J,D as F,u as ee,F as Je,r as P,C as fn,ap as Ur,f as Ve,R as st,as as rn,v as Or}from"./SWWSvUpQ.js";import{p as me,i as he,e as Ie,s as xe,m as zr,u as Pr,a as an,b as Br}from"./CU3XCoqN.js";import{f as ve,a as ae,c as sn,t as wt}from"./D8ekX_8E.js";import{b as vn,r as Ke,s as Ce,e as Lr}from"./h5yPuqEw.js";import{t as Pn,f as et,i as He,A as Ge,e as Bn,b as Nr,h as Hr,C as qr,O as Oe,a as on,j as Wr,p as Ot}from"./CpBQByPR.js";import{i as gt}from"./Bgyk9asy.js";import{S as Ln}from"./BkhfVKlj.js";import{e as $t,i as Nn}from"./YJAcq9su.js";import{b as ct,a as hn,c as ln}from"./CvxMDV_e.js";import{b as St}from"./Dtu51PMB.js";import{b as pt}from"./Cc3l00Qu.js";import{D as Yr,t as yt,f as Et,l as jr,n as $r,u as Qr,o as Hn,p as Ct,q as At,r as qn,b as Mt,g as Vr,s as Kr,B as Gr,v as Zr,w as Xr,x as Jr,h as cn,d as zt,k as Tn}from"./9OwWMZAP.js";import{t as ht}from"./r7-tBYgy.js";import{c as ea}from"./B1PvWMeT.js";import{c as ta,a as ot,e as Rn,f as na,d as ra,V as aa}from"./Bai7YTd4.js";import{R as ze}from"./CrScDWWM.js";import{p as Nt}from"./hpFuuAZu.js";import{a as Ht}from"./BMIVoN_G.js";import{v as ia,D as sa}from"./DqFrpDF4.js";import{s as Mn}from"./CdEA5IGF.js";function oa(g,m){const w=Pn(g);return w.setHours(m),w}function la(g,m){const w=Pn(g);return w.setMinutes(m),w}var ca=ve('<div class="invalid-feedback d-block"> </div>'),da=ve("<option> </option>"),ua=ve('<div class="invalid-feedback d-block"> </div>'),fa=ve('<div class="invalid-feedback d-block"> </div>'),va=ve(`<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Title*</div> <input type="text" placeholder="" required/> <!> <small class="fw-lighter fst-italic">Displayed publicly on the calendar and announcements page. e.g. Ward Conference, Ward BBQ
			Night</small></div> <div class="d-flex flex-column gap-2"><div>Type*</div> <select class="form-select" aria-label="Select Type"><option>Calendar Event</option><option>Announcement</option></select></div> <div class="d-flex flex-column gap-2"><div>Organization*</div> <select aria-label="Select Organization"></select> <!> <small class="fw-lighter fst-italic">Displayed as a public badge on the event listing.</small></div> <div class="d-flex flex-column gap-2"><div>Visibility</div> <div class="form-check form-switch"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">Public (visible without login)</label></div> <small class="fw-lighter fst-italic">Turn off to restrict this event/announcement to logged-in users only.</small></div> <div class="d-flex flex-column gap-2"><div>Description</div> <textarea rows="4" placeholder="Event description (optional)"></textarea> <!> <small class="fw-lighter fst-italic">Shown publicly when viewers expand the event details. Supports basic HTML formatting.</small></div></div>`);function ma(g,m){dt(m,!1);const w=de(),s=de(),e=de();let n=me(m,"title",12,""),d=me(m,"eventType",12,"calendar_event"),l=me(m,"organization",12,""),_=me(m,"isPublic",12,!0),y=me(m,"description",12,""),a=me(m,"disabled",8,!1),t=me(m,"name",8,"event"),r=me(m,"validationErrors",24,()=>({})),c=de(),o=de();function S(){i(c)?.focus()}function M(){i(o)?.focus()}Be(()=>J(r()),()=>{F(w,!!r().title)}),Be(()=>J(r()),()=>{F(s,!!r().description)}),Be(()=>J(r()),()=>{F(e,!!r().organization)}),It();var x={focusTitle:S,focusDescription:M};gt();var B=va(),O=L(B),R=W(L(O),2);Ke(R);let z;pt(R,X=>F(c,X),()=>i(c));var p=W(R,2);{var T=X=>{var ue=ca(),te=L(ue,!0);P(ue),ye(()=>xe(te,(J(r()),ee(()=>r().title)))),ae(X,ue)};he(p,X=>{J(r()),ee(()=>r().title)&&X(T)})}Je(2),P(O);var f=W(O,2),v=W(L(f),2);ye(()=>{d(),fn(()=>{a()})});var b=L(v);b.value=b.__value="calendar_event";var D=W(b);D.value=D.__value="announcement",P(v),P(f);var A=W(f,2),k=W(L(A),2);ye(()=>{l(),fn(()=>{i(e),a()})});let E;$t(k,5,()=>Yr,Nn,(X,ue)=>{var te=da(),se=L(te,!0);P(te);var ge={};ye(()=>{xe(se,(i(ue),ee(()=>i(ue).label))),ge!==(ge=(i(ue),ee(()=>i(ue).key)))&&(te.value=(te.__value=(i(ue),ee(()=>i(ue).key)))??"")}),ae(X,te)}),P(k);var C=W(k,2);{var h=X=>{var ue=ua(),te=L(ue,!0);P(ue),ye(()=>xe(te,(J(r()),ee(()=>r().organization)))),ae(X,ue)};he(C,X=>{J(r()),ee(()=>r().organization)&&X(h)})}Je(2),P(A);var u=W(A,2),q=W(L(u),2),I=L(q);Ke(I);var H=W(I,2);P(q),Je(2),P(u);var G=W(u,2),$=W(L(G),2);Ur($);let j;pt($,X=>F(o,X),()=>i(o));var N=W($,2);{var U=X=>{var ue=fa(),te=L(ue,!0);P(ue),ye(()=>xe(te,(J(r()),ee(()=>r().description)))),ae(X,ue)};he(N,X=>{J(r()),ee(()=>r().description)&&X(U)})}return Je(2),P(G),P(B),ye(()=>{Ce(R,"name",`${t()??""}-title`),z=et(R,1,"form-control",null,z,{"is-invalid":i(w)}),R.disabled=a(),v.disabled=a(),E=et(k,1,"form-select",null,E,{"is-invalid":i(e)}),k.disabled=a(),Ce(I,"id",`${t()??""}-is-public`),I.disabled=a(),Ce(H,"for",`${t()??""}-is-public`),Ce($,"name",`${t()??""}-description`),j=et($,1,"form-control",null,j,{"is-invalid":i(s)}),$.disabled=a()}),Ie("focus",R,()=>i(c).select()),ct(R,n),vn(v,d),vn(k,l),hn(I,_),Ie("focus",$,()=>i(o).select()),ct($,y),ae(g,B),St(m,"focusTitle",S),St(m,"focusDescription",M),ut(x)}var ha=ve('<div class="invalid-feedback d-block"> </div>'),ga=ve('<div class="invalid-feedback d-block"> </div>'),_a=ve('<div class="invalid-feedback d-block"> </div>'),pa=ve('<div class="d-flex flex-column gap-4 ps-4"><div class="d-flex flex-column gap-2"><div>Start time*</div> <input type="time" required/> <!></div> <div class="d-flex flex-column gap-2"><div>End time*</div> <input type="time" required/> <!></div></div>'),ya=ve('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Date*</div> <input type="date" required/> <!></div> <div><div class="form-check d-flex align-items-center gap-2"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">All Day Event</label></div></div> <!></div>');function ba(g,m){dt(m,!1);const w=de(),s=de(),e=de();let n=me(m,"dateInput",12,""),d=me(m,"startTimeInput",12,""),l=me(m,"endTimeInput",12,""),_=me(m,"isAllDay",12,!1),y=me(m,"disabled",8,!1),a=me(m,"name",8,"event"),t=me(m,"validationErrors",24,()=>({})),r=de(),c=de(),o=de();const S=new Date().toISOString().split("T")[0];function M(){i(r)?.focus()}function x(){i(c)?.focus()}function B(){i(o)?.focus()}Be(()=>J(t()),()=>{F(w,!!t().dateInput)}),Be(()=>J(t()),()=>{F(s,!!t().startTimeInput)}),Be(()=>J(t()),()=>{F(e,!!t().endTimeInput)}),It();var O={focusDate:M,focusStartTime:x,focusEndTime:B};gt();var R=ya(),z=L(R),p=W(L(z),2);Ke(p);let T;pt(p,h=>F(r,h),()=>i(r));var f=W(p,2);{var v=h=>{var u=ha(),q=L(u,!0);P(u),ye(()=>xe(q,(J(t()),ee(()=>t().dateInput)))),ae(h,u)};he(f,h=>{J(t()),ee(()=>t().dateInput)&&h(v)})}P(z);var b=W(z,2),D=L(b),A=L(D);Ke(A);var k=W(A,2);P(D),P(b);var E=W(b,2);{var C=h=>{var u=pa(),q=L(u),I=W(L(q),2);Ke(I),Ce(I,"step",900);let H;pt(I,te=>F(c,te),()=>i(c));var G=W(I,2);{var $=te=>{var se=ga(),ge=L(se,!0);P(se),ye(()=>xe(ge,(J(t()),ee(()=>t().startTimeInput)))),ae(te,se)};he(G,te=>{J(t()),ee(()=>t().startTimeInput)&&te($)})}P(q);var j=W(q,2),N=W(L(j),2);Ke(N),Ce(N,"step",900);let U;pt(N,te=>F(o,te),()=>i(o));var X=W(N,2);{var ue=te=>{var se=_a(),ge=L(se,!0);P(se),ye(()=>xe(ge,(J(t()),ee(()=>t().endTimeInput)))),ae(te,se)};he(X,te=>{J(t()),ee(()=>t().endTimeInput)&&te(ue)})}P(j),P(u),ye(()=>{Ce(I,"name",`${a()??""}-start-time`),H=et(I,1,"form-control",null,H,{"is-invalid":i(s)}),I.disabled=y(),Ce(N,"name",`${a()??""}-end-time`),U=et(N,1,"form-control",null,U,{"is-invalid":i(e)}),N.disabled=y()}),Ie("focus",I,()=>i(c).select()),ct(I,d),Ie("focus",N,()=>i(o).select()),ct(N,l),ae(h,u)};he(E,h=>{_()||h(C)})}return P(R),ye(()=>{Ce(p,"name",`${a()??""}-date`),T=et(p,1,"form-control",null,T,{"is-invalid":i(w)}),p.disabled=y(),Ce(p,"min",S),Ce(A,"id",`${a()??""}-all-day-check`),A.disabled=y(),Ce(k,"for",`${a()??""}-all-day-check`)}),Ie("focus",p,()=>i(r).select()),ct(p,n),hn(A,_),ae(g,R),St(m,"focusDate",M),St(m,"focusStartTime",x),St(m,"focusEndTime",B),ut(O)}var wa=ve('<div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div>'),xa=ve('<div class="invalid-feedback d-block"> </div>'),Ea=ve('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold">Repeat on these days<span class="text-danger">*</span></div> <div class="d-flex flex-wrap gap-2"></div> <!> <small class="text-muted">Select at least one day when this event repeats</small></div>'),Aa=ve('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Monthly recurrence">Monthly recurrence</div> <div class="d-flex flex-column gap-2"><div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div></div></div>'),Da=ve('<div class="invalid-feedback d-block"> </div>'),Sa=ve('<div class="d-flex flex-column gap-3 ps-4"><div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Repeat pattern">Repeat pattern</div> <div class="row g-2 align-items-center"><div class="col-auto"><span class="text-muted">Every</span></div> <div class="col-auto"><input type="number" class="form-control" min="1" max="99" style="width: 80px;"/></div> <div class="col-auto"><select class="form-select"><option> </option><option> </option><option> </option><option> </option></select></div></div></div> <!> <!> <div class="d-flex flex-column gap-2"><label class="form-label fw-semibold">Repeat until<span class="text-danger">*</span></label> <input type="date" required/> <!> <small class="text-muted">The last date this event will occur</small></div></div>'),Ia=ve('<div class="d-flex flex-column gap-3"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label fw-semibold">Make this a recurring event</label></div> <!></div>');function ka(g,m){dt(m,!1);const w=[],s=[];let e=me(m,"isRecurring",12,!1),n=me(m,"recurrenceFrequency",12,"weekly"),d=me(m,"recurrenceInterval",12,1),l=me(m,"recurringDays",28,()=>[]),_=me(m,"recurrenceEndDate",12,""),y=me(m,"monthlyType",12,"date"),a=me(m,"dateInput",8,""),t=me(m,"disabled",8,!1),r=me(m,"name",8,"event"),c=me(m,"validationErrors",24,()=>({}));const o=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];function S(T){if(!T)return"Same weekday of the month";try{const f=new Date(T),v=He(f,"EEEE"),b=Math.ceil(f.getDate()/7);return`${["","1st","2nd","3rd","4th","5th"][b]} ${v} of the month`}catch{return"Same weekday of the month"}}function M(T){if(!T)return 1;try{return T.split("-").map(Number)[2]}catch{return 1}}gt();var x=Ia(),B=L(x),O=L(B);Ke(O);var R=W(O,2);P(B);var z=W(B,2);{var p=T=>{var f=Sa(),v=L(f),b=W(L(v),2),D=W(L(b),2),A=L(D);Ke(A),P(D);var k=W(D,2),E=L(k);ye(()=>{n(),fn(()=>{t(),d()})});var C=L(E),h=L(C,!0);P(C),C.value=C.__value="daily";var u=W(C),q=L(u,!0);P(u),u.value=u.__value="weekly";var I=W(u),H=L(I,!0);P(I),I.value=I.__value="monthly";var G=W(I),$=L(G,!0);P(G),G.value=G.__value="yearly",P(E),P(k),P(b),P(v);var j=W(v,2);{var N=Te=>{var Q=Ea(),Z=W(L(Q),2);$t(Z,5,()=>o,Nn,(oe,ce)=>{var ie=wa(),ne=L(ie);Ke(ne);var fe,_e=W(ne,2),le=L(_e,!0);P(_e),P(ie),ye(()=>{Ce(ne,"id",`${r()??""}-day-${i(ce),ee(()=>i(ce).value)??""}`),ne.disabled=t(),fe!==(fe=(i(ce),ee(()=>i(ce).value)))&&(ne.value=(ne.__value=(i(ce),ee(()=>i(ce).value)))??""),Ce(_e,"for",`${r()??""}-day-${i(ce),ee(()=>i(ce).value)??""}`),xe(le,(i(ce),ee(()=>i(ce).label)))}),ln(w,[],ne,()=>(i(ce),ee(()=>i(ce).value),l()),l),ae(oe,ie)}),P(Z);var V=W(Z,2);{var re=oe=>{var ce=xa(),ie=L(ce,!0);P(ce),ye(()=>xe(ie,(J(c()),ee(()=>c().recurringDays)))),ae(oe,ce)};he(V,oe=>{J(c()),ee(()=>c().recurringDays)&&oe(re)})}Je(2),P(Q),ae(Te,Q)};he(j,Te=>{n()==="weekly"&&Te(N)})}var U=W(j,2);{var X=Te=>{var Q=Aa(),Z=W(L(Q),2),V=L(Z),re=L(V);Ke(re),re.value=re.__value="date";var oe=W(re,2),ce=L(oe);P(oe),P(V);var ie=W(V,2),ne=L(ie);Ke(ne),ne.value=ne.__value="weekday";var fe=W(ne,2),_e=L(fe);P(fe),P(ie),P(Z),P(Q),ye((le,pe)=>{Ce(re,"id",`${r()??""}-monthly-date`),re.disabled=t(),Ce(oe,"for",`${r()??""}-monthly-date`),xe(ce,`On day ${le??""} of the month`),Ce(ne,"id",`${r()??""}-monthly-weekday`),ne.disabled=t(),Ce(fe,"for",`${r()??""}-monthly-weekday`),xe(_e,`On the ${pe??""}`)},[()=>(J(a()),ee(()=>M(a()))),()=>(J(a()),ee(()=>S(a())))]),ln(s,[],re,y,y),ln(s,[],ne,y,y),ae(Te,Q)};he(U,Te=>{n()==="monthly"&&Te(X)})}var ue=W(U,2),te=L(ue),se=W(te,2);Ke(se);let ge;var Se=W(se,2);{var De=Te=>{var Q=Da(),Z=L(Q,!0);P(Q),ye(()=>xe(Z,(J(c()),ee(()=>c().recurrenceEndDate)))),ae(Te,Q)};he(Se,Te=>{J(c()),ee(()=>c().recurrenceEndDate)&&Te(De)})}Je(2),P(ue),P(f),ye(()=>{A.disabled=t(),E.disabled=t(),xe(h,d()===1?"day":"days"),xe(q,d()===1?"week":"weeks"),xe(H,d()===1?"month":"months"),xe($,d()===1?"year":"years"),Ce(te,"for",`${r()??""}-recurrence-end-date`),ge=et(se,1,"form-control",null,ge,{"is-invalid":!!c().recurrenceEndDate}),Ce(se,"id",`${r()??""}-recurrence-end-date`),se.disabled=t()}),ct(A,d),vn(E,n),ct(se,_),ae(T,f)};he(z,T=>{e()&&T(p)})}P(x),ye(()=>{Ce(O,"id",`${r()??""}-is-recurring`),O.disabled=t(),Ce(R,"for",`${r()??""}-is-recurring`)}),hn(O,e),ae(g,x),ut()}var Ta=ve('<div class="d-flex flex-column gap-2"><div>Location</div> <input type="text" class="form-control" placeholder="Event location (optional)"/> <small class="fw-lighter fst-italic">Displayed publicly on the event listing. e.g. Cultural Hall, Stake Center</small></div>');function Ra(g,m){dt(m,!1);let w=me(m,"value",12,""),s=me(m,"disabled",8,!1),e=me(m,"name",8,"location"),n=de();function d(){i(n)?.focus()}var l={focus:d},_=Ta(),y=W(L(_),2);return Ke(y),pt(y,a=>F(n,a),()=>i(n)),Je(2),P(_),ye(()=>{Ce(y,"name",e()),y.disabled=s()}),Ie("focus",y,()=>i(n).select()),ct(y,w),ae(g,_),St(m,"focus",d),ut(l)}var Ma=ve('<input type="text" class="form-control form-control-sm"/> <small class="text-muted"> </small>',1),Ca=ve('<div class="fw-semibold"> </div> <small class="text-muted"> </small>',1),Fa=ve('<button type="button" class="btn btn-sm btn-success" title="Save"><i class="bi bi-check-lg"></i></button> <button type="button" class="btn btn-sm btn-secondary" title="Cancel"><i class="bi bi-x-lg"></i></button>',1),Ua=ve('<button type="button" class="btn btn-sm btn-outline-primary" title="Edit name"><i class="bi bi-pencil"></i></button> <button type="button" class="btn btn-sm btn-outline-danger" title="Delete"><i class="bi bi-trash"></i></button>',1),Oa=ve('<div class="d-flex align-items-center gap-2 p-2 border rounded"><div class="flex-grow-1"><!></div> <!></div>'),za=ve('<div class="d-flex flex-column gap-2 mb-2"></div>'),Pa=ve('<div class="d-flex flex-column gap-2"><div>Attachments</div> <!> <div class="d-flex flex-column gap-2"><div class="d-flex gap-2 align-items-center"><input type="file" class="form-control" accept="image/*,application/pdf"/> <!></div> <small class="fw-lighter fst-italic">Publicly visible in the event details. Max 5MB per file. Supports: images, PDFs</small></div></div>');function Ba(g,m){dt(m,!1);let w=me(m,"attachments",24,()=>[]),s=me(m,"disabled",8,!1),e=me(m,"uploadingFile",8,!1);const n=Mr();let d=de(),l=de(null),_=de("");const y=T=>{if(T===0)return"0 Bytes";const f=1024,v=["Bytes","KB","MB"],b=Math.floor(Math.log(T)/Math.log(f));return Math.round(T/Math.pow(f,b)*100)/100+" "+v[b]},a=T=>{const f=T.target;f.files&&f.files[0]&&(n("upload",f.files[0]),f.value="")},t=T=>{F(l,T.id),F(_,T.name)},r=T=>{i(_).trim()&&i(_)!==T.name&&n("edit",{attachment:T,newName:i(_).trim()}),F(l,null),F(_,"")},c=()=>{F(l,null),F(_,"")},o=T=>{n("remove",T)};gt();var S=Pa(),M=W(L(S),2);{var x=T=>{var f=za();$t(f,5,w,v=>v.id,(v,b)=>{var D=Oa(),A=L(D),k=L(A);{var E=I=>{var H=Ma(),G=Ve(H);Ke(G);var $=W(G,2),j=L($,!0);P($),ye(N=>{G.disabled=s(),xe(j,N)},[()=>(i(b),ee(()=>y(i(b).size)))]),ct(G,()=>i(_),N=>F(_,N)),Ie("keydown",G,N=>{N.key==="Enter"&&r(i(b)),N.key==="Escape"&&c()}),ae(I,H)},C=I=>{var H=Ca(),G=Ve(H),$=L(G,!0);P(G);var j=W(G,2),N=L(j,!0);P(j),ye(U=>{xe($,(i(b),ee(()=>i(b).name))),xe(N,U)},[()=>(i(b),ee(()=>y(i(b).size)))]),ae(I,H)};he(k,I=>{i(l),i(b),ee(()=>i(l)===i(b).id)?I(E):I(C,!1)})}P(A);var h=W(A,2);{var u=I=>{var H=Fa(),G=Ve(H),$=W(G,2);ye(()=>{G.disabled=s(),$.disabled=s()}),Ie("click",G,()=>r(i(b))),Ie("click",$,c),ae(I,H)},q=I=>{var H=Ua(),G=Ve(H),$=W(G,2);ye(()=>{G.disabled=s(),$.disabled=s()}),Ie("click",G,()=>t(i(b))),Ie("click",$,()=>o(i(b))),ae(I,H)};he(h,I=>{i(l),i(b),ee(()=>i(l)===i(b).id)?I(u):I(q,!1)})}P(D),ae(v,D)}),P(f),ae(T,f)};he(M,T=>{J(w()),ee(()=>w().length>0)&&T(x)})}var B=W(M,2),O=L(B),R=L(O);pt(R,T=>F(d,T),()=>i(d));var z=W(R,2);{var p=T=>{Ln(T,{size:"sm"})};he(z,T=>{e()&&T(p)})}P(O),Je(2),P(B),P(S),ye(()=>R.disabled=s()||e()),Ie("change",R,a),ae(g,S),ut()}var La=ve('<div class="modal svelte-xtxevo" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Edit Recurring Event</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">How would you like to edit it?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">The entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function Na(g,m){dt(m,!1);const w=de();let s=me(m,"eventTitle",8),e=me(m,"occurrenceDate",8),n=me(m,"callback",8);function d(D){n()(D)}function l(){n()(null)}Be(()=>(J(e()),He),()=>{F(w,(()=>{try{const[D,A,k]=e().split("-").map(Number),E=new Date(D,A-1,k);return He(E,"EEEE, MMMM d, yyyy")}catch{return e()}})())}),It(),gt();var _=La(),y=L(_),a=L(y),t=L(a),r=W(L(t),2);P(t);var c=W(t,2),o=L(c),S=L(o),M=L(S);P(S),Je(),P(o);var x=W(o,4),B=L(x),O=W(L(B),2),R=L(O,!0);P(O),P(B);var z=W(B,2),p=W(L(z),2),T=L(p);P(p),P(z);var f=W(z,2);P(x),P(c);var v=W(c,2),b=L(v);P(v),P(a),P(y),P(_),ye(()=>{xe(M,`"${s()??""}"`),xe(R,i(w)),xe(T,`From ${i(w)??""} onwards`)}),Ie("click",r,l),Ie("click",B,()=>d("single")),Ie("click",z,()=>d("future")),Ie("click",f,()=>d("all")),Ie("click",b,l),ae(g,_),ut()}var Ha=ve('<div class="modal svelte-gu1ski" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Recurring Event</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">What would you like to delete?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">Delete the entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function qa(g,m){dt(m,!1);const w=de();let s=me(m,"eventTitle",8),e=me(m,"occurrenceDate",8),n=me(m,"callback",8);function d(D){n()(D)}function l(){n()(null)}Be(()=>(J(e()),He),()=>{F(w,(()=>{try{const[D,A,k]=e().split("-").map(Number),E=new Date(D,A-1,k);return He(E,"EEEE, MMMM d, yyyy")}catch{return e()}})())}),It(),gt();var _=Ha(),y=L(_),a=L(y),t=L(a),r=W(L(t),2);P(t);var c=W(t,2),o=L(c),S=L(o),M=L(S);P(S),Je(),P(o);var x=W(o,4),B=L(x),O=W(L(B),2),R=L(O,!0);P(O),P(B);var z=W(B,2),p=W(L(z),2),T=L(p);P(p),P(z);var f=W(z,2);P(x),P(c);var v=W(c,2),b=L(v);P(v),P(a),P(y),P(_),ye(()=>{xe(M,`"${s()??""}"`),xe(R,i(w)),xe(T,`From ${i(w)??""} onwards`)}),Ie("click",r,l),Ie("click",B,()=>d("single")),Ie("click",z,()=>d("future")),Ie("click",f,()=>d("all")),Ie("click",b,l),ae(g,_),ut()}var Wa=ve('<div class="modal fade" tabindex="-1" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div> <div class="modal-body"><p> </p> <div class="mb-3"><label for="cloneDate" class="form-label">Event Date</label> <input type="date" class="form-control" id="cloneDate"/></div></div> <div class="modal-footer"><button type="button"> </button> <button type="button"> </button></div></div></div></div>');function Ya(g,m){dt(m,!1);let w=me(m,"title",8,"Clone Event"),s=me(m,"message",8,"Select a date for the cloned event:"),e=me(m,"confirmButtonLabel",8,"Clone"),n=me(m,"confirmButtonCSS",8,"btn-primary"),d=me(m,"rejectButtonLabel",8,"Cancel"),l=me(m,"rejectButtonCSS",8,"btn-secondary"),_=me(m,"defaultDate",8,void 0),y=me(m,"callback",8,()=>{}),a=de(),t=de(_()||He(new Date,"yyyy-MM-dd")),r=!1,c;zn(()=>{const h=window.bootstrap.Modal;new h(i(a)).show(),i(a).addEventListener("hidden.bs.modal",()=>{r?y()(!0,c):y()(!1)})});function o(){r=!0,c=i(t),window.bootstrap.Modal.getInstance(i(a)).hide()}function S(){r=!1,window.bootstrap.Modal.getInstance(i(a)).hide()}gt();var M=Wa(),x=L(M),B=L(x),O=L(B),R=L(O),z=L(R,!0);P(R),Je(2),P(O);var p=W(O,2),T=L(p),f=L(T,!0);P(T);var v=W(T,2),b=W(L(v),2);Ke(b),P(v),P(p);var D=W(p,2),A=L(D),k=L(A,!0);P(A);var E=W(A,2),C=L(E,!0);P(E),P(D),P(B),P(x),P(M),pt(M,h=>F(a,h),()=>i(a)),ye(()=>{xe(z,w()),xe(f,s()),et(A,1,`btn ${l()??""}`),xe(k,d()),et(E,1,`btn ${n()??""}`),xe(C,e())}),ct(b,()=>i(t),h=>F(t,h)),Ie("click",A,S),Ie("click",E,o),ae(g,M),ut()}let Pt;function ja(g){if(typeof document>"u")return;const m=document.createElement("div");document.body.appendChild(m);const w={title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",rejectButtonLabel:"Cancel",rejectButtonCSS:"btn-secondary",callback:()=>{console.log("callback")}};g.title&&(w.title=g.title),g.message&&(w.message=g.message),g.confirmButtonLabel&&(w.confirmButtonLabel=g.confirmButtonLabel),g.confirmButtonCSS&&(w.confirmButtonCSS=g.confirmButtonCSS),g.rejectButtonLabel&&(w.rejectButtonLabel=g.rejectButtonLabel),g.rejectButtonCSS&&(w.rejectButtonCSS=g.rejectButtonCSS),g.defaultDate&&(w.defaultDate=g.defaultDate),w.callback=(s,e)=>{console.log("Clone confirm result:",s,e),Pt&&(Pr(Pt),Pt=void 0),m.remove(),g.callback&&typeof g.callback=="function"&&g.callback(s,e)},Pt=zr(Ya,{target:m,props:w})}const $a=ta().shape({title:ot().required("Title is required").min(3,"Title must be at least 3 characters").max(255,"Title cannot exceed 255 characters"),event_type:ot().oneOf(["calendar_event","announcement"],"Invalid event type").required("Event type is required"),organization:ot().required("Organization is required"),description:ot().nullable().max(1e4,"Description is too long"),location:ot().nullable().max(255,"Location cannot exceed 255 characters"),dateInput:ot().when("event_type",{is:"calendar_event",then:g=>g.required("Date is required"),otherwise:g=>g.nullable()}),startTimeInput:ot().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("Start time is required"),otherwise:g=>g.nullable()}),endTimeInput:ot().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("End time is required"),otherwise:g=>g.nullable()}),isRecurring:Rn(),recurrenceFrequency:ot().oneOf(["daily","weekly","monthly","yearly"]).nullable(),recurringDays:na().of(ra().min(0).max(6)).when(["isRecurring","recurrenceFrequency"],{is:(g,m)=>g&&m==="weekly",then:g=>g.min(1,"Select at least one day for weekly recurring events").required(),otherwise:g=>g.nullable()}),hasEndDate:Rn(),recurrenceEndDate:ot().when(["isRecurring","hasEndDate"],{is:(g,m)=>g&&m,then:g=>g.required("End date is required").test("is-future","End date must be in the future",function(m){if(!m)return!1;const w=new Date(m),s=new Date;return s.setHours(0,0,0,0),w>=s}),otherwise:g=>g.nullable()})});function Qa(){const g=Cr({});async function m(e){try{return await $a.validate(e,{abortEarly:!1}),g.set({}),!0}catch(n){if(n instanceof aa){const d={};return n.inner.forEach(l=>{l.path&&(d[l.path]=l.message)}),g.set(d),!1}return!1}}function w(){g.set({})}function s(){return Object.values(un(g)).filter(n=>n.length>0)}return{validationErrors:g,validate:m,clearErrors:w,getErrorMessages:s}}function gn(g){const{frequency:m,interval:w,recurringDays:s,recurrenceEndDate:e,hasEndDate:n,monthlyType:d,startTime:l}=g,_={0:ze.SU,1:ze.MO,2:ze.TU,3:ze.WE,4:ze.TH,5:ze.FR,6:ze.SA},y={daily:ze.DAILY,weekly:ze.WEEKLY,monthly:ze.MONTHLY,yearly:ze.YEARLY},a=new Date(l),t=yt(a,Ge),r=new Date(t);r.setHours(12,0,0,0);const c=Et(r,Ge),o={freq:y[m],interval:w,dtstart:c};if(n&&e){const M=new Date(`${e}T23:59:59.999`),x=Et(M,Ge);o.until=x}if(m==="weekly"&&s.length>0)o.byweekday=s.map(M=>_[M]);else if(m==="monthly")if(d==="date")o.bymonthday=[r.getDate()];else{const M=Math.ceil(r.getDate()/7),x=r.getDay(),B=[ze.SU,ze.MO,ze.TU,ze.WE,ze.TH,ze.FR,ze.SA];o.byweekday=[B[x].nth(M)]}else m==="yearly"&&(o.bymonth=[r.getMonth()+1],o.bymonthday=[r.getDate()]);return{recurrence_rule:new ze(o).toString(),recurrence_end_date:n&&e?o.until.toISOString():void 0}}function Wn(g,m){try{const s=ze.fromString(g).origOptions,e={6:0,0:1,1:2,2:3,3:4,4:5,5:6},n={[ze.DAILY]:"daily",[ze.WEEKLY]:"weekly",[ze.MONTHLY]:"monthly",[ze.YEARLY]:"yearly"},d=(s.freq!==void 0?n[s.freq]:null)||"weekly",l=s.interval||1;let _=[],y="date";s.byweekday&&d==="weekly"&&(_=(Array.isArray(s.byweekday)?s.byweekday:[s.byweekday]).map(r=>{const c=typeof r=="number"?r:r.weekday;return e[c]})),d==="monthly"&&(s.bymonthday&&Array.isArray(s.bymonthday)&&s.bymonthday.length>0?y="date":s.byweekday&&(y="weekday"));let a="",t=!1;if(m){t=!0;const r=yt(new Date(m),Ge);a=He(r,"yyyy-MM-dd")}else if(s.until){t=!0;const r=yt(s.until,Ge);a=He(r,"yyyy-MM-dd")}return{frequency:d,interval:l,recurringDays:_,recurrenceEndDate:a,hasEndDate:t,monthlyType:y}}catch(w){return console.error("Failed to parse recurrence rule:",w),null}}function Yn(){return{recurrence_rule:void 0,recurrence_end_date:void 0}}function jn(){return{generateRecurrenceRule:gn,parseRecurrenceRule:Wn,clearRecurrence:Yn}}const mn=Object.freeze(Object.defineProperty({__proto__:null,clearRecurrence:Yn,generateRecurrenceRule:gn,parseRecurrenceRule:Wn,useRecurrenceLogic:jn},Symbol.toStringTag,{value:"Module"}));function Va(g,m){return m.forEach(function(w){w&&typeof w!="string"&&!Array.isArray(w)&&Object.keys(w).forEach(function(s){if(s!=="default"&&!(s in g)){var e=Object.getOwnPropertyDescriptor(w,s);Object.defineProperty(g,s,e.get?e:{enumerable:!0,get:function(){return w[s]}})}})}),Object.freeze(g)}function $n(g,m){return new Promise(function(w,s){let e;return Ka(g).then(function(n){try{return e=n,w(new Blob([m.slice(0,2),e,m.slice(2)],{type:"image/jpeg"}))}catch(d){return s(d)}},s)})}const Ka=g=>new Promise((m,w)=>{const s=new FileReader;s.addEventListener("load",({target:{result:e}})=>{const n=new DataView(e);let d=0;if(n.getUint16(d)!==65496)return w("not a valid JPEG");for(d+=2;;){const l=n.getUint16(d);if(l===65498)break;const _=n.getUint16(d+2);if(l===65505&&n.getUint32(d+4)===1165519206){const y=d+10;let a;switch(n.getUint16(y)){case 18761:a=!0;break;case 19789:a=!1;break;default:return w("TIFF header contains invalid endian")}if(n.getUint16(y+2,a)!==42)return w("TIFF header contains invalid version");const t=n.getUint32(y+4,a),r=y+t+2+12*n.getUint16(y+t,a);for(let c=y+t+2;c<r;c+=12)if(n.getUint16(c,a)==274){if(n.getUint16(c+2,a)!==3)return w("Orientation data type is invalid");if(n.getUint32(c+4,a)!==1)return w("Orientation data count is invalid");n.setUint16(c+8,1,a);break}return m(e.slice(d,d+2+_))}d+=2+_}return m(new Blob)}),s.readAsArrayBuffer(g)});var qt={},Ga={get exports(){return qt},set exports(g){qt=g}};(function(g){var m,w,s={};Ga.exports=s,s.parse=function(e,n){for(var d=s.bin.readUshort,l=s.bin.readUint,_=0,y={},a=new Uint8Array(e),t=a.length-4;l(a,t)!=101010256;)t--;_=t,_+=4;var r=d(a,_+=4);d(a,_+=2);var c=l(a,_+=2),o=l(a,_+=4);_+=4,_=o;for(var S=0;S<r;S++){l(a,_),_+=4,_+=4,_+=4,l(a,_+=4),c=l(a,_+=4);var M=l(a,_+=4),x=d(a,_+=4),B=d(a,_+2),O=d(a,_+4);_+=6;var R=l(a,_+=8);_+=4,_+=x+B+O,s._readLocal(a,R,y,c,M,n)}return y},s._readLocal=function(e,n,d,l,_,y){var a=s.bin.readUshort,t=s.bin.readUint;t(e,n),a(e,n+=4),a(e,n+=2);var r=a(e,n+=2);t(e,n+=2),t(e,n+=4),n+=4;var c=a(e,n+=8),o=a(e,n+=2);n+=2;var S=s.bin.readUTF8(e,n,c);if(n+=c,n+=o,y)d[S]={size:_,csize:l};else{var M=new Uint8Array(e.buffer,n);if(r==0)d[S]=new Uint8Array(M.buffer.slice(n,n+l));else{if(r!=8)throw"unknown compression method: "+r;var x=new Uint8Array(_);s.inflateRaw(M,x),d[S]=x}}},s.inflateRaw=function(e,n){return s.F.inflate(e,n)},s.inflate=function(e,n){return e[0],e[1],s.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),n)},s.deflate=function(e,n){n==null&&(n={level:6});var d=0,l=new Uint8Array(50+Math.floor(1.1*e.length));l[d]=120,l[d+1]=156,d+=2,d=s.F.deflateRaw(e,l,d,n.level);var _=s.adler(e,0,e.length);return l[d+0]=_>>>24&255,l[d+1]=_>>>16&255,l[d+2]=_>>>8&255,l[d+3]=_>>>0&255,new Uint8Array(l.buffer,0,d+4)},s.deflateRaw=function(e,n){n==null&&(n={level:6});var d=new Uint8Array(50+Math.floor(1.1*e.length)),l=s.F.deflateRaw(e,d,l,n.level);return new Uint8Array(d.buffer,0,l)},s.encode=function(e,n){n==null&&(n=!1);var d=0,l=s.bin.writeUint,_=s.bin.writeUshort,y={};for(var a in e){var t=!s._noNeed(a)&&!n,r=e[a],c=s.crc.crc(r,0,r.length);y[a]={cpr:t,usize:r.length,crc:c,file:t?s.deflateRaw(r):r}}for(var a in y)d+=y[a].file.length+30+46+2*s.bin.sizeUTF8(a);d+=22;var o=new Uint8Array(d),S=0,M=[];for(var a in y){var x=y[a];M.push(S),S=s._writeHeader(o,S,a,x,0)}var B=0,O=S;for(var a in y)x=y[a],M.push(S),S=s._writeHeader(o,S,a,x,1,M[B++]);var R=S-O;return l(o,S,101010256),S+=4,_(o,S+=4,B),_(o,S+=2,B),l(o,S+=2,R),l(o,S+=4,O),S+=4,S+=2,o.buffer},s._noNeed=function(e){var n=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(n)!=-1},s._writeHeader=function(e,n,d,l,_,y){var a=s.bin.writeUint,t=s.bin.writeUshort,r=l.file;return a(e,n,_==0?67324752:33639248),n+=4,_==1&&(n+=2),t(e,n,20),t(e,n+=2,0),t(e,n+=2,l.cpr?8:0),a(e,n+=2,0),a(e,n+=4,l.crc),a(e,n+=4,r.length),a(e,n+=4,l.usize),t(e,n+=4,s.bin.sizeUTF8(d)),t(e,n+=2,0),n+=2,_==1&&(n+=2,n+=2,a(e,n+=6,y),n+=4),n+=s.bin.writeUTF8(e,n,d),_==0&&(e.set(r,n),n+=r.length),n},s.crc={table:function(){for(var e=new Uint32Array(256),n=0;n<256;n++){for(var d=n,l=0;l<8;l++)1&d?d=3988292384^d>>>1:d>>>=1;e[n]=d}return e}(),update:function(e,n,d,l){for(var _=0;_<l;_++)e=s.crc.table[255&(e^n[d+_])]^e>>>8;return e},crc:function(e,n,d){return 4294967295^s.crc.update(4294967295,e,n,d)}},s.adler=function(e,n,d){for(var l=1,_=0,y=n,a=n+d;y<a;){for(var t=Math.min(y+5552,a);y<t;)_+=l+=e[y++];l%=65521,_%=65521}return _<<16|l},s.bin={readUshort:function(e,n){return e[n]|e[n+1]<<8},writeUshort:function(e,n,d){e[n]=255&d,e[n+1]=d>>8&255},readUint:function(e,n){return 16777216*e[n+3]+(e[n+2]<<16|e[n+1]<<8|e[n])},writeUint:function(e,n,d){e[n]=255&d,e[n+1]=d>>8&255,e[n+2]=d>>16&255,e[n+3]=d>>24&255},readASCII:function(e,n,d){for(var l="",_=0;_<d;_++)l+=String.fromCharCode(e[n+_]);return l},writeASCII:function(e,n,d){for(var l=0;l<d.length;l++)e[n+l]=d.charCodeAt(l)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,n,d){for(var l,_="",y=0;y<d;y++)_+="%"+s.bin.pad(e[n+y].toString(16));try{l=decodeURIComponent(_)}catch{return s.bin.readASCII(e,n,d)}return l},writeUTF8:function(e,n,d){for(var l=d.length,_=0,y=0;y<l;y++){var a=d.charCodeAt(y);if(!(4294967168&a))e[n+_]=a,_++;else if(!(4294965248&a))e[n+_]=192|a>>6,e[n+_+1]=128|a>>0&63,_+=2;else if(!(4294901760&a))e[n+_]=224|a>>12,e[n+_+1]=128|a>>6&63,e[n+_+2]=128|a>>0&63,_+=3;else{if(4292870144&a)throw"e";e[n+_]=240|a>>18,e[n+_+1]=128|a>>12&63,e[n+_+2]=128|a>>6&63,e[n+_+3]=128|a>>0&63,_+=4}}return _},sizeUTF8:function(e){for(var n=e.length,d=0,l=0;l<n;l++){var _=e.charCodeAt(l);if(!(4294967168&_))d++;else if(!(4294965248&_))d+=2;else if(!(4294901760&_))d+=3;else{if(4292870144&_)throw"e";d+=4}}return d}},s.F={},s.F.deflateRaw=function(e,n,d,l){var _=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][l],y=s.F.U,a=s.F._goodIndex;s.F._hash;var t=s.F._putsE,r=0,c=d<<3,o=0,S=e.length;if(l==0){for(;r<S;)t(n,c,r+(D=Math.min(65535,S-r))==S?1:0),c=s.F._copyExact(e,r,D,n,c+8),r+=D;return c>>>3}var M=y.lits,x=y.strt,B=y.prev,O=0,R=0,z=0,p=0,T=0,f=0;for(S>2&&(x[f=s.F._hash(e,0)]=0),r=0;r<S;r++){if(T=f,r+1<S-2){f=s.F._hash(e,r+1);var v=r+1&32767;B[v]=x[f],x[f]=v}if(o<=r){(O>14e3||R>26697)&&S-r>100&&(o<r&&(M[O]=r-o,O+=2,o=r),c=s.F._writeBlock(r==S-1||o==S?1:0,M,O,p,e,z,r-z,n,c),O=R=p=0,z=r);var b=0;r<S-2&&(b=s.F._bestMatch(e,r,B,T,Math.min(_[2],S-r),_[3]));var D=b>>>16,A=65535&b;if(b!=0){A=65535&b;var k=a(D=b>>>16,y.of0);y.lhst[257+k]++;var E=a(A,y.df0);y.dhst[E]++,p+=y.exb[k]+y.dxb[E],M[O]=D<<23|r-o,M[O+1]=A<<16|k<<8|E,O+=2,o=r+D}else y.lhst[e[r]]++;R++}}for(z==r&&e.length!=0||(o<r&&(M[O]=r-o,O+=2,o=r),c=s.F._writeBlock(1,M,O,p,e,z,r-z,n,c),O=0,R=0,O=R=p=0,z=r);7&c;)c++;return c>>>3},s.F._bestMatch=function(e,n,d,l,_,y){var a=32767&n,t=d[a],r=a-t+32768&32767;if(t==a||l!=s.F._hash(e,n-r))return 0;for(var c=0,o=0,S=Math.min(32767,n);r<=S&&--y!=0&&t!=a;){if(c==0||e[n+c]==e[n+c-r]){var M=s.F._howLong(e,n,r);if(M>c){if(o=r,(c=M)>=_)break;r+2<M&&(M=r+2);for(var x=0,B=0;B<M-2;B++){var O=n-r+B+32768&32767,R=O-d[O]+32768&32767;R>x&&(x=R,t=O)}}}r+=(a=t)-(t=d[a])+32768&32767}return c<<16|o},s.F._howLong=function(e,n,d){if(e[n]!=e[n-d]||e[n+1]!=e[n+1-d]||e[n+2]!=e[n+2-d])return 0;var l=n,_=Math.min(e.length,n+258);for(n+=3;n<_&&e[n]==e[n-d];)n++;return n-l},s.F._hash=function(e,n){return(e[n]<<8|e[n+1])+(e[n+2]<<4)&65535},s.saved=0,s.F._writeBlock=function(e,n,d,l,_,y,a,t,r){var c,o,S,M,x,B,O,R,z,p=s.F.U,T=s.F._putsF,f=s.F._putsE;p.lhst[256]++,o=(c=s.F.getTrees())[0],S=c[1],M=c[2],x=c[3],B=c[4],O=c[5],R=c[6],z=c[7];var v=32+(r+3&7?8-(r+3&7):0)+(a<<3),b=l+s.F.contSize(p.fltree,p.lhst)+s.F.contSize(p.fdtree,p.dhst),D=l+s.F.contSize(p.ltree,p.lhst)+s.F.contSize(p.dtree,p.dhst);D+=14+3*O+s.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var A=0;A<286;A++)p.lhst[A]=0;for(A=0;A<30;A++)p.dhst[A]=0;for(A=0;A<19;A++)p.ihst[A]=0;var k=v<b&&v<D?0:b<D?1:2;if(T(t,r,e),T(t,r+1,k),r+=3,k==0){for(;7&r;)r++;r=s.F._copyExact(_,y,a,t,r)}else{var E,C;if(k==1&&(E=p.fltree,C=p.fdtree),k==2){s.F.makeCodes(p.ltree,o),s.F.revCodes(p.ltree,o),s.F.makeCodes(p.dtree,S),s.F.revCodes(p.dtree,S),s.F.makeCodes(p.itree,M),s.F.revCodes(p.itree,M),E=p.ltree,C=p.dtree,f(t,r,x-257),f(t,r+=5,B-1),f(t,r+=5,O-4),r+=4;for(var h=0;h<O;h++)f(t,r+3*h,p.itree[1+(p.ordr[h]<<1)]);r+=3*O,r=s.F._codeTiny(R,p.itree,t,r),r=s.F._codeTiny(z,p.itree,t,r)}for(var u=y,q=0;q<d;q+=2){for(var I=n[q],H=I>>>23,G=u+(8388607&I);u<G;)r=s.F._writeLit(_[u++],E,t,r);if(H!=0){var $=n[q+1],j=$>>16,N=$>>8&255,U=255&$;f(t,r=s.F._writeLit(257+N,E,t,r),H-p.of0[N]),r+=p.exb[N],T(t,r=s.F._writeLit(U,C,t,r),j-p.df0[U]),r+=p.dxb[U],u+=H}}r=s.F._writeLit(256,E,t,r)}return r},s.F._copyExact=function(e,n,d,l,_){var y=_>>>3;return l[y]=d,l[y+1]=d>>>8,l[y+2]=255-l[y],l[y+3]=255-l[y+1],y+=4,l.set(new Uint8Array(e.buffer,n,d),y),_+(d+4<<3)},s.F.getTrees=function(){for(var e=s.F.U,n=s.F._hufTree(e.lhst,e.ltree,15),d=s.F._hufTree(e.dhst,e.dtree,15),l=[],_=s.F._lenCodes(e.ltree,l),y=[],a=s.F._lenCodes(e.dtree,y),t=0;t<l.length;t+=2)e.ihst[l[t]]++;for(t=0;t<y.length;t+=2)e.ihst[y[t]]++;for(var r=s.F._hufTree(e.ihst,e.itree,7),c=19;c>4&&e.itree[1+(e.ordr[c-1]<<1)]==0;)c--;return[n,d,r,_,a,c,l,y]},s.F.getSecond=function(e){for(var n=[],d=0;d<e.length;d+=2)n.push(e[d+1]);return n},s.F.nonZero=function(e){for(var n="",d=0;d<e.length;d+=2)e[d+1]!=0&&(n+=(d>>1)+",");return n},s.F.contSize=function(e,n){for(var d=0,l=0;l<n.length;l++)d+=n[l]*e[1+(l<<1)];return d},s.F._codeTiny=function(e,n,d,l){for(var _=0;_<e.length;_+=2){var y=e[_],a=e[_+1];l=s.F._writeLit(y,n,d,l);var t=y==16?2:y==17?3:7;y>15&&(s.F._putsE(d,l,a,t),l+=t)}return l},s.F._lenCodes=function(e,n){for(var d=e.length;d!=2&&e[d-1]==0;)d-=2;for(var l=0;l<d;l+=2){var _=e[l+1],y=l+3<d?e[l+3]:-1,a=l+5<d?e[l+5]:-1,t=l==0?-1:e[l-1];if(_==0&&y==_&&a==_){for(var r=l+5;r+2<d&&e[r+2]==_;)r+=2;(c=Math.min(r+1-l>>>1,138))<11?n.push(17,c-3):n.push(18,c-11),l+=2*c-2}else if(_==t&&y==_&&a==_){for(r=l+5;r+2<d&&e[r+2]==_;)r+=2;var c=Math.min(r+1-l>>>1,6);n.push(16,c-3),l+=2*c-2}else n.push(_,0)}return d>>>1},s.F._hufTree=function(e,n,d){var l=[],_=e.length,y=n.length,a=0;for(a=0;a<y;a+=2)n[a]=0,n[a+1]=0;for(a=0;a<_;a++)e[a]!=0&&l.push({lit:a,f:e[a]});var t=l.length,r=l.slice(0);if(t==0)return 0;if(t==1){var c=l[0].lit;return r=c==0?1:0,n[1+(c<<1)]=1,n[1+(r<<1)]=1,1}l.sort(function(R,z){return R.f-z.f});var o=l[0],S=l[1],M=0,x=1,B=2;for(l[0]={lit:-1,f:o.f+S.f,l:o,r:S,d:0};x!=t-1;)o=M!=x&&(B==t||l[M].f<l[B].f)?l[M++]:l[B++],S=M!=x&&(B==t||l[M].f<l[B].f)?l[M++]:l[B++],l[x++]={lit:-1,f:o.f+S.f,l:o,r:S};var O=s.F.setDepth(l[x-1],0);for(O>d&&(s.F.restrictDepth(r,d,O),O=d),a=0;a<t;a++)n[1+(r[a].lit<<1)]=r[a].d;return O},s.F.setDepth=function(e,n){return e.lit!=-1?(e.d=n,n):Math.max(s.F.setDepth(e.l,n+1),s.F.setDepth(e.r,n+1))},s.F.restrictDepth=function(e,n,d){var l=0,_=1<<d-n,y=0;for(e.sort(function(t,r){return r.d==t.d?t.f-r.f:r.d-t.d}),l=0;l<e.length&&e[l].d>n;l++){var a=e[l].d;e[l].d=n,y+=_-(1<<d-a)}for(y>>>=d-n;y>0;)(a=e[l].d)<n?(e[l].d++,y-=1<<n-a-1):l++;for(;l>=0;l--)e[l].d==n&&y<0&&(e[l].d--,y++);y!=0&&console.log("debt left")},s.F._goodIndex=function(e,n){var d=0;return n[16|d]<=e&&(d|=16),n[8|d]<=e&&(d|=8),n[4|d]<=e&&(d|=4),n[2|d]<=e&&(d|=2),n[1|d]<=e&&(d|=1),d},s.F._writeLit=function(e,n,d,l){return s.F._putsF(d,l,n[e<<1]),l+n[1+(e<<1)]},s.F.inflate=function(e,n){var d=Uint8Array;if(e[0]==3&&e[1]==0)return n||new d(0);var l=s.F,_=l._bitsF,y=l._bitsE,a=l._decodeTiny,t=l.makeCodes,r=l.codes2map,c=l._get17,o=l.U,S=n==null;S&&(n=new d(e.length>>>2<<3));for(var M,x,B=0,O=0,R=0,z=0,p=0,T=0,f=0,v=0,b=0;B==0;)if(B=_(e,b,1),O=_(e,b+1,2),b+=3,O!=0){if(S&&(n=s.F._check(n,v+(1<<17))),O==1&&(M=o.flmap,x=o.fdmap,T=511,f=31),O==2){R=y(e,b,5)+257,z=y(e,b+5,5)+1,p=y(e,b+10,4)+4,b+=14;for(var D=0;D<38;D+=2)o.itree[D]=0,o.itree[D+1]=0;var A=1;for(D=0;D<p;D++){var k=y(e,b+3*D,3);o.itree[1+(o.ordr[D]<<1)]=k,k>A&&(A=k)}b+=3*p,t(o.itree,A),r(o.itree,A,o.imap),M=o.lmap,x=o.dmap,b=a(o.imap,(1<<A)-1,R+z,e,b,o.ttree);var E=l._copyOut(o.ttree,0,R,o.ltree);T=(1<<E)-1;var C=l._copyOut(o.ttree,R,z,o.dtree);f=(1<<C)-1,t(o.ltree,E),r(o.ltree,E,M),t(o.dtree,C),r(o.dtree,C,x)}for(;;){var h=M[c(e,b)&T];b+=15&h;var u=h>>>4;if(!(u>>>8))n[v++]=u;else{if(u==256)break;var q=v+u-254;if(u>264){var I=o.ldef[u-257];q=v+(I>>>3)+y(e,b,7&I),b+=7&I}var H=x[c(e,b)&f];b+=15&H;var G=H>>>4,$=o.ddef[G],j=($>>>4)+_(e,b,15&$);for(b+=15&$,S&&(n=s.F._check(n,v+(1<<17)));v<q;)n[v]=n[v++-j],n[v]=n[v++-j],n[v]=n[v++-j],n[v]=n[v++-j];v=q}}}else{7&b&&(b+=8-(7&b));var N=4+(b>>>3),U=e[N-4]|e[N-3]<<8;S&&(n=s.F._check(n,v+U)),n.set(new d(e.buffer,e.byteOffset+N,U),v),b=N+U<<3,v+=U}return n.length==v?n:n.slice(0,v)},s.F._check=function(e,n){var d=e.length;if(n<=d)return e;var l=new Uint8Array(Math.max(d<<1,n));return l.set(e,0),l},s.F._decodeTiny=function(e,n,d,l,_,y){for(var a=s.F._bitsE,t=s.F._get17,r=0;r<d;){var c=e[t(l,_)&n];_+=15&c;var o=c>>>4;if(o<=15)y[r]=o,r++;else{var S=0,M=0;o==16?(M=3+a(l,_,2),_+=2,S=y[r-1]):o==17?(M=3+a(l,_,3),_+=3):o==18&&(M=11+a(l,_,7),_+=7);for(var x=r+M;r<x;)y[r]=S,r++}}return _},s.F._copyOut=function(e,n,d,l){for(var _=0,y=0,a=l.length>>>1;y<d;){var t=e[y+n];l[y<<1]=0,l[1+(y<<1)]=t,t>_&&(_=t),y++}for(;y<a;)l[y<<1]=0,l[1+(y<<1)]=0,y++;return _},s.F.makeCodes=function(e,n){for(var d,l,_,y,a=s.F.U,t=e.length,r=a.bl_count,c=0;c<=n;c++)r[c]=0;for(c=1;c<t;c+=2)r[e[c]]++;var o=a.next_code;for(d=0,r[0]=0,l=1;l<=n;l++)d=d+r[l-1]<<1,o[l]=d;for(_=0;_<t;_+=2)(y=e[_+1])!=0&&(e[_]=o[y],o[y]++)},s.F.codes2map=function(e,n,d){for(var l=e.length,_=s.F.U.rev15,y=0;y<l;y+=2)if(e[y+1]!=0)for(var a=y>>1,t=e[y+1],r=a<<4|t,c=n-t,o=e[y]<<c,S=o+(1<<c);o!=S;)d[_[o]>>>15-n]=r,o++},s.F.revCodes=function(e,n){for(var d=s.F.U.rev15,l=15-n,_=0;_<e.length;_+=2){var y=e[_]<<n-e[_+1];e[_]=d[y]>>>l}},s.F._putsE=function(e,n,d){d<<=7&n;var l=n>>>3;e[l]|=d,e[l+1]|=d>>>8},s.F._putsF=function(e,n,d){d<<=7&n;var l=n>>>3;e[l]|=d,e[l+1]|=d>>>8,e[l+2]|=d>>>16},s.F._bitsE=function(e,n,d){return(e[n>>>3]|e[1+(n>>>3)]<<8)>>>(7&n)&(1<<d)-1},s.F._bitsF=function(e,n,d){return(e[n>>>3]|e[1+(n>>>3)]<<8|e[2+(n>>>3)]<<16)>>>(7&n)&(1<<d)-1},s.F._get17=function(e,n){return(e[n>>>3]|e[1+(n>>>3)]<<8|e[2+(n>>>3)]<<16)>>>(7&n)},s.F._get25=function(e,n){return(e[n>>>3]|e[1+(n>>>3)]<<8|e[2+(n>>>3)]<<16|e[3+(n>>>3)]<<24)>>>(7&n)},s.F.U=(m=Uint16Array,w=Uint32Array,{next_code:new m(16),bl_count:new m(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new m(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new w(32),flmap:new m(512),fltree:[],fdmap:new m(32),fdtree:[],lmap:new m(32768),ltree:[],ttree:[],dmap:new m(32768),dtree:[],imap:new m(512),itree:[],rev15:new m(32768),lhst:new w(286),dhst:new w(30),ihst:new w(19),lits:new w(15e3),strt:new m(65536),prev:new m(32768)}),function(){for(var e=s.F.U,n=0;n<32768;n++){var d=n;d=(4278255360&(d=(4042322160&(d=(3435973836&(d=(2863311530&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8,e.rev15[n]=(d>>>16|d<<16)>>>17}function l(_,y,a){for(;y--!=0;)_.push(0,a)}for(n=0;n<32;n++)e.ldef[n]=e.of0[n]<<3|e.exb[n],e.ddef[n]=e.df0[n]<<4|e.dxb[n];l(e.fltree,144,8),l(e.fltree,112,9),l(e.fltree,24,7),l(e.fltree,8,8),s.F.makeCodes(e.fltree,9),s.F.codes2map(e.fltree,9,e.flmap),s.F.revCodes(e.fltree,9),l(e.fdtree,32,5),s.F.makeCodes(e.fdtree,5),s.F.codes2map(e.fdtree,5,e.fdmap),s.F.revCodes(e.fdtree,5),l(e.itree,19,0),l(e.ltree,286,0),l(e.dtree,30,0),l(e.ttree,320,0)}()})();var Za=Va({__proto__:null,default:qt},[qt]);const tt=function(){var g={nextZero(a,t){for(;a[t]!=0;)t++;return t},readUshort:(a,t)=>a[t]<<8|a[t+1],writeUshort(a,t,r){a[t]=r>>8&255,a[t+1]=255&r},readUint:(a,t)=>16777216*a[t]+(a[t+1]<<16|a[t+2]<<8|a[t+3]),writeUint(a,t,r){a[t]=r>>24&255,a[t+1]=r>>16&255,a[t+2]=r>>8&255,a[t+3]=255&r},readASCII(a,t,r){let c="";for(let o=0;o<r;o++)c+=String.fromCharCode(a[t+o]);return c},writeASCII(a,t,r){for(let c=0;c<r.length;c++)a[t+c]=r.charCodeAt(c)},readBytes(a,t,r){const c=[];for(let o=0;o<r;o++)c.push(a[t+o]);return c},pad:a=>a.length<2?`0${a}`:a,readUTF8(a,t,r){let c,o="";for(let S=0;S<r;S++)o+=`%${g.pad(a[t+S].toString(16))}`;try{c=decodeURIComponent(o)}catch{return g.readASCII(a,t,r)}return c}};function m(a,t,r,c){const o=t*r,S=n(c),M=Math.ceil(t*S/8),x=new Uint8Array(4*o),B=new Uint32Array(x.buffer),{ctype:O}=c,{depth:R}=c,z=g.readUshort;if(O==6){const I=o<<2;if(R==8)for(var p=0;p<I;p+=4)x[p]=a[p],x[p+1]=a[p+1],x[p+2]=a[p+2],x[p+3]=a[p+3];if(R==16)for(p=0;p<I;p++)x[p]=a[p<<1]}else if(O==2){const I=c.tabs.tRNS;if(I==null){if(R==8)for(p=0;p<o;p++){var T=3*p;B[p]=255<<24|a[T+2]<<16|a[T+1]<<8|a[T]}if(R==16)for(p=0;p<o;p++)T=6*p,B[p]=255<<24|a[T+4]<<16|a[T+2]<<8|a[T]}else{var f=I[0];const H=I[1],G=I[2];if(R==8)for(p=0;p<o;p++){var v=p<<2;T=3*p,B[p]=255<<24|a[T+2]<<16|a[T+1]<<8|a[T],a[T]==f&&a[T+1]==H&&a[T+2]==G&&(x[v+3]=0)}if(R==16)for(p=0;p<o;p++)v=p<<2,T=6*p,B[p]=255<<24|a[T+4]<<16|a[T+2]<<8|a[T],z(a,T)==f&&z(a,T+2)==H&&z(a,T+4)==G&&(x[v+3]=0)}}else if(O==3){const I=c.tabs.PLTE,H=c.tabs.tRNS,G=H?H.length:0;if(R==1)for(var b=0;b<r;b++){var D=b*M,A=b*t;for(p=0;p<t;p++){v=A+p<<2;var k=3*(E=a[D+(p>>3)]>>7-((7&p)<<0)&1);x[v]=I[k],x[v+1]=I[k+1],x[v+2]=I[k+2],x[v+3]=E<G?H[E]:255}}if(R==2)for(b=0;b<r;b++)for(D=b*M,A=b*t,p=0;p<t;p++)v=A+p<<2,k=3*(E=a[D+(p>>2)]>>6-((3&p)<<1)&3),x[v]=I[k],x[v+1]=I[k+1],x[v+2]=I[k+2],x[v+3]=E<G?H[E]:255;if(R==4)for(b=0;b<r;b++)for(D=b*M,A=b*t,p=0;p<t;p++)v=A+p<<2,k=3*(E=a[D+(p>>1)]>>4-((1&p)<<2)&15),x[v]=I[k],x[v+1]=I[k+1],x[v+2]=I[k+2],x[v+3]=E<G?H[E]:255;if(R==8)for(p=0;p<o;p++){var E;v=p<<2,k=3*(E=a[p]),x[v]=I[k],x[v+1]=I[k+1],x[v+2]=I[k+2],x[v+3]=E<G?H[E]:255}}else if(O==4){if(R==8)for(p=0;p<o;p++){v=p<<2;var C=a[h=p<<1];x[v]=C,x[v+1]=C,x[v+2]=C,x[v+3]=a[h+1]}if(R==16)for(p=0;p<o;p++){var h;v=p<<2,C=a[h=p<<2],x[v]=C,x[v+1]=C,x[v+2]=C,x[v+3]=a[h+2]}}else if(O==0)for(f=c.tabs.tRNS?c.tabs.tRNS:-1,b=0;b<r;b++){const I=b*M,H=b*t;if(R==1)for(var u=0;u<t;u++){var q=(C=255*(a[I+(u>>>3)]>>>7-(7&u)&1))==255*f?0:255;B[H+u]=q<<24|C<<16|C<<8|C}else if(R==2)for(u=0;u<t;u++)q=(C=85*(a[I+(u>>>2)]>>>6-((3&u)<<1)&3))==85*f?0:255,B[H+u]=q<<24|C<<16|C<<8|C;else if(R==4)for(u=0;u<t;u++)q=(C=17*(a[I+(u>>>1)]>>>4-((1&u)<<2)&15))==17*f?0:255,B[H+u]=q<<24|C<<16|C<<8|C;else if(R==8)for(u=0;u<t;u++)q=(C=a[I+u])==f?0:255,B[H+u]=q<<24|C<<16|C<<8|C;else if(R==16)for(u=0;u<t;u++)C=a[I+(u<<1)],q=z(a,I+(u<<1))==f?0:255,B[H+u]=q<<24|C<<16|C<<8|C}return x}function w(a,t,r,c){const o=n(a),S=Math.ceil(r*o/8),M=new Uint8Array((S+1+a.interlace)*c);return t=a.tabs.CgBI?e(t,M):s(t,M),a.interlace==0?t=d(t,a,0,r,c):a.interlace==1&&(t=function(B,O){const R=O.width,z=O.height,p=n(O),T=p>>3,f=Math.ceil(R*p/8),v=new Uint8Array(z*f);let b=0;const D=[0,0,4,0,2,0,1],A=[0,4,0,2,0,1,0],k=[8,8,8,4,4,2,2],E=[8,8,4,4,2,2,1];let C=0;for(;C<7;){const u=k[C],q=E[C];let I=0,H=0,G=D[C];for(;G<z;)G+=u,H++;let $=A[C];for(;$<R;)$+=q,I++;const j=Math.ceil(I*p/8);d(B,O,b,I,H);let N=0,U=D[C];for(;U<z;){let X=A[C],ue=b+N*j<<3;for(;X<R;){var h;if(p==1&&(h=(h=B[ue>>3])>>7-(7&ue)&1,v[U*f+(X>>3)]|=h<<7-((7&X)<<0)),p==2&&(h=(h=B[ue>>3])>>6-(7&ue)&3,v[U*f+(X>>2)]|=h<<6-((3&X)<<1)),p==4&&(h=(h=B[ue>>3])>>4-(7&ue)&15,v[U*f+(X>>1)]|=h<<4-((1&X)<<2)),p>=8){const te=U*f+X*T;for(let se=0;se<T;se++)v[te+se]=B[(ue>>3)+se]}ue+=p,X+=q}N++,U+=u}I*H!=0&&(b+=H*(1+j)),C+=1}return v}(t,a)),t}function s(a,t){return e(new Uint8Array(a.buffer,2,a.length-6),t)}var e=function(){const a={H:{}};return a.H.N=function(t,r){const c=Uint8Array;let o,S,M=0,x=0,B=0,O=0,R=0,z=0,p=0,T=0,f=0;if(t[0]==3&&t[1]==0)return r||new c(0);const v=a.H,b=v.b,D=v.e,A=v.R,k=v.n,E=v.A,C=v.Z,h=v.m,u=r==null;for(u&&(r=new c(t.length>>>2<<5));M==0;)if(M=b(t,f,1),x=b(t,f+1,2),f+=3,x!=0){if(u&&(r=a.H.W(r,T+(1<<17))),x==1&&(o=h.J,S=h.h,z=511,p=31),x==2){B=D(t,f,5)+257,O=D(t,f+5,5)+1,R=D(t,f+10,4)+4,f+=14;let I=1;for(var q=0;q<38;q+=2)h.Q[q]=0,h.Q[q+1]=0;for(q=0;q<R;q++){const $=D(t,f+3*q,3);h.Q[1+(h.X[q]<<1)]=$,$>I&&(I=$)}f+=3*R,k(h.Q,I),E(h.Q,I,h.u),o=h.w,S=h.d,f=A(h.u,(1<<I)-1,B+O,t,f,h.v);const H=v.V(h.v,0,B,h.C);z=(1<<H)-1;const G=v.V(h.v,B,O,h.D);p=(1<<G)-1,k(h.C,H),E(h.C,H,o),k(h.D,G),E(h.D,G,S)}for(;;){const I=o[C(t,f)&z];f+=15&I;const H=I>>>4;if(!(H>>>8))r[T++]=H;else{if(H==256)break;{let G=T+H-254;if(H>264){const X=h.q[H-257];G=T+(X>>>3)+D(t,f,7&X),f+=7&X}const $=S[C(t,f)&p];f+=15&$;const j=$>>>4,N=h.c[j],U=(N>>>4)+b(t,f,15&N);for(f+=15&N;T<G;)r[T]=r[T++-U],r[T]=r[T++-U],r[T]=r[T++-U],r[T]=r[T++-U];T=G}}}}else{7&f&&(f+=8-(7&f));const I=4+(f>>>3),H=t[I-4]|t[I-3]<<8;u&&(r=a.H.W(r,T+H)),r.set(new c(t.buffer,t.byteOffset+I,H),T),f=I+H<<3,T+=H}return r.length==T?r:r.slice(0,T)},a.H.W=function(t,r){const c=t.length;if(r<=c)return t;const o=new Uint8Array(c<<1);return o.set(t,0),o},a.H.R=function(t,r,c,o,S,M){const x=a.H.e,B=a.H.Z;let O=0;for(;O<c;){const R=t[B(o,S)&r];S+=15&R;const z=R>>>4;if(z<=15)M[O]=z,O++;else{let p=0,T=0;z==16?(T=3+x(o,S,2),S+=2,p=M[O-1]):z==17?(T=3+x(o,S,3),S+=3):z==18&&(T=11+x(o,S,7),S+=7);const f=O+T;for(;O<f;)M[O]=p,O++}}return S},a.H.V=function(t,r,c,o){let S=0,M=0;const x=o.length>>>1;for(;M<c;){const B=t[M+r];o[M<<1]=0,o[1+(M<<1)]=B,B>S&&(S=B),M++}for(;M<x;)o[M<<1]=0,o[1+(M<<1)]=0,M++;return S},a.H.n=function(t,r){const c=a.H.m,o=t.length;let S,M,x,B;const O=c.j;for(var R=0;R<=r;R++)O[R]=0;for(R=1;R<o;R+=2)O[t[R]]++;const z=c.K;for(S=0,O[0]=0,M=1;M<=r;M++)S=S+O[M-1]<<1,z[M]=S;for(x=0;x<o;x+=2)B=t[x+1],B!=0&&(t[x]=z[B],z[B]++)},a.H.A=function(t,r,c){const o=t.length,S=a.H.m.r;for(let M=0;M<o;M+=2)if(t[M+1]!=0){const x=M>>1,B=t[M+1],O=x<<4|B,R=r-B;let z=t[M]<<R;const p=z+(1<<R);for(;z!=p;)c[S[z]>>>15-r]=O,z++}},a.H.l=function(t,r){const c=a.H.m.r,o=15-r;for(let S=0;S<t.length;S+=2){const M=t[S]<<r-t[S+1];t[S]=c[M]>>>o}},a.H.M=function(t,r,c){c<<=7&r;const o=r>>>3;t[o]|=c,t[o+1]|=c>>>8},a.H.I=function(t,r,c){c<<=7&r;const o=r>>>3;t[o]|=c,t[o+1]|=c>>>8,t[o+2]|=c>>>16},a.H.e=function(t,r,c){return(t[r>>>3]|t[1+(r>>>3)]<<8)>>>(7&r)&(1<<c)-1},a.H.b=function(t,r,c){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16)>>>(7&r)&(1<<c)-1},a.H.Z=function(t,r){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16)>>>(7&r)},a.H.i=function(t,r){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16|t[3+(r>>>3)]<<24)>>>(7&r)},a.H.m=function(){const t=Uint16Array,r=Uint32Array;return{K:new t(16),j:new t(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new t(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new t(512),_:[],h:new t(32),$:[],w:new t(32768),C:[],v:[],d:new t(32768),D:[],u:new t(512),Q:[],r:new t(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new t(65536),g:new t(32768)}}(),function(){const t=a.H.m;for(var r=0;r<32768;r++){let o=r;o=(2863311530&o)>>>1|(1431655765&o)<<1,o=(3435973836&o)>>>2|(858993459&o)<<2,o=(4042322160&o)>>>4|(252645135&o)<<4,o=(4278255360&o)>>>8|(16711935&o)<<8,t.r[r]=(o>>>16|o<<16)>>>17}function c(o,S,M){for(;S--!=0;)o.push(0,M)}for(r=0;r<32;r++)t.q[r]=t.S[r]<<3|t.T[r],t.c[r]=t.p[r]<<4|t.z[r];c(t._,144,8),c(t._,112,9),c(t._,24,7),c(t._,8,8),a.H.n(t._,9),a.H.A(t._,9,t.J),a.H.l(t._,9),c(t.$,32,5),a.H.n(t.$,5),a.H.A(t.$,5,t.h),a.H.l(t.$,5),c(t.Q,19,0),c(t.C,286,0),c(t.D,30,0),c(t.v,320,0)}(),a.H.N}();function n(a){return[1,null,3,1,2,null,4][a.ctype]*a.depth}function d(a,t,r,c,o){let S=n(t);const M=Math.ceil(c*S/8);let x,B;S=Math.ceil(S/8);let O=a[r],R=0;if(O>1&&(a[r]=[0,0,1][O-2]),O==3)for(R=S;R<M;R++)a[R+1]=a[R+1]+(a[R+1-S]>>>1)&255;for(let z=0;z<o;z++)if(x=r+z*M,B=x+z+1,O=a[B-1],R=0,O==0)for(;R<M;R++)a[x+R]=a[B+R];else if(O==1){for(;R<S;R++)a[x+R]=a[B+R];for(;R<M;R++)a[x+R]=a[B+R]+a[x+R-S]}else if(O==2)for(;R<M;R++)a[x+R]=a[B+R]+a[x+R-M];else if(O==3){for(;R<S;R++)a[x+R]=a[B+R]+(a[x+R-M]>>>1);for(;R<M;R++)a[x+R]=a[B+R]+(a[x+R-M]+a[x+R-S]>>>1)}else{for(;R<S;R++)a[x+R]=a[B+R]+l(0,a[x+R-M],0);for(;R<M;R++)a[x+R]=a[B+R]+l(a[x+R-S],a[x+R-M],a[x+R-S-M])}return a}function l(a,t,r){const c=a+t-r,o=c-a,S=c-t,M=c-r;return o*o<=S*S&&o*o<=M*M?a:S*S<=M*M?t:r}function _(a,t,r){r.width=g.readUint(a,t),t+=4,r.height=g.readUint(a,t),t+=4,r.depth=a[t],t++,r.ctype=a[t],t++,r.compress=a[t],t++,r.filter=a[t],t++,r.interlace=a[t],t++}function y(a,t,r,c,o,S,M,x,B){const O=Math.min(t,o),R=Math.min(r,S);let z=0,p=0;for(let C=0;C<R;C++)for(let h=0;h<O;h++)if(M>=0&&x>=0?(z=C*t+h<<2,p=(x+C)*o+M+h<<2):(z=(-x+C)*t-M+h<<2,p=C*o+h<<2),B==0)c[p]=a[z],c[p+1]=a[z+1],c[p+2]=a[z+2],c[p+3]=a[z+3];else if(B==1){var T=a[z+3]*.00392156862745098,f=a[z]*T,v=a[z+1]*T,b=a[z+2]*T,D=c[p+3]*(1/255),A=c[p]*D,k=c[p+1]*D,E=c[p+2]*D;const u=1-T,q=T+D*u,I=q==0?0:1/q;c[p+3]=255*q,c[p+0]=(f+A*u)*I,c[p+1]=(v+k*u)*I,c[p+2]=(b+E*u)*I}else if(B==2)T=a[z+3],f=a[z],v=a[z+1],b=a[z+2],D=c[p+3],A=c[p],k=c[p+1],E=c[p+2],T==D&&f==A&&v==k&&b==E?(c[p]=0,c[p+1]=0,c[p+2]=0,c[p+3]=0):(c[p]=f,c[p+1]=v,c[p+2]=b,c[p+3]=T);else if(B==3){if(T=a[z+3],f=a[z],v=a[z+1],b=a[z+2],D=c[p+3],A=c[p],k=c[p+1],E=c[p+2],T==D&&f==A&&v==k&&b==E)continue;if(T<220&&D>20)return!1}return!0}return{decode:function(t){const r=new Uint8Array(t);let c=8;const o=g,S=o.readUshort,M=o.readUint,x={tabs:{},frames:[]},B=new Uint8Array(r.length);let O,R=0,z=0;const p=[137,80,78,71,13,10,26,10];for(var T=0;T<8;T++)if(r[T]!=p[T])throw"The input is not a PNG file!";for(;c<r.length;){const C=o.readUint(r,c);c+=4;const h=o.readASCII(r,c,4);if(c+=4,h=="IHDR")_(r,c,x);else if(h=="iCCP"){for(var f=c;r[f]!=0;)f++;o.readASCII(r,c,f-c),r[f+1];const u=r.slice(f+2,c+C);let q=null;try{q=s(u)}catch{q=e(u)}x.tabs[h]=q}else if(h=="CgBI")x.tabs[h]=r.slice(c,c+4);else if(h=="IDAT"){for(T=0;T<C;T++)B[R+T]=r[c+T];R+=C}else if(h=="acTL")x.tabs[h]={num_frames:M(r,c),num_plays:M(r,c+4)},O=new Uint8Array(r.length);else if(h=="fcTL"){z!=0&&((E=x.frames[x.frames.length-1]).data=w(x,O.slice(0,z),E.rect.width,E.rect.height),z=0);const u={x:M(r,c+12),y:M(r,c+16),width:M(r,c+4),height:M(r,c+8)};let q=S(r,c+22);q=S(r,c+20)/(q==0?100:q);const I={rect:u,delay:Math.round(1e3*q),dispose:r[c+24],blend:r[c+25]};x.frames.push(I)}else if(h=="fdAT"){for(T=0;T<C-4;T++)O[z+T]=r[c+T+4];z+=C-4}else if(h=="pHYs")x.tabs[h]=[o.readUint(r,c),o.readUint(r,c+4),r[c+8]];else if(h=="cHRM")for(x.tabs[h]=[],T=0;T<8;T++)x.tabs[h].push(o.readUint(r,c+4*T));else if(h=="tEXt"||h=="zTXt"){x.tabs[h]==null&&(x.tabs[h]={});var v=o.nextZero(r,c),b=o.readASCII(r,c,v-c),D=c+C-v-1;if(h=="tEXt")k=o.readASCII(r,v+1,D);else{var A=s(r.slice(v+2,v+2+D));k=o.readUTF8(A,0,A.length)}x.tabs[h][b]=k}else if(h=="iTXt"){x.tabs[h]==null&&(x.tabs[h]={}),v=0,f=c,v=o.nextZero(r,f),b=o.readASCII(r,f,v-f);const u=r[f=v+1];var k;r[f+1],f+=2,v=o.nextZero(r,f),o.readASCII(r,f,v-f),f=v+1,v=o.nextZero(r,f),o.readUTF8(r,f,v-f),D=C-((f=v+1)-c),u==0?k=o.readUTF8(r,f,D):(A=s(r.slice(f,f+D)),k=o.readUTF8(A,0,A.length)),x.tabs[h][b]=k}else if(h=="PLTE")x.tabs[h]=o.readBytes(r,c,C);else if(h=="hIST"){const u=x.tabs.PLTE.length/3;for(x.tabs[h]=[],T=0;T<u;T++)x.tabs[h].push(S(r,c+2*T))}else if(h=="tRNS")x.ctype==3?x.tabs[h]=o.readBytes(r,c,C):x.ctype==0?x.tabs[h]=S(r,c):x.ctype==2&&(x.tabs[h]=[S(r,c),S(r,c+2),S(r,c+4)]);else if(h=="gAMA")x.tabs[h]=o.readUint(r,c)/1e5;else if(h=="sRGB")x.tabs[h]=r[c];else if(h=="bKGD")x.ctype==0||x.ctype==4?x.tabs[h]=[S(r,c)]:x.ctype==2||x.ctype==6?x.tabs[h]=[S(r,c),S(r,c+2),S(r,c+4)]:x.ctype==3&&(x.tabs[h]=r[c]);else if(h=="IEND")break;c+=C,o.readUint(r,c),c+=4}var E;return z!=0&&((E=x.frames[x.frames.length-1]).data=w(x,O.slice(0,z),E.rect.width,E.rect.height)),x.data=w(x,B,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(t){const r=t.width,c=t.height;if(t.tabs.acTL==null)return[m(t.data,r,c,t).buffer];const o=[];t.frames[0].data==null&&(t.frames[0].data=t.data);const S=r*c*4,M=new Uint8Array(S),x=new Uint8Array(S),B=new Uint8Array(S);for(let R=0;R<t.frames.length;R++){const z=t.frames[R],p=z.rect.x,T=z.rect.y,f=z.rect.width,v=z.rect.height,b=m(z.data,f,v,t);if(R!=0)for(var O=0;O<S;O++)B[O]=M[O];if(z.blend==0?y(b,f,v,M,r,c,p,T,0):z.blend==1&&y(b,f,v,M,r,c,p,T,1),o.push(M.buffer.slice(0)),z.dispose!=0){if(z.dispose==1)y(x,f,v,M,r,c,p,T,0);else if(z.dispose==2)for(O=0;O<S;O++)M[O]=B[O]}}return o},_paeth:l,_copyTile:y,_bin:g}}();(function(){const{_copyTile:g}=tt,{_bin:m}=tt,w=tt._paeth;var s={table:function(){const f=new Uint32Array(256);for(let v=0;v<256;v++){let b=v;for(let D=0;D<8;D++)1&b?b=3988292384^b>>>1:b>>>=1;f[v]=b}return f}(),update(f,v,b,D){for(let A=0;A<D;A++)f=s.table[255&(f^v[b+A])]^f>>>8;return f},crc:(f,v,b)=>4294967295^s.update(4294967295,f,v,b)};function e(f,v,b,D){v[b]+=f[0]*D>>4,v[b+1]+=f[1]*D>>4,v[b+2]+=f[2]*D>>4,v[b+3]+=f[3]*D>>4}function n(f){return Math.max(0,Math.min(255,f))}function d(f,v){const b=f[0]-v[0],D=f[1]-v[1],A=f[2]-v[2],k=f[3]-v[3];return b*b+D*D+A*A+k*k}function l(f,v,b,D,A,k,E){E==null&&(E=1);const C=D.length,h=[];for(var u=0;u<C;u++){const U=D[u];h.push([U>>>0&255,U>>>8&255,U>>>16&255,U>>>24&255])}for(u=0;u<C;u++){let U=4294967295;for(var q=0,I=0;I<C;I++){var H=d(h[u],h[I]);I!=u&&H<U&&(U=H,q=I)}}const G=new Uint32Array(A.buffer),$=new Int16Array(v*b*4),j=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(u=0;u<j.length;u++)j[u]=255*((j[u]+.5)/16-.5);for(let U=0;U<b;U++)for(let X=0;X<v;X++){var N;u=4*(U*v+X),E!=2?N=[n(f[u]+$[u]),n(f[u+1]+$[u+1]),n(f[u+2]+$[u+2]),n(f[u+3]+$[u+3])]:(H=j[4*(3&U)+(3&X)],N=[n(f[u]+H),n(f[u+1]+H),n(f[u+2]+H),n(f[u+3]+H)]),q=0;let ue=16777215;for(I=0;I<C;I++){const ge=d(N,h[I]);ge<ue&&(ue=ge,q=I)}const te=h[q],se=[N[0]-te[0],N[1]-te[1],N[2]-te[2],N[3]-te[3]];E==1&&(X!=v-1&&e(se,$,u+4,7),U!=b-1&&(X!=0&&e(se,$,u+4*v-4,3),e(se,$,u+4*v,5),X!=v-1&&e(se,$,u+4*v+4,1))),k[u>>2]=q,G[u>>2]=D[q]}}function _(f,v,b,D,A){A==null&&(A={});const{crc:k}=s,E=m.writeUint,C=m.writeUshort,h=m.writeASCII;let u=8;const q=f.frames.length>1;let I,H=!1,G=33+(q?20:0);if(A.sRGB!=null&&(G+=13),A.pHYs!=null&&(G+=21),A.iCCP!=null&&(I=pako.deflate(A.iCCP),G+=21+I.length+4),f.ctype==3){for(var $=f.plte.length,j=0;j<$;j++)f.plte[j]>>>24!=255&&(H=!0);G+=8+3*$+4+(H?8+1*$+4:0)}for(var N=0;N<f.frames.length;N++)q&&(G+=38),G+=(te=f.frames[N]).cimg.length+12,N!=0&&(G+=4);G+=12;const U=new Uint8Array(G),X=[137,80,78,71,13,10,26,10];for(j=0;j<8;j++)U[j]=X[j];if(E(U,u,13),u+=4,h(U,u,"IHDR"),u+=4,E(U,u,v),u+=4,E(U,u,b),u+=4,U[u]=f.depth,u++,U[u]=f.ctype,u++,U[u]=0,u++,U[u]=0,u++,U[u]=0,u++,E(U,u,k(U,u-17,17)),u+=4,A.sRGB!=null&&(E(U,u,1),u+=4,h(U,u,"sRGB"),u+=4,U[u]=A.sRGB,u++,E(U,u,k(U,u-5,5)),u+=4),A.iCCP!=null){const se=13+I.length;E(U,u,se),u+=4,h(U,u,"iCCP"),u+=4,h(U,u,"ICC profile"),u+=11,u+=2,U.set(I,u),u+=I.length,E(U,u,k(U,u-(se+4),se+4)),u+=4}if(A.pHYs!=null&&(E(U,u,9),u+=4,h(U,u,"pHYs"),u+=4,E(U,u,A.pHYs[0]),u+=4,E(U,u,A.pHYs[1]),u+=4,U[u]=A.pHYs[2],u++,E(U,u,k(U,u-13,13)),u+=4),q&&(E(U,u,8),u+=4,h(U,u,"acTL"),u+=4,E(U,u,f.frames.length),u+=4,E(U,u,A.loop!=null?A.loop:0),u+=4,E(U,u,k(U,u-12,12)),u+=4),f.ctype==3){for(E(U,u,3*($=f.plte.length)),u+=4,h(U,u,"PLTE"),u+=4,j=0;j<$;j++){const se=3*j,ge=f.plte[j],Se=255&ge,De=ge>>>8&255,Te=ge>>>16&255;U[u+se+0]=Se,U[u+se+1]=De,U[u+se+2]=Te}if(u+=3*$,E(U,u,k(U,u-3*$-4,3*$+4)),u+=4,H){for(E(U,u,$),u+=4,h(U,u,"tRNS"),u+=4,j=0;j<$;j++)U[u+j]=f.plte[j]>>>24&255;u+=$,E(U,u,k(U,u-$-4,$+4)),u+=4}}let ue=0;for(N=0;N<f.frames.length;N++){var te=f.frames[N];q&&(E(U,u,26),u+=4,h(U,u,"fcTL"),u+=4,E(U,u,ue++),u+=4,E(U,u,te.rect.width),u+=4,E(U,u,te.rect.height),u+=4,E(U,u,te.rect.x),u+=4,E(U,u,te.rect.y),u+=4,C(U,u,D[N]),u+=2,C(U,u,1e3),u+=2,U[u]=te.dispose,u++,U[u]=te.blend,u++,E(U,u,k(U,u-30,30)),u+=4);const se=te.cimg;E(U,u,($=se.length)+(N==0?0:4)),u+=4;const ge=u;h(U,u,N==0?"IDAT":"fdAT"),u+=4,N!=0&&(E(U,u,ue++),u+=4),U.set(se,u),u+=$,E(U,u,k(U,ge,u-ge)),u+=4}return E(U,u,0),u+=4,h(U,u,"IEND"),u+=4,E(U,u,k(U,u-4,4)),u+=4,U.buffer}function y(f,v,b){for(let D=0;D<f.frames.length;D++){const A=f.frames[D];A.rect.width;const k=A.rect.height,E=new Uint8Array(k*A.bpl+k);A.cimg=c(A.img,k,A.bpp,A.bpl,E,v,b)}}function a(f,v,b,D,A){const k=A[0],E=A[1],C=A[2],h=A[3],u=A[4],q=A[5];let I=6,H=8,G=255;for(var $=0;$<f.length;$++){const V=new Uint8Array(f[$]);for(var j=V.length,N=0;N<j;N+=4)G&=V[N+3]}const U=G!=255,X=function(re,oe,ce,ie,ne,fe){const _e=[];for(var le=0;le<re.length;le++){const Ee=new Uint8Array(re[le]),Re=new Uint32Array(Ee.buffer);var pe;let qe=0,Ne=0,Pe=oe,Me=ce,We=ie?1:0;if(le!=0){const ft=fe||ie||le==1||_e[le-2].dispose!=0?1:2;let nt=0,rt=1e9;for(let at=0;at<ft;at++){var ke=new Uint8Array(re[le-1-at]);const Vt=new Uint32Array(re[le-1-at]);let it=oe,Ze=ce,Fe=-1,bt=-1;for(let vt=0;vt<ce;vt++)for(let mt=0;mt<oe;mt++)Re[be=vt*oe+mt]!=Vt[be]&&(mt<it&&(it=mt),mt>Fe&&(Fe=mt),vt<Ze&&(Ze=vt),vt>bt&&(bt=vt));Fe==-1&&(it=Ze=Fe=bt=0),ne&&((1&it)==1&&it--,(1&Ze)==1&&Ze--);const Ft=(Fe-it+1)*(bt-Ze+1);Ft<rt&&(rt=Ft,nt=at,qe=it,Ne=Ze,Pe=Fe-it+1,Me=bt-Ze+1)}ke=new Uint8Array(re[le-1-nt]),nt==1&&(_e[le-1].dispose=2),pe=new Uint8Array(Pe*Me*4),g(ke,oe,ce,pe,Pe,Me,-qe,-Ne,0),We=g(Ee,oe,ce,pe,Pe,Me,-qe,-Ne,3)?1:0,We==1?r(Ee,oe,ce,pe,{x:qe,y:Ne,width:Pe,height:Me}):g(Ee,oe,ce,pe,Pe,Me,-qe,-Ne,0)}else pe=Ee.slice(0);_e.push({rect:{x:qe,y:Ne,width:Pe,height:Me},img:pe,blend:We,dispose:0})}if(ie)for(le=0;le<_e.length;le++){if((je=_e[le]).blend==1)continue;const Ee=je.rect,Re=_e[le-1].rect,qe=Math.min(Ee.x,Re.x),Ne=Math.min(Ee.y,Re.y),Pe={x:qe,y:Ne,width:Math.max(Ee.x+Ee.width,Re.x+Re.width)-qe,height:Math.max(Ee.y+Ee.height,Re.y+Re.height)-Ne};_e[le-1].dispose=1,le-1!=0&&t(re,oe,ce,_e,le-1,Pe,ne),t(re,oe,ce,_e,le,Pe,ne)}let Le=0;if(re.length!=1)for(var be=0;be<_e.length;be++){var je;Le+=(je=_e[be]).rect.width*je.rect.height}return _e}(f,v,b,k,E,C),ue={},te=[],se=[];if(D!=0){const V=[];for(N=0;N<X.length;N++)V.push(X[N].img.buffer);const re=function(ne){let fe=0;for(var _e=0;_e<ne.length;_e++)fe+=ne[_e].byteLength;const le=new Uint8Array(fe);let pe=0;for(_e=0;_e<ne.length;_e++){const ke=new Uint8Array(ne[_e]),Le=ke.length;for(let be=0;be<Le;be+=4){let je=ke[be],Ee=ke[be+1],Re=ke[be+2];const qe=ke[be+3];qe==0&&(je=Ee=Re=0),le[pe+be]=je,le[pe+be+1]=Ee,le[pe+be+2]=Re,le[pe+be+3]=qe}pe+=Le}return le.buffer}(V),oe=S(re,D);for(N=0;N<oe.plte.length;N++)te.push(oe.plte[N].est.rgba);let ce=0;for(N=0;N<X.length;N++){const ie=(Se=X[N]).img.length;var ge=new Uint8Array(oe.inds.buffer,ce>>2,ie>>2);se.push(ge);const ne=new Uint8Array(oe.abuf,ce,ie);q&&l(Se.img,Se.rect.width,Se.rect.height,te,ne,ge),Se.img.set(ne),ce+=ie}}else for($=0;$<X.length;$++){var Se=X[$];const V=new Uint32Array(Se.img.buffer);var De=Se.rect.width;for(j=V.length,ge=new Uint8Array(j),se.push(ge),N=0;N<j;N++){const re=V[N];if(N!=0&&re==V[N-1])ge[N]=ge[N-1];else if(N>De&&re==V[N-De])ge[N]=ge[N-De];else{let oe=ue[re];if(oe==null&&(ue[re]=oe=te.length,te.push(re),te.length>=300))break;ge[N]=oe}}}const Te=te.length;for(Te<=256&&u==0&&(H=Te<=2?1:Te<=4?2:Te<=16?4:8,H=Math.max(H,h)),$=0;$<X.length;$++){(Se=X[$]).rect.x,Se.rect.y,De=Se.rect.width;const V=Se.rect.height;let re=Se.img;new Uint32Array(re.buffer);let oe=4*De,ce=4;if(Te<=256&&u==0){oe=Math.ceil(H*De/8);var Q=new Uint8Array(oe*V);const ie=se[$];for(let ne=0;ne<V;ne++){N=ne*oe;const fe=ne*De;if(H==8)for(var Z=0;Z<De;Z++)Q[N+Z]=ie[fe+Z];else if(H==4)for(Z=0;Z<De;Z++)Q[N+(Z>>1)]|=ie[fe+Z]<<4-4*(1&Z);else if(H==2)for(Z=0;Z<De;Z++)Q[N+(Z>>2)]|=ie[fe+Z]<<6-2*(3&Z);else if(H==1)for(Z=0;Z<De;Z++)Q[N+(Z>>3)]|=ie[fe+Z]<<7-1*(7&Z)}re=Q,I=3,ce=1}else if(U==0&&X.length==1){Q=new Uint8Array(De*V*3);const ie=De*V;for(N=0;N<ie;N++){const ne=3*N,fe=4*N;Q[ne]=re[fe],Q[ne+1]=re[fe+1],Q[ne+2]=re[fe+2]}re=Q,I=2,ce=3,oe=3*De}Se.img=re,Se.bpl=oe,Se.bpp=ce}return{ctype:I,depth:H,plte:te,frames:X}}function t(f,v,b,D,A,k,E){const C=Uint8Array,h=Uint32Array,u=new C(f[A-1]),q=new h(f[A-1]),I=A+1<f.length?new C(f[A+1]):null,H=new C(f[A]),G=new h(H.buffer);let $=v,j=b,N=-1,U=-1;for(let ue=0;ue<k.height;ue++)for(let te=0;te<k.width;te++){const se=k.x+te,ge=k.y+ue,Se=ge*v+se,De=G[Se];De==0||D[A-1].dispose==0&&q[Se]==De&&(I==null||I[4*Se+3]!=0)||(se<$&&($=se),se>N&&(N=se),ge<j&&(j=ge),ge>U&&(U=ge))}N==-1&&($=j=N=U=0),E&&((1&$)==1&&$--,(1&j)==1&&j--),k={x:$,y:j,width:N-$+1,height:U-j+1};const X=D[A];X.rect=k,X.blend=1,X.img=new Uint8Array(k.width*k.height*4),D[A-1].dispose==0?(g(u,v,b,X.img,k.width,k.height,-k.x,-k.y,0),r(H,v,b,X.img,k)):g(H,v,b,X.img,k.width,k.height,-k.x,-k.y,0)}function r(f,v,b,D,A){g(f,v,b,D,A.width,A.height,-A.x,-A.y,2)}function c(f,v,b,D,A,k,E){const C=[];let h,u=[0,1,2,3,4];k!=-1?u=[k]:(v*D>5e5||b==1)&&(u=[0]),E&&(h={level:0});const q=Za;for(var I=0;I<u.length;I++){for(let $=0;$<v;$++)o(A,f,$,D,b,u[I]);C.push(q.deflate(A,h))}let H,G=1e9;for(I=0;I<C.length;I++)C[I].length<G&&(H=I,G=C[I].length);return C[H]}function o(f,v,b,D,A,k){const E=b*D;let C=E+b;if(f[C]=k,C++,k==0)if(D<500)for(var h=0;h<D;h++)f[C+h]=v[E+h];else f.set(new Uint8Array(v.buffer,E,D),C);else if(k==1){for(h=0;h<A;h++)f[C+h]=v[E+h];for(h=A;h<D;h++)f[C+h]=v[E+h]-v[E+h-A]+256&255}else if(b==0){for(h=0;h<A;h++)f[C+h]=v[E+h];if(k==2)for(h=A;h<D;h++)f[C+h]=v[E+h];if(k==3)for(h=A;h<D;h++)f[C+h]=v[E+h]-(v[E+h-A]>>1)+256&255;if(k==4)for(h=A;h<D;h++)f[C+h]=v[E+h]-w(v[E+h-A],0,0)+256&255}else{if(k==2)for(h=0;h<D;h++)f[C+h]=v[E+h]+256-v[E+h-D]&255;if(k==3){for(h=0;h<A;h++)f[C+h]=v[E+h]+256-(v[E+h-D]>>1)&255;for(h=A;h<D;h++)f[C+h]=v[E+h]+256-(v[E+h-D]+v[E+h-A]>>1)&255}if(k==4){for(h=0;h<A;h++)f[C+h]=v[E+h]+256-w(0,v[E+h-D],0)&255;for(h=A;h<D;h++)f[C+h]=v[E+h]+256-w(v[E+h-A],v[E+h-D],v[E+h-A-D])&255}}}function S(f,v){const b=new Uint8Array(f),D=b.slice(0),A=new Uint32Array(D.buffer),k=M(D,v),E=k[0],C=k[1],h=b.length,u=new Uint8Array(h>>2);let q;if(b.length<2e7)for(var I=0;I<h;I+=4)q=x(E,H=b[I]*(1/255),G=b[I+1]*(1/255),$=b[I+2]*(1/255),j=b[I+3]*(1/255)),u[I>>2]=q.ind,A[I>>2]=q.est.rgba;else for(I=0;I<h;I+=4){var H=b[I]*.00392156862745098,G=b[I+1]*(1/255),$=b[I+2]*(1/255),j=b[I+3]*(1/255);for(q=E;q.left;)q=B(q.est,H,G,$,j)<=0?q.left:q.right;u[I>>2]=q.ind,A[I>>2]=q.est.rgba}return{abuf:D.buffer,inds:u,plte:C}}function M(f,v,b){b==null&&(b=1e-4);const D=new Uint32Array(f.buffer),A={i0:0,i1:f.length,bst:null,est:null,tdst:0,left:null,right:null};A.bst=z(f,A.i0,A.i1),A.est=p(A.bst);const k=[A];for(;k.length<v;){let C=0,h=0;for(var E=0;E<k.length;E++)k[E].est.L>C&&(C=k[E].est.L,h=E);if(C<b)break;const u=k[h],q=O(f,D,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=q||u.i1<=q){u.est.L=0;continue}const I={i0:u.i0,i1:q,bst:null,est:null,tdst:0,left:null,right:null};I.bst=z(f,I.i0,I.i1),I.est=p(I.bst);const H={i0:q,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(H.bst={R:[],m:[],N:u.bst.N-I.bst.N},E=0;E<16;E++)H.bst.R[E]=u.bst.R[E]-I.bst.R[E];for(E=0;E<4;E++)H.bst.m[E]=u.bst.m[E]-I.bst.m[E];H.est=p(H.bst),u.left=I,u.right=H,k[h]=I,k.push(H)}for(k.sort((C,h)=>h.bst.N-C.bst.N),E=0;E<k.length;E++)k[E].ind=E;return[A,k]}function x(f,v,b,D,A){if(f.left==null)return f.tdst=function(I,H,G,$,j){const N=H-I[0],U=G-I[1],X=$-I[2],ue=j-I[3];return N*N+U*U+X*X+ue*ue}(f.est.q,v,b,D,A),f;const k=B(f.est,v,b,D,A);let E=f.left,C=f.right;k>0&&(E=f.right,C=f.left);const h=x(E,v,b,D,A);if(h.tdst<=k*k)return h;const u=x(C,v,b,D,A);return u.tdst<h.tdst?u:h}function B(f,v,b,D,A){const{e:k}=f;return k[0]*v+k[1]*b+k[2]*D+k[3]*A-f.eMq}function O(f,v,b,D,A,k){for(D-=4;b<D;){for(;R(f,b,A)<=k;)b+=4;for(;R(f,D,A)>k;)D-=4;if(b>=D)break;const E=v[b>>2];v[b>>2]=v[D>>2],v[D>>2]=E,b+=4,D-=4}for(;R(f,b,A)>k;)b-=4;return b+4}function R(f,v,b){return f[v]*b[0]+f[v+1]*b[1]+f[v+2]*b[2]+f[v+3]*b[3]}function z(f,v,b){const D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],k=b-v>>2;for(let E=v;E<b;E+=4){const C=f[E]*.00392156862745098,h=f[E+1]*(1/255),u=f[E+2]*(1/255),q=f[E+3]*(1/255);A[0]+=C,A[1]+=h,A[2]+=u,A[3]+=q,D[0]+=C*C,D[1]+=C*h,D[2]+=C*u,D[3]+=C*q,D[5]+=h*h,D[6]+=h*u,D[7]+=h*q,D[10]+=u*u,D[11]+=u*q,D[15]+=q*q}return D[4]=D[1],D[8]=D[2],D[9]=D[6],D[12]=D[3],D[13]=D[7],D[14]=D[11],{R:D,m:A,N:k}}function p(f){const{R:v}=f,{m:b}=f,{N:D}=f,A=b[0],k=b[1],E=b[2],C=b[3],h=D==0?0:1/D,u=[v[0]-A*A*h,v[1]-A*k*h,v[2]-A*E*h,v[3]-A*C*h,v[4]-k*A*h,v[5]-k*k*h,v[6]-k*E*h,v[7]-k*C*h,v[8]-E*A*h,v[9]-E*k*h,v[10]-E*E*h,v[11]-E*C*h,v[12]-C*A*h,v[13]-C*k*h,v[14]-C*E*h,v[15]-C*C*h],q=u,I=T;let H=[Math.random(),Math.random(),Math.random(),Math.random()],G=0,$=0;if(D!=0)for(let N=0;N<16&&(H=I.multVec(q,H),$=Math.sqrt(I.dot(H,H)),H=I.sml(1/$,H),!(N!=0&&Math.abs($-G)<1e-9));N++)G=$;const j=[A*h,k*h,E*h,C*h];return{Cov:u,q:j,e:H,L:G,eMq255:I.dot(I.sml(255,j),H),eMq:I.dot(H,j),rgba:(Math.round(255*j[3])<<24|Math.round(255*j[2])<<16|Math.round(255*j[1])<<8|Math.round(255*j[0])<<0)>>>0}}var T={multVec:(f,v)=>[f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],f[4]*v[0]+f[5]*v[1]+f[6]*v[2]+f[7]*v[3],f[8]*v[0]+f[9]*v[1]+f[10]*v[2]+f[11]*v[3],f[12]*v[0]+f[13]*v[1]+f[14]*v[2]+f[15]*v[3]],dot:(f,v)=>f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],sml:(f,v)=>[f*v[0],f*v[1],f*v[2],f*v[3]]};tt.encode=function(v,b,D,A,k,E,C){A==null&&(A=0),C==null&&(C=!1);const h=a(v,b,D,A,[!1,!1,!1,0,C,!1]);return y(h,-1),_(h,b,D,k,E)},tt.encodeLL=function(v,b,D,A,k,E,C,h){const u={ctype:0+(A==1?0:2)+(k==0?0:4),depth:E,frames:[]},q=(A+k)*E,I=q*b;for(let H=0;H<v.length;H++)u.frames.push({rect:{x:0,y:0,width:b,height:D},img:new Uint8Array(v[H]),blend:0,dispose:1,bpp:Math.ceil(q/8),bpl:Math.ceil(I/8)});return y(u,0,!0),_(u,b,D,C,h)},tt.encode.compress=a,tt.encode.dither=l,tt.quantize=S,tt.quantize.getKDtree=M,tt.quantize.getNearest=x})();const Qn={toArrayBuffer(g,m){const w=g.width,s=g.height,e=w<<2,n=g.getContext("2d").getImageData(0,0,w,s),d=new Uint32Array(n.data.buffer),l=(32*w+31)/32<<2,_=l*s,y=122+_,a=new ArrayBuffer(y),t=new DataView(a),r=1<<20;let c,o,S,M,x=r,B=0,O=0,R=0;function z(f){t.setUint16(O,f,!0),O+=2}function p(f){t.setUint32(O,f,!0),O+=4}function T(f){O+=f}z(19778),p(y),T(4),p(122),p(108),p(w),p(-s>>>0),z(1),z(32),p(3),p(_),p(2835),p(2835),T(8),p(16711680),p(65280),p(255),p(4278190080),p(1466527264),function f(){for(;B<s&&x>0;){for(M=122+B*l,c=0;c<e;)x--,o=d[R++],S=o>>>24,t.setUint32(M+c,o<<8|S),c+=4;B++}R<d.length?(x=r,setTimeout(f,Qn._dly)):m(a)}()},toBlob(g,m){this.toArrayBuffer(g,w=>{m(new Blob([w],{type:"image/bmp"}))})},_dly:9};var Xe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},Xa={[Xe.CHROME]:16384,[Xe.FIREFOX]:11180,[Xe.DESKTOP_SAFARI]:16384,[Xe.IE]:8192,[Xe.IOS]:4096,[Xe.ETC]:8192};const _n=typeof window<"u",Vn=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Wt=_n&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),Ja=(_n||Vn)&&(Wt&&Wt.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Kn=(_n||Vn)&&(Wt&&Wt.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function pn(g,m,w=Date.now()){return new Promise(s=>{const e=g.split(","),n=e[0].match(/:(.*?);/)[1],d=globalThis.atob(e[1]);let l=d.length;const _=new Uint8Array(l);for(;l--;)_[l]=d.charCodeAt(l);const y=new Blob([_],{type:n});y.name=m,y.lastModified=w,s(y)})}function Gn(g){return new Promise((m,w)=>{const s=new Kn;s.onload=()=>m(s.result),s.onerror=e=>w(e),s.readAsDataURL(g)})}function Zn(g){return new Promise((m,w)=>{const s=new Image;s.onload=()=>m(s),s.onerror=e=>w(e),s.src=g})}function xt(){if(xt.cachedResult!==void 0)return xt.cachedResult;let g=Xe.ETC;const{userAgent:m}=navigator;return/Chrom(e|ium)/i.test(m)?g=Xe.CHROME:/iP(ad|od|hone)/i.test(m)&&/WebKit/i.test(m)?g=Xe.IOS:/Safari/i.test(m)?g=Xe.DESKTOP_SAFARI:/Firefox/i.test(m)?g=Xe.FIREFOX:(/MSIE/i.test(m)||document.documentMode)&&(g=Xe.IE),xt.cachedResult=g,xt.cachedResult}function Xn(g,m){const w=xt(),s=Xa[w];let e=g,n=m,d=e*n;const l=e>n?n/e:e/n;for(;d>s*s;){const _=(s+e)/2,y=(s+n)/2;_<y?(n=y,e=y*l):(n=_*l,e=_),d=e*n}return{width:e,height:n}}function Qt(g,m){let w,s;try{if(w=new OffscreenCanvas(g,m),s=w.getContext("2d"),s===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{w=document.createElement("canvas"),s=w.getContext("2d")}return w.width=g,w.height=m,[w,s]}function Jn(g,m){const{width:w,height:s}=Xn(g.width,g.height),[e,n]=Qt(w,s);return m&&/jpe?g/.test(m)&&(n.fillStyle="white",n.fillRect(0,0,e.width,e.height)),n.drawImage(g,0,0,e.width,e.height),e}function Bt(){return Bt.cachedResult!==void 0||(Bt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Bt.cachedResult}function Yt(g,m={}){return new Promise(function(w,s){let e,n;var d=function(){try{return n=Jn(e,m.fileType||g.type),w([e,n])}catch(_){return s(_)}},l=function(_){try{var y=function(a){try{throw a}catch(t){return s(t)}};try{let a;return Gn(g).then(function(t){try{return a=t,Zn(a).then(function(r){try{return e=r,function(){try{return d()}catch(c){return s(c)}}()}catch(c){return y(c)}},y)}catch(r){return y(r)}},y)}catch(a){y(a)}}catch(a){return s(a)}};try{if(Bt()||[Xe.DESKTOP_SAFARI,Xe.MOBILE_SAFARI].includes(xt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(g).then(function(_){try{return e=_,d()}catch{return l()}},l)}catch{l()}})}function jt(g,m,w,s,e=1){return new Promise(function(n,d){let l;if(m==="image/png"){let y,a,t;return y=g.getContext("2d"),{data:a}=y.getImageData(0,0,g.width,g.height),t=tt.encode([a.buffer],g.width,g.height,4096*e),l=new Blob([t],{type:m}),l.name=w,l.lastModified=s,_.call(this)}{let y=function(){return _.call(this)};if(m==="image/bmp")return new Promise(a=>Qn.toBlob(g,a)).then(function(a){try{return l=a,l.name=w,l.lastModified=s,y.call(this)}catch(t){return d(t)}}.bind(this),d);{let a=function(){return y.call(this)};if(typeof OffscreenCanvas=="function"&&g instanceof OffscreenCanvas)return g.convertToBlob({type:m,quality:e}).then(function(t){try{return l=t,l.name=w,l.lastModified=s,a.call(this)}catch(r){return d(r)}}.bind(this),d);{let t;return t=g.toDataURL(m,e),pn(t,w,s).then(function(r){try{return l=r,a.call(this)}catch(c){return d(c)}}.bind(this),d)}}}function _(){return n(l)}})}function lt(g){g.width=0,g.height=0}function Dt(){return new Promise(function(g,m){let w,s,e,n;return Dt.cachedResult!==void 0?g(Dt.cachedResult):pn("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(d){try{return w=d,Yt(w).then(function(l){try{return s=l[1],jt(s,w.type,w.name,w.lastModified).then(function(_){try{return e=_,lt(s),Yt(e).then(function(y){try{return n=y[0],Dt.cachedResult=n.width===1&&n.height===2,g(Dt.cachedResult)}catch(a){return m(a)}},m)}catch(y){return m(y)}},m)}catch(_){return m(_)}},m)}catch(l){return m(l)}},m)})}function er(g){return new Promise((m,w)=>{const s=new Kn;s.onload=e=>{const n=new DataView(e.target.result);if(n.getUint16(0,!1)!=65496)return m(-2);const d=n.byteLength;let l=2;for(;l<d;){if(n.getUint16(l+2,!1)<=8)return m(-1);const _=n.getUint16(l,!1);if(l+=2,_==65505){if(n.getUint32(l+=2,!1)!=1165519206)return m(-1);const y=n.getUint16(l+=6,!1)==18761;l+=n.getUint32(l+4,y);const a=n.getUint16(l,y);l+=2;for(let t=0;t<a;t++)if(n.getUint16(l+12*t,y)==274)return m(n.getUint16(l+12*t+8,y))}else{if((65280&_)!=65280)break;l+=n.getUint16(l,!1)}}return m(-1)},s.onerror=e=>w(e),s.readAsArrayBuffer(g)})}function tr(g,m){const{width:w}=g,{height:s}=g,{maxWidthOrHeight:e}=m;let n,d=g;return isFinite(e)&&(w>e||s>e)&&([d,n]=Qt(w,s),w>s?(d.width=e,d.height=s/w*e):(d.width=w/s*e,d.height=e),n.drawImage(g,0,0,d.width,d.height),lt(g)),d}function nr(g,m){const{width:w}=g,{height:s}=g,[e,n]=Qt(w,s);switch(m>4&&m<9?(e.width=s,e.height=w):(e.width=w,e.height=s),m){case 2:n.transform(-1,0,0,1,w,0);break;case 3:n.transform(-1,0,0,-1,w,s);break;case 4:n.transform(1,0,0,-1,0,s);break;case 5:n.transform(0,1,1,0,0,0);break;case 6:n.transform(0,1,-1,0,s,0);break;case 7:n.transform(0,-1,-1,0,s,w);break;case 8:n.transform(0,-1,1,0,0,w)}return n.drawImage(g,0,0,w,s),lt(g),e}function Cn(g,m,w=0){return new Promise(function(s,e){let n,d,l,_,y,a,t,r,c,o,S,M,x,B,O,R,z,p,T,f;function v(D=5){if(m.signal&&m.signal.aborted)throw m.signal.reason;n+=D,m.onProgress(Math.min(n,100))}function b(D){if(m.signal&&m.signal.aborted)throw m.signal.reason;n=Math.min(Math.max(D,n),100),m.onProgress(n)}return n=w,d=m.maxIteration||10,l=1024*m.maxSizeMB*1024,v(),Yt(g,m).then(function(D){try{return[,_]=D,v(),y=tr(_,m),v(),new Promise(function(A,k){var E;if(!(E=m.exifOrientation))return er(g).then(function(h){try{return E=h,C.call(this)}catch(u){return k(u)}}.bind(this),k);function C(){return A(E)}return C.call(this)}).then(function(A){try{return a=A,v(),Dt().then(function(k){try{return t=k?y:nr(y,a),v(),r=m.initialQuality||1,c=m.fileType||g.type,jt(t,c,g.name,g.lastModified,r).then(function(E){try{{let h=function(){if(d--&&(O>l||O>x)){let q,I;return q=f?.95*T.width:T.width,I=f?.95*T.height:T.height,[z,p]=Qt(q,I),p.drawImage(T,0,0,q,I),r*=c==="image/png"?.85:.95,jt(z,c,g.name,g.lastModified,r).then(function(H){try{return R=H,lt(T),T=z,O=R.size,b(Math.min(99,Math.floor((B-O)/(B-l)*100))),h}catch(G){return e(G)}},e)}return[1]},u=function(){return lt(T),lt(z),lt(y),lt(t),lt(_),b(100),s(R)};if(o=E,v(),S=o.size>l,M=o.size>g.size,!S&&!M)return b(100),s(o);var C;return x=g.size,B=o.size,O=B,T=t,f=!m.alwaysKeepResolution&&S,(C=function(q){for(;q;){if(q.then)return void q.then(C,e);try{if(q.pop){if(q.length)return q.pop()?u.call(this):q;q=h}else q=q.call(this)}catch(I){return e(I)}}}.bind(this))(h)}}catch(h){return e(h)}}.bind(this),e)}catch(E){return e(E)}}.bind(this),e)}catch(k){return e(k)}}.bind(this),e)}catch(A){return e(A)}}.bind(this),e)})}const ei=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let dn;function ti(g,m){return new Promise((w,s)=>{dn||(dn=function(d){const l=[];return l.push(d),URL.createObjectURL(new Blob(l))}(ei));const e=new Worker(dn);e.addEventListener("message",function(d){if(m.signal&&m.signal.aborted)e.terminate();else if(d.data.progress===void 0){if(d.data.error)return s(new Error(d.data.error)),void e.terminate();w(d.data.file),e.terminate()}else m.onProgress(d.data.progress)}),e.addEventListener("error",s),m.signal&&m.signal.addEventListener("abort",()=>{s(m.signal.reason),e.terminate()}),e.postMessage({file:g,imageCompressionLibUrl:m.libURL,options:{...m,onProgress:void 0,signal:void 0}})})}function $e(g,m){return new Promise(function(w,s){let e,n,d,l,_,y;if(e={...m},d=0,{onProgress:l}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,_=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=c=>{d=c,typeof l=="function"&&l(d)},!(g instanceof Blob||g instanceof Ja))return s(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(g.type))return s(new Error("The file given is not an image"));if(y=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!_||typeof Worker!="function"||y)return Cn(g,e).then(function(c){try{return n=c,r.call(this)}catch(o){return s(o)}}.bind(this),s);var a=function(){try{return r.call(this)}catch(c){return s(c)}}.bind(this),t=function(c){try{return Cn(g,e).then(function(o){try{return n=o,a()}catch(S){return s(S)}},s)}catch(o){return s(o)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",ti(g,e).then(function(c){try{return n=c,a()}catch{return t()}},t)}catch{t()}function r(){try{n.name=g.name,n.lastModified=g.lastModified}catch{}try{e.preserveExif&&g.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===g.type)&&(n=$n(g,n))}catch{}return w(n)}})}$e.getDataUrlFromFile=Gn,$e.getFilefromDataUrl=pn,$e.loadImage=Zn,$e.drawImageInCanvas=Jn,$e.drawFileInCanvas=Yt,$e.canvasToFile=jt,$e.getExifOrientation=er,$e.handleMaxWidthOrHeight=tr,$e.followExifOrientation=nr,$e.cleanupCanvasMemory=lt,$e.isAutoOrientationInBrowser=Dt,$e.approximateBelowMaximumCanvasSizeOfBrowser=Xn,$e.copyExifWithoutOrientation=$n,$e.getBrowserName=xt,$e.version="2.0.2";const ni={maxSizeMB:.8,maxWidthOrHeight:2400,initialQuality:.9,useWebWorker:!0,compressionThresholdMB:1};async function ri(g,m,w={},s){const e={...ni,...w};try{let n=g;if(g.type.startsWith("image/")&&g.size>e.compressionThresholdMB*1024*1024){s?.("Compressing image...");try{const _=await $e(g,{maxSizeMB:e.maxSizeMB,maxWidthOrHeight:e.maxWidthOrHeight,initialQuality:e.initialQuality,useWebWorker:e.useWebWorker});n=_;const y=(g.size/(1024*1024)).toFixed(2),a=(_.size/(1024*1024)).toFixed(2),t=((1-_.size/g.size)*100).toFixed(0);console.log(`Image compressed: ${y}MB  ${a}MB (${t}% smaller)`)}catch(_){console.warn("Image compression failed, uploading original:",_)}}return s?.("Uploading file..."),{success:!0,attachment:await Qr(n,m)}}catch(n){return console.error("File upload failed:",n),{success:!1,error:n instanceof Error?n.message:"Upload failed"}}}async function ai(g){try{const m=jr(g.url);return await $r(m),!0}catch(m){return console.error("Failed to remove attachment:",m),!1}}function ii(g,m,w){return g.map(s=>s.id===m?{...s,name:w}:s)}function si(g,m=5){const w=g.type.startsWith("image/"),s=m*1024*1024;if(!w&&g.size>s){const e=(g.size/1048576).toFixed(2);return{valid:!1,error:`Non-image files must be under ${m}MB (selected file is ${e}MB)`}}return{valid:!0}}function oi(g){return{uploadAttachment:(m,w,s)=>ri(m,w,g,s),removeAttachment:ai,updateAttachmentName:ii,validateFile:si}}function Fn(g,m){const[w,s]=m.split(":").map(Number);let e=oa(g,w);return e=la(e,s),e}function Un(g){return Array.from(new Set(g)).sort((m,w)=>m-w)}function li(g,m){if(m.includes(g))return 0;const w=m.find(s=>s>g);return w!==void 0?w-g:7-g+m[0]}function ci(g,m,w){const s=new Date(g),e=yt(s,Ge),n=e.getDay(),d=li(n,w);if(d===0)return{start_time:g,end_time:m};const l=Ht(e,d),_=Et(l,Ge);let y=m;if(m){const a=yt(new Date(m),Ge),t=Ht(a,d);y=Et(t,Ge).toISOString()}return{start_time:_.toISOString(),end_time:y}}function rr({eventItem:g,dateInput:m,startTimeInput:w,endTimeInput:s,attachments:e,isRecurring:n,recurrenceFrequency:d,recurrenceInterval:l,recurringDays:_,recurrenceEndDate:y,hasEndDate:a,monthlyType:t}){const r=!g.id,c={...g.meta_data??{}};if(g.organization){c.organization=g.organization;const p=Mt(g.organization);p?.label&&(c.organization_label=p.label)}const o=Bn(),S=o?un(o.stores.currentUser):void 0;if(r){const p=o?un(o.stores.userOrganizations):void 0,T=S?.displayName||S?.username,f=S?.id;T&&!c.submitted_by_name&&(c.submitted_by_name=T),f&&!c.submitted_by_user_id&&(c.submitted_by_user_id=f);const v=p?Array.from(p):[];v.length&&!c.submitted_by_organizations&&(c.submitted_by_organizations=v),c.submitted_at||(c.submitted_at=new Date().toISOString())}else{const p=S?.displayName||S?.username;p&&(c.edited_by_name=p),S?.id&&(c.edited_by_user_id=S.id),c.edited_at=new Date().toISOString()}const M=Object.keys(c).length?c:void 0,x={title:g.title,description:g.description,location:g.location,is_public:g.is_public??!0,event_type:g.event_type,meta_data:M,attachments:e.length>0?e:null};if(g.event_type!=="calendar_event")return{...x,start_time:void 0,end_time:void 0,is_all_day:void 0,recurrence_rule:void 0,recurrence_end_date:void 0};const B=m?Nt(m,"yyyy-MM-dd",new Date):new Date;let O,R;if(g.is_all_day){const p=Et(B,Ge);O=p.toISOString(),R=p.toISOString()}else{const p=new Date(B.getTime()),T=new Date(B.getTime()),f=w?Fn(p,w):B,v=s?Fn(T,s):B;O=Et(f,Ge).toISOString(),R=Et(v,Ge).toISOString()}const z={...x,start_time:O,end_time:R,is_all_day:g.is_all_day};if(n&&z.start_time){if(d==="weekly"&&_.length>0){const T=Un(_),f=ci(z.start_time,z.end_time,T);z.start_time=f.start_time,z.end_time=f.end_time}if(d==="daily"||d==="yearly"||d==="weekly"&&_.length>0||d==="monthly"){const{recurrence_rule:T,recurrence_end_date:f}=gn({frequency:d,interval:l,recurringDays:d==="weekly"?Un(_):[],recurrenceEndDate:y,hasEndDate:a,monthlyType:t,startTime:z.start_time});z.recurrence_rule=T,z.recurrence_end_date=f}else z.recurrence_rule=void 0,z.recurrence_end_date=void 0}else z.recurrence_rule=void 0,z.recurrence_end_date=void 0;return z}async function di({id:g,...m}){const w=rr(m);return g?(m.eventItem.bishop_approval==="NO"&&Object.assign(w,{bishop_approval:null,bishop_approval_at:null,bishop_approval_by_user_id:null,first_counselor_approval:null,first_counselor_approval_at:null,first_counselor_approval_by_user_id:null,second_counselor_approval:null,second_counselor_approval_at:null,second_counselor_approval_by_user_id:null}),{action:"update",event:await At(g,w)}):{action:"create",event:await qn(w)}}async function ui(g){await Hn(g)}function fi({event:g,newDate:m}){const w=g.start_time?new Date(g.start_time):new Date,s=g.end_time?new Date(g.end_time):new Date,[e,n,d]=m.split("-").map(Number),l=new Date(w);l.setFullYear(e,n-1,d);const _=new Date(s);return _.setFullYear(e,n-1,d),{...g,id:void 0,title:`CLONED - ${g.title}`,start_time:l.toISOString(),end_time:_.toISOString(),attachments:[],recurrence_rule:void 0,recurrence_end_date:void 0}}async function vi(g,m,w){const s=await Ct(g);if(!s)throw new Error("Event not found");const e=s.recurrence_exceptions||[];e.includes(m)||e.push(m);const n=s.recurrence_overrides||{};n[m]={title:w.title,description:w.description,location:w.location,start_time:w.start_time,end_time:w.end_time,is_all_day:w.is_all_day,meta_data:w.meta_data},await At(g,{recurrence_exceptions:e,recurrence_overrides:n})}async function mi(g,m,w){const s=await Ct(g);if(!s||!s.recurrence_rule||!s.start_time)throw new Error("Event not found or is not recurring");const{parseRecurrenceRule:e,generateRecurrenceRule:n}=await Lt(async()=>{const{parseRecurrenceRule:O,generateRecurrenceRule:R}=await Promise.resolve().then(()=>mn);return{parseRecurrenceRule:O,generateRecurrenceRule:R}},void 0,import.meta.url),d=e(s.recurrence_rule,s.recurrence_end_date);if(!d)throw new Error("Failed to parse recurrence rule");const l=He(new Date(s.start_time),"yyyy-MM-dd"),_=Nt(m,"yyyy-MM-dd",new Date),y=Nt(l,"yyyy-MM-dd",new Date);if(_<=y)return await At(g,w),g;const a=Ht(_,-1),t=He(a,"yyyy-MM-dd"),{recurrence_rule:r,recurrence_end_date:c}=n({frequency:d.frequency,interval:d.interval,recurringDays:d.recurringDays,recurrenceEndDate:t,hasEndDate:!0,monthlyType:d.monthlyType,startTime:s.start_time});await At(g,{recurrence_rule:r,recurrence_end_date:c});const o=d.hasEndDate?d.recurrenceEndDate:"",{recurrence_rule:S,recurrence_end_date:M}=n({frequency:d.frequency,interval:d.interval,recurringDays:d.recurringDays,recurrenceEndDate:o,hasEndDate:d.hasEndDate,monthlyType:d.monthlyType,startTime:w.start_time||s.start_time}),x={...w,recurrence_rule:S,recurrence_end_date:M};return(await qn(x))?.id||0}async function hi(g,m){const w=await Ct(g);if(!w)throw new Error("Event not found");const s={title:m.title,description:m.description,location:m.location,event_type:m.event_type,meta_data:m.meta_data,attachments:m.attachments,is_all_day:m.is_all_day,start_time:w.start_time,end_time:w.end_time,recurrence_rule:w.recurrence_rule,recurrence_end_date:w.recurrence_end_date,recurrence_exceptions:[],recurrence_overrides:{}};await At(g,s)}async function gi(g,m){const w=await Ct(g);if(!w)throw new Error("Event not found");const s=w.recurrence_exceptions||[];s.includes(m)||s.push(m);const e=w.recurrence_overrides||{};e[m]&&delete e[m],await At(g,{recurrence_exceptions:s,recurrence_overrides:e})}async function _i(g,m){const w=await Ct(g);if(!w||!w.recurrence_rule||!w.start_time)throw new Error("Event not found or is not recurring");const s=Nt(m,"yyyy-MM-dd",new Date),e=Ht(s,-1),n=He(e,"yyyy-MM-dd"),{parseRecurrenceRule:d}=await Lt(async()=>{const{parseRecurrenceRule:t}=await Promise.resolve().then(()=>mn);return{parseRecurrenceRule:t}},void 0,import.meta.url),l=d(w.recurrence_rule,w.recurrence_end_date);if(!l)throw new Error("Failed to parse recurrence rule");const{generateRecurrenceRule:_}=await Lt(async()=>{const{generateRecurrenceRule:t}=await Promise.resolve().then(()=>mn);return{generateRecurrenceRule:t}},void 0,import.meta.url),{recurrence_rule:y,recurrence_end_date:a}=_({frequency:l.frequency,interval:l.interval,recurringDays:l.recurringDays,recurrenceEndDate:n,hasEndDate:!0,monthlyType:l.monthlyType,startTime:w.start_time});await At(g,{recurrence_rule:y,recurrence_end_date:a})}async function pi(g){await Hn(g)}function yi(){return{saveEvent:di,deleteEventById:ui,cloneEventForDate:fi,buildEventPayload:rr,saveSingleInstance:vi,saveFutureInstances:mi,saveAllInstances:hi,deleteSingleInstance:gi,deleteFutureInstances:_i,deleteAllInstances:pi}}const bi=`${Nr}/functions/v1/calendar-approval-notify`;async function wi(g,m){if(!(!g||typeof fetch>"u"))try{const w=await fetch(bi,{method:"POST",headers:Hr(!0,{useAuthToken:!0}),body:JSON.stringify({event_id:g,reason:m})});if(!w.ok){const s=await w.text();console.error("Failed to send approval notification:",s)}}catch(w){console.error("Error sending approval notification:",w)}}var xi=ve('<div class="alert alert-info d-flex align-items-center gap-2 mb-0" role="alert"><i class="bi bi-arrow-repeat"></i> <div><strong>Recurring Event</strong> <div class="small">Changes to this event will apply to all future occurrences.</div></div></div>'),Ei=ve('<button class="btn btn-primary btn-sm"><i class="bi bi-files"></i> <span class="ms-1">Clone</span></button>'),Ai=ve("<!> <!>",1),Di=ve('<span class="badge bg-secondary-subtle text-secondary-emphasis"> </span>'),Si=ve('<div class="card"><button type="button" class="btn btn-link text-start text-decoration-none d-flex align-items-center gap-3 p-3 w-100 submitter-chat-toggle svelte-1ujj5ue"><i class="bi bi-chat-left-dots"></i> <div class="d-flex flex-column align-items-start"><span class="fw-semibold">Discussion with Bishopric</span> <small class="text-muted">Ask questions or respond to feedback</small></div> <div class="ms-auto d-flex align-items-center gap-2"><!> <i class="bi bi-chevron-right"></i></div></button></div> <!>',1),Ii=ve('<div class="alert alert-info small mb-0 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All submissions require bishopric approval before they appear on the public calendar.</span></div> <!>',1),ki=ve('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),Ti=ve("<span>Save</span>"),Ri=ve("<span>Create</span>"),Mi=ve('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),Ci=ve('<button class="btn btn-primary position-relative"><!> <!></button>'),Fi=ve('<div class="d-flex flex-column gap-4"><!> <div class="d-flex flex-column gap-3"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap"><h2 class="h5 mb-0">Event Details</h2> <!></div> <!></div> <!> <!> <!> <!> <div class="d-flex justify-content-between align-items-center gap-2 flex-row"><div class="d-flex flex-row gap-2"><!></div> <div class="d-flex flex-row gap-2"><button class="btn btn-secondary position-relative">Cancel</button> <!></div></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span></div> <!></div> <!> <!>',1);function Ss(g,m){dt(m,!1);const w=()=>an(B,"$userOrganizations",n),s=()=>an(O,"$currentUser",n),e=()=>an(R,"$validationErrors",n),[n,d]=Br(),l=de(),_=de(),y=de(),a=de(),t=de();let r=me(m,"name",8,""),c=me(m,"drawerId",8,""),o=me(m,"eventItem",12,qr),S=me(m,"canDelete",8,!0),M=me(m,"canCreate",8,!0);const{actions:{reload:x}}=Vr(),{stores:{userOrganizations:B,currentUser:O}}=Bn(),{validationErrors:R,validate:z,getErrorMessages:p,clearErrors:T}=Qa(),{parseRecurrenceRule:f}=jn(),{uploadAttachment:v,removeAttachment:b,updateAttachmentName:D,validateFile:A}=oi(),{saveEvent:k,deleteEventById:E,cloneEventForDate:C,buildEventPayload:h,saveSingleInstance:u,saveFutureInstances:q,saveAllInstances:I,deleteSingleInstance:H,deleteFutureInstances:G,deleteAllInstances:$}=yi();let j=de(!1),N=de(!1),U=de(!1),X=de("weekly"),ue=de(1),te=de([]),se=de(""),ge=de(!0),Se=de("date"),De=de([]),Te=de(!1),Q=de(!1),Z=de(void 0),V=de(void 0),re=de(!1),oe=de(null),ce=de(!1),ie=de(null),ne=de(0),fe=de({title:"",description:"",start_time:"",end_time:"",location:"",is_all_day:!1,event_type:"announcement"}),_e=de({message:"",type:"info"}),le=de(""),pe=de(""),ke=de(""),Le=de({dateInput:"",startTimeInput:"",endTimeInput:"",isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"}),be=de(!1);const je=(K,Y)=>K.length===Y.length&&K.every((we,Ae)=>we===Y[Ae]);let Ee=de([]),Re=de(!1),qe=de(!1);const Ne=`submitter-chat-form-${ia()}`;let Pe=de(null),Me=null,We=null;zn(async()=>{typeof window<"u"&&(We=(await Lt(()=>import("./DO0djbQe.js").then(Y=>Y.o),__vite__mapDeps([0,1]),import.meta.url)).default)}),Fr(()=>{rt()});function ft(){if(!We)return;const K=document.getElementById(Ne);if(!K)return;We.getOrCreateInstance(K).show()}function nt(K){const Y=K??o()?.id??null;if(Me||!Y)return;const we=typeof window<"u"?localStorage.getItem("authToken"):null;we&&on.realtime.setAuth(we),Me=on.channel(`submitter-comments-form-${Y}`).on("postgres_changes",{event:"*",schema:"public",table:"event_submitter_comments",filter:`event_id=eq.${Y}`},()=>{at(Y)}).subscribe()}function rt(){Me&&(on.removeChannel(Me),Me=null)}async function at(K){const Y=K??o()?.id??null;if(Y){i(qe)||F(Re,!0);try{const we=await Kr(Y);Y===(o()?.id??null)&&(F(Ee,we),F(qe,!0))}catch(we){console.error("Failed to load submitter comments:",we)}finally{Y===(o()?.id??null)&&F(Re,!1)}}}async function Vt(K){if(!o()?.id||!s()?.id)return;const Y=s().displayName||s().username||"Unknown";await Jr(o().id,s().id,Y,K),await at()}async function it(K){await Xr(K),await at()}const Ze=()=>{const K=`[data-bs-target="#${c()}"]`,Y=document.querySelector(K);Y&&Y.click()},Fe=(K,Y=0,we="info")=>{rn(_e,i(_e).message=K),rn(_e,i(_e).type=we),Y&&setTimeout(()=>{rn(_e,i(_e).message="")},Y)},bt=async K=>{const Y=K.detail;if(!Y)return;const we=A(Y);if(!we.valid){Fe(we.error??"Invalid file selected",7e3,"danger");return}F(N,!0);try{const Ae=await v(Y,i(l)??"temp",Ye=>Fe(Ye));if(!Ae.success||!Ae.attachment)throw new Error(Ae.error??"Upload failed");F(De,[...i(De),Ae.attachment]),F(Te,!0),Fe("File uploaded!",3e3,"success")}catch(Ae){console.error("File upload failed:",Ae),Fe("Failed to upload file. Please try again.",7e3,"danger")}finally{F(N,!1)}},Ft=K=>{const{attachment:Y,newName:we}=K.detail;F(De,D(i(De),Y.id,we)),F(Te,!0),Fe("Attachment name updated!",3e3,"success")},vt=async K=>{const Y=K.detail;if(Y){F(N,!0);try{if(!await b(Y))throw new Error("Failed to remove attachment");F(De,i(De).filter(Ae=>Ae.id!==Y.id)),F(Te,!0),Fe("Attachment removed!",3e3,"success")}catch(we){console.error("Failed to remove attachment:",we),Fe("Failed to remove attachment. Please try again.",7e3,"danger")}finally{F(N,!1)}}},mt=async()=>{if(!i(l)){Fe("ID is not defined",0,"danger");return}try{await E(i(l)),await x(),ht("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{F(j,!1),F(fe,{...o(),id:i(l)}),Fe("Event Deleted",3e3,"success"),Ze()},800)}catch(K){ht("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{F(j,!1),console.error("Delete failed:",K),Fe("Failed to delete event. Please try again.",7e3,"danger")},800)}},ar=()=>!!o().recurrence_rule,ir=async()=>{const K=i(l)||o().meta_data?.recurring_parent_id;if(K&&i(Q)&&i(V)&&i(Z)){if(F(ie,null),F(ce,!0),await new Promise(Y=>{const we=setInterval(()=>{i(ce)||(clearInterval(we),Y())},50)}),!i(ie))return;F(j,!0);try{i(ie)==="single"?await H(K,i(Z)):i(ie)==="future"?await G(K,i(Z)):i(ie)==="all"&&await $(K),await x(),ht("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{F(j,!1),F(fe,{...o(),id:i(l)}),Fe("Event Deleted",3e3,"success"),Ze()},800)}catch(Y){ht("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{F(j,!1),console.error("Delete failed:",Y),Fe("Failed to delete event. Please try again.",7e3,"danger")},800)}}else F(j,!0),ea({title:"Delete Confirmation",message:ar()?"This recurring event and every occurrence, past and future, will be removed. You won't be able to undo this. Continue?":"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:Y=>{Y?mt():F(j,!1)}})},sr=K=>{if(i(l))try{const Y=C({event:o(),newDate:K});ht("clone_calendar_event_form_loaded","interaction","Clone Calendar Event Form Loaded",1),Fe("Event cloned. Review and click Create to save.",5e3,"success"),o(Y),F(le,Y.start_time?He(new Date(Y.start_time),"yyyy-MM-dd"):""),F(pe,Y.start_time?He(new Date(Y.start_time),"HH:mm"):""),F(ke,Y.end_time?He(new Date(Y.end_time),"HH:mm"):""),F(De,[]),F(U,!1),F(te,[]),F(se,""),F(ge,!0),F(Te,!0),F(ne,void 0),F(fe,{...Y}),F(Le,{dateInput:i(le),startTimeInput:i(pe),endTimeInput:i(ke),isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"})}catch(Y){console.error("Clone failed:",Y),Fe("Failed to clone event. Please try again.",7e3,"danger")}},or=()=>{ja({title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",defaultDate:i(le),callback:(K,Y)=>{K&&Y&&sr(Y)}})},lr=async()=>{if(i(l)&&!i(y)){Fe("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!await z({title:o().title,event_type:o().event_type,organization:o().organization??"",description:o().description,location:o().location,is_all_day:o().is_all_day,dateInput:i(le),startTimeInput:i(pe),endTimeInput:i(ke),isRecurring:i(U),recurrenceFrequency:i(X),recurringDays:i(U)?i(te):[],recurrenceEndDate:i(U)?i(se):void 0,hasEndDate:i(ge)})){const we=p();we.length&&Fe(we.join(". ")+".  Please address accordingly.",0,"danger");return}const Y=i(l)||o().meta_data?.recurring_parent_id;if(Y&&i(Q)&&i(V)&&i(Z)){if(F(oe,null),F(re,!0),await new Promise(Ae=>{const Ye=setInterval(()=>{i(re)||(clearInterval(Ye),Ae())},100)}),!i(oe)||i(j))return;Fe("Saving ..."),F(j,!0);const we=h({eventItem:o(),dateInput:i(le),startTimeInput:i(pe),endTimeInput:i(ke),attachments:i(De),isRecurring:i(_)&&i(U),recurrenceFrequency:i(X),recurrenceInterval:i(ue),recurringDays:i(U)?i(te):[],recurrenceEndDate:i(U)?i(se):"",hasEndDate:i(ge),monthlyType:i(Se)});try{let Ae;i(oe)==="single"?await u(Y,i(Z),we):i(oe)==="future"?Ae=await q(Y,i(Z),we):i(oe)==="all"&&await I(Y,we),await x(),await Or(),ht("set_calendar_event_success","interaction",`Set Calendar Event Successful ${o().title}`,1),F(j,!1),Ae&&o({...o(),id:Ae}),o(o().attachments=i(De),!0),F(fe,{...o(),id:Ae||Y}),F(Te,!1),Fe("Saved",3e3,"success"),Ze()}catch(Ae){ht("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${o().title}`,1),setTimeout(()=>{F(j,!1),console.error("Save failed:",Ae),Fe("Failed to save event. Please try again.",7e3,"danger")},800)}}else{if(i(j))return;Fe("Saving ..."),F(j,!0);const we=!!i(l)&&(o().bishop_approval==="NO"||o().first_counselor_approval==="NO"||o().second_counselor_approval==="NO");try{const Ae=await k({id:i(l),eventItem:o(),dateInput:i(le),startTimeInput:i(pe),endTimeInput:i(ke),attachments:i(De),isRecurring:i(_)&&i(U),recurrenceFrequency:i(X),recurrenceInterval:i(ue),recurringDays:i(U)?i(te):[],recurrenceEndDate:i(U)?i(se):"",hasEndDate:i(ge),monthlyType:i(Se)});let Ye=null;Ae.action==="create"?Ye="created":we&&(Ye="resubmitted"),Ae.event&&o({...o(),...Ae.event}),o(o().attachments=i(De),!0),await x();const Ue=Ae.event?.id??i(l);Ye&&Ue&&wi(Ue,Ye),ht("set_calendar_event_success","interaction",`Set Calendar Event Successful ${o().title}`,1),setTimeout(()=>{F(j,!1),F(fe,{...o(),id:i(l)}),F(Te,!1),Fe("Saved",3e3,"success"),Ze()},800)}catch(Ae){ht("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${o().title}`,1),setTimeout(()=>{F(j,!1),console.error("Save failed:",Ae),Fe("Failed to save event. Please try again.",7e3,"danger")},800)}}};Be(()=>J(o()),()=>{F(l,o().id)}),Be(()=>J(o()),()=>{F(_,o().event_type==="calendar_event")}),Be(()=>(i(_),i(U),i(te),i(se)),()=>{!i(_)&&(i(U)||i(te).length>0||i(se))&&(F(U,!1),F(X,"weekly"),F(ue,1),F(te,[]),F(se,""),F(ge,!0),F(Se,"date"))}),Be(()=>(J(o()),i(ne),i(fe),i(Te),i(le),i(pe),i(ke),i(U),i(X),i(ue),i(te),i(se),i(ge),i(Se)),()=>{if(o()?.id!==i(ne)||o()?.start_time!==i(fe).start_time||o()?.meta_data?.recurring_instance_index!==i(fe).meta_data?.recurring_instance_index){F(j,!0);const K=i(Te),Y=o();setTimeout(()=>{const we=Y.event_type==="calendar_event";if(F(le,we&&Y.start_time?He(new Date(Y.start_time),"yyyy-MM-dd"):""),F(pe,we&&Y.start_time?He(new Date(Y.start_time),"HH:mm"):""),F(ke,we&&Y.end_time?He(new Date(Y.end_time),"HH:mm"):""),K||F(De,Y.attachments?[...Y.attachments]:[]),Y.meta_data?.recurring_instance&&Y.start_time?(F(V,Y.recurrence_rule),F(Q,!0),F(Z,He(new Date(Y.start_time),"yyyy-MM-dd"))):(F(V,void 0),F(Q,!1),F(Z,void 0)),Y.recurrence_rule){const Ae=f(Y.recurrence_rule,Y.recurrence_end_date);Ae?(F(U,!0),F(X,Ae.frequency),F(ue,Ae.interval),F(te,Ae.recurringDays),F(se,Ae.recurrenceEndDate),F(ge,Ae.hasEndDate),F(Se,Ae.monthlyType)):(F(U,!1),F(X,"weekly"),F(ue,1),F(te,[]),F(se,""),F(ge,!0),F(Se,"date"))}else F(U,!1),F(X,"weekly"),F(ue,1),F(te,[]),F(se,""),F(ge,!0),F(Se,"date");F(ne,Y.id),F(fe,{...Y}),F(j,!1),F(Te,!1),T(),F(Le,{dateInput:i(le),startTimeInput:i(pe),endTimeInput:i(ke),isRecurring:i(U),recurrenceFrequency:i(X),recurrenceInterval:i(ue),recurringDays:[...i(te)],recurrenceEndDate:i(se),hasEndDate:i(ge),monthlyType:i(Se)})},200)}}),Be(()=>(i(fe),J(o()),i(De),i(le),i(Le),i(pe),i(ke),i(U),i(X),i(ue),i(te),i(se),i(ge),i(Se)),()=>{F(y,i(fe).title!==o().title||i(fe).start_time!==o().start_time||i(fe).end_time!==o().end_time||i(fe).description!==o().description||i(fe).location!==o().location||i(fe).is_public!==o().is_public||i(fe).organization!==o().organization||i(fe).is_all_day!==o().is_all_day||JSON.stringify(i(De))!==JSON.stringify(o().attachments||[])||i(fe).recurrence_rule!==o().recurrence_rule||i(fe).recurrence_end_date!==o().recurrence_end_date||i(le)!==i(Le).dateInput||i(pe)!==i(Le).startTimeInput||i(ke)!==i(Le).endTimeInput||i(U)!==i(Le).isRecurring||i(X)!==i(Le).recurrenceFrequency||i(ue)!==i(Le).recurrenceInterval||!je(i(te),i(Le).recurringDays)||i(se)!==i(Le).recurrenceEndDate||i(ge)!==i(Le).hasEndDate||i(Se)!==i(Le).monthlyType)}),Be(()=>(w(),Oe),()=>{F(be,w().has(Oe.Bishopric))}),Be(()=>(J(o()),s()),()=>{F(a,!!o()?.id&&!!s()?.id&&o().meta_data?.submitted_by_user_id===s().id)}),Be(()=>(i(a),i(be)),()=>{F(t,i(a)&&!i(be))}),Be(()=>(i(t),J(o()),i(Pe)),()=>{const K=i(t)?o()?.id??null:null;K&&K!==i(Pe)?(F(Pe,K),F(Ee,[]),F(qe,!1),F(Re,!1),rt(),at(K),nt(K)):!K&&i(Pe)!==null&&(F(Pe,null),F(Ee,[]),F(qe,!1),F(Re,!1),rt())}),It(),gt();var yn=Fi(),Kt=Ve(yn),bn=L(Kt);{var cr=K=>{var Y=xi();ae(K,Y)};he(bn,K=>{J(o()),i(l),ee(()=>o().recurrence_rule&&i(l))&&K(cr)})}var Gt=W(bn,2),Zt=L(Gt),dr=W(L(Zt),2);{var ur=K=>{var Y=Ei();ye(()=>Y.disabled=i(j)||i(N)),Ie("click",Y,or),ae(K,Y)};he(dr,K=>{i(l)&&K(ur)})}P(Zt);var fr=W(Zt,2);{let K=st(()=>i(j)||i(N));ma(fr,{get disabled(){return i(K)},get name(){return r()},get validationErrors(){return e()},get title(){return o().title},set title(Y){o(o().title=Y,!0)},get eventType(){return o().event_type},set eventType(Y){o(o().event_type=Y,!0)},get organization(){return o().organization},set organization(Y){o(o().organization=Y,!0)},get isPublic(){return o().is_public},set isPublic(Y){o(o().is_public=Y,!0)},get description(){return o().description},set description(Y){o(o().description=Y,!0)},$$legacy:!0})}P(Gt);var wn=W(Gt,2);{var vr=K=>{var Y=Ai(),we=Ve(Y);{let Ye=st(()=>i(j)||i(N));ba(we,{get disabled(){return i(Ye)},get name(){return r()},get validationErrors(){return e()},get dateInput(){return i(le)},set dateInput(Ue){F(le,Ue)},get startTimeInput(){return i(pe)},set startTimeInput(Ue){F(pe,Ue)},get endTimeInput(){return i(ke)},set endTimeInput(Ue){F(ke,Ue)},get isAllDay(){return o().is_all_day},set isAllDay(Ue){o(o().is_all_day=Ue,!0)},$$legacy:!0})}var Ae=W(we,2);{let Ye=st(()=>i(j)||i(N));ka(Ae,{get disabled(){return i(Ye)},get name(){return r()},get validationErrors(){return e()},get isRecurring(){return i(U)},set isRecurring(Ue){F(U,Ue)},get recurrenceFrequency(){return i(X)},set recurrenceFrequency(Ue){F(X,Ue)},get recurrenceInterval(){return i(ue)},set recurrenceInterval(Ue){F(ue,Ue)},get recurringDays(){return i(te)},set recurringDays(Ue){F(te,Ue)},get recurrenceEndDate(){return i(se)},set recurrenceEndDate(Ue){F(se,Ue)},get monthlyType(){return i(Se)},set monthlyType(Ue){F(Se,Ue)},get dateInput(){return i(le)},set dateInput(Ue){F(le,Ue)},$$legacy:!0})}ae(K,Y)};he(wn,K=>{i(_)&&K(vr)})}var xn=W(wn,2);{let K=st(()=>i(j)||i(N));Ba(xn,{get attachments(){return i(De)},get uploadingFile(){return i(N)},get disabled(){return i(K)},$$events:{upload:bt,edit:Ft,remove:vt}})}var En=W(xn,2);{let K=st(()=>i(j)||i(N)),Y=st(()=>`${r()}-location`);Ra(En,{get disabled(){return i(K)},get name(){return i(Y)},get value(){return o().location},set value(we){o(o().location=we,!0)},$$legacy:!0})}var An=W(En,2);{var mr=K=>{var Y=Ii(),we=W(Ve(Y),2);{var Ae=Ye=>{var Ue=Si(),kt=Ve(Ue),Qe=L(kt),_t=W(L(Qe),4),Sr=L(_t);{var Ir=Tt=>{var Rt=Di(),kn=L(Rt,!0);P(Rt),ye(()=>xe(kn,(i(Ee),ee(()=>i(Ee).length)))),ae(Tt,Rt)};he(Sr,Tt=>{i(Ee),ee(()=>i(Ee).length>0)&&Tt(Ir)})}Je(2),P(_t),P(Qe),P(kt);var kr=W(kt,2);{let Tt=st(()=>(J(o()),ee(()=>o()?.title||"Event")));sa(kr,{get id(){return Ne},subtitle:"Discussion with Bishopric",get title(){return i(Tt)},className:"submitter-chat-drawer-stacked",bodyClass:"overflow-hidden d-flex flex-column",children:(Rt,kn)=>{{let Tr=st(()=>(s(),ee(()=>s()?.id??-1))),Rr=st(()=>i(j)||i(N));Zr(Rt,{get comments(){return i(Ee)},get currentUserId(){return i(Tr)},onSend:Vt,onDelete:it,get loading(){return i(Re)},fullHeight:!0,get disabled(){return i(Rr)}})}},$$slots:{default:!0}})}ye(()=>Ce(Qe,"aria-controls",Ne)),Ie("click",Qe,ft),ae(Ye,Ue)};he(we,Ye=>{i(t)&&Ye(Ae)})}ae(K,Y)};he(An,K=>{i(be)||K(mr)})}var Xt=W(An,2),Jt=L(Xt),hr=L(Jt);{var gr=K=>{var Y=ki();ye(()=>Y.disabled=i(j)||i(N)),Ie("click",Y,ir),ae(K,Y)};he(hr,K=>{(i(l)||i(Q))&&S()&&K(gr)})}P(Jt);var Dn=W(Jt,2),en=L(Dn),_r=W(en,2);{var pr=K=>{var Y=Ci(),we=L(Y);{var Ae=Qe=>{var _t=Ti();ae(Qe,_t)},Ye=Qe=>{var _t=Ri();ae(Qe,_t)};he(we,Qe=>{i(l)||i(Q)?Qe(Ae):Qe(Ye,!1)})}var Ue=W(we,2);{var kt=Qe=>{var _t=Mi();ae(Qe,_t)};he(Ue,Qe=>{i(y)&&Qe(kt)})}P(Y),ye(()=>Y.disabled=i(j)||i(N)),Ie("click",Y,lr),ae(K,Y)};he(_r,K=>{(i(l)||i(Q)||M())&&K(pr)})}P(Dn),P(Xt);var tn=W(Xt,2),Ut=L(tn),yr=L(Ut,!0);P(Ut);var nn=W(Ut,2);let Sn;var br=L(nn);Ln(br,{size:"xs"}),P(nn),P(tn);var wr=W(tn,2);{var xr=K=>{{let Y=st(()=>i(j)||i(N));Gr(K,{get disabled(){return i(Y)},get reloadEvents(){return x},get eventItem(){return o()},set eventItem(we){o(we)},$$legacy:!0})}};he(wr,K=>{i(be),J(o()),ee(()=>i(be)&&!o()?.is_published)&&K(xr)})}P(Kt);var In=W(Kt,2);{var Er=K=>{Na(K,{get eventTitle(){return J(o()),ee(()=>o().title)},get occurrenceDate(){return i(Z)},callback:Y=>{F(oe,Y),F(re,!1)}})};he(In,K=>{i(re)&&i(Z)&&K(Er)})}var Ar=W(In,2);{var Dr=K=>{qa(K,{get eventTitle(){return J(o()),ee(()=>o().title)},get occurrenceDate(){return i(Z)},callback:Y=>{F(ie,Y),F(ce,!1)}})};he(Ar,K=>{i(ce)&&i(Z)&&K(Dr)})}ye(()=>{en.disabled=i(j)||i(N),et(Ut,1,`fw-lighter fst-italic text-${i(_e),ee(()=>i(_e).type)??""}`,"svelte-1ujj5ue"),xe(yr,(i(_e),ee(()=>i(_e).message))),Sn=et(nn,1,"",null,Sn,{"d-none":!i(j)})}),Ie("click",en,Ze),ae(g,yn),ut(),d()}const On={SRS:[Oe.Stake],SEQ:[Oe.Stake],SYO:[Oe.Stake],SYW:[Oe.Stake],SYM:[Oe.Stake],SPR:[Oe.Stake],SSS:[Oe.Stake],SYA:[Oe.Stake],RES:[Oe.ReliefSociety],ELQ:[Oe.EldersQuorum],YOU:[Oe.YoungWomen,Oe.YoungMen],YOW:[Oe.YoungWomen],YWP:[Oe.YoungWomen],YWR:[Oe.YoungWomen],YWD:[Oe.YoungWomen],YOM:[Oe.YoungMen],YMD:[Oe.YoungMen],YMT:[Oe.YoungMen],YMP:[Oe.YoungMen],PRI:[Oe.Primary],PRN:[Oe.Primary],PRS:[Oe.Primary],PRC:[Oe.Primary],PRV:[Oe.Primary],SUS:[Oe.SundaySchool],YSA:[Oe.Stake]},Ui=g=>{const m=new Set,w=g.meta_data?.submitted_by_organizations;if(w?.length)return w.forEach(e=>m.add(e)),m;const s=g.meta_data?.organization;return s&&On[s]&&On[s].forEach(e=>m.add(e)),m},Is=(g,m)=>{if(!g)return!1;const{currentUserId:w,isPrivileged:s,canEditOwnOrgEvents:e,userOrganizations:n}=m;if(s)return!0;const d=g.meta_data?.submitted_by_user_id;if(w&&typeof d=="number"&&d===w)return!0;if(!e)return!1;const l=Ui(g);if(!l.size)return!1;for(const _ of l)if(n.has(_))return!0;return!1};var Oi=ve('<div style="min-width: 85px !important;"><strong> </strong> <div><small class="d-block"> </small></div></div>'),zi=ve('<span class="d-block text-uppercase small fw-semibold svelte-lx28z">All Day</span>'),Pi=ve('<span class="d-block small svelte-lx28z"> </span>'),Bi=ve('<span class="text-muted"></span>'),Li=ve("<span> </span> <!>",1),Ni=ve('<span class="text-muted"></span>'),Hi=ve('<span class="text-muted small svelte-lx28z"><i class="bi bi-arrow-repeat"></i> </span> <!>',1),qi=ve('<span class="text-muted"></span>'),Wi=ve('<span class="text-muted small svelte-lx28z"><i class="bi bi-arrow-repeat"></i> Recurring event</span> <!>',1),Yi=ve('<span class="text-muted"></span>'),ji=ve('<em class="small fw-lighter svelte-lx28z"><!></em> <!>',1),$i=ve('<em class="small fw-lighter text-decoration-underline svelte-lx28z"><!> details</em>'),Qi=ve('<div class="small svelte-lx28z"><!></div>'),Vi=ve('<div class="attachment-image-container svelte-lx28z"><button type="button" class="attachment-image-button svelte-lx28z"><img class="attachment-image svelte-lx28z"/></button> <div class="attachment-image-label svelte-lx28z"><small class="text-muted"> </small></div></div>'),Ki=ve('<button type="button" class="btn btn-sm btn-primary d-flex align-items-center gap-2"><i class="bi bi-file-pdf"></i> <span class="text-truncate" style="max-width: 150px;"> </span> <small class="text-muted"> </small></button>'),Gi=ve('<div class="mt-1 svelte-lx28z"><div class="fw-semibold small mb-1 svelte-lx28z">Attachments:</div> <div class="d-flex flex-wrap gap-2"></div></div>'),Zi=ve('<div class="small text-muted posted-meta svelte-lx28z">Posted <!> <!></div>'),Xi=ve('<div class="small text-muted posted-meta svelte-lx28z">Last edited <!> <!></div>'),Ji=ve('<div class="details-container svelte-lx28z"><!> <!> <!> <!></div>'),es=ve('<div class="event-thumbnail-container svelte-lx28z"><img class="event-thumbnail svelte-lx28z"/></div>'),ts=ve('<div role="button" tabindex="0"><!> <div class="d-flex gap-1"><div class="d-flex flex-column flex-grow-1 gap-1 svelte-lx28z"><div class="fw-bold svelte-lx28z"><!></div> <!> <div class="flex d-flex align-items-center flex-wrap gap-2"><!> <!> <!> <!></div> <!></div> <!></div></div>');function ks(g,m){dt(m,!1);const w=de(),s=de(),e=de(),n=de(),d=de(),l=de(),_=de(),y=de(),a=de();let t=me(m,"item",8),r=me(m,"showDetails",12,!1),c=me(m,"showDate",8,!0),o=me(m,"searchQuery",8,"");const S=Q=>{if(!Q)return"";const Z=Ot(Q),V=yt(Z,Ge);return He(V,"h:mm aa")},M=Q=>{if(!Q)return"";const Z=Ot(Q),V=yt(Z,Ge);return He(V,"EEE")},x=Q=>{if(!Q)return"";const Z=Ot(Q),V=yt(Z,Ge);return He(V,"MMM, dd")},B=()=>{i(s)&&r(!r())},O=Q=>{i(s)&&(Q.key==="Enter"||Q.key===" ")&&B()},R=Q=>Q<1024?Q+" B":Q<1024*1024?(Q/1024).toFixed(1)+" KB":(Q/(1024*1024)).toFixed(1)+" MB",z=Q=>Q.startsWith("image/"),p=Q=>{window.open(Q,"_blank")},T=Q=>{if(!Q)return"";try{return He(Ot(Q),"MMM d, yyyy 'at' h:mm a")}catch{return""}},f=Q=>{try{const V=ze.fromString(Q).origOptions,re=V.interval||1,oe=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ce=["","1st","2nd","3rd","4th","5th"];if(V.freq===ze.DAILY)return re===1?"Repeats daily":`Repeats every ${re} days`;if(V.freq===ze.WEEKLY){if(V.byweekday){const ne=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday]).map(fe=>{const _e=typeof fe=="number"?fe:fe.weekday,le=_e===6?0:_e+1;return oe[le]});return re===1?ne.length===1?`Repeats every ${ne[0]}`:`Repeats on ${ne.join(", ")}`:`Repeats every ${re} weeks on ${ne.join(", ")}`}return re===1?"Repeats weekly":`Repeats every ${re} weeks`}if(V.freq===ze.MONTHLY){if(V.byweekday){const ne=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday])[0];if(ne&&typeof ne=="object"&&"n"in ne&&"weekday"in ne){const fe=ne.weekday,_e=fe===6?0:fe+1,le=ne.n,pe=ce[le]||`${le}th`;return re===1?`Repeats on the ${pe} ${oe[_e]} of the month`:`Repeats on the ${pe} ${oe[_e]} every ${re} months`}}if(V.bymonthday){const ie=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,ne=ie===1?"st":ie===2?"nd":ie===3?"rd":"th";return re===1?`Repeats on the ${ie}${ne} of the month`:`Repeats on the ${ie}${ne} every ${re} months`}return re===1?"Repeats monthly":`Repeats every ${re} months`}if(V.freq===ze.YEARLY){if(V.bymonth&&V.bymonthday){const ie=["","January","February","March","April","May","June","July","August","September","October","November","December"],ne=Array.isArray(V.bymonth)?V.bymonth[0]:V.bymonth,fe=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,_e=fe===1?"st":fe===2?"nd":fe===3?"rd":"th";return re===1?`Repeats every ${ie[ne]} ${fe}${_e}`:`Repeats every ${re} years on ${ie[ne]} ${fe}${_e}`}return re===1?"Repeats yearly":`Repeats every ${re} years`}return"Repeats"}catch{return"Repeats"}};let v=de("");Be(()=>J(c()),()=>{F(v,c()?"d-flex flex-sm-column flex-md-row flex-lg-row flex-xl-row gap-1":"d-flex flex-column gap-1")}),Be(()=>J(t()),()=>{F(w,t().attachments?.find(Q=>z(Q.type)))}),Be(()=>J(t()),()=>{F(s,!!(t().description||t().attachments&&t().attachments.length>0))}),Be(()=>J(t()),()=>{F(e,t().meta_data?.submitted_at??t().created_at)}),Be(()=>i(e),()=>{F(n,T(i(e)))}),Be(()=>J(t()),()=>{F(d,t().meta_data?.submitted_by_name)}),Be(()=>(i(n),i(d)),()=>{F(l,!!(i(n)||i(d)))}),Be(()=>J(t()),()=>{F(_,T(t().meta_data?.edited_at))}),Be(()=>J(t()),()=>{F(y,t().meta_data?.edited_by_name)}),Be(()=>(i(_),i(y)),()=>{F(a,!!(i(_)||i(y)))}),It(),gt();var b=ts(),D=L(b);{var A=Q=>{var Z=Oi(),V=L(Z),re=L(V,!0);P(V);var oe=W(V,2),ce=L(oe),ie=L(ce,!0);P(ce),P(oe),P(Z),ye((ne,fe)=>{xe(re,ne),xe(ie,fe)},[()=>(J(t()),ee(()=>M(t().start_time))),()=>(J(t()),ee(()=>x(t().start_time)))]),ae(Q,Z)};he(D,Q=>{c()&&Q(A)})}var k=W(D,2),E=L(k),C=L(E),h=L(C);cn(h,()=>(J(zt),J(t()),J(o()),ee(()=>zt(t().title||"",o())))),P(C);var u=W(C,2);{var q=Q=>{var Z=zi();ae(Q,Z)},I=Q=>{var Z=Pi(),V=L(Z);P(Z),ye((re,oe)=>xe(V,`${re??""} to ${oe??""}`),[()=>(J(t()),ee(()=>S(t().start_time))),()=>(J(t()),ee(()=>S(t().end_time)))]),ae(Q,Z)};he(u,Q=>{J(t()),ee(()=>t().is_all_day)?Q(q):Q(I,!1)})}var H=W(u,2),G=L(H);{var $=Q=>{var Z=Li(),V=Ve(Z),re=L(V,!0);P(V);var oe=W(V,2);{var ce=ie=>{var ne=Bi();ae(ie,ne)};he(oe,ie=>{J(t()),ee(()=>t().recurrence_rule||t()?.meta_data?.recurring_instance||t().location||t().description||t().attachments&&t().attachments.length>0)&&ie(ce)})}ye((ie,ne)=>{et(V,1,`badge rounded-pill bg-color-${ie??""}`,"svelte-lx28z"),xe(re,ne)},[()=>(J(Mt),J(t()),ee(()=>Mt(t()?.meta_data?.organization)?.color_number)),()=>(J(Mt),J(t()),ee(()=>Mt(t()?.meta_data?.organization)?.label))]),ae(Q,Z)};he(G,Q=>{J(t()),ee(()=>t()?.meta_data?.organization)&&Q($)})}var j=W(G,2);{var N=Q=>{var Z=Hi(),V=Ve(Z),re=W(L(V));P(V);var oe=W(V,2);{var ce=ie=>{var ne=Ni();ae(ie,ne)};he(oe,ie=>{J(t()),ee(()=>t().location||t().description||t().attachments&&t().attachments.length>0)&&ie(ce)})}ye(ie=>xe(re,` ${ie??""}`),[()=>(J(t()),ee(()=>f(t().recurrence_rule)))]),ae(Q,Z)},U=Q=>{var Z=sn(),V=Ve(Z);{var re=oe=>{var ce=Wi(),ie=W(Ve(ce),2);{var ne=fe=>{var _e=qi();ae(fe,_e)};he(ie,fe=>{J(t()),ee(()=>t().location||t().description||t().attachments&&t().attachments.length>0)&&fe(ne)})}ae(oe,ce)};he(V,oe=>{J(t()),ee(()=>t()?.meta_data?.recurring_instance)&&oe(re)},!0)}ae(Q,Z)};he(j,Q=>{J(t()),ee(()=>t().recurrence_rule)?Q(N):Q(U,!1)})}var X=W(j,2);{var ue=Q=>{var Z=ji(),V=Ve(Z),re=L(V);cn(re,()=>(J(zt),J(t()),J(o()),ee(()=>zt(t().location,o())))),P(V);var oe=W(V,2);{var ce=ie=>{var ne=Yi();ae(ie,ne)};he(oe,ie=>{J(t()),ee(()=>t().description||t().attachments&&t().attachments.length>0)&&ie(ce)})}ae(Q,Z)};he(X,Q=>{J(t()),ee(()=>t().location)&&Q(ue)})}var te=W(X,2);{var se=Q=>{var Z=$i(),V=L(Z);{var re=ce=>{var ie=wt("Hide");ae(ce,ie)},oe=ce=>{var ie=wt("Show");ae(ce,ie)};he(V,ce=>{r()?ce(re):ce(oe,!1)})}Je(),P(Z),ae(Q,Z)};he(te,Q=>{J(t()),ee(()=>t().description||t().attachments&&t().attachments.length>0)&&Q(se)})}P(H);var ge=W(H,2);{var Se=Q=>{var Z=Ji(),V=L(Z);{var re=le=>{var pe=Qi(),ke=L(pe);cn(ke,()=>(J(Tn),J(t()),J(o()),ee(()=>Tn(t().description,o())))),P(pe),ae(le,pe)};he(V,le=>{J(t()),ee(()=>t().description)&&le(re)})}var oe=W(V,2);{var ce=le=>{var pe=Gi(),ke=W(L(pe),2);$t(ke,5,()=>(J(t()),ee(()=>t().attachments)),Le=>Le.id,(Le,be)=>{var je=sn(),Ee=Ve(je);{var Re=Ne=>{var Pe=Vi(),Me=L(Pe),We=L(Me);P(Me);var ft=W(Me,2),nt=L(ft),rt=L(nt,!0);P(nt),P(ft),P(Pe),ye(()=>{Ce(Me,"title",`Open ${i(be),ee(()=>i(be).name)??""}`),Ce(We,"src",(i(be),ee(()=>i(be).url))),Ce(We,"alt",(i(be),ee(()=>i(be).name))),xe(rt,(i(be),ee(()=>i(be).name)))}),Ie("click",Me,Mn(()=>p(i(be).url))),ae(Ne,Pe)},qe=Ne=>{var Pe=Ki(),Me=W(L(Pe),2),We=L(Me,!0);P(Me);var ft=W(Me,2),nt=L(ft);P(ft),P(Pe),ye(rt=>{Ce(Pe,"title",`Open ${i(be),ee(()=>i(be).name)??""}`),xe(We,(i(be),ee(()=>i(be).name))),xe(nt,`(${rt??""})`)},[()=>(i(be),ee(()=>R(i(be).size)))]),Ie("click",Pe,Mn(()=>p(i(be).url))),ae(Ne,Pe)};he(Ee,Ne=>{i(be),ee(()=>z(i(be).type))?Ne(Re):Ne(qe,!1)})}ae(Le,je)}),P(ke),P(pe),ae(le,pe)};he(oe,le=>{J(t()),ee(()=>t().attachments&&t().attachments.length>0)&&le(ce)})}var ie=W(oe,2);{var ne=le=>{var pe=Zi(),ke=W(L(pe));{var Le=Ee=>{var Re=wt();ye(()=>xe(Re,i(n))),ae(Ee,Re)};he(ke,Ee=>{i(n)&&Ee(Le)})}var be=W(ke,2);{var je=Ee=>{var Re=sn(),qe=Ve(Re);{var Ne=Me=>{var We=wt();ye(()=>xe(We,`by ${i(d)??""}`)),ae(Me,We)},Pe=Me=>{var We=wt();ye(()=>xe(We,`by ${i(d)??""}`)),ae(Me,We)};he(qe,Me=>{i(n)?Me(Ne):Me(Pe,!1)})}ae(Ee,Re)};he(be,Ee=>{i(d)&&Ee(je)})}P(pe),ae(le,pe)};he(ie,le=>{i(l)&&le(ne)})}var fe=W(ie,2);{var _e=le=>{var pe=Xi(),ke=W(L(pe));{var Le=Ee=>{var Re=wt();ye(()=>xe(Re,i(_))),ae(Ee,Re)};he(ke,Ee=>{i(_)&&Ee(Le)})}var be=W(ke,2);{var je=Ee=>{var Re=wt();ye(()=>xe(Re,`by ${i(y)??""}`)),ae(Ee,Re)};he(be,Ee=>{i(y)&&Ee(je)})}P(pe),ae(le,pe)};he(fe,le=>{i(a)&&le(_e)})}P(Z),ae(Q,Z)};he(ge,Q=>{r()&&Q(Se)})}P(E);var De=W(E,2);{var Te=Q=>{var Z=es(),V=L(Z);P(Z),ye(()=>{Ce(V,"src",(i(w),ee(()=>i(w).url))),Ce(V,"alt",(i(w),ee(()=>i(w).name)))}),ae(Q,Z)};he(De,Q=>{i(w)&&Q(Te)})}P(k),P(b),ye(()=>{et(b,1,Wr(i(v)),"svelte-lx28z"),Lr(b,i(s)?"cursor: pointer;":"")}),Ie("keydown",b,O),Ie("click",b,B),ae(g,b),ut()}export{Ss as C,ks as E,Is as c};
