const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Dy2Bvcee.js","./SWWSvUpQ.js","./DIeogL5L.js","./D8ekX_8E.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./WW5OsAH7.js","./CU3XCoqN.js","./YJAcq9su.js","./DdQSbrzx.js","./Dyb6OuQt.js","./BTRUZsJg.js","./BUApaBEI.js","./Bgyk9asy.js","./D9YuIQc8.js","../assets/Spinner.DTjfhZ6-.css","./DDvya4sx.js","./mnkQx8ai.js","./CvxMDV_e.js","./Cc3l00Qu.js","./B0jOl1al.js","./kD5nSIae.js","./DCggU3jP.js","./CZYG5XfA.js","./DM-tgP-I.js","../assets/BishopricApprovalSection.DRGo_BHg.css"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{o as Je,w as pa,g as Ne}from"./WW5OsAH7.js";import{h as fa,d as ba,bb as ya,P as ga,p as _e,ah as Y,ai as $e,B as I,a as pe,n as m,m as t,E as z,s,c as r,D,r as a,u as n,f as dt,R as Jt,F as ue,C as Ve}from"./SWWSvUpQ.js";import{B as ha,p as Rt,i as y,s as U,e as gt,b as Te,a as xt,d as Ea,j as wa}from"./CU3XCoqN.js";import{e as ae,i as we}from"./YJAcq9su.js";import{f as p,a as o,c as Bt,t as ie}from"./D8ekX_8E.js";import{s as Ot,e as xa,b as ka,i as Ma,d as Da}from"./DdQSbrzx.js";import{t as xe,c as Ye,i as ut,p as Dt,f as ne,e as ke,O as Me,P as Tt,y as Ca,A as ye,z as Oa}from"./Dyb6OuQt.js";import{s as De}from"./CdEA5IGF.js";import{i as fe}from"./Bgyk9asy.js";import{C as Ge,c as Ze}from"./D7adWxr2.js";import{b as Zt,h as ze,g as Xe,C as ta,c as Ia,f as ge,d as he}from"./Dy2Bvcee.js";import{S as Ce}from"./D9YuIQc8.js";import{v as Oe,D as Ie}from"./DDvya4sx.js";import{_ as He}from"./CmsKOCeN.js";import{R as me}from"./kD5nSIae.js";import{P as $a}from"./BgB8pT2-.js";import{p as Aa}from"./efatLz4-.js";import{c as Sa,e as Fa}from"./B0jOl1al.js";import{i as Ee}from"./Dbnf1ogl.js";import{e as za}from"./DCggU3jP.js";import{a as We}from"./CZYG5XfA.js";function Ta(h,c,e){fa&&ba();var d=new ha(h),x=!ya();ga(()=>{var B=c();x&&B!==null&&typeof B=="object"&&(B={}),d.ensure(B,e)})}function ea(h,c){const e=xe(h);if(isNaN(c))return Ye(h,NaN);if(!c)return e;const d=e.getDate(),x=Ye(h,e.getTime());x.setMonth(e.getMonth()+c+1,0);const B=x.getDate();return d>=B?x:(e.setFullYear(x.getFullYear(),x.getMonth(),d),e)}function Ra(h){const c=xe(h);return c.setDate(1),c.setHours(0,0,0,0),c}function Ke(h,c){const e=xe(h),d=xe(c);return e.getFullYear()===d.getFullYear()&&e.getMonth()===d.getMonth()}function qe(h){return Ee(h,Sa(h))}function Ua(h,c){return ea(h,-1)}var Pa=p('<div class="event-header-image svelte-lu3xbf"><img class="svelte-lu3xbf"/></div>'),Ba=p("<span> </span>"),La=p('<button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i> Edit</button>'),Na=p('<p class="section-content svelte-lu3xbf"><span class="badge bg-secondary">All Day Event</span></p>'),Va=p('<p class="section-content svelte-lu3xbf"> </p>'),Ya=p('<p class="section-content svelte-lu3xbf"><strong> </strong></p> <!>',1),Ha=p('<p class="section-content text-muted svelte-lu3xbf"><i class="bi bi-arrow-repeat"></i> <!></p>'),Wa=p('<p class="section-content text-muted svelte-lu3xbf"><i class="bi bi-arrow-repeat"></i> Part of recurring event series</p>'),Ka=p('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-geo-alt"></i> Location</h6> <p class="section-content svelte-lu3xbf"> </p></div>'),qa=p('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-card-text"></i> Description</h6> <div class="section-content event-description svelte-lu3xbf"><!></div></div>'),ja=p('<div class="attachment-image-container svelte-lu3xbf"><button type="button" class="attachment-image-button svelte-lu3xbf"><img class="attachment-image svelte-lu3xbf"/></button> <div class="attachment-image-label svelte-lu3xbf"><small class="text-muted"> </small></div></div>'),Qa=p('<button type="button" class="btn btn-outline-secondary attachment-file-button svelte-lu3xbf"><i class="bi bi-file-pdf"></i> <span class="text-truncate svelte-lu3xbf"> </span> <small class="text-muted"> </small></button>'),Ja=p('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-paperclip"></i> Attachments</h6> <div class="attachments-grid svelte-lu3xbf"></div></div>'),Ga=p('<p class="metadata-item svelte-lu3xbf"><i class="bi bi-clock-history"></i> Posted <!> <!></p>'),Za=p('<p class="metadata-item svelte-lu3xbf"><i class="bi bi-pencil-square"></i> Last edited <!> <!></p>'),Xa=p('<div class="event-section event-metadata svelte-lu3xbf"><!> <!></div>'),tn=p('<div class="event-details-view svelte-lu3xbf"><div class="event-header svelte-lu3xbf"><div class="event-header-content svelte-lu3xbf"><!> <div class="event-header-text svelte-lu3xbf"><h3 class="event-title svelte-lu3xbf"> </h3> <!></div></div> <!></div> <div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-calendar-event"></i> Date & Time</h6> <!> <!></div> <!> <!> <!> <!></div>');function aa(h,c){_e(c,!1);const e=z(),d=z(),x=z(),B=z(),st=z(),H=z(),Z=z(),ot=z(),nt=z();let f=Rt(c,"event",8),T=Rt(c,"onEdit",8,null),Q=Rt(c,"canEdit",8,!1);const it=i=>i.startsWith("image/"),kt=i=>i<1024?i+" B":i<1024*1024?(i/1024).toFixed(1)+" KB":(i/(1024*1024)).toFixed(1)+" MB",wt=i=>{window.open(i,"_blank")},lt=i=>{if(!i)return"";try{return ut(Dt(i),"MMM d, yyyy 'at' h:mm a")}catch{return""}},Ct=i=>{try{const v=me.fromString(i).origOptions,w=v.interval||1,C=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],G=["","1st","2nd","3rd","4th","5th"];if(v.freq===me.DAILY)return w===1?"Repeats daily":`Repeats every ${w} days`;if(v.freq===me.WEEKLY){if(v.byweekday){const g=(Array.isArray(v.byweekday)?v.byweekday:[v.byweekday]).map(u=>{const b=typeof u=="number"?u:u.weekday,F=b===6?0:b+1;return C[F]});return w===1?g.length===1?`Repeats every ${g[0]}`:`Repeats on ${g.join(", ")}`:`Repeats every ${w} weeks on ${g.join(", ")}`}return w===1?"Repeats weekly":`Repeats every ${w} weeks`}if(v.freq===me.MONTHLY){if(v.byweekday){const g=(Array.isArray(v.byweekday)?v.byweekday:[v.byweekday])[0];if(g&&typeof g=="object"&&"n"in g&&"weekday"in g){const u=g.weekday,b=u===6?0:u+1,F=g.n,q=G[F]||`${F}th`;return w===1?`Repeats on the ${q} ${C[b]} of the month`:`Repeats on the ${q} ${C[b]} every ${w} months`}}if(v.bymonthday){const S=Array.isArray(v.bymonthday)?v.bymonthday[0]:v.bymonthday,g=S===1?"st":S===2?"nd":S===3?"rd":"th";return w===1?`Repeats on the ${S}${g} of the month`:`Repeats on the ${S}${g} every ${w} months`}return w===1?"Repeats monthly":`Repeats every ${w} months`}if(v.freq===me.YEARLY){if(v.bymonth&&v.bymonthday){const S=["","January","February","March","April","May","June","July","August","September","October","November","December"],g=Array.isArray(v.bymonth)?v.bymonth[0]:v.bymonth,u=Array.isArray(v.bymonthday)?v.bymonthday[0]:v.bymonthday,b=u===1?"st":u===2?"nd":u===3?"rd":"th";return w===1?`Repeats every ${S[g]} ${u}${b}`:`Repeats every ${w} years on ${S[g]} ${u}${b}`}return w===1?"Repeats yearly":`Repeats every ${w} years`}return"Repeats"}catch{return"Repeats"}};Y(()=>m(f()),()=>{D(e,Zt(f()?.meta_data?.organization??""))}),Y(()=>m(f()),()=>{D(d,f().meta_data?.submitted_at??f().created_at)}),Y(()=>t(d),()=>{D(x,lt(t(d)))}),Y(()=>m(f()),()=>{D(B,f().meta_data?.submitted_by_name)}),Y(()=>(t(x),t(B)),()=>{D(st,!!(t(x)||t(B)))}),Y(()=>m(f()),()=>{D(H,lt(f().meta_data?.edited_at))}),Y(()=>m(f()),()=>{D(Z,f().meta_data?.edited_by_name)}),Y(()=>(t(H),t(Z)),()=>{D(ot,!!(t(H)||t(Z)))}),Y(()=>m(f()),()=>{D(nt,f().attachments?.find(i=>it(i.type)))}),$e(),fe();var At=tn(),Lt=r(At),mt=r(Lt),Kt=r(mt);{var Nt=i=>{var _=Pa(),v=r(_);a(_),I(()=>{Ot(v,"src",(t(nt),n(()=>t(nt).url))),Ot(v,"alt",(t(nt),n(()=>t(nt).name)))}),o(i,_)};y(Kt,i=>{t(nt)&&i(Nt)})}var Ut=s(Kt,2),It=r(Ut),qt=r(It,!0);a(It);var Vt=s(It,2);{var Pt=i=>{var _=Ba(),v=r(_,!0);a(_),I(()=>{ne(_,1,`badge rounded-pill bg-color-${t(e),n(()=>t(e).color_number)??""}`,"svelte-lu3xbf"),U(v,(t(e),n(()=>t(e).label)))}),o(i,_)};y(Vt,i=>{t(e),n(()=>t(e)?.label)&&i(Pt)})}a(Ut),a(mt);var Yt=s(mt,2);{var Ht=i=>{var _=La();gt("click",_,function(...v){T()?.apply(this,v)}),o(i,_)};y(Yt,i=>{Q()&&T()&&i(Ht)})}a(Lt);var Mt=s(Lt,2),St=s(r(Mt),2);{var N=i=>{var _=Ya(),v=dt(_),w=r(v),C=r(w,!0);a(w),a(v);var G=s(v,2);{var S=u=>{var b=Na();o(u,b)},g=u=>{var b=Bt(),F=dt(b);{var q=V=>{var l=Va(),k=r(l);a(l),I((O,tt)=>U(k,`${O??""} - ${tt??""}`),[()=>(m(ut),m(Dt),m(f()),n(()=>ut(Dt(f().start_time),"h:mm a"))),()=>(m(ut),m(Dt),m(f()),n(()=>ut(Dt(f().end_time),"h:mm a")))]),o(V,l)};y(F,V=>{m(f()),n(()=>f().start_time&&f().end_time)&&V(q)},!0)}o(u,b)};y(G,u=>{m(f()),n(()=>f().is_all_day)?u(S):u(g,!1)})}I(u=>U(C,u),[()=>(m(ut),m(Dt),m(f()),n(()=>ut(Dt(f().start_time),"EEEE, MMMM d, yyyy")))]),o(i,_)};y(St,i=>{m(f()),n(()=>f().start_time)&&i(N)})}var J=s(St,2);{var ht=i=>{var _=Ha(),v=s(r(_)),w=s(v);{var C=G=>{var S=ie();I(g=>U(S,`until ${g??""}`),[()=>(m(ut),m(Dt),m(f()),n(()=>ut(Dt(f().recurrence_end_date),"MMM d, yyyy")))]),o(G,S)};y(w,G=>{m(f()),n(()=>f().recurrence_end_date)&&G(C)})}a(_),I(G=>U(v,` ${G??""} `),[()=>(m(f()),n(()=>Ct(f().recurrence_rule)))]),o(i,_)},ft=i=>{var _=Bt(),v=dt(_);{var w=C=>{var G=Wa();o(C,G)};y(v,C=>{m(f()),n(()=>f()?.meta_data?.recurring_instance)&&C(w)},!0)}o(i,_)};y(J,i=>{m(f()),n(()=>f().recurrence_rule)?i(ht):i(ft,!1)})}a(Mt);var Ft=s(Mt,2);{var M=i=>{var _=Ka(),v=s(r(_),2),w=r(v,!0);a(v),a(_),I(()=>U(w,(m(f()),n(()=>f().location)))),o(i,_)};y(Ft,i=>{m(f()),n(()=>f().location)&&i(M)})}var E=s(Ft,2);{var L=i=>{var _=qa(),v=s(r(_),2),w=r(v);ze(w,()=>(m(f()),n(()=>f().description))),a(v),a(_),o(i,_)};y(E,i=>{m(f()),n(()=>f().description)&&i(L)})}var P=s(E,2);{var X=i=>{var _=Ja(),v=s(r(_),2);ae(v,5,()=>(m(f()),n(()=>f().attachments)),w=>w.id,(w,C)=>{var G=Bt(),S=dt(G);{var g=b=>{var F=ja(),q=r(F),V=r(q);a(q);var l=s(q,2),k=r(l),O=r(k,!0);a(k),a(l),a(F),I(()=>{Ot(q,"title",`Open ${t(C),n(()=>t(C).name)??""}`),Ot(V,"src",(t(C),n(()=>t(C).url))),Ot(V,"alt",(t(C),n(()=>t(C).name))),U(O,(t(C),n(()=>t(C).name)))}),gt("click",q,()=>wt(t(C).url)),o(b,F)},u=b=>{var F=Qa(),q=s(r(F),2),V=r(q,!0);a(q);var l=s(q,2),k=r(l);a(l),a(F),I(O=>{Ot(F,"title",`Open ${t(C),n(()=>t(C).name)??""}`),U(V,(t(C),n(()=>t(C).name))),U(k,`(${O??""})`)},[()=>(t(C),n(()=>kt(t(C).size)))]),gt("click",F,()=>wt(t(C).url)),o(b,F)};y(S,b=>{t(C),n(()=>it(t(C).type))?b(g):b(u,!1)})}o(w,G)}),a(v),a(_),o(i,_)};y(P,i=>{m(f()),n(()=>f().attachments&&f().attachments.length>0)&&i(X)})}var A=s(P,2);{var R=i=>{var _=Xa(),v=r(_);{var w=S=>{var g=Ga(),u=s(r(g),2);{var b=V=>{var l=ie();I(()=>U(l,t(x))),o(V,l)};y(u,V=>{t(x)&&V(b)})}var F=s(u,2);{var q=V=>{var l=ie();I(()=>U(l,`by ${t(B)??""}`)),o(V,l)};y(F,V=>{t(B)&&V(q)})}a(g),o(S,g)};y(v,S=>{t(st)&&S(w)})}var C=s(v,2);{var G=S=>{var g=Za(),u=s(r(g),2);{var b=V=>{var l=ie();I(()=>U(l,t(H))),o(V,l)};y(u,V=>{t(H)&&V(b)})}var F=s(u,2);{var q=V=>{var l=ie();I(()=>U(l,`by ${t(Z)??""}`)),o(V,l)};y(F,V=>{t(Z)&&V(q)})}a(g),o(S,g)};y(C,S=>{t(ot)&&S(G)})}a(_),o(i,_)};y(A,i=>{(t(st)||t(ot))&&i(R)})}a(At),I(()=>U(qt,(m(f()),n(()=>f().title)))),o(h,At),pe()}var en=p('<button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add announcement"><i class="bi bi-plus"></i> <span class="d-none d-md-inline ms-1">Add Announcement</span></button>'),an=p("<span> </span>"),nn=p('<span class="announcement-location svelte-1yokbat"><i class="bi bi-geo-alt"></i> </span>'),rn=p('<div class="announcement-thumbnail-container svelte-1yokbat"><img class="announcement-thumbnail svelte-1yokbat"/></div>'),sn=p('<div class="announcement-actions svelte-1yokbat"><button type="button" class="btn btn-sm btn-primary" title="Edit announcement"><i class="bi bi-pencil"></i></button></div>'),on=p('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="announcement-details-button svelte-1yokbat"><div class="announcement-title svelte-1yokbat"> </div> <div class="announcement-meta svelte-1yokbat"><!> <!></div></button> <!> <!></li>'),ln=p('<div class="announcements-footer svelte-1yokbat"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),vn=p('<div class="announcements-list-container svelte-1yokbat"><ul class="list-group list-group-flush"></ul></div> <!>',1),cn=p('<div class="no-announcements svelte-1yokbat"><!></div>'),dn=p('<div class="announcements-container svelte-1yokbat"><div class="announcements-header svelte-1yokbat"><h2 class="announcements-title svelte-1yokbat">Announcements</h2> <div class="announcements-actions svelte-1yokbat"><!></div></div> <!></div>'),un=p('<div class="d-flex flex-column gap-4"><!></div>'),mn=p("<!> <!> <!>",1);function Lr(h,c){_e(c,!1);const e=()=>xt(Kt,"$searchQuery",nt),d=()=>xt(mt,"$announcements",nt),x=()=>xt(kt,"$currentUser",nt),B=()=>xt(At,"$userOrganizations",nt),st=()=>xt(wt,"$currentUserHasPermission",nt),H=()=>xt(Ct,"$currentUserIsRoot",nt),Z=()=>xt(lt,"$currentUserIsAdmin",nt),ot=()=>xt(Lt,"$ready",nt),[nt,f]=Te(),T=z(),Q=z(),it=z(),{stores:{currentUser:kt,currentUserHasPermission:wt,currentUserIsAdmin:lt,currentUserIsRoot:Ct,userOrganizations:At}}=ke(),{stores:{ready:Lt,announcements:mt,searchQuery:Kt},actions:{reload:Nt}}=Xe(),Ut={title:"Announcement",description:"",location:"",event_type:"announcement",is_public:!0},It=Oe(),qt=Oe();let Vt=z(!1),Pt=z(!1),Yt=z(),Ht=z(!1),Mt=z(!1),St=z(!1),N=z(new Set),J=z(""),ht=z({...Ut}),ft=z({...Ut});const Ft=5,M=5;let E=z(Ft);function L(){D(E,t(E)+M)}const P=u=>Ze(u,{currentUserId:t(Yt),isPrivileged:t(Pt),canEditOwnOrgEvents:t(St),userOrganizations:t(N)}),X=u=>u.startsWith("image/");Je(async()=>{await Nt()});const A=u=>{D(J,"Announcement Form"),D(ht,{...u,organization:u?.meta_data?.organization??""})},R=u=>{D(ft,u);const b=document.getElementById(qt);b&&new window.bootstrap.Offcanvas(b).show()},i=u=>{A(u);const b=document.getElementById(It);b&&new window.bootstrap.Offcanvas(b).show()},_=()=>{const u=document.getElementById(qt);if(u){const b=window.bootstrap.Offcanvas.getInstance(u);b&&b.hide()}A(t(ft)),setTimeout(()=>{const b=document.getElementById(It);b&&new window.bootstrap.Offcanvas(b).show()},300)};Y(()=>(e(),d(),t(E)),()=>{D(T,e()?d()??[]:(d()??[]).slice(0,t(E)))}),Y(()=>(e(),d(),t(E)),()=>{D(Q,!e()&&(d()?.length??0)>t(E))}),Y(()=>x(),()=>{D(Yt,x()?.id)}),Y(()=>t(Yt),()=>{D(Mt,!!t(Yt))}),Y(()=>B(),()=>{D(N,B())}),Y(()=>(t(N),Me),()=>{D(Ht,t(N).has(Me.Bishopric))}),Y(()=>(st(),Tt),()=>{D(St,st()(Tt.EditOwnOrgEvents))}),Y(()=>(H(),Z(),t(Ht),st(),Tt),()=>{D(Pt,H()||Z()||t(Ht)||st()(Tt.EditAllEvents))}),Y(()=>(t(Pt),st(),t(St),t(Mt)),()=>{D(Vt,t(Pt)||st()(Tt.CreateEvents)||t(St)||t(Mt))}),Y(()=>(st(),Tt),()=>{D(it,st()(Tt.DeleteEvents))}),$e(),fe();var v=mn(),w=dt(v);Ie(w,{get title(){return t(J)},get id(){return It},children:(u,b)=>{Ge(u,{get eventItem(){return t(ht)},get drawerId(){return It},name:"announcement-item-form",get canDelete(){return t(it)}})},$$slots:{default:!0}});var C=s(w,2);Ie(C,{title:"Announcement Details",get id(){return qt},children:(u,b)=>{{let F=Jt(()=>(t(ft),n(()=>P(t(ft)))));aa(u,{get event(){return t(ft)},get canEdit(){return t(F)},onEdit:_})}},$$slots:{default:!0}});var G=s(C,2);{var S=u=>{var b=dn(),F=r(b),q=s(r(F),2),V=r(q);{var l=et=>{var yt=en();I(()=>{Ot(yt,"data-bs-target",`#${It??""}`),Ot(yt,"aria-controls",It)}),gt("click",yt,()=>A({...Ut,event_type:"announcement"})),o(et,yt)};y(V,et=>{t(Vt)&&et(l)})}a(q),a(F);var k=s(F,2);{var O=et=>{var yt=vn(),Gt=dt(yt),Xt=r(Gt);ae(Xt,5,()=>t(T),K=>K.id,(K,j)=>{const _t=Jt(()=>(t(j),n(()=>t(j).attachments?.find(bt=>X(bt.type))))),at=Jt(()=>(m(Zt),t(j),n(()=>Zt(t(j)?.meta_data?.organization??""))));var pt=on(),jt=r(pt),zt=s(jt,2),Wt=r(zt),re=r(Wt,!0);a(Wt);var se=s(Wt,2),$t=r(se);{var le=bt=>{var Et=an(),ee=r(Et,!0);a(Et),I(()=>{ne(Et,1,`badge rounded-pill bg-color-${m(t(at)),n(()=>t(at).color_number)??""}`,"svelte-1yokbat"),U(ee,(m(t(at)),n(()=>t(at).label)))}),o(bt,Et)};y($t,bt=>{m(t(at)),n(()=>t(at)?.label)&&bt(le)})}var ve=s($t,2);{var vt=bt=>{var Et=nn(),ee=s(r(Et));a(Et),I(()=>U(ee,` ${t(j),n(()=>t(j).location)??""}`)),o(bt,Et)};y(ve,bt=>{t(j),n(()=>t(j).location)&&bt(vt)})}a(se),a(zt);var ce=s(zt,2);{var te=bt=>{var Et=rn(),ee=r(Et);a(Et),I(()=>{Ot(ee,"src",(m(t(_t)),n(()=>t(_t).url))),Ot(ee,"alt",(m(t(_t)),n(()=>t(_t).name)))}),o(bt,Et)};y(ce,bt=>{t(_t)&&bt(te)})}var de=s(ce,2);{var be=bt=>{var Et=sn(),ee=r(Et);a(Et),gt("click",ee,De(()=>i(t(j)))),o(bt,Et)};y(de,bt=>{t(j),n(()=>P(t(j)))&&bt(be)})}a(pt),I(()=>{ne(jt,1,`announcement-color-indicator bg-color-${m(t(at)),n(()=>t(at)?.color_number??0)??""}`,"svelte-1yokbat"),U(re,(t(j),n(()=>t(j).title)))}),gt("click",zt,()=>R(t(j))),o(K,pt)}),a(Xt),a(Gt);var W=s(Gt,2);{var $=K=>{var j=ln(),_t=r(j),at=r(_t);a(_t);var pt=s(_t,2);a(j),I(()=>U(at,`Showing ${t(E)??""} of ${d(),n(()=>d()?.length??0)??""}`)),gt("click",pt,L),o(K,j)};y(W,K=>{t(Q)&&K($)})}o(et,yt)},tt=et=>{var yt=Bt(),Gt=dt(yt);{var Xt=W=>{var $=cn(),K=r($);{var j=at=>{var pt=ie("No announcements match your search.");o(at,pt)},_t=at=>{var pt=ie("There are no announcements yet.");o(at,pt)};y(K,at=>{e()?at(j):at(_t,!1)})}a($),o(W,$)};y(Gt,W=>{d(),n(()=>d()?.length===0)&&W(Xt)},!0)}o(et,yt)};y(k,et=>{t(T),n(()=>t(T).length)?et(O):et(tt,!1)})}a(b),o(u,b)},g=u=>{var b=un(),F=r(b);Ce(F,{}),a(b),o(u,b)};y(G,u=>{ot()?u(S):u(g,!1)})}o(h,v),pe(),f()}const na={};for(const h of Object.values(ta))h.key&&(na[h.label.toLowerCase()]=h.key);const _n=new Set(Object.values(ta).map(h=>h.key).filter(Boolean));function pn(h){const c=h.trim();if(c)return _n.has(c.toUpperCase())?c.toUpperCase():na[c.toLowerCase()]}async function fn(h){return new Promise((c,e)=>{$a.parse(h,{header:!0,skipEmptyLines:!0,complete:d=>{const x=d.data,B=d.meta.fields||[];c({data:x,columns:B})},error:d=>e(d)})})}function bn(h){return h.map(c=>{const e=c.toLowerCase().trim();return e==="title"||e==="event"||e==="event name"||e==="name"?{csvColumn:c,eventField:"title"}:e==="description"||e==="details"||e==="notes"?{csvColumn:c,eventField:"description"}:e==="start date"||e==="start_date"||e==="date"||e==="event date"?{csvColumn:c,eventField:"start_date"}:e==="start time"||e==="start_time"||e==="time"||e==="event time"?{csvColumn:c,eventField:"start_time"}:e==="end date"||e==="end_date"?{csvColumn:c,eventField:"end_date"}:e==="end time"||e==="end_time"?{csvColumn:c,eventField:"end_time"}:e==="location"||e==="place"||e==="venue"?{csvColumn:c,eventField:"location"}:e==="organization"||e==="group"||e==="organization"||e==="org"?{csvColumn:c,eventField:"organization"}:e==="all day"||e==="all_day"||e==="is_all_day"||e==="allday"?{csvColumn:c,eventField:"is_all_day"}:{csvColumn:c,eventField:null}})}function oe(h,c,e){const d=c.find(x=>x.eventField===e);return d?(h[d.csvColumn]||"").trim():""}function je(h){const c=["yyyy-MM-dd","MM/dd/yyyy","M/d/yyyy","MM-dd-yyyy","M-d-yyyy","MM/dd/yy","M/d/yy","yyyy/MM/dd","MMM d, yyyy","MMMM d, yyyy","MMM d yyyy","d MMM yyyy"];for(const e of c){const d=Aa(h,e,new Date);if(Ca(d))return d}return null}function Qe(h){const c=h.match(/^(\d{1,2}):(\d{2})$/);if(c){const d=parseInt(c[1],10),x=parseInt(c[2],10);if(d>=0&&d<=23&&x>=0&&x<=59)return{hours:d,minutes:x}}const e=h.match(/^(\d{1,2})(?::(\d{2}))?\s*(am|pm)$/i);if(e){let d=parseInt(e[1],10);const x=e[2]?parseInt(e[2],10):0,B=e[3].toLowerCase();if(d>=1&&d<=12&&x>=0&&x<=59)return B==="pm"&&d!==12&&(d+=12),B==="am"&&d===12&&(d=0),{hours:d,minutes:x}}return null}function yn(h){const c=h.toLowerCase().trim();return["true","yes","1","y","x"].includes(c)}function gn(h,c,e){const d=[],x=oe(h,c,"title"),B=oe(h,c,"description"),st=oe(h,c,"start_date"),H=oe(h,c,"start_time"),Z=oe(h,c,"end_date"),ot=oe(h,c,"end_time"),nt=oe(h,c,"location"),f=oe(h,c,"organization"),T=oe(h,c,"is_all_day");if(!x)return d.push({row:e,field:"title",message:"Title is required"}),{event:null,errors:d};if(x.length<3)return d.push({row:e,field:"title",message:"Title must be at least 3 characters"}),{event:null,errors:d};if(x.length>255)return d.push({row:e,field:"title",message:"Title cannot exceed 255 characters"}),{event:null,errors:d};if(!st)return d.push({row:e,field:"start_date",message:"Start date is required"}),{event:null,errors:d};const Q=je(st);if(!Q)return d.push({row:e,field:"start_date",message:`Invalid date format: "${st}"`}),{event:null,errors:d};const it=T?yn(T):!H;let kt;if(!it&&H){const mt=Qe(H);if(!mt)return d.push({row:e,field:"start_time",message:`Invalid time format: "${H}"`}),{event:null,errors:d};Q.setHours(mt.hours,mt.minutes,0,0),kt=ge(Q,ye)}else Q.setHours(0,0,0,0),kt=ge(Q,ye);let wt;const lt=Z?je(Z):new Date(Q);if(lt&&!it&&ot){const mt=Qe(ot);if(!mt)return d.push({row:e,field:"end_time",message:`Invalid time format: "${ot}"`}),{event:null,errors:d};lt.setHours(mt.hours,mt.minutes,0,0),wt=ge(lt,ye)}else if(!it&&H)wt=new Date(kt.getTime()+60*60*1e3);else{const mt=lt||new Date(Q);mt.setHours(23,59,59,0),wt=ge(mt,ye)}let Ct;if(f&&(Ct=pn(f),!Ct))return d.push({row:e,field:"organization",message:`Unknown organization: "${f}"`}),{event:null,errors:d};if(nt&&nt.length>255)return d.push({row:e,field:"location",message:"Location cannot exceed 255 characters"}),{event:null,errors:d};const At={};return Ct&&(At.organization=Ct),{event:{title:x,event_type:"calendar_event",start_time:kt.toISOString(),end_time:wt.toISOString(),is_all_day:it,is_public:!0,is_published:!1,meta_data:At,...B?{description:B}:{},...nt?{location:nt}:{}},errors:[]}}async function hn(h,c){const e={success:0,validationErrors:0,errors:[]},d=[];for(let H=0;H<h.length;H++){const{event:Z,errors:ot}=gn(h[H],c,H+1);if(ot.length>0){e.validationErrors++,e.errors.push(...ot);continue}Z&&d.push(Z)}const x=ke(),B=x?Ne(x.stores.currentUser):void 0,st=x?Ne(x.stores.userOrganizations):void 0;if(B){const H=B.displayName||B.username,Z=B.id,ot=st?Array.from(st):[],nt=new Date().toISOString();for(const f of d){const T=f.meta_data||{};H&&(T.submitted_by_name=H),Z&&(T.submitted_by_user_id=Z),ot.length&&(T.submitted_by_organizations=ot),T.submitted_at=nt,f.meta_data=T}}return d.length>0&&(await Ia(d),e.success=d.length),e}function En(){const h=pa({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null});return{state:h,parseCsvFile:fn,autoDetectMappings:bn,importEvents:hn,reset:()=>h.set({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null})}}var wn=p(`<p class="text-muted small mb-3">Upload a CSV file to bulk-import calendar events. Need a starting point? <a href="/sample-events.csv" download="">Download sample CSV template</a>.</p> <div class="mb-3"><label for="csvFile" class="form-label">Select CSV File</label> <input type="file" class="form-control" id="csvFile" accept=".csv"/></div> <div class="alert alert-warning small mb-3 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All imported events require <strong>bishopric approval</strong> before they appear on the
							public calendar.</span></div> <div class="alert alert-info small mb-0"><strong>Format Guide:</strong> <ul class="mb-0 mt-1"><li><strong>Required columns:</strong> Title, Date</li> <li><strong>Optional columns:</strong> Start Time, End Time, Location, Category, Description</li> <li>Dates: YYYY-MM-DD, MM/DD/YYYY, Jan 1, 2025, etc.</li> <li>Times: 7:00 PM, 19:00, etc. (omit for all-day events)</li> <li>Categories: Ward, Relief Society, Elders Quorum, Youth, Young Women, Young Men,
								Primary, etc.</li></ul></div>`,1),xn=p('<tr><td> </td><td><select class="form-select form-select-sm"><option>-- Skip --</option><option>Title</option><option>Description</option><option>Start Date</option><option>Start Time</option><option>End Date</option><option>End Time</option><option>Location</option><option>Category</option><option>All Day</option></select></td></tr>'),kn=p('<h6>Map CSV Columns to Event Fields</h6> <p class="text-muted"> </p> <table class="table table-sm"><thead><tr><th>CSV Column</th><th>Maps To</th></tr></thead><tbody></tbody></table>',1),Mn=p('<div class="text-center py-5"><!> <p class="mt-3">Importing events...</p></div>'),Dn=p("<li><strong> </strong> rows had validation errors</li>"),Cn=p(`<div class="alert alert-info small">Imported events are <strong>unpublished</strong> and will need bishopric approval before
							they appear on the public calendar.</div>`),On=p("<li> </li>"),In=p("<li><em> </em></li>"),$n=p('<div class="alert alert-warning"><h6>Validation Errors:</h6> <ul class="mb-0" style="max-height: 200px; overflow-y: auto;"><!> <!></ul></div>'),An=p('<div class="alert alert-success"><h6>Import Complete</h6> <ul class="mb-0"><li><strong> </strong> events imported successfully</li> <!></ul></div> <!> <!>',1),Sn=p('<button type="button" class="btn btn-secondary">Cancel</button>'),Fn=p('<button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary"> </button>',1),zn=p('<button type="button" class="btn btn-secondary" disabled>Cancel</button> <button type="button" class="btn btn-primary" disabled><!> Importing...</button>',1),Tn=p('<button type="button" class="btn btn-primary">Done</button>'),Rn=p('<div class="modal-backdrop fade show"></div>'),Un=p('<div tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Import Events from CSV</h5> <button type="button" class="btn-close" aria-label="Close import modal"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><!></div></div></div></div> <!>',1);function Pn(h,c){_e(c,!1);const e=()=>xt(Z,"$state",d),[d,x]=Te();let B=Rt(c,"isOpen",8,!1),st=Rt(c,"onClose",8),H=Rt(c,"onComplete",8);const{state:Z,parseCsvFile:ot,autoDetectMappings:nt,importEvents:f,reset:T}=En();async function Q(N){const J=N.target.files?.[0];if(J)try{const{data:ht,columns:ft}=await ot(J),Ft=nt(ft);Z.update(M=>({...M,step:"mapping",csvData:ht,csvColumns:ft,columnMappings:Ft}))}catch(ht){console.error("Failed to parse CSV:",ht),alert("Failed to parse CSV file. Please check the file format.")}}async function it(){Z.update(N=>({...N,step:"importing"}));try{const N=await f(e().csvData,e().columnMappings);Z.update(J=>({...J,step:"complete",importResult:N})),H()()}catch(N){console.error("Failed to import events:",N),alert("Failed to import events. Please try again."),Z.update(J=>({...J,step:"mapping"}))}}function kt(){T(),st()()}fe();var wt=Un(),lt=dt(wt);let Ct;var At=r(lt),Lt=r(At),mt=r(Lt),Kt=s(r(mt),2);Kt.__click=kt,a(mt);var Nt=s(mt,2),Ut=r(Nt);{var It=N=>{var J=wn(),ht=s(dt(J),2),ft=s(r(ht),2);ft.__change=Q,a(ht),ue(4),o(N,J)},qt=N=>{var J=Bt(),ht=dt(J);{var ft=M=>{var E=kn(),L=s(dt(E),2),P=r(L);a(L);var X=s(L,2),A=s(r(X));ae(A,5,()=>(e(),n(()=>e().columnMappings)),we,(R,i,_)=>{var v=xn(),w=r(v),C=r(w,!0);a(w);var G=s(w),S=r(G);I(()=>{t(i),Ve(()=>{})});var g=r(S);g.value=(g.__value=null)??"";var u=s(g);u.value=u.__value="title";var b=s(u);b.value=b.__value="description";var F=s(b);F.value=F.__value="start_date";var q=s(F);q.value=q.__value="start_time";var V=s(q);V.value=V.__value="end_date";var l=s(V);l.value=l.__value="end_time";var k=s(l);k.value=k.__value="location";var O=s(k);O.value=O.__value="category";var tt=s(O);tt.value=tt.__value="is_all_day",a(S),a(G),a(v),I(()=>U(C,(t(i),n(()=>t(i).csvColumn)))),ka(S,()=>t(i).eventField,et=>(t(i).eventField=et,Ve(()=>e()),wa(d,"$state"))),o(R,v)}),a(A),a(X),I(()=>U(P,`Found ${e(),n(()=>e().csvData.length)??""} rows in CSV`)),o(M,E)},Ft=M=>{var E=Bt(),L=dt(E);{var P=A=>{var R=Mn(),i=r(R);Ce(i,{}),ue(2),a(R),o(A,R)},X=A=>{var R=Bt(),i=dt(R);{var _=v=>{var w=An(),C=dt(w),G=s(r(C),2),S=r(G),g=r(S),u=r(g,!0);a(g),ue(),a(S);var b=s(S,2);{var F=O=>{var tt=Dn(),et=r(tt),yt=r(et,!0);a(et),ue(),a(tt),I(()=>U(yt,(e(),n(()=>e().importResult.validationErrors)))),o(O,tt)};y(b,O=>{e(),n(()=>e().importResult?.validationErrors&&e().importResult.validationErrors>0)&&O(F)})}a(G),a(C);var q=s(C,2);{var V=O=>{var tt=Cn();o(O,tt)};y(q,O=>{e(),n(()=>e().importResult?.success&&e().importResult.success>0)&&O(V)})}var l=s(q,2);{var k=O=>{var tt=$n(),et=s(r(tt),2),yt=r(et);ae(yt,1,()=>(e(),n(()=>e().importResult.errors.slice(0,10))),we,(W,$)=>{var K=On(),j=r(K);a(K),I(()=>U(j,`Row ${t($),n(()=>t($).row)??""}: ${t($),n(()=>t($).message)??""}`)),o(W,K)});var Gt=s(yt,2);{var Xt=W=>{var $=In(),K=r($),j=r(K);a(K),a($),I(()=>U(j,`... and ${e(),n(()=>e().importResult.errors.length-10)??""} more errors`)),o(W,$)};y(Gt,W=>{e(),n(()=>e().importResult.errors.length>10)&&W(Xt)})}a(et),a(tt),o(O,tt)};y(l,O=>{e(),n(()=>e().importResult?.errors&&e().importResult.errors.length>0)&&O(k)})}I(()=>U(u,(e(),n(()=>e().importResult?.success||0)))),o(v,w)};y(i,v=>{e(),n(()=>e().step==="complete")&&v(_)},!0)}o(A,R)};y(L,A=>{e(),n(()=>e().step==="importing")?A(P):A(X,!1)},!0)}o(M,E)};y(ht,M=>{e(),n(()=>e().step==="mapping")?M(ft):M(Ft,!1)},!0)}o(N,J)};y(Ut,N=>{e(),n(()=>e().step==="upload")?N(It):N(qt,!1)})}a(Nt);var Vt=s(Nt,2),Pt=r(Vt);{var Yt=N=>{var J=Sn();J.__click=kt,o(N,J)},Ht=N=>{var J=Bt(),ht=dt(J);{var ft=M=>{var E=Fn(),L=dt(E);L.__click=kt;var P=s(L,2);P.__click=it;var X=r(P);a(P),I(()=>U(X,`Import ${e(),n(()=>e().csvData.length)??""} Events`)),o(M,E)},Ft=M=>{var E=Bt(),L=dt(E);{var P=A=>{var R=zn(),i=s(dt(R),2),_=r(i);Ce(_,{size:"sm"}),ue(),a(i),o(A,R)},X=A=>{var R=Bt(),i=dt(R);{var _=v=>{var w=Tn();w.__click=kt,o(v,w)};y(i,v=>{e(),n(()=>e().step==="complete")&&v(_)},!0)}o(A,R)};y(L,A=>{e(),n(()=>e().step==="importing")?A(P):A(X,!1)},!0)}o(M,E)};y(ht,M=>{e(),n(()=>e().step==="mapping")?M(ft):M(Ft,!1)},!0)}o(N,J)};y(Pt,N=>{e(),n(()=>e().step==="upload")?N(Yt):N(Ht,!1)})}a(Vt),a(Lt),a(At),a(lt);var Mt=s(lt,2);{var St=N=>{var J=Rn();o(N,J)};y(Mt,N=>{B()&&N(St)})}I(()=>{Ct=ne(lt,1,"modal fade",null,Ct,{show:B()}),xa(lt,`display: ${B()?"block":"none"}`)}),o(h,wt),pe(),x()}Ea(["click","change"]);var Bn=p("<option> </option>"),Ln=p('<select class="form-select form-select-sm organization-filter svelte-14mpkul" aria-label="Filter calendar by organization"><option>All Organizations</option><!></select>'),Nn=p('<div class="calendar-day-header svelte-14mpkul"><span class="d-none d-md-inline"> </span> <span class="d-md-none"> </span></div>'),Vn=p('<button type="button"><span class="event-title svelte-14mpkul"> </span></button>'),Yn=p('<div class="more-events svelte-14mpkul"> </div>'),Hn=p('<div role="button" tabindex="0"><div class="day-number svelte-14mpkul"> </div> <div class="day-events svelte-14mpkul"><!> <!></div></div>'),Wn=p("<span> </span>"),Kn=p('<span class="badge bg-secondary">All Day</span>'),qn=p('<span class="event-time svelte-14mpkul"> </span>'),jn=p('<span class="event-location svelte-14mpkul"><i class="bi bi-geo-alt"></i> </span>'),Qn=p('<div class="event-thumbnail-container svelte-14mpkul"><img class="event-thumbnail svelte-14mpkul"/></div>'),Jn=p('<div class="event-actions svelte-14mpkul"><button type="button" class="btn btn-sm btn-primary" title="Edit event"><i class="bi bi-pencil"></i></button></div>'),Gn=p('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="event-details-button svelte-14mpkul"><div class="event-title-full svelte-14mpkul"> </div> <div class="event-meta svelte-14mpkul"><!> <!> <!></div></button> <!> <!></li>'),Zn=p('<div class="card mt-3"><div class="card-header d-flex justify-content-between align-items-center"><h6 class="mb-0 fw-semibold"> </h6> <button type="button" class="btn btn-sm btn-primary" aria-label="Close"><i class="bi bi-x-lg"></i></button></div> <ul class="list-group list-group-flush"></ul></div>'),Xn=p('<div class="month-calendar svelte-14mpkul"><div class="calendar-header svelte-14mpkul"><h5 class="month-title svelte-14mpkul"> </h5> <div class="calendar-controls svelte-14mpkul"><div class="calendar-nav svelte-14mpkul"><button type="button" class="btn btn-sm btn-primary" aria-label="Previous month"><i class="bi bi-chevron-left"></i></button> <button type="button" class="btn btn-sm btn-primary" aria-label="Go to today">Today</button> <button type="button" class="btn btn-sm btn-primary" aria-label="Next month"><i class="bi bi-chevron-right"></i></button></div> <!></div></div> <div class="calendar-grid svelte-14mpkul"><!> <!></div> <!></div>');function tr(h,c){_e(c,!1);const e=z(),d=z(),x=z();let B=Rt(c,"events",24,()=>[]),st=Rt(c,"onEventClick",8,()=>{}),H=Rt(c,"onEventEdit",8,null),Z=Rt(c,"canEditEvent",8,null),ot=Rt(c,"organizationFilter",8,""),nt=Rt(c,"onOrganizationFilterChange",8,()=>{}),f=Rt(c,"availableOrganizations",24,()=>[]),T=z(new Date),Q=z(null);const it=M=>{t(Q)&&Ee(t(Q),M)?D(Q,null):D(Q,M)},kt=()=>{D(T,new Date)},wt=()=>{D(T,Ua(t(T)))},lt=()=>{D(T,ea(t(T),1))},Ct=M=>{const E=ut(M,"yyyy-MM-dd");return t(x)[E]||[]},At=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Lt=["S","M","T","W","T","F","S"],mt=M=>M.startsWith("image/");Y(()=>m(B()),()=>{console.log("[MonthCalendarView] events count:",B().length)}),Y(()=>m(ot()),()=>{console.log("[MonthCalendarView] organizationFilter:",ot())}),Y(()=>t(Q),()=>{D(e,t(Q)?Ct(t(Q)):[])}),Y(()=>(t(T),We),()=>{D(d,(()=>{const M=Ra(t(T)),E=Fa(t(T)),L=Oa(M,{weekStartsOn:0}),P=za(E,{weekStartsOn:0}),X=[];let A=L;for(;A<=P;)X.push(A),A=We(A,1);return X})())}),Y(()=>(m(B()),ut),()=>{D(x,B().reduce((M,E)=>{if(!E.start_time)return M;const L=Dt(E.start_time),P=ut(L,"yyyy-MM-dd");return M[P]||(M[P]=[]),M[P].push(E),M},{}))}),Y(()=>t(x),()=>{console.log("[MonthCalendarView] eventsByDate keys:",Object.keys(t(x)).length)}),$e(),fe();var Kt=Xn(),Nt=r(Kt),Ut=r(Nt),It=r(Ut,!0);a(Ut);var qt=s(Ut,2),Vt=r(qt),Pt=r(Vt),Yt=s(Pt,2),Ht=s(Yt,2);a(Vt);var Mt=s(Vt,2);{var St=M=>{var E=Ln(),L=r(E);L.value=L.__value="";var P=s(L);ae(P,1,f,we,(A,R)=>{var i=Bn(),_=r(i,!0);a(i);var v={};I(()=>{U(_,(t(R),n(()=>t(R).label))),v!==(v=(t(R),n(()=>t(R).key)))&&(i.value=(i.__value=(t(R),n(()=>t(R).key)))??"")}),o(A,i)}),a(E);var X;Ma(E),I(()=>{X!==(X=ot())&&(E.value=(E.__value=ot())??"",Da(E,ot()))}),gt("change",E,A=>nt()(A.currentTarget.value)),o(M,E)};y(Mt,M=>{m(f()),n(()=>f().length>0)&&M(St)})}a(qt),a(Nt);var N=s(Nt,2),J=r(N);ae(J,1,()=>At,we,(M,E,L)=>{var P=Nn(),X=r(P),A=r(X,!0);a(X);var R=s(X,2),i=r(R,!0);a(R),a(P),I(()=>{U(A,t(E)),U(i,n(()=>Lt[L]))}),o(M,P)});var ht=s(J,2);ae(ht,1,()=>t(d),M=>ut(M,"yyyy-MM-dd"),(M,E)=>{const L=Jt(()=>(t(E),n(()=>Ct(t(E))))),P=Jt(()=>(m(Ke),t(E),t(T),n(()=>Ke(t(E),t(T))))),X=Jt(()=>(m(qe),t(E),n(()=>qe(t(E))))),A=Jt(()=>(t(Q),m(Ee),t(E),n(()=>t(Q)&&Ee(t(Q),t(E)))));var R=Hn();let i;var _=r(R),v=r(_,!0);a(_);var w=s(_,2),C=r(w);ae(C,1,()=>(m(t(L)),n(()=>t(L).slice(0,3))),g=>g.id??g.start_time,(g,u)=>{var b=Vn(),F=r(b),q=r(F,!0);a(F),a(b),I(V=>{ne(b,1,`event-badge bg-color-${V??""}`,"svelte-14mpkul"),Ot(b,"title",(t(u),n(()=>t(u).title))),U(q,(t(u),n(()=>t(u).title)))},[()=>(m(Zt),t(u),n(()=>Zt(t(u)?.meta_data?.organization??"")?.color_number??0))]),gt("click",b,De(()=>st()(t(u)))),o(g,b)});var G=s(C,2);{var S=g=>{var u=Yn(),b=r(u);a(u),I(()=>U(b,`+${m(t(L)),n(()=>t(L).length-3)??""} more`)),o(g,u)};y(G,g=>{m(t(L)),n(()=>t(L).length>3)&&g(S)})}a(w),a(R),I(g=>{i=ne(R,1,"calendar-day svelte-14mpkul",null,i,{"other-month":!t(P),today:t(X),selected:t(A),"has-events":t(L).length>0}),U(v,g)},[()=>(m(ut),t(E),n(()=>ut(t(E),"d")))]),gt("click",R,()=>it(t(E))),gt("keydown",R,g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),it(t(E)))}),o(M,R)}),a(N);var ft=s(N,2);{var Ft=M=>{var E=Zn(),L=r(E),P=r(L),X=r(P,!0);a(P);var A=s(P,2);a(L);var R=s(L,2);ae(R,5,()=>t(e),i=>i.id??i.start_time,(i,_)=>{const v=Jt(()=>(t(_),n(()=>t(_).attachments?.find(W=>mt(W.type))))),w=Jt(()=>(m(Zt),t(_),n(()=>Zt(t(_)?.meta_data?.organization??""))));var C=Gn(),G=r(C),S=s(G,2),g=r(S),u=r(g,!0);a(g);var b=s(g,2),F=r(b);{var q=W=>{var $=Wn(),K=r($,!0);a($),I(()=>{ne($,1,`badge rounded-pill bg-color-${m(t(w)),n(()=>t(w).color_number)??""}`,"svelte-14mpkul"),U(K,(m(t(w)),n(()=>t(w).label)))}),o(W,$)};y(F,W=>{m(t(w)),n(()=>t(w)?.label)&&W(q)})}var V=s(F,2);{var l=W=>{var $=Kn();o(W,$)},k=W=>{var $=Bt(),K=dt($);{var j=_t=>{var at=qn(),pt=r(at,!0);a(at),I(jt=>U(pt,jt),[()=>(m(ut),m(Dt),t(_),n(()=>ut(Dt(t(_).start_time),"h:mm a")))]),o(_t,at)};y(K,_t=>{t(_),n(()=>t(_).start_time)&&_t(j)},!0)}o(W,$)};y(V,W=>{t(_),n(()=>t(_).is_all_day)?W(l):W(k,!1)})}var O=s(V,2);{var tt=W=>{var $=jn(),K=s(r($));a($),I(()=>U(K,` ${t(_),n(()=>t(_).location)??""}`)),o(W,$)};y(O,W=>{t(_),n(()=>t(_).location)&&W(tt)})}a(b),a(S);var et=s(S,2);{var yt=W=>{var $=Qn(),K=r($);a($),I(()=>{Ot(K,"src",(m(t(v)),n(()=>t(v).url))),Ot(K,"alt",(m(t(v)),n(()=>t(v).name)))}),o(W,$)};y(et,W=>{t(v)&&W(yt)})}var Gt=s(et,2);{var Xt=W=>{var $=Jn(),K=r($);a($),gt("click",K,De(()=>H()&&H()(t(_)))),o(W,$)};y(Gt,W=>{m(Z()),m(H()),t(_),n(()=>Z()&&H()&&Z()(t(_)))&&W(Xt)})}a(C),I(()=>{ne(G,1,`event-color-indicator bg-color-${m(t(w)),n(()=>t(w)?.color_number??0)??""}`,"svelte-14mpkul"),U(u,(t(_),n(()=>t(_).title)))}),gt("click",S,()=>st()(t(_))),o(i,C)}),a(R),a(E),I(i=>U(X,i),[()=>(m(ut),t(Q),n(()=>ut(t(Q),"EEEE, MMMM d, yyyy")))]),gt("click",A,()=>D(Q,null)),o(M,E)};y(ft,M=>{t(Q),t(e),n(()=>t(Q)&&t(e).length>0)&&M(Ft)})}a(Kt),I(M=>U(It,M),[()=>(m(ut),t(T),n(()=>ut(t(T),"MMMM yyyy")))]),gt("click",Pt,wt),gt("click",Yt,kt),gt("click",Ht,lt),o(h,Kt),pe()}var er=p('<div class="dropdown"><button class="btn btn-sm btn-primary dropdown-toggle" type="button" id="addEventDropdown" data-bs-toggle="dropdown" aria-label="Add event actions" aria-expanded="false"><i class="bi bi-plus"></i> <span class="d-none d-md-inline ms-1">Add Event</span></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="addEventDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-calendar-plus me-2"></i>Create Event</button></li> <li><button class="dropdown-item" type="button"><i class="bi bi-file-earmark-arrow-up me-2"></i>Import CSV</button></li></ul></div>'),ar=p("<span> </span>"),nr=p('<span class="event-date svelte-1p8xa6u"> </span>'),rr=p('<span class="badge bg-secondary">All Day</span>'),sr=p('<span class="event-time svelte-1p8xa6u"> </span>'),or=p('<span class="event-location svelte-1p8xa6u"><i class="bi bi-geo-alt"></i> <!></span>'),ir=p('<div class="event-thumbnail-container svelte-1p8xa6u"><img class="event-thumbnail svelte-1p8xa6u"/></div>'),lr=p('<div class="event-actions svelte-1p8xa6u"><button type="button" class="btn btn-sm btn-primary" title="Edit event"><i class="bi bi-pencil"></i></button></div>'),vr=p('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="event-details-button svelte-1p8xa6u"><div class="event-title-full svelte-1p8xa6u"><!></div> <div class="event-meta svelte-1p8xa6u"><!> <!> <!> <!></div></button> <!> <!></li>'),cr=p('<div class="search-results svelte-1p8xa6u"><div class="search-results-header svelte-1p8xa6u"><h6 class="search-results-title svelte-1p8xa6u"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),dr=p('<div class="search-no-results svelte-1p8xa6u"> </div>'),ur=p("<!> <!>",1),mr=p('<div class="no-events svelte-1p8xa6u"><!></div>'),_r=p('<div class="d-flex flex-column gap-2"><div class="calendar-header svelte-1p8xa6u"><h2 class="calendar-title svelte-1p8xa6u">Events</h2> <div class="calendar-actions svelte-1p8xa6u"><!></div></div> <!></div>'),pr=p('<div class="d-flex flex-column gap-4"><!></div>'),fr=p("<!> <!> <!> <!>",1);function Nr(h,c){_e(c,!1);const e=()=>xt(Vt,"$dbData",T),d=()=>xt(Yt,"$authenticated",T),x=()=>xt(qt,"$searchQuery",T),B=()=>xt(At,"$currentUser",T),st=()=>xt(Nt,"$userOrganizations",T),H=()=>xt(Lt,"$currentUserHasPermission",T),Z=()=>xt(Kt,"$currentUserIsRoot",T),ot=()=>xt(mt,"$currentUserIsAdmin",T),nt=()=>xt(Ut,"$ready",T),f=()=>xt(It,"$calendarEvents",T),[T,Q]=Te(),it=z(),kt=z(),wt=z(),lt=z(),Ct=z(),{stores:{currentUser:At,currentUserHasPermission:Lt,currentUserIsAdmin:mt,currentUserIsRoot:Kt,userOrganizations:Nt}}=ke(),{stores:{ready:Ut,calendarEvents:It,searchQuery:qt,dbData:Vt},actions:{reload:Pt}}=Xe(),{stores:{authenticated:Yt}}=ke(),Ht={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let Mt=Rt(c,"formId",24,Oe),St=Rt(c,"detailsId",24,Oe),N=z(!1),J=z(!1),ht=z(),ft=z(!1),Ft=z(!1),M=z(new Set),E=z(""),L=z({...Ht}),P=z({...Ht}),X=z(!1),A=z("");const R=l=>Ze(l,{currentUserId:t(ht),isPrivileged:t(J),canEditOwnOrgEvents:t(Ft),userOrganizations:t(M)}),i=l=>l.startsWith("image/");function _(){Pt()}Je(async()=>{await Pt()});const v=async l=>{if(D(E,"Item Form"),l?.meta_data?.recurring_instance&&l?.meta_data?.recurring_parent_id){const{getCalendarEvent:k}=await He(async()=>{const{getCalendarEvent:tt}=await import("./Dy2Bvcee.js").then(et=>et.x);return{getCalendarEvent:tt}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),O=await k(l.meta_data.recurring_parent_id);if(O){D(L,{...O,organization:O?.meta_data?.organization,start_time:l.start_time,end_time:l.end_time,meta_data:{...O.meta_data,recurring_instance:!0,recurring_parent_id:l.meta_data.recurring_parent_id,recurring_instance_index:l.meta_data.recurring_instance_index}});return}}D(L,{...l,organization:l?.meta_data?.organization})},w=async l=>{if(l?.meta_data?.recurring_instance&&l?.meta_data?.recurring_parent_id){const{getCalendarEvent:O}=await He(async()=>{const{getCalendarEvent:et}=await import("./Dy2Bvcee.js").then(yt=>yt.x);return{getCalendarEvent:et}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),tt=await O(l.meta_data.recurring_parent_id);tt?D(P,{...tt,start_time:l.start_time,end_time:l.end_time,meta_data:{...tt.meta_data,recurring_instance:!0,recurring_parent_id:l.meta_data.recurring_parent_id,recurring_instance_index:l.meta_data.recurring_instance_index}}):D(P,l)}else D(P,l);const k=document.getElementById(St());k&&new window.bootstrap.Offcanvas(k).show()},C=async l=>{await v(l);const k=document.getElementById(Mt());k&&new window.bootstrap.Offcanvas(k).show()},G=async()=>{const l=document.getElementById(St());if(l){const k=window.bootstrap.Offcanvas.getInstance(l);k&&k.hide()}await v(t(P)),setTimeout(()=>{const k=document.getElementById(Mt());k&&new window.bootstrap.Offcanvas(k).show()},300)};Y(()=>(e(),d(),Dt),()=>{D(it,(e()??[]).filter(l=>l.event_type==="calendar_event").filter(l=>!(!l.is_published||!d()&&l.is_public===!1)).filter(l=>{if(!l.start_time)return!1;const k=Dt(l.start_time),O=new Date;return O.setHours(0,0,0,0),k>=O}))}),Y(()=>(t(it),Zt),()=>{D(kt,(()=>{const l=new Set(t(it).filter(k=>k?.meta_data?.organization).map(k=>k.meta_data?.organization).filter(k=>k));return Array.from(l).map(k=>Zt(k||"")).filter(k=>k!==void 0).sort((k,O)=>k.sort_index-O.sort_index)})())}),Y(()=>(t(A),t(it)),()=>{D(wt,t(A)?t(it).filter(l=>l?.meta_data?.organization===t(A)):t(it))}),Y(()=>t(A),()=>{console.log("[Calendar Filter] calendarOrganizationFilter:",t(A))}),Y(()=>t(it),()=>{console.log("[Calendar Filter] allFutureEvents count:",t(it).length)}),Y(()=>t(wt),()=>{console.log("[Calendar Filter] filteredCalendarEvents count:",t(wt).length)}),Y(()=>(x(),t(it)),()=>{D(lt,x()?t(it).filter(l=>{const k=x().toLowerCase(),O=(l.title||"").toLowerCase(),tt=(l.description||"").replace(/<[^>]*>/g,"").toLowerCase(),et=(l.location||"").toLowerCase();return O.includes(k)||tt.includes(k)||et.includes(k)}):[])}),Y(()=>B(),()=>{D(ht,B()?.id)}),Y(()=>st(),()=>{D(M,st())}),Y(()=>(t(M),Me),()=>{D(ft,t(M).has(Me.Bishopric))}),Y(()=>(H(),Tt),()=>{D(Ft,H()(Tt.EditOwnOrgEvents))}),Y(()=>(Z(),ot(),t(ft),H(),Tt),()=>{D(J,Z()||ot()||t(ft)||H()(Tt.EditAllEvents))}),Y(()=>(H(),Tt),()=>{D(N,H()(Tt.CreateEvents))}),Y(()=>(H(),Tt),()=>{D(Ct,H()(Tt.DeleteEvents))}),$e(),fe();var S=fr(),g=dt(S);Ie(g,{get title(){return t(E)},get id(){return Mt()},children:(l,k)=>{Ge(l,{get eventItem(){return t(L)},get drawerId(){return Mt()},name:"event-item-form",get canDelete(){return t(Ct)}})},$$slots:{default:!0}});var u=s(g,2);Ie(u,{title:"Event Details",get id(){return St()},children:(l,k)=>{{let O=Jt(()=>(t(P),n(()=>R(t(P)))));aa(l,{get event(){return t(P)},get canEdit(){return t(O)},onEdit:G})}},$$slots:{default:!0}});var b=s(u,2);Pn(b,{get isOpen(){return t(X)},onClose:()=>D(X,!1),onComplete:_});var F=s(b,2);{var q=l=>{var k=_r(),O=r(k),tt=s(r(O),2),et=r(tt);{var yt=$=>{var K=er(),j=s(r(K),2),_t=r(j),at=r(_t);a(_t);var pt=s(_t,2),jt=r(pt);a(pt),a(j),a(K),I(()=>{Ot(at,"data-bs-target",`#${Mt()??""}`),Ot(at,"aria-controls",Mt())}),gt("click",at,()=>v({...Ht,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),gt("click",jt,()=>D(X,!0)),o($,K)};y(et,$=>{t(N)&&$(yt)})}a(tt),a(O);var Gt=s(O,2);{var Xt=$=>{var K=ur(),j=dt(K);{var _t=zt=>{var Wt=Bt(),re=dt(Wt);Ta(re,()=>t(A),se=>{tr(se,{get events(){return t(wt)},onEventClick:$t=>w($t),onEventEdit:$t=>C($t),canEditEvent:$t=>R($t),get organizationFilter(){return t(A)},onOrganizationFilterChange:$t=>D(A,$t),get availableOrganizations(){return t(kt)}})}),o(zt,Wt)};y(j,zt=>{x()||zt(_t)})}var at=s(j,2);{var pt=zt=>{var Wt=cr(),re=r(Wt),se=r(re),$t=r(se);a(se),a(re);var le=s(re,2);ae(le,5,()=>t(lt),ve=>ve.id??ve.start_time,(ve,vt)=>{const ce=Jt(()=>(t(vt),n(()=>t(vt).attachments?.find(rt=>i(rt.type))))),te=Jt(()=>(m(Zt),t(vt),n(()=>Zt(t(vt)?.meta_data?.organization??""))));var de=vr(),be=r(de),bt=s(be,2),Et=r(bt),ee=r(Et);ze(ee,()=>(m(he),t(vt),x(),n(()=>he(t(vt).title,x())))),a(Et);var Re=s(Et,2),Ue=r(Re);{var ra=rt=>{var ct=ar(),Qt=r(ct,!0);a(ct),I(()=>{ne(ct,1,`badge rounded-pill bg-color-${m(t(te)),n(()=>t(te).color_number)??""}`,"svelte-1p8xa6u"),U(Qt,(m(t(te)),n(()=>t(te).label)))}),o(rt,ct)};y(Ue,rt=>{m(t(te)),n(()=>t(te)?.label)&&rt(ra)})}var Pe=s(Ue,2);{var sa=rt=>{var ct=nr(),Qt=r(ct,!0);a(ct),I(Ae=>U(Qt,Ae),[()=>(m(ut),m(Dt),t(vt),n(()=>ut(Dt(t(vt).start_time),"MMM d, yyyy")))]),o(rt,ct)};y(Pe,rt=>{t(vt),n(()=>t(vt).start_time)&&rt(sa)})}var Be=s(Pe,2);{var oa=rt=>{var ct=rr();o(rt,ct)},ia=rt=>{var ct=Bt(),Qt=dt(ct);{var Ae=Se=>{var Fe=sr(),ma=r(Fe,!0);a(Fe),I(_a=>U(ma,_a),[()=>(m(ut),m(Dt),t(vt),n(()=>ut(Dt(t(vt).start_time),"h:mm a")))]),o(Se,Fe)};y(Qt,Se=>{t(vt),n(()=>t(vt).start_time)&&Se(Ae)},!0)}o(rt,ct)};y(Be,rt=>{t(vt),n(()=>t(vt).is_all_day)?rt(oa):rt(ia,!1)})}var la=s(Be,2);{var va=rt=>{var ct=or(),Qt=s(r(ct),2);ze(Qt,()=>(m(he),t(vt),x(),n(()=>he(t(vt).location,x())))),a(ct),o(rt,ct)};y(la,rt=>{t(vt),n(()=>t(vt).location)&&rt(va)})}a(Re),a(bt);var Le=s(bt,2);{var ca=rt=>{var ct=ir(),Qt=r(ct);a(ct),I(()=>{Ot(Qt,"src",(m(t(ce)),n(()=>t(ce).url))),Ot(Qt,"alt",(m(t(ce)),n(()=>t(ce).name)))}),o(rt,ct)};y(Le,rt=>{t(ce)&&rt(ca)})}var da=s(Le,2);{var ua=rt=>{var ct=lr(),Qt=r(ct);a(ct),gt("click",Qt,De(()=>C(t(vt)))),o(rt,ct)};y(da,rt=>{t(vt),n(()=>R(t(vt)))&&rt(ua)})}a(de),I(()=>ne(be,1,`event-color-indicator bg-color-${m(t(te)),n(()=>t(te)?.color_number??0)??""}`,"svelte-1p8xa6u")),gt("click",bt,()=>w(t(vt))),o(ve,de)}),a(le),a(Wt),I(()=>U($t,`${t(lt),n(()=>t(lt).length)??""} event${t(lt),n(()=>t(lt).length===1?"":"s")??""} matching "${x()??""}"`)),o(zt,Wt)},jt=zt=>{var Wt=Bt(),re=dt(Wt);{var se=$t=>{var le=dr(),ve=r(le);a(le),I(()=>U(ve,`No events match your search for "${x()??""}"`)),o($t,le)};y(re,$t=>{x()&&$t(se)},!0)}o(zt,Wt)};y(at,zt=>{x(),t(lt),n(()=>x()&&t(lt).length>0)?zt(pt):zt(jt,!1)})}o($,K)},W=$=>{var K=mr(),j=r(K);{var _t=pt=>{var jt=ie("No events match your search.");o(pt,jt)},at=pt=>{var jt=ie("There are no upcoming events scheduled.");o(pt,jt)};y(j,pt=>{x()?pt(_t):pt(at,!1)})}a(K),o($,K)};y(Gt,$=>{f(),n(()=>f()?.length)?$(Xt):$(W,!1)})}a(k),o(l,k)},V=l=>{var k=pr(),O=r(k);Ce(O,{}),a(k),o(l,k)};y(F,l=>{nt()?l(q):l(V,!1)})}o(h,S),pe(),Q()}export{Lr as A,aa as C,Nr as E,Ra as s};
