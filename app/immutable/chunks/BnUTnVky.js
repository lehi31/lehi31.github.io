import{d as l,w as i}from"./RHGBNuRb.js";import{s as f,a as n}from"./B65hWas1.js";const c=i([]),o=i(!1),a=i(null);async function d(){o.set(!0),a.set(null);try{const e=localStorage.getItem("authToken"),s=await fetch(`${f}/functions/v1/admin-get-users`,{headers:{"x-auth-token":e?`Bearer ${e}`:"",Authorization:`Bearer ${n}`,apikey:n}}),r=await s.json();if(!s.ok)throw new Error(r.error||"Failed to fetch users");if(r.users)c.set(r.users);else throw new Error("No users data returned")}catch(e){const s=e instanceof Error?e.message:"Unknown error occurred";a.set(s),console.error("Fetch users error:",e)}finally{o.set(!1)}}async function h(e,s){o.set(!0),a.set(null);try{const r=localStorage.getItem("authToken"),t=await fetch(`${f}/functions/v1/admin-update-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":r?`Bearer ${r}`:"",Authorization:`Bearer ${n}`,apikey:n},body:JSON.stringify({userId:e,updates:s})}),u=await t.json();if(!t.ok)throw new Error(u.error||"Failed to update user");if(u.success)return await d(),{success:!0};throw new Error(u.error||"Update failed")}catch(r){const t=r instanceof Error?r.message:"Unknown error occurred";return a.set(t),console.error("Update user error:",r),{success:!1,error:t}}finally{o.set(!1)}}l(c,e=>e.filter(s=>s.is_active));l(c,e=>e.length);const g={stores:{users:c,loading:o,error:a},actions:{fetchUsers:d,updateUser:h}};export{g as u};
