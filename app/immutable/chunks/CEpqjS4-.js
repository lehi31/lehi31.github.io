import{d,w as i}from"./CF1jV8Uj.js";import{s as l,a as n}from"./jIfZw83t.js";const c=i([]),o=i(!1),a=i(null);async function f(){o.set(!0),a.set(null);try{const t=localStorage.getItem("authToken"),r=await fetch(`${l}/functions/v1/admin-get-users`,{headers:{"x-auth-token":t?`Bearer ${t}`:"",Authorization:`Bearer ${n}`,apikey:n}}),e=await r.json();if(!r.ok)throw new Error(e.error||"Failed to fetch users");if(e.users)c.set(e.users);else throw new Error("No users data returned")}catch(t){const r=t instanceof Error?t.message:"Unknown error occurred";a.set(r),console.error("Fetch users error:",t)}finally{o.set(!1)}}async function h(t,r){o.set(!0),a.set(null);try{const e=localStorage.getItem("authToken"),s=await fetch(`${l}/functions/v1/admin-update-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":e?`Bearer ${e}`:"",Authorization:`Bearer ${n}`,apikey:n},body:JSON.stringify({userId:t,updates:r})}),u=await s.json();if(!s.ok)throw new Error(u.error||"Failed to update user");if(u.success)return await f(),{success:!0};throw new Error(u.error||"Update failed")}catch(e){const s=e instanceof Error?e.message:"Unknown error occurred";return a.set(s),console.error("Update user error:",e),{success:!1,error:s}}finally{o.set(!1)}}async function w(t){o.set(!0),a.set(null);try{const r=localStorage.getItem("authToken"),e=await fetch(`${l}/functions/v1/admin-delete-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":r?`Bearer ${r}`:"",Authorization:`Bearer ${n}`,apikey:n},body:JSON.stringify({userId:t})}),s=await e.json();if(!e.ok)throw new Error(s.error||"Failed to delete user");if(s.success)return await f(),{success:!0};throw new Error(s.error||"Delete failed")}catch(r){const e=r instanceof Error?r.message:"Unknown error occurred";return a.set(e),console.error("Delete user error:",r),{success:!1,error:e}}finally{o.set(!1)}}d(c,t=>t.filter(r=>r.is_active));d(c,t=>t.length);const g={stores:{users:c,loading:o,error:a},actions:{fetchUsers:f,updateUser:h,deleteUser:w}};export{g as u};
