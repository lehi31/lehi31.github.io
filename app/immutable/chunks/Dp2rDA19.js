const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{p as nt,ai as Ie,D as O,E as ce,w as G,d as n,aj as St,c as B,s as W,u as X,r as z,t as _e,a as at,f as We,F as Je,i as fr,ap as Cn,R as ct,as as lr,z as Fn}from"./DkHtKwEy.js";import{p as ge,i as de,e as Se,s as be,m as Un,u as On,b as or,a as zn}from"./DJ88wS1R.js";import{f as le,a as J,c as Ot,t as Ze}from"./B190dNFg.js";import{e as zt,i as Or}from"./CKczAFpg.js";import{h as Tt,j as yt,b as bt,t as wt,k as qt,D as Pn,f as Dt,l as Bn,m as Ln,u as Hn,n as zr,o as Pt,p as kt,q as Pr,g as Nn,r as qn,B as Wn,s as $n,v as Yn,w as jn}from"./DMc808GQ.js";import{e as Br,s as Te,b as vr,r as Ke}from"./DSRfHcWV.js";import{t as Lr,e as tt,j as Qn,i as He,p as Ut,A as Ve,d as Hr,G as Kn,O as Oe,s as cr}from"./DsQF7ATG.js";import{s as Wt}from"./CdEA5IGF.js";import{i as vt}from"./CrhaOPk_.js";import{R as ze}from"./DoBrUMEb.js";import{_ as $t}from"./CmsKOCeN.js";import{c as Vn,o as Nr,w as Gn,g as mr,a as Zn}from"./DUiJaq3B.js";import{S as qr}from"./BED0Tb20.js";import{b as ft,a as gr,c as dr}from"./Cf6qqcEk.js";import{b as Rt}from"./BczpZ8nK.js";import{b as xt}from"./DO_vVYAf.js";import{t as _t}from"./r7-tBYgy.js";import{c as Xn}from"./DvqAUWcV.js";import{c as Jn,a as dt,e as Rr,f as ea,d as ta,V as ra}from"./Bai7YTd4.js";import{p as Yt}from"./BDT4lekt.js";import{a as jt}from"./Ca8CDg5L.js";import{v as na,D as aa}from"./BFNSnplj.js";function ia(g,m){const w=Lr(g);return w.setHours(m),w}function sa(g,m){const w=Lr(g);return w.setMinutes(m),w}var la=le('<div style="min-width: 85px !important;"><strong> </strong> <div><small class="d-block"> </small></div></div>'),oa=le('<span class="d-block text-uppercase small fw-semibold svelte-1rksp2z">All Day</span>'),ca=le('<span class="d-block small svelte-1rksp2z"> </span>'),da=le('<span class="text-muted">•</span>'),ua=le("<span> </span> <!>",1),fa=le('<span class="text-muted">•</span>'),va=le('<span class="text-muted small svelte-1rksp2z"><i class="bi bi-arrow-repeat"></i> </span> <!>',1),ma=le('<span class="text-muted">•</span>'),ha=le('<span class="text-muted small svelte-1rksp2z"><i class="bi bi-arrow-repeat"></i> Recurring event</span> <!>',1),ga=le('<span class="text-muted">•</span>'),_a=le('<em class="small fw-lighter svelte-1rksp2z"><!></em> <!>',1),pa=le('<em class="small fw-lighter text-decoration-underline svelte-1rksp2z"><!> details</em>'),ya=le('<div class="small svelte-1rksp2z"><!></div>'),ba=le('<div class="attachment-image-container svelte-1rksp2z"><button type="button" class="attachment-image-button svelte-1rksp2z"><img class="attachment-image svelte-1rksp2z"/></button> <div class="attachment-image-label svelte-1rksp2z"><small class="text-muted"> </small></div></div>'),wa=le('<button type="button" class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-2"><i class="bi bi-file-pdf"></i> <span class="text-truncate" style="max-width: 150px;"> </span> <small class="text-muted"> </small></button>'),xa=le('<div class="mt-1 svelte-1rksp2z"><div class="fw-semibold small mb-1 svelte-1rksp2z">Attachments:</div> <div class="d-flex flex-wrap gap-2"></div></div>'),Ea=le('<div class="small text-muted posted-meta svelte-1rksp2z">Posted <!> <!></div>'),Aa=le('<div class="small text-muted posted-meta svelte-1rksp2z">Last edited <!> <!></div>'),Da=le('<div class="details-container svelte-1rksp2z"><!> <!> <!> <!></div>'),ka=le('<div class="event-thumbnail-container svelte-1rksp2z"><img class="event-thumbnail svelte-1rksp2z"/></div>'),Sa=le('<div role="button" tabindex="0"><!> <div class="d-flex gap-1"><div class="d-flex flex-column flex-grow-1 gap-1 svelte-1rksp2z"><div class="fw-bold svelte-1rksp2z"><!></div> <!> <div class="flex d-flex align-items-center flex-wrap gap-2"><!> <!> <!> <!></div> <!></div> <!></div></div>');function Os(g,m){nt(m,!1);const w=ce(),s=ce(),t=ce(),r=ce(),d=ce(),o=ce(),_=ce(),p=ce(),i=ce();let e=ge(m,"item",8),a=ge(m,"showDetails",12,!1),c=ge(m,"showDate",8,!0),l=ge(m,"searchQuery",8,"");const k=Q=>{if(!Q)return"";const Z=Ut(Q),V=wt(Z,Ve);return He(V,"h:mm aa")},C=Q=>{if(!Q)return"";const Z=Ut(Q),V=wt(Z,Ve);return He(V,"EEE")},x=Q=>{if(!Q)return"";const Z=Ut(Q),V=wt(Z,Ve);return He(V,"MMM, dd")},N=()=>{n(s)&&a(!a())},P=Q=>{n(s)&&(Q.key==="Enter"||Q.key===" ")&&N()},M=Q=>Q<1024?Q+" B":Q<1024*1024?(Q/1024).toFixed(1)+" KB":(Q/(1024*1024)).toFixed(1)+" MB",L=Q=>Q.startsWith("image/"),y=Q=>{window.open(Q,"_blank")},S=Q=>{if(!Q)return"";try{return He(Ut(Q),"MMM d, yyyy 'at' h:mm a")}catch{return""}},f=Q=>{try{const V=ze.fromString(Q).origOptions,re=V.interval||1,se=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ne=["","1st","2nd","3rd","4th","5th"];if(V.freq===ze.DAILY)return re===1?"Repeats daily":`Repeats every ${re} days`;if(V.freq===ze.WEEKLY){if(V.byweekday){const ie=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday]).map(me=>{const ye=typeof me=="number"?me:me.weekday,oe=ye===6?0:ye+1;return se[oe]});return re===1?ie.length===1?`Repeats every ${ie[0]}`:`Repeats on ${ie.join(", ")}`:`Repeats every ${re} weeks on ${ie.join(", ")}`}return re===1?"Repeats weekly":`Repeats every ${re} weeks`}if(V.freq===ze.MONTHLY){if(V.byweekday){const ie=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday])[0];if(ie&&typeof ie=="object"&&"n"in ie&&"weekday"in ie){const me=ie.weekday,ye=me===6?0:me+1,oe=ie.n,pe=ne[oe]||`${oe}th`;return re===1?`Repeats on the ${pe} ${se[ye]} of the month`:`Repeats on the ${pe} ${se[ye]} every ${re} months`}}if(V.bymonthday){const ae=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,ie=ae===1?"st":ae===2?"nd":ae===3?"rd":"th";return re===1?`Repeats on the ${ae}${ie} of the month`:`Repeats on the ${ae}${ie} every ${re} months`}return re===1?"Repeats monthly":`Repeats every ${re} months`}if(V.freq===ze.YEARLY){if(V.bymonth&&V.bymonthday){const ae=["","January","February","March","April","May","June","July","August","September","October","November","December"],ie=Array.isArray(V.bymonth)?V.bymonth[0]:V.bymonth,me=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,ye=me===1?"st":me===2?"nd":me===3?"rd":"th";return re===1?`Repeats every ${ae[ie]} ${me}${ye}`:`Repeats every ${re} years on ${ae[ie]} ${me}${ye}`}return re===1?"Repeats yearly":`Repeats every ${re} years`}return"Repeats"}catch{return"Repeats"}};let v=ce("");Ie(()=>G(c()),()=>{O(v,c()?"d-flex flex-sm-column flex-md-row flex-lg-row flex-xl-row gap-1":"d-flex flex-column gap-1")}),Ie(()=>G(e()),()=>{O(w,e().attachments?.find(Q=>L(Q.type)))}),Ie(()=>G(e()),()=>{O(s,!!(e().description||e().attachments&&e().attachments.length>0))}),Ie(()=>G(e()),()=>{O(t,e().meta_data?.submitted_at??e().created_at)}),Ie(()=>n(t),()=>{O(r,S(n(t)))}),Ie(()=>G(e()),()=>{O(d,e().meta_data?.submitted_by_name)}),Ie(()=>(n(r),n(d)),()=>{O(o,!!(n(r)||n(d)))}),Ie(()=>G(e()),()=>{O(_,S(e().meta_data?.edited_at))}),Ie(()=>G(e()),()=>{O(p,e().meta_data?.edited_by_name)}),Ie(()=>(n(_),n(p)),()=>{O(i,!!(n(_)||n(p)))}),St(),vt();var b=Sa(),A=B(b);{var D=Q=>{var Z=la(),V=B(Z),re=B(V,!0);z(V);var se=W(V,2),ne=B(se),ae=B(ne,!0);z(ne),z(se),z(Z),_e((ie,me)=>{be(re,ie),be(ae,me)},[()=>(G(e()),X(()=>C(e().start_time))),()=>(G(e()),X(()=>x(e().start_time)))]),J(Q,Z)};de(A,Q=>{c()&&Q(D)})}var I=W(A,2),E=B(I),T=B(E),h=B(T);Tt(h,()=>(G(yt),G(e()),G(l()),X(()=>yt(e().title||"",l())))),z(T);var u=W(T,2);{var q=Q=>{var Z=oa();J(Q,Z)},R=Q=>{var Z=ca(),V=B(Z);z(Z),_e((re,se)=>be(V,`${re??""} to ${se??""}`),[()=>(G(e()),X(()=>k(e().start_time))),()=>(G(e()),X(()=>k(e().end_time)))]),J(Q,Z)};de(u,Q=>{G(e()),X(()=>e().is_all_day)?Q(q):Q(R,!1)})}var U=W(u,2),K=B(U);{var Y=Q=>{var Z=ua(),V=We(Z),re=B(V,!0);z(V);var se=W(V,2);{var ne=ae=>{var ie=da();J(ae,ie)};de(se,ae=>{G(e()),X(()=>e().recurrence_rule||e()?.meta_data?.recurring_instance||e().location||e().description||e().attachments&&e().attachments.length>0)&&ae(ne)})}_e((ae,ie)=>{tt(V,1,`badge rounded-pill bg-color-${ae??""}`,"svelte-1rksp2z"),be(re,ie)},[()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.color_number)),()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.label))]),J(Q,Z)};de(K,Q=>{G(e()),X(()=>e()?.meta_data?.category)&&Q(Y)})}var $=W(K,2);{var H=Q=>{var Z=va(),V=We(Z),re=W(B(V));z(V);var se=W(V,2);{var ne=ae=>{var ie=fa();J(ae,ie)};de(se,ae=>{G(e()),X(()=>e().location||e().description||e().attachments&&e().attachments.length>0)&&ae(ne)})}_e(ae=>be(re,` ${ae??""}`),[()=>(G(e()),X(()=>f(e().recurrence_rule)))]),J(Q,Z)},F=Q=>{var Z=Ot(),V=We(Z);{var re=se=>{var ne=ha(),ae=W(We(ne),2);{var ie=me=>{var ye=ma();J(me,ye)};de(ae,me=>{G(e()),X(()=>e().location||e().description||e().attachments&&e().attachments.length>0)&&me(ie)})}J(se,ne)};de(V,se=>{G(e()),X(()=>e()?.meta_data?.recurring_instance)&&se(re)},!0)}J(Q,Z)};de($,Q=>{G(e()),X(()=>e().recurrence_rule)?Q(H):Q(F,!1)})}var ee=W($,2);{var ue=Q=>{var Z=_a(),V=We(Z),re=B(V);Tt(re,()=>(G(yt),G(e()),G(l()),X(()=>yt(e().location,l())))),z(V);var se=W(V,2);{var ne=ae=>{var ie=ga();J(ae,ie)};de(se,ae=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&ae(ne)})}J(Q,Z)};de(ee,Q=>{G(e()),X(()=>e().location)&&Q(ue)})}var he=W(ee,2);{var fe=Q=>{var Z=pa(),V=B(Z);{var re=ne=>{var ae=Ze("Hide");J(ne,ae)},se=ne=>{var ae=Ze("Show");J(ne,ae)};de(V,ne=>{a()?ne(re):ne(se,!1)})}Je(),z(Z),J(Q,Z)};de(he,Q=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&Q(fe)})}z(U);var ve=W(U,2);{var Ee=Q=>{var Z=Da(),V=B(Z);{var re=oe=>{var pe=ya(),Me=B(pe);Tt(Me,()=>(G(qt),G(e()),G(l()),X(()=>qt(e().description,l())))),z(pe),J(oe,pe)};de(V,oe=>{G(e()),X(()=>e().description)&&oe(re)})}var se=W(V,2);{var ne=oe=>{var pe=xa(),Me=W(B(pe),2);zt(Me,5,()=>(G(e()),X(()=>e().attachments)),Be=>Be.id,(Be,xe)=>{var Ye=Ot(),De=We(Ye);{var Ce=Ne=>{var Pe=ba(),Fe=B(Pe),$e=B(Fe);z(Fe);var mt=W(Fe,2),it=B(mt),st=B(it,!0);z(it),z(mt),z(Pe),_e(()=>{Te(Fe,"title",`Open ${n(xe),X(()=>n(xe).name)??""}`),Te($e,"src",(n(xe),X(()=>n(xe).url))),Te($e,"alt",(n(xe),X(()=>n(xe).name))),be(st,(n(xe),X(()=>n(xe).name)))}),Se("click",Fe,Wt(()=>y(n(xe).url))),J(Ne,Pe)},qe=Ne=>{var Pe=wa(),Fe=W(B(Pe),2),$e=B(Fe,!0);z(Fe);var mt=W(Fe,2),it=B(mt);z(mt),z(Pe),_e(st=>{Te(Pe,"title",`Open ${n(xe),X(()=>n(xe).name)??""}`),be($e,(n(xe),X(()=>n(xe).name))),be(it,`(${st??""})`)},[()=>(n(xe),X(()=>M(n(xe).size)))]),Se("click",Pe,Wt(()=>y(n(xe).url))),J(Ne,Pe)};de(De,Ne=>{n(xe),X(()=>L(n(xe).type))?Ne(Ce):Ne(qe,!1)})}J(Be,Ye)}),z(Me),z(pe),J(oe,pe)};de(se,oe=>{G(e()),X(()=>e().attachments&&e().attachments.length>0)&&oe(ne)})}var ae=W(se,2);{var ie=oe=>{var pe=Ea(),Me=W(B(pe));{var Be=De=>{var Ce=Ze();_e(()=>be(Ce,n(r))),J(De,Ce)};de(Me,De=>{n(r)&&De(Be)})}var xe=W(Me,2);{var Ye=De=>{var Ce=Ot(),qe=We(Ce);{var Ne=Fe=>{var $e=Ze();_e(()=>be($e,`by ${n(d)??""}`)),J(Fe,$e)},Pe=Fe=>{var $e=Ze();_e(()=>be($e,`by ${n(d)??""}`)),J(Fe,$e)};de(qe,Fe=>{n(r)?Fe(Ne):Fe(Pe,!1)})}J(De,Ce)};de(xe,De=>{n(d)&&De(Ye)})}z(pe),J(oe,pe)};de(ae,oe=>{n(o)&&oe(ie)})}var me=W(ae,2);{var ye=oe=>{var pe=Aa(),Me=W(B(pe));{var Be=De=>{var Ce=Ze();_e(()=>be(Ce,n(_))),J(De,Ce)};de(Me,De=>{n(_)&&De(Be)})}var xe=W(Me,2);{var Ye=De=>{var Ce=Ze();_e(()=>be(Ce,`by ${n(p)??""}`)),J(De,Ce)};de(xe,De=>{n(p)&&De(Ye)})}z(pe),J(oe,pe)};de(me,oe=>{n(i)&&oe(ye)})}z(Z),J(Q,Z)};de(ve,Q=>{a()&&Q(Ee)})}z(E);var Ae=W(E,2);{var ke=Q=>{var Z=ka(),V=B(Z);z(Z),_e(()=>{Te(V,"src",(n(w),X(()=>n(w).url))),Te(V,"alt",(n(w),X(()=>n(w).name)))}),J(Q,Z)};de(Ae,Q=>{n(w)&&Q(ke)})}z(I),z(b),_e(()=>{tt(b,1,Qn(n(v)),"svelte-1rksp2z"),Br(b,n(s)?"cursor: pointer;":"")}),Se("keydown",b,P),Se("click",b,N),J(g,b),at()}var Ia=le('<div class="invalid-feedback d-block"> </div>'),Ta=le("<option> </option>"),Ra=le('<div class="invalid-feedback d-block"> </div>'),Ma=le(`<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Title*</div> <input type="text" placeholder="" required/> <!> <small class="fw-lighter fst-italic">Displayed publicly on the calendar and announcements page. e.g. Ward Conference, Ward BBQ
			Night</small></div> <div class="d-flex flex-column gap-2"><div>Type*</div> <select class="form-select" aria-label="Select Type"><option>Calendar Event</option><option>Announcement</option></select></div> <div class="d-flex flex-column gap-2"><div>Organization*</div> <select class="form-select" aria-label="Select Category"></select> <small class="fw-lighter fst-italic">Displayed as a public badge on the event listing.</small></div> <div class="d-flex flex-column gap-2"><div>Visibility</div> <div class="form-check form-switch"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">Public (visible without login)</label></div> <small class="fw-lighter fst-italic">Turn off to restrict this event/announcement to logged-in users only.</small></div> <div class="d-flex flex-column gap-2"><div>Description</div> <textarea rows="4" placeholder="Event description (optional)"></textarea> <!> <small class="fw-lighter fst-italic">Shown publicly when viewers expand the event details. Supports basic HTML formatting.</small></div></div>`);function Ca(g,m){nt(m,!1);const w=ce(),s=ce();let t=ge(m,"title",12,""),r=ge(m,"eventType",12,"calendar_event"),d=ge(m,"category",12,""),o=ge(m,"isPublic",12,!0),_=ge(m,"description",12,""),p=ge(m,"disabled",8,!1),i=ge(m,"name",8,"event"),e=ge(m,"validationErrors",24,()=>({})),a=ce(),c=ce();function l(){n(a)?.focus()}function k(){n(c)?.focus()}Ie(()=>G(e()),()=>{O(w,!!e().title)}),Ie(()=>G(e()),()=>{O(s,!!e().description)}),St();var C={focusTitle:l,focusDescription:k};vt();var x=Ma(),N=B(x),P=W(B(N),2);Ke(P);let M;xt(P,Y=>O(a,Y),()=>n(a));var L=W(P,2);{var y=Y=>{var $=Ia(),H=B($,!0);z($),_e(()=>be(H,(G(e()),X(()=>e().title)))),J(Y,$)};de(L,Y=>{G(e()),X(()=>e().title)&&Y(y)})}Je(2),z(N);var S=W(N,2),f=W(B(S),2);_e(()=>{r(),fr(()=>{p()})});var v=B(f);v.value=v.__value="calendar_event";var b=W(v);b.value=b.__value="announcement",z(f),z(S);var A=W(S,2),D=W(B(A),2);_e(()=>{d(),fr(()=>{p()})}),zt(D,5,()=>Pn,Or,(Y,$)=>{var H=Ta(),F=B(H,!0);z(H);var ee={};_e(()=>{be(F,(n($),X(()=>n($).label))),ee!==(ee=(n($),X(()=>n($).key)))&&(H.value=(H.__value=(n($),X(()=>n($).key)))??"")}),J(Y,H)}),z(D),Je(2),z(A);var I=W(A,2),E=W(B(I),2),T=B(E);Ke(T);var h=W(T,2);z(E),Je(2),z(I);var u=W(I,2),q=W(B(u),2);Cn(q);let R;xt(q,Y=>O(c,Y),()=>n(c));var U=W(q,2);{var K=Y=>{var $=Ra(),H=B($,!0);z($),_e(()=>be(H,(G(e()),X(()=>e().description)))),J(Y,$)};de(U,Y=>{G(e()),X(()=>e().description)&&Y(K)})}return Je(2),z(u),z(x),_e(()=>{Te(P,"name",`${i()??""}-title`),M=tt(P,1,"form-control",null,M,{"is-invalid":n(w)}),P.disabled=p(),f.disabled=p(),D.disabled=p(),Te(T,"id",`${i()??""}-is-public`),T.disabled=p(),Te(h,"for",`${i()??""}-is-public`),Te(q,"name",`${i()??""}-description`),R=tt(q,1,"form-control",null,R,{"is-invalid":n(s)}),q.disabled=p()}),Se("focus",P,()=>n(a).select()),ft(P,t),vr(f,r),vr(D,d),gr(T,o),Se("focus",q,()=>n(c).select()),ft(q,_),J(g,x),Rt(m,"focusTitle",l),Rt(m,"focusDescription",k),at(C)}var Fa=le('<div class="invalid-feedback d-block"> </div>'),Ua=le('<div class="invalid-feedback d-block"> </div>'),Oa=le('<div class="invalid-feedback d-block"> </div>'),za=le('<div class="d-flex flex-column gap-4 ps-4"><div class="d-flex flex-column gap-2"><div>Start time*</div> <input type="time" required/> <!></div> <div class="d-flex flex-column gap-2"><div>End time*</div> <input type="time" required/> <!></div></div>'),Pa=le('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Date*</div> <input type="date" required/> <!></div> <div><div class="form-check d-flex align-items-center gap-2"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">All Day Event</label></div></div> <!></div>');function Ba(g,m){nt(m,!1);const w=ce(),s=ce(),t=ce();let r=ge(m,"dateInput",12,""),d=ge(m,"startTimeInput",12,""),o=ge(m,"endTimeInput",12,""),_=ge(m,"isAllDay",12,!1),p=ge(m,"disabled",8,!1),i=ge(m,"name",8,"event"),e=ge(m,"validationErrors",24,()=>({})),a=ce(),c=ce(),l=ce();function k(){n(a)?.focus()}function C(){n(c)?.focus()}function x(){n(l)?.focus()}Ie(()=>G(e()),()=>{O(w,!!e().dateInput)}),Ie(()=>G(e()),()=>{O(s,!!e().startTimeInput)}),Ie(()=>G(e()),()=>{O(t,!!e().endTimeInput)}),St();var N={focusDate:k,focusStartTime:C,focusEndTime:x};vt();var P=Pa(),M=B(P),L=W(B(M),2);Ke(L);let y;xt(L,T=>O(a,T),()=>n(a));var S=W(L,2);{var f=T=>{var h=Fa(),u=B(h,!0);z(h),_e(()=>be(u,(G(e()),X(()=>e().dateInput)))),J(T,h)};de(S,T=>{G(e()),X(()=>e().dateInput)&&T(f)})}z(M);var v=W(M,2),b=B(v),A=B(b);Ke(A);var D=W(A,2);z(b),z(v);var I=W(v,2);{var E=T=>{var h=za(),u=B(h),q=W(B(u),2);Ke(q),Te(q,"step",900);let R;xt(q,ue=>O(c,ue),()=>n(c));var U=W(q,2);{var K=ue=>{var he=Ua(),fe=B(he,!0);z(he),_e(()=>be(fe,(G(e()),X(()=>e().startTimeInput)))),J(ue,he)};de(U,ue=>{G(e()),X(()=>e().startTimeInput)&&ue(K)})}z(u);var Y=W(u,2),$=W(B(Y),2);Ke($),Te($,"step",900);let H;xt($,ue=>O(l,ue),()=>n(l));var F=W($,2);{var ee=ue=>{var he=Oa(),fe=B(he,!0);z(he),_e(()=>be(fe,(G(e()),X(()=>e().endTimeInput)))),J(ue,he)};de(F,ue=>{G(e()),X(()=>e().endTimeInput)&&ue(ee)})}z(Y),z(h),_e(()=>{Te(q,"name",`${i()??""}-start-time`),R=tt(q,1,"form-control",null,R,{"is-invalid":n(s)}),q.disabled=p(),Te($,"name",`${i()??""}-end-time`),H=tt($,1,"form-control",null,H,{"is-invalid":n(t)}),$.disabled=p()}),Se("focus",q,()=>n(c).select()),ft(q,d),Se("focus",$,()=>n(l).select()),ft($,o),J(T,h)};de(I,T=>{_()||T(E)})}return z(P),_e(()=>{Te(L,"name",`${i()??""}-date`),y=tt(L,1,"form-control",null,y,{"is-invalid":n(w)}),L.disabled=p(),Te(A,"id",`${i()??""}-all-day-check`),A.disabled=p(),Te(D,"for",`${i()??""}-all-day-check`)}),Se("focus",L,()=>n(a).select()),ft(L,r),gr(A,_),J(g,P),Rt(m,"focusDate",k),Rt(m,"focusStartTime",C),Rt(m,"focusEndTime",x),at(N)}var La=le('<div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div>'),Ha=le('<div class="invalid-feedback d-block"> </div>'),Na=le('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold">Repeat on these days<span class="text-danger">*</span></div> <div class="d-flex flex-wrap gap-2"></div> <!> <small class="text-muted">Select at least one day when this event repeats</small></div>'),qa=le('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Monthly recurrence">Monthly recurrence</div> <div class="d-flex flex-column gap-2"><div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div></div></div>'),Wa=le('<div class="invalid-feedback d-block"> </div>'),$a=le('<div class="d-flex flex-column gap-3 ps-4"><div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Repeat pattern">Repeat pattern</div> <div class="row g-2 align-items-center"><div class="col-auto"><span class="text-muted">Every</span></div> <div class="col-auto"><input type="number" class="form-control" min="1" max="99" style="width: 80px;"/></div> <div class="col-auto"><select class="form-select"><option> </option><option> </option><option> </option><option> </option></select></div></div></div> <!> <!> <div class="d-flex flex-column gap-2"><label class="form-label fw-semibold">Repeat until<span class="text-danger">*</span></label> <input type="date" required/> <!> <small class="text-muted">The last date this event will occur</small></div></div>'),Ya=le('<div class="d-flex flex-column gap-3"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label fw-semibold">Make this a recurring event</label></div> <!></div>');function ja(g,m){nt(m,!1);const w=[],s=[];let t=ge(m,"isRecurring",12,!1),r=ge(m,"recurrenceFrequency",12,"weekly"),d=ge(m,"recurrenceInterval",12,1),o=ge(m,"recurringDays",28,()=>[]),_=ge(m,"recurrenceEndDate",12,""),p=ge(m,"monthlyType",12,"date"),i=ge(m,"dateInput",8,""),e=ge(m,"disabled",8,!1),a=ge(m,"name",8,"event"),c=ge(m,"validationErrors",24,()=>({}));const l=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];function k(S){if(!S)return"Same weekday of the month";try{const f=new Date(S),v=He(f,"EEEE"),b=Math.ceil(f.getDate()/7);return`${["","1st","2nd","3rd","4th","5th"][b]} ${v} of the month`}catch{return"Same weekday of the month"}}function C(S){if(!S)return 1;try{return S.split("-").map(Number)[2]}catch{return 1}}vt();var x=Ya(),N=B(x),P=B(N);Ke(P);var M=W(P,2);z(N);var L=W(N,2);{var y=S=>{var f=$a(),v=B(f),b=W(B(v),2),A=W(B(b),2),D=B(A);Ke(D),z(A);var I=W(A,2),E=B(I);_e(()=>{r(),fr(()=>{e(),d()})});var T=B(E),h=B(T,!0);z(T),T.value=T.__value="daily";var u=W(T),q=B(u,!0);z(u),u.value=u.__value="weekly";var R=W(u),U=B(R,!0);z(R),R.value=R.__value="monthly";var K=W(R),Y=B(K,!0);z(K),K.value=K.__value="yearly",z(E),z(I),z(b),z(v);var $=W(v,2);{var H=ke=>{var Q=Na(),Z=W(B(Q),2);zt(Z,5,()=>l,Or,(se,ne)=>{var ae=La(),ie=B(ae);Ke(ie);var me,ye=W(ie,2),oe=B(ye,!0);z(ye),z(ae),_e(()=>{Te(ie,"id",`${a()??""}-day-${n(ne),X(()=>n(ne).value)??""}`),ie.disabled=e(),me!==(me=(n(ne),X(()=>n(ne).value)))&&(ie.value=(ie.__value=(n(ne),X(()=>n(ne).value)))??""),Te(ye,"for",`${a()??""}-day-${n(ne),X(()=>n(ne).value)??""}`),be(oe,(n(ne),X(()=>n(ne).label)))}),dr(w,[],ie,()=>(n(ne),X(()=>n(ne).value),o()),o),J(se,ae)}),z(Z);var V=W(Z,2);{var re=se=>{var ne=Ha(),ae=B(ne,!0);z(ne),_e(()=>be(ae,(G(c()),X(()=>c().recurringDays)))),J(se,ne)};de(V,se=>{G(c()),X(()=>c().recurringDays)&&se(re)})}Je(2),z(Q),J(ke,Q)};de($,ke=>{r()==="weekly"&&ke(H)})}var F=W($,2);{var ee=ke=>{var Q=qa(),Z=W(B(Q),2),V=B(Z),re=B(V);Ke(re),re.value=re.__value="date";var se=W(re,2),ne=B(se);z(se),z(V);var ae=W(V,2),ie=B(ae);Ke(ie),ie.value=ie.__value="weekday";var me=W(ie,2),ye=B(me);z(me),z(ae),z(Z),z(Q),_e((oe,pe)=>{Te(re,"id",`${a()??""}-monthly-date`),re.disabled=e(),Te(se,"for",`${a()??""}-monthly-date`),be(ne,`On day ${oe??""} of the month`),Te(ie,"id",`${a()??""}-monthly-weekday`),ie.disabled=e(),Te(me,"for",`${a()??""}-monthly-weekday`),be(ye,`On the ${pe??""}`)},[()=>(G(i()),X(()=>C(i()))),()=>(G(i()),X(()=>k(i())))]),dr(s,[],re,p,p),dr(s,[],ie,p,p),J(ke,Q)};de(F,ke=>{r()==="monthly"&&ke(ee)})}var ue=W(F,2),he=B(ue),fe=W(he,2);Ke(fe);let ve;var Ee=W(fe,2);{var Ae=ke=>{var Q=Wa(),Z=B(Q,!0);z(Q),_e(()=>be(Z,(G(c()),X(()=>c().recurrenceEndDate)))),J(ke,Q)};de(Ee,ke=>{G(c()),X(()=>c().recurrenceEndDate)&&ke(Ae)})}Je(2),z(ue),z(f),_e(()=>{D.disabled=e(),E.disabled=e(),be(h,d()===1?"day":"days"),be(q,d()===1?"week":"weeks"),be(U,d()===1?"month":"months"),be(Y,d()===1?"year":"years"),Te(he,"for",`${a()??""}-recurrence-end-date`),ve=tt(fe,1,"form-control",null,ve,{"is-invalid":!!c().recurrenceEndDate}),Te(fe,"id",`${a()??""}-recurrence-end-date`),fe.disabled=e()}),ft(D,d),vr(E,r),ft(fe,_),J(S,f)};de(L,S=>{t()&&S(y)})}z(x),_e(()=>{Te(P,"id",`${a()??""}-is-recurring`),P.disabled=e(),Te(M,"for",`${a()??""}-is-recurring`)}),gr(P,t),J(g,x),at()}var Qa=le('<div class="d-flex flex-column gap-2"><div>Location</div> <input type="text" class="form-control" placeholder="Event location (optional)"/> <small class="fw-lighter fst-italic">Displayed publicly on the event listing. e.g. Cultural Hall, Stake Center</small></div>');function Ka(g,m){nt(m,!1);let w=ge(m,"value",12,""),s=ge(m,"disabled",8,!1),t=ge(m,"name",8,"location"),r=ce();function d(){n(r)?.focus()}var o={focus:d},_=Qa(),p=W(B(_),2);return Ke(p),xt(p,i=>O(r,i),()=>n(r)),Je(2),z(_),_e(()=>{Te(p,"name",t()),p.disabled=s()}),Se("focus",p,()=>n(r).select()),ft(p,w),J(g,_),Rt(m,"focus",d),at(o)}var Va=le('<input type="text" class="form-control form-control-sm"/> <small class="text-muted"> </small>',1),Ga=le('<div class="fw-semibold"> </div> <small class="text-muted"> </small>',1),Za=le('<button type="button" class="btn btn-sm btn-success" title="Save"><i class="bi bi-check-lg"></i></button> <button type="button" class="btn btn-sm btn-secondary" title="Cancel"><i class="bi bi-x-lg"></i></button>',1),Xa=le('<button type="button" class="btn btn-sm btn-outline-primary" title="Edit name"><i class="bi bi-pencil"></i></button> <button type="button" class="btn btn-sm btn-outline-danger" title="Delete"><i class="bi bi-trash"></i></button>',1),Ja=le('<div class="d-flex align-items-center gap-2 p-2 border rounded"><div class="flex-grow-1"><!></div> <!></div>'),ei=le('<div class="d-flex flex-column gap-2 mb-2"></div>'),ti=le('<div class="d-flex flex-column gap-2"><div>Attachments</div> <!> <div class="d-flex flex-column gap-2"><div class="d-flex gap-2 align-items-center"><input type="file" class="form-control" accept="image/*,application/pdf"/> <!></div> <small class="fw-lighter fst-italic">Publicly visible in the event details. Max 5MB per file. Supports: images, PDFs</small></div></div>');function ri(g,m){nt(m,!1);let w=ge(m,"attachments",24,()=>[]),s=ge(m,"disabled",8,!1),t=ge(m,"uploadingFile",8,!1);const r=Vn();let d=ce(),o=ce(null),_=ce("");const p=S=>{if(S===0)return"0 Bytes";const f=1024,v=["Bytes","KB","MB"],b=Math.floor(Math.log(S)/Math.log(f));return Math.round(S/Math.pow(f,b)*100)/100+" "+v[b]},i=S=>{const f=S.target;f.files&&f.files[0]&&(r("upload",f.files[0]),f.value="")},e=S=>{O(o,S.id),O(_,S.name)},a=S=>{n(_).trim()&&n(_)!==S.name&&r("edit",{attachment:S,newName:n(_).trim()}),O(o,null),O(_,"")},c=()=>{O(o,null),O(_,"")},l=S=>{r("remove",S)};vt();var k=ti(),C=W(B(k),2);{var x=S=>{var f=ei();zt(f,5,w,v=>v.id,(v,b)=>{var A=Ja(),D=B(A),I=B(D);{var E=R=>{var U=Va(),K=We(U);Ke(K);var Y=W(K,2),$=B(Y,!0);z(Y),_e(H=>{K.disabled=s(),be($,H)},[()=>(n(b),X(()=>p(n(b).size)))]),ft(K,()=>n(_),H=>O(_,H)),Se("keydown",K,H=>{H.key==="Enter"&&a(n(b)),H.key==="Escape"&&c()}),J(R,U)},T=R=>{var U=Ga(),K=We(U),Y=B(K,!0);z(K);var $=W(K,2),H=B($,!0);z($),_e(F=>{be(Y,(n(b),X(()=>n(b).name))),be(H,F)},[()=>(n(b),X(()=>p(n(b).size)))]),J(R,U)};de(I,R=>{n(o),n(b),X(()=>n(o)===n(b).id)?R(E):R(T,!1)})}z(D);var h=W(D,2);{var u=R=>{var U=Za(),K=We(U),Y=W(K,2);_e(()=>{K.disabled=s(),Y.disabled=s()}),Se("click",K,()=>a(n(b))),Se("click",Y,c),J(R,U)},q=R=>{var U=Xa(),K=We(U),Y=W(K,2);_e(()=>{K.disabled=s(),Y.disabled=s()}),Se("click",K,()=>e(n(b))),Se("click",Y,()=>l(n(b))),J(R,U)};de(h,R=>{n(o),n(b),X(()=>n(o)===n(b).id)?R(u):R(q,!1)})}z(A),J(v,A)}),z(f),J(S,f)};de(C,S=>{G(w()),X(()=>w().length>0)&&S(x)})}var N=W(C,2),P=B(N),M=B(P);xt(M,S=>O(d,S),()=>n(d));var L=W(M,2);{var y=S=>{qr(S,{size:"sm"})};de(L,S=>{t()&&S(y)})}z(P),Je(2),z(N),z(k),_e(()=>M.disabled=s()||t()),Se("change",M,i),J(g,k),at()}var ni=le('<div class="modal svelte-xtxevo" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Edit Recurring Event</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">How would you like to edit it?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">The entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function ai(g,m){nt(m,!1);const w=ce();let s=ge(m,"eventTitle",8),t=ge(m,"occurrenceDate",8),r=ge(m,"callback",8);function d(A){r()(A)}function o(){r()(null)}Ie(()=>(G(t()),He),()=>{O(w,(()=>{try{const[A,D,I]=t().split("-").map(Number),E=new Date(A,D-1,I);return He(E,"EEEE, MMMM d, yyyy")}catch{return t()}})())}),St(),vt();var _=ni(),p=B(_),i=B(p),e=B(i),a=W(B(e),2);z(e);var c=W(e,2),l=B(c),k=B(l),C=B(k);z(k),Je(),z(l);var x=W(l,4),N=B(x),P=W(B(N),2),M=B(P,!0);z(P),z(N);var L=W(N,2),y=W(B(L),2),S=B(y);z(y),z(L);var f=W(L,2);z(x),z(c);var v=W(c,2),b=B(v);z(v),z(i),z(p),z(_),_e(()=>{be(C,`"${s()??""}"`),be(M,n(w)),be(S,`From ${n(w)??""} onwards`)}),Se("click",a,o),Se("click",N,()=>d("single")),Se("click",L,()=>d("future")),Se("click",f,()=>d("all")),Se("click",b,o),J(g,_),at()}var ii=le('<div class="modal svelte-gu1ski" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Recurring Event</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">What would you like to delete?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">Delete the entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function si(g,m){nt(m,!1);const w=ce();let s=ge(m,"eventTitle",8),t=ge(m,"occurrenceDate",8),r=ge(m,"callback",8);function d(A){r()(A)}function o(){r()(null)}Ie(()=>(G(t()),He),()=>{O(w,(()=>{try{const[A,D,I]=t().split("-").map(Number),E=new Date(A,D-1,I);return He(E,"EEEE, MMMM d, yyyy")}catch{return t()}})())}),St(),vt();var _=ii(),p=B(_),i=B(p),e=B(i),a=W(B(e),2);z(e);var c=W(e,2),l=B(c),k=B(l),C=B(k);z(k),Je(),z(l);var x=W(l,4),N=B(x),P=W(B(N),2),M=B(P,!0);z(P),z(N);var L=W(N,2),y=W(B(L),2),S=B(y);z(y),z(L);var f=W(L,2);z(x),z(c);var v=W(c,2),b=B(v);z(v),z(i),z(p),z(_),_e(()=>{be(C,`"${s()??""}"`),be(M,n(w)),be(S,`From ${n(w)??""} onwards`)}),Se("click",a,o),Se("click",N,()=>d("single")),Se("click",L,()=>d("future")),Se("click",f,()=>d("all")),Se("click",b,o),J(g,_),at()}var li=le('<div class="modal fade" tabindex="-1" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div> <div class="modal-body"><p> </p> <div class="mb-3"><label for="cloneDate" class="form-label">Event Date</label> <input type="date" class="form-control" id="cloneDate"/></div></div> <div class="modal-footer"><button type="button"> </button> <button type="button"> </button></div></div></div></div>');function oi(g,m){nt(m,!1);let w=ge(m,"title",8,"Clone Event"),s=ge(m,"message",8,"Select a date for the cloned event:"),t=ge(m,"confirmButtonLabel",8,"Clone"),r=ge(m,"confirmButtonCSS",8,"btn-primary"),d=ge(m,"rejectButtonLabel",8,"Cancel"),o=ge(m,"rejectButtonCSS",8,"btn-secondary"),_=ge(m,"defaultDate",8,void 0),p=ge(m,"callback",8,()=>{}),i=ce(),e=ce(_()||He(new Date,"yyyy-MM-dd")),a=!1,c;Nr(()=>{const h=window.bootstrap.Modal;new h(n(i)).show(),n(i).addEventListener("hidden.bs.modal",()=>{a?p()(!0,c):p()(!1)})});function l(){a=!0,c=n(e),window.bootstrap.Modal.getInstance(n(i)).hide()}function k(){a=!1,window.bootstrap.Modal.getInstance(n(i)).hide()}vt();var C=li(),x=B(C),N=B(x),P=B(N),M=B(P),L=B(M,!0);z(M),Je(2),z(P);var y=W(P,2),S=B(y),f=B(S,!0);z(S);var v=W(S,2),b=W(B(v),2);Ke(b),z(v),z(y);var A=W(y,2),D=B(A),I=B(D,!0);z(D);var E=W(D,2),T=B(E,!0);z(E),z(A),z(N),z(x),z(C),xt(C,h=>O(i,h),()=>n(i)),_e(()=>{be(L,w()),be(f,s()),tt(D,1,`btn ${o()??""}`),be(I,d()),tt(E,1,`btn ${r()??""}`),be(T,t())}),ft(b,()=>n(e),h=>O(e,h)),Se("click",D,k),Se("click",E,l),J(g,C),at()}let Ht;function ci(g){if(typeof document>"u")return;const m=document.createElement("div");document.body.appendChild(m);const w={title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",rejectButtonLabel:"Cancel",rejectButtonCSS:"btn-secondary",callback:()=>{console.log("callback")}};g.title&&(w.title=g.title),g.message&&(w.message=g.message),g.confirmButtonLabel&&(w.confirmButtonLabel=g.confirmButtonLabel),g.confirmButtonCSS&&(w.confirmButtonCSS=g.confirmButtonCSS),g.rejectButtonLabel&&(w.rejectButtonLabel=g.rejectButtonLabel),g.rejectButtonCSS&&(w.rejectButtonCSS=g.rejectButtonCSS),g.defaultDate&&(w.defaultDate=g.defaultDate),w.callback=(s,t)=>{console.log("Clone confirm result:",s,t),Ht&&(On(Ht),Ht=void 0),m.remove(),g.callback&&typeof g.callback=="function"&&g.callback(s,t)},Ht=Un(oi,{target:m,props:w})}const di=Jn().shape({title:dt().required("Title is required").min(3,"Title must be at least 3 characters").max(255,"Title cannot exceed 255 characters"),event_type:dt().oneOf(["calendar_event","announcement"],"Invalid event type").required("Event type is required"),category:dt().required("Category is required"),description:dt().nullable().max(1e4,"Description is too long"),location:dt().nullable().max(255,"Location cannot exceed 255 characters"),dateInput:dt().when("event_type",{is:"calendar_event",then:g=>g.required("Date is required"),otherwise:g=>g.nullable()}),startTimeInput:dt().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("Start time is required"),otherwise:g=>g.nullable()}),endTimeInput:dt().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("End time is required"),otherwise:g=>g.nullable()}),isRecurring:Rr(),recurrenceFrequency:dt().oneOf(["daily","weekly","monthly","yearly"]).nullable(),recurringDays:ea().of(ta().min(0).max(6)).when(["isRecurring","recurrenceFrequency"],{is:(g,m)=>g&&m==="weekly",then:g=>g.min(1,"Select at least one day for weekly recurring events").required(),otherwise:g=>g.nullable()}),hasEndDate:Rr(),recurrenceEndDate:dt().when(["isRecurring","hasEndDate"],{is:(g,m)=>g&&m,then:g=>g.required("End date is required").test("is-future","End date must be in the future",function(m){if(!m)return!1;const w=new Date(m),s=new Date;return s.setHours(0,0,0,0),w>=s}),otherwise:g=>g.nullable()})});function ui(){const g=Gn({});async function m(t){try{return await di.validate(t,{abortEarly:!1}),g.set({}),!0}catch(r){if(r instanceof ra){const d={};return r.inner.forEach(o=>{o.path&&(d[o.path]=o.message)}),g.set(d),!1}return!1}}function w(){g.set({})}function s(){return Object.values(mr(g)).filter(r=>r.length>0)}return{validationErrors:g,validate:m,clearErrors:w,getErrorMessages:s}}function _r(g){const{frequency:m,interval:w,recurringDays:s,recurrenceEndDate:t,hasEndDate:r,monthlyType:d,startTime:o}=g,_={0:ze.SU,1:ze.MO,2:ze.TU,3:ze.WE,4:ze.TH,5:ze.FR,6:ze.SA},p={daily:ze.DAILY,weekly:ze.WEEKLY,monthly:ze.MONTHLY,yearly:ze.YEARLY},i=new Date(o),e=wt(i,Ve),a=new Date(e);a.setHours(12,0,0,0);const c=Dt(a,Ve),l={freq:p[m],interval:w,dtstart:c};if(r&&t){const C=new Date(`${t}T23:59:59.999`),x=Dt(C,Ve);l.until=x}if(m==="weekly"&&s.length>0)l.byweekday=s.map(C=>_[C]);else if(m==="monthly")if(d==="date")l.bymonthday=[a.getDate()];else{const C=Math.ceil(a.getDate()/7),x=a.getDay(),N=[ze.SU,ze.MO,ze.TU,ze.WE,ze.TH,ze.FR,ze.SA];l.byweekday=[N[x].nth(C)]}else m==="yearly"&&(l.bymonth=[a.getMonth()+1],l.bymonthday=[a.getDate()]);return{recurrence_rule:new ze(l).toString(),recurrence_end_date:r&&t?l.until.toISOString():void 0}}function Wr(g,m){try{const s=ze.fromString(g).origOptions,t={6:0,0:1,1:2,2:3,3:4,4:5,5:6},r={[ze.DAILY]:"daily",[ze.WEEKLY]:"weekly",[ze.MONTHLY]:"monthly",[ze.YEARLY]:"yearly"},d=(s.freq!==void 0?r[s.freq]:null)||"weekly",o=s.interval||1;let _=[],p="date";s.byweekday&&d==="weekly"&&(_=(Array.isArray(s.byweekday)?s.byweekday:[s.byweekday]).map(a=>{const c=typeof a=="number"?a:a.weekday;return t[c]})),d==="monthly"&&(s.bymonthday&&Array.isArray(s.bymonthday)&&s.bymonthday.length>0?p="date":s.byweekday&&(p="weekday"));let i="",e=!1;if(m){e=!0;const a=wt(new Date(m),Ve);i=He(a,"yyyy-MM-dd")}else if(s.until){e=!0;const a=wt(s.until,Ve);i=He(a,"yyyy-MM-dd")}return{frequency:d,interval:o,recurringDays:_,recurrenceEndDate:i,hasEndDate:e,monthlyType:p}}catch(w){return console.error("Failed to parse recurrence rule:",w),null}}function $r(){return{recurrence_rule:void 0,recurrence_end_date:void 0}}function Yr(){return{generateRecurrenceRule:_r,parseRecurrenceRule:Wr,clearRecurrence:$r}}const hr=Object.freeze(Object.defineProperty({__proto__:null,clearRecurrence:$r,generateRecurrenceRule:_r,parseRecurrenceRule:Wr,useRecurrenceLogic:Yr},Symbol.toStringTag,{value:"Module"}));function fi(g,m){return m.forEach(function(w){w&&typeof w!="string"&&!Array.isArray(w)&&Object.keys(w).forEach(function(s){if(s!=="default"&&!(s in g)){var t=Object.getOwnPropertyDescriptor(w,s);Object.defineProperty(g,s,t.get?t:{enumerable:!0,get:function(){return w[s]}})}})}),Object.freeze(g)}function jr(g,m){return new Promise(function(w,s){let t;return vi(g).then(function(r){try{return t=r,w(new Blob([m.slice(0,2),t,m.slice(2)],{type:"image/jpeg"}))}catch(d){return s(d)}},s)})}const vi=g=>new Promise((m,w)=>{const s=new FileReader;s.addEventListener("load",({target:{result:t}})=>{const r=new DataView(t);let d=0;if(r.getUint16(d)!==65496)return w("not a valid JPEG");for(d+=2;;){const o=r.getUint16(d);if(o===65498)break;const _=r.getUint16(d+2);if(o===65505&&r.getUint32(d+4)===1165519206){const p=d+10;let i;switch(r.getUint16(p)){case 18761:i=!0;break;case 19789:i=!1;break;default:return w("TIFF header contains invalid endian")}if(r.getUint16(p+2,i)!==42)return w("TIFF header contains invalid version");const e=r.getUint32(p+4,i),a=p+e+2+12*r.getUint16(p+e,i);for(let c=p+e+2;c<a;c+=12)if(r.getUint16(c,i)==274){if(r.getUint16(c+2,i)!==3)return w("Orientation data type is invalid");if(r.getUint32(c+4,i)!==1)return w("Orientation data count is invalid");r.setUint16(c+8,1,i);break}return m(t.slice(d,d+2+_))}d+=2+_}return m(new Blob)}),s.readAsArrayBuffer(g)});var Qt={},mi={get exports(){return Qt},set exports(g){Qt=g}};(function(g){var m,w,s={};mi.exports=s,s.parse=function(t,r){for(var d=s.bin.readUshort,o=s.bin.readUint,_=0,p={},i=new Uint8Array(t),e=i.length-4;o(i,e)!=101010256;)e--;_=e,_+=4;var a=d(i,_+=4);d(i,_+=2);var c=o(i,_+=2),l=o(i,_+=4);_+=4,_=l;for(var k=0;k<a;k++){o(i,_),_+=4,_+=4,_+=4,o(i,_+=4),c=o(i,_+=4);var C=o(i,_+=4),x=d(i,_+=4),N=d(i,_+2),P=d(i,_+4);_+=6;var M=o(i,_+=8);_+=4,_+=x+N+P,s._readLocal(i,M,p,c,C,r)}return p},s._readLocal=function(t,r,d,o,_,p){var i=s.bin.readUshort,e=s.bin.readUint;e(t,r),i(t,r+=4),i(t,r+=2);var a=i(t,r+=2);e(t,r+=2),e(t,r+=4),r+=4;var c=i(t,r+=8),l=i(t,r+=2);r+=2;var k=s.bin.readUTF8(t,r,c);if(r+=c,r+=l,p)d[k]={size:_,csize:o};else{var C=new Uint8Array(t.buffer,r);if(a==0)d[k]=new Uint8Array(C.buffer.slice(r,r+o));else{if(a!=8)throw"unknown compression method: "+a;var x=new Uint8Array(_);s.inflateRaw(C,x),d[k]=x}}},s.inflateRaw=function(t,r){return s.F.inflate(t,r)},s.inflate=function(t,r){return t[0],t[1],s.inflateRaw(new Uint8Array(t.buffer,t.byteOffset+2,t.length-6),r)},s.deflate=function(t,r){r==null&&(r={level:6});var d=0,o=new Uint8Array(50+Math.floor(1.1*t.length));o[d]=120,o[d+1]=156,d+=2,d=s.F.deflateRaw(t,o,d,r.level);var _=s.adler(t,0,t.length);return o[d+0]=_>>>24&255,o[d+1]=_>>>16&255,o[d+2]=_>>>8&255,o[d+3]=_>>>0&255,new Uint8Array(o.buffer,0,d+4)},s.deflateRaw=function(t,r){r==null&&(r={level:6});var d=new Uint8Array(50+Math.floor(1.1*t.length)),o=s.F.deflateRaw(t,d,o,r.level);return new Uint8Array(d.buffer,0,o)},s.encode=function(t,r){r==null&&(r=!1);var d=0,o=s.bin.writeUint,_=s.bin.writeUshort,p={};for(var i in t){var e=!s._noNeed(i)&&!r,a=t[i],c=s.crc.crc(a,0,a.length);p[i]={cpr:e,usize:a.length,crc:c,file:e?s.deflateRaw(a):a}}for(var i in p)d+=p[i].file.length+30+46+2*s.bin.sizeUTF8(i);d+=22;var l=new Uint8Array(d),k=0,C=[];for(var i in p){var x=p[i];C.push(k),k=s._writeHeader(l,k,i,x,0)}var N=0,P=k;for(var i in p)x=p[i],C.push(k),k=s._writeHeader(l,k,i,x,1,C[N++]);var M=k-P;return o(l,k,101010256),k+=4,_(l,k+=4,N),_(l,k+=2,N),o(l,k+=2,M),o(l,k+=4,P),k+=4,k+=2,l.buffer},s._noNeed=function(t){var r=t.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(r)!=-1},s._writeHeader=function(t,r,d,o,_,p){var i=s.bin.writeUint,e=s.bin.writeUshort,a=o.file;return i(t,r,_==0?67324752:33639248),r+=4,_==1&&(r+=2),e(t,r,20),e(t,r+=2,0),e(t,r+=2,o.cpr?8:0),i(t,r+=2,0),i(t,r+=4,o.crc),i(t,r+=4,a.length),i(t,r+=4,o.usize),e(t,r+=4,s.bin.sizeUTF8(d)),e(t,r+=2,0),r+=2,_==1&&(r+=2,r+=2,i(t,r+=6,p),r+=4),r+=s.bin.writeUTF8(t,r,d),_==0&&(t.set(a,r),r+=a.length),r},s.crc={table:function(){for(var t=new Uint32Array(256),r=0;r<256;r++){for(var d=r,o=0;o<8;o++)1&d?d=3988292384^d>>>1:d>>>=1;t[r]=d}return t}(),update:function(t,r,d,o){for(var _=0;_<o;_++)t=s.crc.table[255&(t^r[d+_])]^t>>>8;return t},crc:function(t,r,d){return 4294967295^s.crc.update(4294967295,t,r,d)}},s.adler=function(t,r,d){for(var o=1,_=0,p=r,i=r+d;p<i;){for(var e=Math.min(p+5552,i);p<e;)_+=o+=t[p++];o%=65521,_%=65521}return _<<16|o},s.bin={readUshort:function(t,r){return t[r]|t[r+1]<<8},writeUshort:function(t,r,d){t[r]=255&d,t[r+1]=d>>8&255},readUint:function(t,r){return 16777216*t[r+3]+(t[r+2]<<16|t[r+1]<<8|t[r])},writeUint:function(t,r,d){t[r]=255&d,t[r+1]=d>>8&255,t[r+2]=d>>16&255,t[r+3]=d>>24&255},readASCII:function(t,r,d){for(var o="",_=0;_<d;_++)o+=String.fromCharCode(t[r+_]);return o},writeASCII:function(t,r,d){for(var o=0;o<d.length;o++)t[r+o]=d.charCodeAt(o)},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(t,r,d){for(var o,_="",p=0;p<d;p++)_+="%"+s.bin.pad(t[r+p].toString(16));try{o=decodeURIComponent(_)}catch{return s.bin.readASCII(t,r,d)}return o},writeUTF8:function(t,r,d){for(var o=d.length,_=0,p=0;p<o;p++){var i=d.charCodeAt(p);if(!(4294967168&i))t[r+_]=i,_++;else if(!(4294965248&i))t[r+_]=192|i>>6,t[r+_+1]=128|i>>0&63,_+=2;else if(!(4294901760&i))t[r+_]=224|i>>12,t[r+_+1]=128|i>>6&63,t[r+_+2]=128|i>>0&63,_+=3;else{if(4292870144&i)throw"e";t[r+_]=240|i>>18,t[r+_+1]=128|i>>12&63,t[r+_+2]=128|i>>6&63,t[r+_+3]=128|i>>0&63,_+=4}}return _},sizeUTF8:function(t){for(var r=t.length,d=0,o=0;o<r;o++){var _=t.charCodeAt(o);if(!(4294967168&_))d++;else if(!(4294965248&_))d+=2;else if(!(4294901760&_))d+=3;else{if(4292870144&_)throw"e";d+=4}}return d}},s.F={},s.F.deflateRaw=function(t,r,d,o){var _=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],p=s.F.U,i=s.F._goodIndex;s.F._hash;var e=s.F._putsE,a=0,c=d<<3,l=0,k=t.length;if(o==0){for(;a<k;)e(r,c,a+(A=Math.min(65535,k-a))==k?1:0),c=s.F._copyExact(t,a,A,r,c+8),a+=A;return c>>>3}var C=p.lits,x=p.strt,N=p.prev,P=0,M=0,L=0,y=0,S=0,f=0;for(k>2&&(x[f=s.F._hash(t,0)]=0),a=0;a<k;a++){if(S=f,a+1<k-2){f=s.F._hash(t,a+1);var v=a+1&32767;N[v]=x[f],x[f]=v}if(l<=a){(P>14e3||M>26697)&&k-a>100&&(l<a&&(C[P]=a-l,P+=2,l=a),c=s.F._writeBlock(a==k-1||l==k?1:0,C,P,y,t,L,a-L,r,c),P=M=y=0,L=a);var b=0;a<k-2&&(b=s.F._bestMatch(t,a,N,S,Math.min(_[2],k-a),_[3]));var A=b>>>16,D=65535&b;if(b!=0){D=65535&b;var I=i(A=b>>>16,p.of0);p.lhst[257+I]++;var E=i(D,p.df0);p.dhst[E]++,y+=p.exb[I]+p.dxb[E],C[P]=A<<23|a-l,C[P+1]=D<<16|I<<8|E,P+=2,l=a+A}else p.lhst[t[a]]++;M++}}for(L==a&&t.length!=0||(l<a&&(C[P]=a-l,P+=2,l=a),c=s.F._writeBlock(1,C,P,y,t,L,a-L,r,c),P=0,M=0,P=M=y=0,L=a);7&c;)c++;return c>>>3},s.F._bestMatch=function(t,r,d,o,_,p){var i=32767&r,e=d[i],a=i-e+32768&32767;if(e==i||o!=s.F._hash(t,r-a))return 0;for(var c=0,l=0,k=Math.min(32767,r);a<=k&&--p!=0&&e!=i;){if(c==0||t[r+c]==t[r+c-a]){var C=s.F._howLong(t,r,a);if(C>c){if(l=a,(c=C)>=_)break;a+2<C&&(C=a+2);for(var x=0,N=0;N<C-2;N++){var P=r-a+N+32768&32767,M=P-d[P]+32768&32767;M>x&&(x=M,e=P)}}}a+=(i=e)-(e=d[i])+32768&32767}return c<<16|l},s.F._howLong=function(t,r,d){if(t[r]!=t[r-d]||t[r+1]!=t[r+1-d]||t[r+2]!=t[r+2-d])return 0;var o=r,_=Math.min(t.length,r+258);for(r+=3;r<_&&t[r]==t[r-d];)r++;return r-o},s.F._hash=function(t,r){return(t[r]<<8|t[r+1])+(t[r+2]<<4)&65535},s.saved=0,s.F._writeBlock=function(t,r,d,o,_,p,i,e,a){var c,l,k,C,x,N,P,M,L,y=s.F.U,S=s.F._putsF,f=s.F._putsE;y.lhst[256]++,l=(c=s.F.getTrees())[0],k=c[1],C=c[2],x=c[3],N=c[4],P=c[5],M=c[6],L=c[7];var v=32+(a+3&7?8-(a+3&7):0)+(i<<3),b=o+s.F.contSize(y.fltree,y.lhst)+s.F.contSize(y.fdtree,y.dhst),A=o+s.F.contSize(y.ltree,y.lhst)+s.F.contSize(y.dtree,y.dhst);A+=14+3*P+s.F.contSize(y.itree,y.ihst)+(2*y.ihst[16]+3*y.ihst[17]+7*y.ihst[18]);for(var D=0;D<286;D++)y.lhst[D]=0;for(D=0;D<30;D++)y.dhst[D]=0;for(D=0;D<19;D++)y.ihst[D]=0;var I=v<b&&v<A?0:b<A?1:2;if(S(e,a,t),S(e,a+1,I),a+=3,I==0){for(;7&a;)a++;a=s.F._copyExact(_,p,i,e,a)}else{var E,T;if(I==1&&(E=y.fltree,T=y.fdtree),I==2){s.F.makeCodes(y.ltree,l),s.F.revCodes(y.ltree,l),s.F.makeCodes(y.dtree,k),s.F.revCodes(y.dtree,k),s.F.makeCodes(y.itree,C),s.F.revCodes(y.itree,C),E=y.ltree,T=y.dtree,f(e,a,x-257),f(e,a+=5,N-1),f(e,a+=5,P-4),a+=4;for(var h=0;h<P;h++)f(e,a+3*h,y.itree[1+(y.ordr[h]<<1)]);a+=3*P,a=s.F._codeTiny(M,y.itree,e,a),a=s.F._codeTiny(L,y.itree,e,a)}for(var u=p,q=0;q<d;q+=2){for(var R=r[q],U=R>>>23,K=u+(8388607&R);u<K;)a=s.F._writeLit(_[u++],E,e,a);if(U!=0){var Y=r[q+1],$=Y>>16,H=Y>>8&255,F=255&Y;f(e,a=s.F._writeLit(257+H,E,e,a),U-y.of0[H]),a+=y.exb[H],S(e,a=s.F._writeLit(F,T,e,a),$-y.df0[F]),a+=y.dxb[F],u+=U}}a=s.F._writeLit(256,E,e,a)}return a},s.F._copyExact=function(t,r,d,o,_){var p=_>>>3;return o[p]=d,o[p+1]=d>>>8,o[p+2]=255-o[p],o[p+3]=255-o[p+1],p+=4,o.set(new Uint8Array(t.buffer,r,d),p),_+(d+4<<3)},s.F.getTrees=function(){for(var t=s.F.U,r=s.F._hufTree(t.lhst,t.ltree,15),d=s.F._hufTree(t.dhst,t.dtree,15),o=[],_=s.F._lenCodes(t.ltree,o),p=[],i=s.F._lenCodes(t.dtree,p),e=0;e<o.length;e+=2)t.ihst[o[e]]++;for(e=0;e<p.length;e+=2)t.ihst[p[e]]++;for(var a=s.F._hufTree(t.ihst,t.itree,7),c=19;c>4&&t.itree[1+(t.ordr[c-1]<<1)]==0;)c--;return[r,d,a,_,i,c,o,p]},s.F.getSecond=function(t){for(var r=[],d=0;d<t.length;d+=2)r.push(t[d+1]);return r},s.F.nonZero=function(t){for(var r="",d=0;d<t.length;d+=2)t[d+1]!=0&&(r+=(d>>1)+",");return r},s.F.contSize=function(t,r){for(var d=0,o=0;o<r.length;o++)d+=r[o]*t[1+(o<<1)];return d},s.F._codeTiny=function(t,r,d,o){for(var _=0;_<t.length;_+=2){var p=t[_],i=t[_+1];o=s.F._writeLit(p,r,d,o);var e=p==16?2:p==17?3:7;p>15&&(s.F._putsE(d,o,i,e),o+=e)}return o},s.F._lenCodes=function(t,r){for(var d=t.length;d!=2&&t[d-1]==0;)d-=2;for(var o=0;o<d;o+=2){var _=t[o+1],p=o+3<d?t[o+3]:-1,i=o+5<d?t[o+5]:-1,e=o==0?-1:t[o-1];if(_==0&&p==_&&i==_){for(var a=o+5;a+2<d&&t[a+2]==_;)a+=2;(c=Math.min(a+1-o>>>1,138))<11?r.push(17,c-3):r.push(18,c-11),o+=2*c-2}else if(_==e&&p==_&&i==_){for(a=o+5;a+2<d&&t[a+2]==_;)a+=2;var c=Math.min(a+1-o>>>1,6);r.push(16,c-3),o+=2*c-2}else r.push(_,0)}return d>>>1},s.F._hufTree=function(t,r,d){var o=[],_=t.length,p=r.length,i=0;for(i=0;i<p;i+=2)r[i]=0,r[i+1]=0;for(i=0;i<_;i++)t[i]!=0&&o.push({lit:i,f:t[i]});var e=o.length,a=o.slice(0);if(e==0)return 0;if(e==1){var c=o[0].lit;return a=c==0?1:0,r[1+(c<<1)]=1,r[1+(a<<1)]=1,1}o.sort(function(M,L){return M.f-L.f});var l=o[0],k=o[1],C=0,x=1,N=2;for(o[0]={lit:-1,f:l.f+k.f,l,r:k,d:0};x!=e-1;)l=C!=x&&(N==e||o[C].f<o[N].f)?o[C++]:o[N++],k=C!=x&&(N==e||o[C].f<o[N].f)?o[C++]:o[N++],o[x++]={lit:-1,f:l.f+k.f,l,r:k};var P=s.F.setDepth(o[x-1],0);for(P>d&&(s.F.restrictDepth(a,d,P),P=d),i=0;i<e;i++)r[1+(a[i].lit<<1)]=a[i].d;return P},s.F.setDepth=function(t,r){return t.lit!=-1?(t.d=r,r):Math.max(s.F.setDepth(t.l,r+1),s.F.setDepth(t.r,r+1))},s.F.restrictDepth=function(t,r,d){var o=0,_=1<<d-r,p=0;for(t.sort(function(e,a){return a.d==e.d?e.f-a.f:a.d-e.d}),o=0;o<t.length&&t[o].d>r;o++){var i=t[o].d;t[o].d=r,p+=_-(1<<d-i)}for(p>>>=d-r;p>0;)(i=t[o].d)<r?(t[o].d++,p-=1<<r-i-1):o++;for(;o>=0;o--)t[o].d==r&&p<0&&(t[o].d--,p++);p!=0&&console.log("debt left")},s.F._goodIndex=function(t,r){var d=0;return r[16|d]<=t&&(d|=16),r[8|d]<=t&&(d|=8),r[4|d]<=t&&(d|=4),r[2|d]<=t&&(d|=2),r[1|d]<=t&&(d|=1),d},s.F._writeLit=function(t,r,d,o){return s.F._putsF(d,o,r[t<<1]),o+r[1+(t<<1)]},s.F.inflate=function(t,r){var d=Uint8Array;if(t[0]==3&&t[1]==0)return r||new d(0);var o=s.F,_=o._bitsF,p=o._bitsE,i=o._decodeTiny,e=o.makeCodes,a=o.codes2map,c=o._get17,l=o.U,k=r==null;k&&(r=new d(t.length>>>2<<3));for(var C,x,N=0,P=0,M=0,L=0,y=0,S=0,f=0,v=0,b=0;N==0;)if(N=_(t,b,1),P=_(t,b+1,2),b+=3,P!=0){if(k&&(r=s.F._check(r,v+(1<<17))),P==1&&(C=l.flmap,x=l.fdmap,S=511,f=31),P==2){M=p(t,b,5)+257,L=p(t,b+5,5)+1,y=p(t,b+10,4)+4,b+=14;for(var A=0;A<38;A+=2)l.itree[A]=0,l.itree[A+1]=0;var D=1;for(A=0;A<y;A++){var I=p(t,b+3*A,3);l.itree[1+(l.ordr[A]<<1)]=I,I>D&&(D=I)}b+=3*y,e(l.itree,D),a(l.itree,D,l.imap),C=l.lmap,x=l.dmap,b=i(l.imap,(1<<D)-1,M+L,t,b,l.ttree);var E=o._copyOut(l.ttree,0,M,l.ltree);S=(1<<E)-1;var T=o._copyOut(l.ttree,M,L,l.dtree);f=(1<<T)-1,e(l.ltree,E),a(l.ltree,E,C),e(l.dtree,T),a(l.dtree,T,x)}for(;;){var h=C[c(t,b)&S];b+=15&h;var u=h>>>4;if(!(u>>>8))r[v++]=u;else{if(u==256)break;var q=v+u-254;if(u>264){var R=l.ldef[u-257];q=v+(R>>>3)+p(t,b,7&R),b+=7&R}var U=x[c(t,b)&f];b+=15&U;var K=U>>>4,Y=l.ddef[K],$=(Y>>>4)+_(t,b,15&Y);for(b+=15&Y,k&&(r=s.F._check(r,v+(1<<17)));v<q;)r[v]=r[v++-$],r[v]=r[v++-$],r[v]=r[v++-$],r[v]=r[v++-$];v=q}}}else{7&b&&(b+=8-(7&b));var H=4+(b>>>3),F=t[H-4]|t[H-3]<<8;k&&(r=s.F._check(r,v+F)),r.set(new d(t.buffer,t.byteOffset+H,F),v),b=H+F<<3,v+=F}return r.length==v?r:r.slice(0,v)},s.F._check=function(t,r){var d=t.length;if(r<=d)return t;var o=new Uint8Array(Math.max(d<<1,r));return o.set(t,0),o},s.F._decodeTiny=function(t,r,d,o,_,p){for(var i=s.F._bitsE,e=s.F._get17,a=0;a<d;){var c=t[e(o,_)&r];_+=15&c;var l=c>>>4;if(l<=15)p[a]=l,a++;else{var k=0,C=0;l==16?(C=3+i(o,_,2),_+=2,k=p[a-1]):l==17?(C=3+i(o,_,3),_+=3):l==18&&(C=11+i(o,_,7),_+=7);for(var x=a+C;a<x;)p[a]=k,a++}}return _},s.F._copyOut=function(t,r,d,o){for(var _=0,p=0,i=o.length>>>1;p<d;){var e=t[p+r];o[p<<1]=0,o[1+(p<<1)]=e,e>_&&(_=e),p++}for(;p<i;)o[p<<1]=0,o[1+(p<<1)]=0,p++;return _},s.F.makeCodes=function(t,r){for(var d,o,_,p,i=s.F.U,e=t.length,a=i.bl_count,c=0;c<=r;c++)a[c]=0;for(c=1;c<e;c+=2)a[t[c]]++;var l=i.next_code;for(d=0,a[0]=0,o=1;o<=r;o++)d=d+a[o-1]<<1,l[o]=d;for(_=0;_<e;_+=2)(p=t[_+1])!=0&&(t[_]=l[p],l[p]++)},s.F.codes2map=function(t,r,d){for(var o=t.length,_=s.F.U.rev15,p=0;p<o;p+=2)if(t[p+1]!=0)for(var i=p>>1,e=t[p+1],a=i<<4|e,c=r-e,l=t[p]<<c,k=l+(1<<c);l!=k;)d[_[l]>>>15-r]=a,l++},s.F.revCodes=function(t,r){for(var d=s.F.U.rev15,o=15-r,_=0;_<t.length;_+=2){var p=t[_]<<r-t[_+1];t[_]=d[p]>>>o}},s.F._putsE=function(t,r,d){d<<=7&r;var o=r>>>3;t[o]|=d,t[o+1]|=d>>>8},s.F._putsF=function(t,r,d){d<<=7&r;var o=r>>>3;t[o]|=d,t[o+1]|=d>>>8,t[o+2]|=d>>>16},s.F._bitsE=function(t,r,d){return(t[r>>>3]|t[1+(r>>>3)]<<8)>>>(7&r)&(1<<d)-1},s.F._bitsF=function(t,r,d){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16)>>>(7&r)&(1<<d)-1},s.F._get17=function(t,r){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16)>>>(7&r)},s.F._get25=function(t,r){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16|t[3+(r>>>3)]<<24)>>>(7&r)},s.F.U=(m=Uint16Array,w=Uint32Array,{next_code:new m(16),bl_count:new m(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new m(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new w(32),flmap:new m(512),fltree:[],fdmap:new m(32),fdtree:[],lmap:new m(32768),ltree:[],ttree:[],dmap:new m(32768),dtree:[],imap:new m(512),itree:[],rev15:new m(32768),lhst:new w(286),dhst:new w(30),ihst:new w(19),lits:new w(15e3),strt:new m(65536),prev:new m(32768)}),function(){for(var t=s.F.U,r=0;r<32768;r++){var d=r;d=(4278255360&(d=(4042322160&(d=(3435973836&(d=(2863311530&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8,t.rev15[r]=(d>>>16|d<<16)>>>17}function o(_,p,i){for(;p--!=0;)_.push(0,i)}for(r=0;r<32;r++)t.ldef[r]=t.of0[r]<<3|t.exb[r],t.ddef[r]=t.df0[r]<<4|t.dxb[r];o(t.fltree,144,8),o(t.fltree,112,9),o(t.fltree,24,7),o(t.fltree,8,8),s.F.makeCodes(t.fltree,9),s.F.codes2map(t.fltree,9,t.flmap),s.F.revCodes(t.fltree,9),o(t.fdtree,32,5),s.F.makeCodes(t.fdtree,5),s.F.codes2map(t.fdtree,5,t.fdmap),s.F.revCodes(t.fdtree,5),o(t.itree,19,0),o(t.ltree,286,0),o(t.dtree,30,0),o(t.ttree,320,0)}()})();var hi=fi({__proto__:null,default:Qt},[Qt]);const rt=function(){var g={nextZero(i,e){for(;i[e]!=0;)e++;return e},readUshort:(i,e)=>i[e]<<8|i[e+1],writeUshort(i,e,a){i[e]=a>>8&255,i[e+1]=255&a},readUint:(i,e)=>16777216*i[e]+(i[e+1]<<16|i[e+2]<<8|i[e+3]),writeUint(i,e,a){i[e]=a>>24&255,i[e+1]=a>>16&255,i[e+2]=a>>8&255,i[e+3]=255&a},readASCII(i,e,a){let c="";for(let l=0;l<a;l++)c+=String.fromCharCode(i[e+l]);return c},writeASCII(i,e,a){for(let c=0;c<a.length;c++)i[e+c]=a.charCodeAt(c)},readBytes(i,e,a){const c=[];for(let l=0;l<a;l++)c.push(i[e+l]);return c},pad:i=>i.length<2?`0${i}`:i,readUTF8(i,e,a){let c,l="";for(let k=0;k<a;k++)l+=`%${g.pad(i[e+k].toString(16))}`;try{c=decodeURIComponent(l)}catch{return g.readASCII(i,e,a)}return c}};function m(i,e,a,c){const l=e*a,k=r(c),C=Math.ceil(e*k/8),x=new Uint8Array(4*l),N=new Uint32Array(x.buffer),{ctype:P}=c,{depth:M}=c,L=g.readUshort;if(P==6){const R=l<<2;if(M==8)for(var y=0;y<R;y+=4)x[y]=i[y],x[y+1]=i[y+1],x[y+2]=i[y+2],x[y+3]=i[y+3];if(M==16)for(y=0;y<R;y++)x[y]=i[y<<1]}else if(P==2){const R=c.tabs.tRNS;if(R==null){if(M==8)for(y=0;y<l;y++){var S=3*y;N[y]=255<<24|i[S+2]<<16|i[S+1]<<8|i[S]}if(M==16)for(y=0;y<l;y++)S=6*y,N[y]=255<<24|i[S+4]<<16|i[S+2]<<8|i[S]}else{var f=R[0];const U=R[1],K=R[2];if(M==8)for(y=0;y<l;y++){var v=y<<2;S=3*y,N[y]=255<<24|i[S+2]<<16|i[S+1]<<8|i[S],i[S]==f&&i[S+1]==U&&i[S+2]==K&&(x[v+3]=0)}if(M==16)for(y=0;y<l;y++)v=y<<2,S=6*y,N[y]=255<<24|i[S+4]<<16|i[S+2]<<8|i[S],L(i,S)==f&&L(i,S+2)==U&&L(i,S+4)==K&&(x[v+3]=0)}}else if(P==3){const R=c.tabs.PLTE,U=c.tabs.tRNS,K=U?U.length:0;if(M==1)for(var b=0;b<a;b++){var A=b*C,D=b*e;for(y=0;y<e;y++){v=D+y<<2;var I=3*(E=i[A+(y>>3)]>>7-((7&y)<<0)&1);x[v]=R[I],x[v+1]=R[I+1],x[v+2]=R[I+2],x[v+3]=E<K?U[E]:255}}if(M==2)for(b=0;b<a;b++)for(A=b*C,D=b*e,y=0;y<e;y++)v=D+y<<2,I=3*(E=i[A+(y>>2)]>>6-((3&y)<<1)&3),x[v]=R[I],x[v+1]=R[I+1],x[v+2]=R[I+2],x[v+3]=E<K?U[E]:255;if(M==4)for(b=0;b<a;b++)for(A=b*C,D=b*e,y=0;y<e;y++)v=D+y<<2,I=3*(E=i[A+(y>>1)]>>4-((1&y)<<2)&15),x[v]=R[I],x[v+1]=R[I+1],x[v+2]=R[I+2],x[v+3]=E<K?U[E]:255;if(M==8)for(y=0;y<l;y++){var E;v=y<<2,I=3*(E=i[y]),x[v]=R[I],x[v+1]=R[I+1],x[v+2]=R[I+2],x[v+3]=E<K?U[E]:255}}else if(P==4){if(M==8)for(y=0;y<l;y++){v=y<<2;var T=i[h=y<<1];x[v]=T,x[v+1]=T,x[v+2]=T,x[v+3]=i[h+1]}if(M==16)for(y=0;y<l;y++){var h;v=y<<2,T=i[h=y<<2],x[v]=T,x[v+1]=T,x[v+2]=T,x[v+3]=i[h+2]}}else if(P==0)for(f=c.tabs.tRNS?c.tabs.tRNS:-1,b=0;b<a;b++){const R=b*C,U=b*e;if(M==1)for(var u=0;u<e;u++){var q=(T=255*(i[R+(u>>>3)]>>>7-(7&u)&1))==255*f?0:255;N[U+u]=q<<24|T<<16|T<<8|T}else if(M==2)for(u=0;u<e;u++)q=(T=85*(i[R+(u>>>2)]>>>6-((3&u)<<1)&3))==85*f?0:255,N[U+u]=q<<24|T<<16|T<<8|T;else if(M==4)for(u=0;u<e;u++)q=(T=17*(i[R+(u>>>1)]>>>4-((1&u)<<2)&15))==17*f?0:255,N[U+u]=q<<24|T<<16|T<<8|T;else if(M==8)for(u=0;u<e;u++)q=(T=i[R+u])==f?0:255,N[U+u]=q<<24|T<<16|T<<8|T;else if(M==16)for(u=0;u<e;u++)T=i[R+(u<<1)],q=L(i,R+(u<<1))==f?0:255,N[U+u]=q<<24|T<<16|T<<8|T}return x}function w(i,e,a,c){const l=r(i),k=Math.ceil(a*l/8),C=new Uint8Array((k+1+i.interlace)*c);return e=i.tabs.CgBI?t(e,C):s(e,C),i.interlace==0?e=d(e,i,0,a,c):i.interlace==1&&(e=function(N,P){const M=P.width,L=P.height,y=r(P),S=y>>3,f=Math.ceil(M*y/8),v=new Uint8Array(L*f);let b=0;const A=[0,0,4,0,2,0,1],D=[0,4,0,2,0,1,0],I=[8,8,8,4,4,2,2],E=[8,8,4,4,2,2,1];let T=0;for(;T<7;){const u=I[T],q=E[T];let R=0,U=0,K=A[T];for(;K<L;)K+=u,U++;let Y=D[T];for(;Y<M;)Y+=q,R++;const $=Math.ceil(R*y/8);d(N,P,b,R,U);let H=0,F=A[T];for(;F<L;){let ee=D[T],ue=b+H*$<<3;for(;ee<M;){var h;if(y==1&&(h=(h=N[ue>>3])>>7-(7&ue)&1,v[F*f+(ee>>3)]|=h<<7-((7&ee)<<0)),y==2&&(h=(h=N[ue>>3])>>6-(7&ue)&3,v[F*f+(ee>>2)]|=h<<6-((3&ee)<<1)),y==4&&(h=(h=N[ue>>3])>>4-(7&ue)&15,v[F*f+(ee>>1)]|=h<<4-((1&ee)<<2)),y>=8){const he=F*f+ee*S;for(let fe=0;fe<S;fe++)v[he+fe]=N[(ue>>3)+fe]}ue+=y,ee+=q}H++,F+=u}R*U!=0&&(b+=U*(1+$)),T+=1}return v}(e,i)),e}function s(i,e){return t(new Uint8Array(i.buffer,2,i.length-6),e)}var t=function(){const i={H:{}};return i.H.N=function(e,a){const c=Uint8Array;let l,k,C=0,x=0,N=0,P=0,M=0,L=0,y=0,S=0,f=0;if(e[0]==3&&e[1]==0)return a||new c(0);const v=i.H,b=v.b,A=v.e,D=v.R,I=v.n,E=v.A,T=v.Z,h=v.m,u=a==null;for(u&&(a=new c(e.length>>>2<<5));C==0;)if(C=b(e,f,1),x=b(e,f+1,2),f+=3,x!=0){if(u&&(a=i.H.W(a,S+(1<<17))),x==1&&(l=h.J,k=h.h,L=511,y=31),x==2){N=A(e,f,5)+257,P=A(e,f+5,5)+1,M=A(e,f+10,4)+4,f+=14;let R=1;for(var q=0;q<38;q+=2)h.Q[q]=0,h.Q[q+1]=0;for(q=0;q<M;q++){const Y=A(e,f+3*q,3);h.Q[1+(h.X[q]<<1)]=Y,Y>R&&(R=Y)}f+=3*M,I(h.Q,R),E(h.Q,R,h.u),l=h.w,k=h.d,f=D(h.u,(1<<R)-1,N+P,e,f,h.v);const U=v.V(h.v,0,N,h.C);L=(1<<U)-1;const K=v.V(h.v,N,P,h.D);y=(1<<K)-1,I(h.C,U),E(h.C,U,l),I(h.D,K),E(h.D,K,k)}for(;;){const R=l[T(e,f)&L];f+=15&R;const U=R>>>4;if(!(U>>>8))a[S++]=U;else{if(U==256)break;{let K=S+U-254;if(U>264){const ee=h.q[U-257];K=S+(ee>>>3)+A(e,f,7&ee),f+=7&ee}const Y=k[T(e,f)&y];f+=15&Y;const $=Y>>>4,H=h.c[$],F=(H>>>4)+b(e,f,15&H);for(f+=15&H;S<K;)a[S]=a[S++-F],a[S]=a[S++-F],a[S]=a[S++-F],a[S]=a[S++-F];S=K}}}}else{7&f&&(f+=8-(7&f));const R=4+(f>>>3),U=e[R-4]|e[R-3]<<8;u&&(a=i.H.W(a,S+U)),a.set(new c(e.buffer,e.byteOffset+R,U),S),f=R+U<<3,S+=U}return a.length==S?a:a.slice(0,S)},i.H.W=function(e,a){const c=e.length;if(a<=c)return e;const l=new Uint8Array(c<<1);return l.set(e,0),l},i.H.R=function(e,a,c,l,k,C){const x=i.H.e,N=i.H.Z;let P=0;for(;P<c;){const M=e[N(l,k)&a];k+=15&M;const L=M>>>4;if(L<=15)C[P]=L,P++;else{let y=0,S=0;L==16?(S=3+x(l,k,2),k+=2,y=C[P-1]):L==17?(S=3+x(l,k,3),k+=3):L==18&&(S=11+x(l,k,7),k+=7);const f=P+S;for(;P<f;)C[P]=y,P++}}return k},i.H.V=function(e,a,c,l){let k=0,C=0;const x=l.length>>>1;for(;C<c;){const N=e[C+a];l[C<<1]=0,l[1+(C<<1)]=N,N>k&&(k=N),C++}for(;C<x;)l[C<<1]=0,l[1+(C<<1)]=0,C++;return k},i.H.n=function(e,a){const c=i.H.m,l=e.length;let k,C,x,N;const P=c.j;for(var M=0;M<=a;M++)P[M]=0;for(M=1;M<l;M+=2)P[e[M]]++;const L=c.K;for(k=0,P[0]=0,C=1;C<=a;C++)k=k+P[C-1]<<1,L[C]=k;for(x=0;x<l;x+=2)N=e[x+1],N!=0&&(e[x]=L[N],L[N]++)},i.H.A=function(e,a,c){const l=e.length,k=i.H.m.r;for(let C=0;C<l;C+=2)if(e[C+1]!=0){const x=C>>1,N=e[C+1],P=x<<4|N,M=a-N;let L=e[C]<<M;const y=L+(1<<M);for(;L!=y;)c[k[L]>>>15-a]=P,L++}},i.H.l=function(e,a){const c=i.H.m.r,l=15-a;for(let k=0;k<e.length;k+=2){const C=e[k]<<a-e[k+1];e[k]=c[C]>>>l}},i.H.M=function(e,a,c){c<<=7&a;const l=a>>>3;e[l]|=c,e[l+1]|=c>>>8},i.H.I=function(e,a,c){c<<=7&a;const l=a>>>3;e[l]|=c,e[l+1]|=c>>>8,e[l+2]|=c>>>16},i.H.e=function(e,a,c){return(e[a>>>3]|e[1+(a>>>3)]<<8)>>>(7&a)&(1<<c)-1},i.H.b=function(e,a,c){return(e[a>>>3]|e[1+(a>>>3)]<<8|e[2+(a>>>3)]<<16)>>>(7&a)&(1<<c)-1},i.H.Z=function(e,a){return(e[a>>>3]|e[1+(a>>>3)]<<8|e[2+(a>>>3)]<<16)>>>(7&a)},i.H.i=function(e,a){return(e[a>>>3]|e[1+(a>>>3)]<<8|e[2+(a>>>3)]<<16|e[3+(a>>>3)]<<24)>>>(7&a)},i.H.m=function(){const e=Uint16Array,a=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new a(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new a(286),Y:new a(30),a:new a(19),t:new a(15e3),k:new e(65536),g:new e(32768)}}(),function(){const e=i.H.m;for(var a=0;a<32768;a++){let l=a;l=(2863311530&l)>>>1|(1431655765&l)<<1,l=(3435973836&l)>>>2|(858993459&l)<<2,l=(4042322160&l)>>>4|(252645135&l)<<4,l=(4278255360&l)>>>8|(16711935&l)<<8,e.r[a]=(l>>>16|l<<16)>>>17}function c(l,k,C){for(;k--!=0;)l.push(0,C)}for(a=0;a<32;a++)e.q[a]=e.S[a]<<3|e.T[a],e.c[a]=e.p[a]<<4|e.z[a];c(e._,144,8),c(e._,112,9),c(e._,24,7),c(e._,8,8),i.H.n(e._,9),i.H.A(e._,9,e.J),i.H.l(e._,9),c(e.$,32,5),i.H.n(e.$,5),i.H.A(e.$,5,e.h),i.H.l(e.$,5),c(e.Q,19,0),c(e.C,286,0),c(e.D,30,0),c(e.v,320,0)}(),i.H.N}();function r(i){return[1,null,3,1,2,null,4][i.ctype]*i.depth}function d(i,e,a,c,l){let k=r(e);const C=Math.ceil(c*k/8);let x,N;k=Math.ceil(k/8);let P=i[a],M=0;if(P>1&&(i[a]=[0,0,1][P-2]),P==3)for(M=k;M<C;M++)i[M+1]=i[M+1]+(i[M+1-k]>>>1)&255;for(let L=0;L<l;L++)if(x=a+L*C,N=x+L+1,P=i[N-1],M=0,P==0)for(;M<C;M++)i[x+M]=i[N+M];else if(P==1){for(;M<k;M++)i[x+M]=i[N+M];for(;M<C;M++)i[x+M]=i[N+M]+i[x+M-k]}else if(P==2)for(;M<C;M++)i[x+M]=i[N+M]+i[x+M-C];else if(P==3){for(;M<k;M++)i[x+M]=i[N+M]+(i[x+M-C]>>>1);for(;M<C;M++)i[x+M]=i[N+M]+(i[x+M-C]+i[x+M-k]>>>1)}else{for(;M<k;M++)i[x+M]=i[N+M]+o(0,i[x+M-C],0);for(;M<C;M++)i[x+M]=i[N+M]+o(i[x+M-k],i[x+M-C],i[x+M-k-C])}return i}function o(i,e,a){const c=i+e-a,l=c-i,k=c-e,C=c-a;return l*l<=k*k&&l*l<=C*C?i:k*k<=C*C?e:a}function _(i,e,a){a.width=g.readUint(i,e),e+=4,a.height=g.readUint(i,e),e+=4,a.depth=i[e],e++,a.ctype=i[e],e++,a.compress=i[e],e++,a.filter=i[e],e++,a.interlace=i[e],e++}function p(i,e,a,c,l,k,C,x,N){const P=Math.min(e,l),M=Math.min(a,k);let L=0,y=0;for(let T=0;T<M;T++)for(let h=0;h<P;h++)if(C>=0&&x>=0?(L=T*e+h<<2,y=(x+T)*l+C+h<<2):(L=(-x+T)*e-C+h<<2,y=T*l+h<<2),N==0)c[y]=i[L],c[y+1]=i[L+1],c[y+2]=i[L+2],c[y+3]=i[L+3];else if(N==1){var S=i[L+3]*.00392156862745098,f=i[L]*S,v=i[L+1]*S,b=i[L+2]*S,A=c[y+3]*(1/255),D=c[y]*A,I=c[y+1]*A,E=c[y+2]*A;const u=1-S,q=S+A*u,R=q==0?0:1/q;c[y+3]=255*q,c[y+0]=(f+D*u)*R,c[y+1]=(v+I*u)*R,c[y+2]=(b+E*u)*R}else if(N==2)S=i[L+3],f=i[L],v=i[L+1],b=i[L+2],A=c[y+3],D=c[y],I=c[y+1],E=c[y+2],S==A&&f==D&&v==I&&b==E?(c[y]=0,c[y+1]=0,c[y+2]=0,c[y+3]=0):(c[y]=f,c[y+1]=v,c[y+2]=b,c[y+3]=S);else if(N==3){if(S=i[L+3],f=i[L],v=i[L+1],b=i[L+2],A=c[y+3],D=c[y],I=c[y+1],E=c[y+2],S==A&&f==D&&v==I&&b==E)continue;if(S<220&&A>20)return!1}return!0}return{decode:function(e){const a=new Uint8Array(e);let c=8;const l=g,k=l.readUshort,C=l.readUint,x={tabs:{},frames:[]},N=new Uint8Array(a.length);let P,M=0,L=0;const y=[137,80,78,71,13,10,26,10];for(var S=0;S<8;S++)if(a[S]!=y[S])throw"The input is not a PNG file!";for(;c<a.length;){const T=l.readUint(a,c);c+=4;const h=l.readASCII(a,c,4);if(c+=4,h=="IHDR")_(a,c,x);else if(h=="iCCP"){for(var f=c;a[f]!=0;)f++;l.readASCII(a,c,f-c),a[f+1];const u=a.slice(f+2,c+T);let q=null;try{q=s(u)}catch{q=t(u)}x.tabs[h]=q}else if(h=="CgBI")x.tabs[h]=a.slice(c,c+4);else if(h=="IDAT"){for(S=0;S<T;S++)N[M+S]=a[c+S];M+=T}else if(h=="acTL")x.tabs[h]={num_frames:C(a,c),num_plays:C(a,c+4)},P=new Uint8Array(a.length);else if(h=="fcTL"){L!=0&&((E=x.frames[x.frames.length-1]).data=w(x,P.slice(0,L),E.rect.width,E.rect.height),L=0);const u={x:C(a,c+12),y:C(a,c+16),width:C(a,c+4),height:C(a,c+8)};let q=k(a,c+22);q=k(a,c+20)/(q==0?100:q);const R={rect:u,delay:Math.round(1e3*q),dispose:a[c+24],blend:a[c+25]};x.frames.push(R)}else if(h=="fdAT"){for(S=0;S<T-4;S++)P[L+S]=a[c+S+4];L+=T-4}else if(h=="pHYs")x.tabs[h]=[l.readUint(a,c),l.readUint(a,c+4),a[c+8]];else if(h=="cHRM")for(x.tabs[h]=[],S=0;S<8;S++)x.tabs[h].push(l.readUint(a,c+4*S));else if(h=="tEXt"||h=="zTXt"){x.tabs[h]==null&&(x.tabs[h]={});var v=l.nextZero(a,c),b=l.readASCII(a,c,v-c),A=c+T-v-1;if(h=="tEXt")I=l.readASCII(a,v+1,A);else{var D=s(a.slice(v+2,v+2+A));I=l.readUTF8(D,0,D.length)}x.tabs[h][b]=I}else if(h=="iTXt"){x.tabs[h]==null&&(x.tabs[h]={}),v=0,f=c,v=l.nextZero(a,f),b=l.readASCII(a,f,v-f);const u=a[f=v+1];var I;a[f+1],f+=2,v=l.nextZero(a,f),l.readASCII(a,f,v-f),f=v+1,v=l.nextZero(a,f),l.readUTF8(a,f,v-f),A=T-((f=v+1)-c),u==0?I=l.readUTF8(a,f,A):(D=s(a.slice(f,f+A)),I=l.readUTF8(D,0,D.length)),x.tabs[h][b]=I}else if(h=="PLTE")x.tabs[h]=l.readBytes(a,c,T);else if(h=="hIST"){const u=x.tabs.PLTE.length/3;for(x.tabs[h]=[],S=0;S<u;S++)x.tabs[h].push(k(a,c+2*S))}else if(h=="tRNS")x.ctype==3?x.tabs[h]=l.readBytes(a,c,T):x.ctype==0?x.tabs[h]=k(a,c):x.ctype==2&&(x.tabs[h]=[k(a,c),k(a,c+2),k(a,c+4)]);else if(h=="gAMA")x.tabs[h]=l.readUint(a,c)/1e5;else if(h=="sRGB")x.tabs[h]=a[c];else if(h=="bKGD")x.ctype==0||x.ctype==4?x.tabs[h]=[k(a,c)]:x.ctype==2||x.ctype==6?x.tabs[h]=[k(a,c),k(a,c+2),k(a,c+4)]:x.ctype==3&&(x.tabs[h]=a[c]);else if(h=="IEND")break;c+=T,l.readUint(a,c),c+=4}var E;return L!=0&&((E=x.frames[x.frames.length-1]).data=w(x,P.slice(0,L),E.rect.width,E.rect.height)),x.data=w(x,N,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(e){const a=e.width,c=e.height;if(e.tabs.acTL==null)return[m(e.data,a,c,e).buffer];const l=[];e.frames[0].data==null&&(e.frames[0].data=e.data);const k=a*c*4,C=new Uint8Array(k),x=new Uint8Array(k),N=new Uint8Array(k);for(let M=0;M<e.frames.length;M++){const L=e.frames[M],y=L.rect.x,S=L.rect.y,f=L.rect.width,v=L.rect.height,b=m(L.data,f,v,e);if(M!=0)for(var P=0;P<k;P++)N[P]=C[P];if(L.blend==0?p(b,f,v,C,a,c,y,S,0):L.blend==1&&p(b,f,v,C,a,c,y,S,1),l.push(C.buffer.slice(0)),L.dispose!=0){if(L.dispose==1)p(x,f,v,C,a,c,y,S,0);else if(L.dispose==2)for(P=0;P<k;P++)C[P]=N[P]}}return l},_paeth:o,_copyTile:p,_bin:g}}();(function(){const{_copyTile:g}=rt,{_bin:m}=rt,w=rt._paeth;var s={table:function(){const f=new Uint32Array(256);for(let v=0;v<256;v++){let b=v;for(let A=0;A<8;A++)1&b?b=3988292384^b>>>1:b>>>=1;f[v]=b}return f}(),update(f,v,b,A){for(let D=0;D<A;D++)f=s.table[255&(f^v[b+D])]^f>>>8;return f},crc:(f,v,b)=>4294967295^s.update(4294967295,f,v,b)};function t(f,v,b,A){v[b]+=f[0]*A>>4,v[b+1]+=f[1]*A>>4,v[b+2]+=f[2]*A>>4,v[b+3]+=f[3]*A>>4}function r(f){return Math.max(0,Math.min(255,f))}function d(f,v){const b=f[0]-v[0],A=f[1]-v[1],D=f[2]-v[2],I=f[3]-v[3];return b*b+A*A+D*D+I*I}function o(f,v,b,A,D,I,E){E==null&&(E=1);const T=A.length,h=[];for(var u=0;u<T;u++){const F=A[u];h.push([F>>>0&255,F>>>8&255,F>>>16&255,F>>>24&255])}for(u=0;u<T;u++){let F=4294967295;for(var q=0,R=0;R<T;R++){var U=d(h[u],h[R]);R!=u&&U<F&&(F=U,q=R)}}const K=new Uint32Array(D.buffer),Y=new Int16Array(v*b*4),$=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(u=0;u<$.length;u++)$[u]=255*(($[u]+.5)/16-.5);for(let F=0;F<b;F++)for(let ee=0;ee<v;ee++){var H;u=4*(F*v+ee),E!=2?H=[r(f[u]+Y[u]),r(f[u+1]+Y[u+1]),r(f[u+2]+Y[u+2]),r(f[u+3]+Y[u+3])]:(U=$[4*(3&F)+(3&ee)],H=[r(f[u]+U),r(f[u+1]+U),r(f[u+2]+U),r(f[u+3]+U)]),q=0;let ue=16777215;for(R=0;R<T;R++){const ve=d(H,h[R]);ve<ue&&(ue=ve,q=R)}const he=h[q],fe=[H[0]-he[0],H[1]-he[1],H[2]-he[2],H[3]-he[3]];E==1&&(ee!=v-1&&t(fe,Y,u+4,7),F!=b-1&&(ee!=0&&t(fe,Y,u+4*v-4,3),t(fe,Y,u+4*v,5),ee!=v-1&&t(fe,Y,u+4*v+4,1))),I[u>>2]=q,K[u>>2]=A[q]}}function _(f,v,b,A,D){D==null&&(D={});const{crc:I}=s,E=m.writeUint,T=m.writeUshort,h=m.writeASCII;let u=8;const q=f.frames.length>1;let R,U=!1,K=33+(q?20:0);if(D.sRGB!=null&&(K+=13),D.pHYs!=null&&(K+=21),D.iCCP!=null&&(R=pako.deflate(D.iCCP),K+=21+R.length+4),f.ctype==3){for(var Y=f.plte.length,$=0;$<Y;$++)f.plte[$]>>>24!=255&&(U=!0);K+=8+3*Y+4+(U?8+1*Y+4:0)}for(var H=0;H<f.frames.length;H++)q&&(K+=38),K+=(he=f.frames[H]).cimg.length+12,H!=0&&(K+=4);K+=12;const F=new Uint8Array(K),ee=[137,80,78,71,13,10,26,10];for($=0;$<8;$++)F[$]=ee[$];if(E(F,u,13),u+=4,h(F,u,"IHDR"),u+=4,E(F,u,v),u+=4,E(F,u,b),u+=4,F[u]=f.depth,u++,F[u]=f.ctype,u++,F[u]=0,u++,F[u]=0,u++,F[u]=0,u++,E(F,u,I(F,u-17,17)),u+=4,D.sRGB!=null&&(E(F,u,1),u+=4,h(F,u,"sRGB"),u+=4,F[u]=D.sRGB,u++,E(F,u,I(F,u-5,5)),u+=4),D.iCCP!=null){const fe=13+R.length;E(F,u,fe),u+=4,h(F,u,"iCCP"),u+=4,h(F,u,"ICC profile"),u+=11,u+=2,F.set(R,u),u+=R.length,E(F,u,I(F,u-(fe+4),fe+4)),u+=4}if(D.pHYs!=null&&(E(F,u,9),u+=4,h(F,u,"pHYs"),u+=4,E(F,u,D.pHYs[0]),u+=4,E(F,u,D.pHYs[1]),u+=4,F[u]=D.pHYs[2],u++,E(F,u,I(F,u-13,13)),u+=4),q&&(E(F,u,8),u+=4,h(F,u,"acTL"),u+=4,E(F,u,f.frames.length),u+=4,E(F,u,D.loop!=null?D.loop:0),u+=4,E(F,u,I(F,u-12,12)),u+=4),f.ctype==3){for(E(F,u,3*(Y=f.plte.length)),u+=4,h(F,u,"PLTE"),u+=4,$=0;$<Y;$++){const fe=3*$,ve=f.plte[$],Ee=255&ve,Ae=ve>>>8&255,ke=ve>>>16&255;F[u+fe+0]=Ee,F[u+fe+1]=Ae,F[u+fe+2]=ke}if(u+=3*Y,E(F,u,I(F,u-3*Y-4,3*Y+4)),u+=4,U){for(E(F,u,Y),u+=4,h(F,u,"tRNS"),u+=4,$=0;$<Y;$++)F[u+$]=f.plte[$]>>>24&255;u+=Y,E(F,u,I(F,u-Y-4,Y+4)),u+=4}}let ue=0;for(H=0;H<f.frames.length;H++){var he=f.frames[H];q&&(E(F,u,26),u+=4,h(F,u,"fcTL"),u+=4,E(F,u,ue++),u+=4,E(F,u,he.rect.width),u+=4,E(F,u,he.rect.height),u+=4,E(F,u,he.rect.x),u+=4,E(F,u,he.rect.y),u+=4,T(F,u,A[H]),u+=2,T(F,u,1e3),u+=2,F[u]=he.dispose,u++,F[u]=he.blend,u++,E(F,u,I(F,u-30,30)),u+=4);const fe=he.cimg;E(F,u,(Y=fe.length)+(H==0?0:4)),u+=4;const ve=u;h(F,u,H==0?"IDAT":"fdAT"),u+=4,H!=0&&(E(F,u,ue++),u+=4),F.set(fe,u),u+=Y,E(F,u,I(F,ve,u-ve)),u+=4}return E(F,u,0),u+=4,h(F,u,"IEND"),u+=4,E(F,u,I(F,u-4,4)),u+=4,F.buffer}function p(f,v,b){for(let A=0;A<f.frames.length;A++){const D=f.frames[A];D.rect.width;const I=D.rect.height,E=new Uint8Array(I*D.bpl+I);D.cimg=c(D.img,I,D.bpp,D.bpl,E,v,b)}}function i(f,v,b,A,D){const I=D[0],E=D[1],T=D[2],h=D[3],u=D[4],q=D[5];let R=6,U=8,K=255;for(var Y=0;Y<f.length;Y++){const V=new Uint8Array(f[Y]);for(var $=V.length,H=0;H<$;H+=4)K&=V[H+3]}const F=K!=255,ee=function(re,se,ne,ae,ie,me){const ye=[];for(var oe=0;oe<re.length;oe++){const De=new Uint8Array(re[oe]),Ce=new Uint32Array(De.buffer);var pe;let qe=0,Ne=0,Pe=se,Fe=ne,$e=ae?1:0;if(oe!=0){const mt=me||ae||oe==1||ye[oe-2].dispose!=0?1:2;let it=0,st=1e9;for(let lt=0;lt<mt;lt++){var Me=new Uint8Array(re[oe-1-lt]);const Xt=new Uint32Array(re[oe-1-lt]);let ot=se,Ge=ne,Ue=-1,Et=-1;for(let ht=0;ht<ne;ht++)for(let gt=0;gt<se;gt++)Ce[xe=ht*se+gt]!=Xt[xe]&&(gt<ot&&(ot=gt),gt>Ue&&(Ue=gt),ht<Ge&&(Ge=ht),ht>Et&&(Et=ht));Ue==-1&&(ot=Ge=Ue=Et=0),ie&&((1&ot)==1&&ot--,(1&Ge)==1&&Ge--);const Bt=(Ue-ot+1)*(Et-Ge+1);Bt<st&&(st=Bt,it=lt,qe=ot,Ne=Ge,Pe=Ue-ot+1,Fe=Et-Ge+1)}Me=new Uint8Array(re[oe-1-it]),it==1&&(ye[oe-1].dispose=2),pe=new Uint8Array(Pe*Fe*4),g(Me,se,ne,pe,Pe,Fe,-qe,-Ne,0),$e=g(De,se,ne,pe,Pe,Fe,-qe,-Ne,3)?1:0,$e==1?a(De,se,ne,pe,{x:qe,y:Ne,width:Pe,height:Fe}):g(De,se,ne,pe,Pe,Fe,-qe,-Ne,0)}else pe=De.slice(0);ye.push({rect:{x:qe,y:Ne,width:Pe,height:Fe},img:pe,blend:$e,dispose:0})}if(ae)for(oe=0;oe<ye.length;oe++){if((Ye=ye[oe]).blend==1)continue;const De=Ye.rect,Ce=ye[oe-1].rect,qe=Math.min(De.x,Ce.x),Ne=Math.min(De.y,Ce.y),Pe={x:qe,y:Ne,width:Math.max(De.x+De.width,Ce.x+Ce.width)-qe,height:Math.max(De.y+De.height,Ce.y+Ce.height)-Ne};ye[oe-1].dispose=1,oe-1!=0&&e(re,se,ne,ye,oe-1,Pe,ie),e(re,se,ne,ye,oe,Pe,ie)}let Be=0;if(re.length!=1)for(var xe=0;xe<ye.length;xe++){var Ye;Be+=(Ye=ye[xe]).rect.width*Ye.rect.height}return ye}(f,v,b,I,E,T),ue={},he=[],fe=[];if(A!=0){const V=[];for(H=0;H<ee.length;H++)V.push(ee[H].img.buffer);const re=function(ie){let me=0;for(var ye=0;ye<ie.length;ye++)me+=ie[ye].byteLength;const oe=new Uint8Array(me);let pe=0;for(ye=0;ye<ie.length;ye++){const Me=new Uint8Array(ie[ye]),Be=Me.length;for(let xe=0;xe<Be;xe+=4){let Ye=Me[xe],De=Me[xe+1],Ce=Me[xe+2];const qe=Me[xe+3];qe==0&&(Ye=De=Ce=0),oe[pe+xe]=Ye,oe[pe+xe+1]=De,oe[pe+xe+2]=Ce,oe[pe+xe+3]=qe}pe+=Be}return oe.buffer}(V),se=k(re,A);for(H=0;H<se.plte.length;H++)he.push(se.plte[H].est.rgba);let ne=0;for(H=0;H<ee.length;H++){const ae=(Ee=ee[H]).img.length;var ve=new Uint8Array(se.inds.buffer,ne>>2,ae>>2);fe.push(ve);const ie=new Uint8Array(se.abuf,ne,ae);q&&o(Ee.img,Ee.rect.width,Ee.rect.height,he,ie,ve),Ee.img.set(ie),ne+=ae}}else for(Y=0;Y<ee.length;Y++){var Ee=ee[Y];const V=new Uint32Array(Ee.img.buffer);var Ae=Ee.rect.width;for($=V.length,ve=new Uint8Array($),fe.push(ve),H=0;H<$;H++){const re=V[H];if(H!=0&&re==V[H-1])ve[H]=ve[H-1];else if(H>Ae&&re==V[H-Ae])ve[H]=ve[H-Ae];else{let se=ue[re];if(se==null&&(ue[re]=se=he.length,he.push(re),he.length>=300))break;ve[H]=se}}}const ke=he.length;for(ke<=256&&u==0&&(U=ke<=2?1:ke<=4?2:ke<=16?4:8,U=Math.max(U,h)),Y=0;Y<ee.length;Y++){(Ee=ee[Y]).rect.x,Ee.rect.y,Ae=Ee.rect.width;const V=Ee.rect.height;let re=Ee.img;new Uint32Array(re.buffer);let se=4*Ae,ne=4;if(ke<=256&&u==0){se=Math.ceil(U*Ae/8);var Q=new Uint8Array(se*V);const ae=fe[Y];for(let ie=0;ie<V;ie++){H=ie*se;const me=ie*Ae;if(U==8)for(var Z=0;Z<Ae;Z++)Q[H+Z]=ae[me+Z];else if(U==4)for(Z=0;Z<Ae;Z++)Q[H+(Z>>1)]|=ae[me+Z]<<4-4*(1&Z);else if(U==2)for(Z=0;Z<Ae;Z++)Q[H+(Z>>2)]|=ae[me+Z]<<6-2*(3&Z);else if(U==1)for(Z=0;Z<Ae;Z++)Q[H+(Z>>3)]|=ae[me+Z]<<7-1*(7&Z)}re=Q,R=3,ne=1}else if(F==0&&ee.length==1){Q=new Uint8Array(Ae*V*3);const ae=Ae*V;for(H=0;H<ae;H++){const ie=3*H,me=4*H;Q[ie]=re[me],Q[ie+1]=re[me+1],Q[ie+2]=re[me+2]}re=Q,R=2,ne=3,se=3*Ae}Ee.img=re,Ee.bpl=se,Ee.bpp=ne}return{ctype:R,depth:U,plte:he,frames:ee}}function e(f,v,b,A,D,I,E){const T=Uint8Array,h=Uint32Array,u=new T(f[D-1]),q=new h(f[D-1]),R=D+1<f.length?new T(f[D+1]):null,U=new T(f[D]),K=new h(U.buffer);let Y=v,$=b,H=-1,F=-1;for(let ue=0;ue<I.height;ue++)for(let he=0;he<I.width;he++){const fe=I.x+he,ve=I.y+ue,Ee=ve*v+fe,Ae=K[Ee];Ae==0||A[D-1].dispose==0&&q[Ee]==Ae&&(R==null||R[4*Ee+3]!=0)||(fe<Y&&(Y=fe),fe>H&&(H=fe),ve<$&&($=ve),ve>F&&(F=ve))}H==-1&&(Y=$=H=F=0),E&&((1&Y)==1&&Y--,(1&$)==1&&$--),I={x:Y,y:$,width:H-Y+1,height:F-$+1};const ee=A[D];ee.rect=I,ee.blend=1,ee.img=new Uint8Array(I.width*I.height*4),A[D-1].dispose==0?(g(u,v,b,ee.img,I.width,I.height,-I.x,-I.y,0),a(U,v,b,ee.img,I)):g(U,v,b,ee.img,I.width,I.height,-I.x,-I.y,0)}function a(f,v,b,A,D){g(f,v,b,A,D.width,D.height,-D.x,-D.y,2)}function c(f,v,b,A,D,I,E){const T=[];let h,u=[0,1,2,3,4];I!=-1?u=[I]:(v*A>5e5||b==1)&&(u=[0]),E&&(h={level:0});const q=hi;for(var R=0;R<u.length;R++){for(let Y=0;Y<v;Y++)l(D,f,Y,A,b,u[R]);T.push(q.deflate(D,h))}let U,K=1e9;for(R=0;R<T.length;R++)T[R].length<K&&(U=R,K=T[R].length);return T[U]}function l(f,v,b,A,D,I){const E=b*A;let T=E+b;if(f[T]=I,T++,I==0)if(A<500)for(var h=0;h<A;h++)f[T+h]=v[E+h];else f.set(new Uint8Array(v.buffer,E,A),T);else if(I==1){for(h=0;h<D;h++)f[T+h]=v[E+h];for(h=D;h<A;h++)f[T+h]=v[E+h]-v[E+h-D]+256&255}else if(b==0){for(h=0;h<D;h++)f[T+h]=v[E+h];if(I==2)for(h=D;h<A;h++)f[T+h]=v[E+h];if(I==3)for(h=D;h<A;h++)f[T+h]=v[E+h]-(v[E+h-D]>>1)+256&255;if(I==4)for(h=D;h<A;h++)f[T+h]=v[E+h]-w(v[E+h-D],0,0)+256&255}else{if(I==2)for(h=0;h<A;h++)f[T+h]=v[E+h]+256-v[E+h-A]&255;if(I==3){for(h=0;h<D;h++)f[T+h]=v[E+h]+256-(v[E+h-A]>>1)&255;for(h=D;h<A;h++)f[T+h]=v[E+h]+256-(v[E+h-A]+v[E+h-D]>>1)&255}if(I==4){for(h=0;h<D;h++)f[T+h]=v[E+h]+256-w(0,v[E+h-A],0)&255;for(h=D;h<A;h++)f[T+h]=v[E+h]+256-w(v[E+h-D],v[E+h-A],v[E+h-D-A])&255}}}function k(f,v){const b=new Uint8Array(f),A=b.slice(0),D=new Uint32Array(A.buffer),I=C(A,v),E=I[0],T=I[1],h=b.length,u=new Uint8Array(h>>2);let q;if(b.length<2e7)for(var R=0;R<h;R+=4)q=x(E,U=b[R]*(1/255),K=b[R+1]*(1/255),Y=b[R+2]*(1/255),$=b[R+3]*(1/255)),u[R>>2]=q.ind,D[R>>2]=q.est.rgba;else for(R=0;R<h;R+=4){var U=b[R]*.00392156862745098,K=b[R+1]*(1/255),Y=b[R+2]*(1/255),$=b[R+3]*(1/255);for(q=E;q.left;)q=N(q.est,U,K,Y,$)<=0?q.left:q.right;u[R>>2]=q.ind,D[R>>2]=q.est.rgba}return{abuf:A.buffer,inds:u,plte:T}}function C(f,v,b){b==null&&(b=1e-4);const A=new Uint32Array(f.buffer),D={i0:0,i1:f.length,bst:null,est:null,tdst:0,left:null,right:null};D.bst=L(f,D.i0,D.i1),D.est=y(D.bst);const I=[D];for(;I.length<v;){let T=0,h=0;for(var E=0;E<I.length;E++)I[E].est.L>T&&(T=I[E].est.L,h=E);if(T<b)break;const u=I[h],q=P(f,A,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=q||u.i1<=q){u.est.L=0;continue}const R={i0:u.i0,i1:q,bst:null,est:null,tdst:0,left:null,right:null};R.bst=L(f,R.i0,R.i1),R.est=y(R.bst);const U={i0:q,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(U.bst={R:[],m:[],N:u.bst.N-R.bst.N},E=0;E<16;E++)U.bst.R[E]=u.bst.R[E]-R.bst.R[E];for(E=0;E<4;E++)U.bst.m[E]=u.bst.m[E]-R.bst.m[E];U.est=y(U.bst),u.left=R,u.right=U,I[h]=R,I.push(U)}for(I.sort((T,h)=>h.bst.N-T.bst.N),E=0;E<I.length;E++)I[E].ind=E;return[D,I]}function x(f,v,b,A,D){if(f.left==null)return f.tdst=function(R,U,K,Y,$){const H=U-R[0],F=K-R[1],ee=Y-R[2],ue=$-R[3];return H*H+F*F+ee*ee+ue*ue}(f.est.q,v,b,A,D),f;const I=N(f.est,v,b,A,D);let E=f.left,T=f.right;I>0&&(E=f.right,T=f.left);const h=x(E,v,b,A,D);if(h.tdst<=I*I)return h;const u=x(T,v,b,A,D);return u.tdst<h.tdst?u:h}function N(f,v,b,A,D){const{e:I}=f;return I[0]*v+I[1]*b+I[2]*A+I[3]*D-f.eMq}function P(f,v,b,A,D,I){for(A-=4;b<A;){for(;M(f,b,D)<=I;)b+=4;for(;M(f,A,D)>I;)A-=4;if(b>=A)break;const E=v[b>>2];v[b>>2]=v[A>>2],v[A>>2]=E,b+=4,A-=4}for(;M(f,b,D)>I;)b-=4;return b+4}function M(f,v,b){return f[v]*b[0]+f[v+1]*b[1]+f[v+2]*b[2]+f[v+3]*b[3]}function L(f,v,b){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D=[0,0,0,0],I=b-v>>2;for(let E=v;E<b;E+=4){const T=f[E]*.00392156862745098,h=f[E+1]*(1/255),u=f[E+2]*(1/255),q=f[E+3]*(1/255);D[0]+=T,D[1]+=h,D[2]+=u,D[3]+=q,A[0]+=T*T,A[1]+=T*h,A[2]+=T*u,A[3]+=T*q,A[5]+=h*h,A[6]+=h*u,A[7]+=h*q,A[10]+=u*u,A[11]+=u*q,A[15]+=q*q}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:D,N:I}}function y(f){const{R:v}=f,{m:b}=f,{N:A}=f,D=b[0],I=b[1],E=b[2],T=b[3],h=A==0?0:1/A,u=[v[0]-D*D*h,v[1]-D*I*h,v[2]-D*E*h,v[3]-D*T*h,v[4]-I*D*h,v[5]-I*I*h,v[6]-I*E*h,v[7]-I*T*h,v[8]-E*D*h,v[9]-E*I*h,v[10]-E*E*h,v[11]-E*T*h,v[12]-T*D*h,v[13]-T*I*h,v[14]-T*E*h,v[15]-T*T*h],q=u,R=S;let U=[Math.random(),Math.random(),Math.random(),Math.random()],K=0,Y=0;if(A!=0)for(let H=0;H<16&&(U=R.multVec(q,U),Y=Math.sqrt(R.dot(U,U)),U=R.sml(1/Y,U),!(H!=0&&Math.abs(Y-K)<1e-9));H++)K=Y;const $=[D*h,I*h,E*h,T*h];return{Cov:u,q:$,e:U,L:K,eMq255:R.dot(R.sml(255,$),U),eMq:R.dot(U,$),rgba:(Math.round(255*$[3])<<24|Math.round(255*$[2])<<16|Math.round(255*$[1])<<8|Math.round(255*$[0])<<0)>>>0}}var S={multVec:(f,v)=>[f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],f[4]*v[0]+f[5]*v[1]+f[6]*v[2]+f[7]*v[3],f[8]*v[0]+f[9]*v[1]+f[10]*v[2]+f[11]*v[3],f[12]*v[0]+f[13]*v[1]+f[14]*v[2]+f[15]*v[3]],dot:(f,v)=>f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],sml:(f,v)=>[f*v[0],f*v[1],f*v[2],f*v[3]]};rt.encode=function(v,b,A,D,I,E,T){D==null&&(D=0),T==null&&(T=!1);const h=i(v,b,A,D,[!1,!1,!1,0,T,!1]);return p(h,-1),_(h,b,A,I,E)},rt.encodeLL=function(v,b,A,D,I,E,T,h){const u={ctype:0+(D==1?0:2)+(I==0?0:4),depth:E,frames:[]},q=(D+I)*E,R=q*b;for(let U=0;U<v.length;U++)u.frames.push({rect:{x:0,y:0,width:b,height:A},img:new Uint8Array(v[U]),blend:0,dispose:1,bpp:Math.ceil(q/8),bpl:Math.ceil(R/8)});return p(u,0,!0),_(u,b,A,T,h)},rt.encode.compress=i,rt.encode.dither=o,rt.quantize=k,rt.quantize.getKDtree=C,rt.quantize.getNearest=x})();const Qr={toArrayBuffer(g,m){const w=g.width,s=g.height,t=w<<2,r=g.getContext("2d").getImageData(0,0,w,s),d=new Uint32Array(r.data.buffer),o=(32*w+31)/32<<2,_=o*s,p=122+_,i=new ArrayBuffer(p),e=new DataView(i),a=1<<20;let c,l,k,C,x=a,N=0,P=0,M=0;function L(f){e.setUint16(P,f,!0),P+=2}function y(f){e.setUint32(P,f,!0),P+=4}function S(f){P+=f}L(19778),y(p),S(4),y(122),y(108),y(w),y(-s>>>0),L(1),L(32),y(3),y(_),y(2835),y(2835),S(8),y(16711680),y(65280),y(255),y(4278190080),y(1466527264),function f(){for(;N<s&&x>0;){for(C=122+N*o,c=0;c<t;)x--,l=d[M++],k=l>>>24,e.setUint32(C+c,l<<8|k),c+=4;N++}M<d.length?(x=a,setTimeout(f,Qr._dly)):m(i)}()},toBlob(g,m){this.toArrayBuffer(g,w=>{m(new Blob([w],{type:"image/bmp"}))})},_dly:9};var Xe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gi={[Xe.CHROME]:16384,[Xe.FIREFOX]:11180,[Xe.DESKTOP_SAFARI]:16384,[Xe.IE]:8192,[Xe.IOS]:4096,[Xe.ETC]:8192};const pr=typeof window<"u",Kr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Kt=pr&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),_i=(pr||Kr)&&(Kt&&Kt.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Vr=(pr||Kr)&&(Kt&&Kt.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function yr(g,m,w=Date.now()){return new Promise(s=>{const t=g.split(","),r=t[0].match(/:(.*?);/)[1],d=globalThis.atob(t[1]);let o=d.length;const _=new Uint8Array(o);for(;o--;)_[o]=d.charCodeAt(o);const p=new Blob([_],{type:r});p.name=m,p.lastModified=w,s(p)})}function Gr(g){return new Promise((m,w)=>{const s=new Vr;s.onload=()=>m(s.result),s.onerror=t=>w(t),s.readAsDataURL(g)})}function Zr(g){return new Promise((m,w)=>{const s=new Image;s.onload=()=>m(s),s.onerror=t=>w(t),s.src=g})}function At(){if(At.cachedResult!==void 0)return At.cachedResult;let g=Xe.ETC;const{userAgent:m}=navigator;return/Chrom(e|ium)/i.test(m)?g=Xe.CHROME:/iP(ad|od|hone)/i.test(m)&&/WebKit/i.test(m)?g=Xe.IOS:/Safari/i.test(m)?g=Xe.DESKTOP_SAFARI:/Firefox/i.test(m)?g=Xe.FIREFOX:(/MSIE/i.test(m)||document.documentMode)&&(g=Xe.IE),At.cachedResult=g,At.cachedResult}function Xr(g,m){const w=At(),s=gi[w];let t=g,r=m,d=t*r;const o=t>r?r/t:t/r;for(;d>s*s;){const _=(s+t)/2,p=(s+r)/2;_<p?(r=p,t=p*o):(r=_*o,t=_),d=t*r}return{width:t,height:r}}function Zt(g,m){let w,s;try{if(w=new OffscreenCanvas(g,m),s=w.getContext("2d"),s===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{w=document.createElement("canvas"),s=w.getContext("2d")}return w.width=g,w.height=m,[w,s]}function Jr(g,m){const{width:w,height:s}=Xr(g.width,g.height),[t,r]=Zt(w,s);return m&&/jpe?g/.test(m)&&(r.fillStyle="white",r.fillRect(0,0,t.width,t.height)),r.drawImage(g,0,0,t.width,t.height),t}function Nt(){return Nt.cachedResult!==void 0||(Nt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Nt.cachedResult}function Vt(g,m={}){return new Promise(function(w,s){let t,r;var d=function(){try{return r=Jr(t,m.fileType||g.type),w([t,r])}catch(_){return s(_)}},o=function(_){try{var p=function(i){try{throw i}catch(e){return s(e)}};try{let i;return Gr(g).then(function(e){try{return i=e,Zr(i).then(function(a){try{return t=a,function(){try{return d()}catch(c){return s(c)}}()}catch(c){return p(c)}},p)}catch(a){return p(a)}},p)}catch(i){p(i)}}catch(i){return s(i)}};try{if(Nt()||[Xe.DESKTOP_SAFARI,Xe.MOBILE_SAFARI].includes(At()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(g).then(function(_){try{return t=_,d()}catch{return o()}},o)}catch{o()}})}function Gt(g,m,w,s,t=1){return new Promise(function(r,d){let o;if(m==="image/png"){let p,i,e;return p=g.getContext("2d"),{data:i}=p.getImageData(0,0,g.width,g.height),e=rt.encode([i.buffer],g.width,g.height,4096*t),o=new Blob([e],{type:m}),o.name=w,o.lastModified=s,_.call(this)}{let p=function(){return _.call(this)};if(m==="image/bmp")return new Promise(i=>Qr.toBlob(g,i)).then(function(i){try{return o=i,o.name=w,o.lastModified=s,p.call(this)}catch(e){return d(e)}}.bind(this),d);{let i=function(){return p.call(this)};if(typeof OffscreenCanvas=="function"&&g instanceof OffscreenCanvas)return g.convertToBlob({type:m,quality:t}).then(function(e){try{return o=e,o.name=w,o.lastModified=s,i.call(this)}catch(a){return d(a)}}.bind(this),d);{let e;return e=g.toDataURL(m,t),yr(e,w,s).then(function(a){try{return o=a,i.call(this)}catch(c){return d(c)}}.bind(this),d)}}}function _(){return r(o)}})}function ut(g){g.width=0,g.height=0}function It(){return new Promise(function(g,m){let w,s,t,r;return It.cachedResult!==void 0?g(It.cachedResult):yr("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(d){try{return w=d,Vt(w).then(function(o){try{return s=o[1],Gt(s,w.type,w.name,w.lastModified).then(function(_){try{return t=_,ut(s),Vt(t).then(function(p){try{return r=p[0],It.cachedResult=r.width===1&&r.height===2,g(It.cachedResult)}catch(i){return m(i)}},m)}catch(p){return m(p)}},m)}catch(_){return m(_)}},m)}catch(o){return m(o)}},m)})}function en(g){return new Promise((m,w)=>{const s=new Vr;s.onload=t=>{const r=new DataView(t.target.result);if(r.getUint16(0,!1)!=65496)return m(-2);const d=r.byteLength;let o=2;for(;o<d;){if(r.getUint16(o+2,!1)<=8)return m(-1);const _=r.getUint16(o,!1);if(o+=2,_==65505){if(r.getUint32(o+=2,!1)!=1165519206)return m(-1);const p=r.getUint16(o+=6,!1)==18761;o+=r.getUint32(o+4,p);const i=r.getUint16(o,p);o+=2;for(let e=0;e<i;e++)if(r.getUint16(o+12*e,p)==274)return m(r.getUint16(o+12*e+8,p))}else{if((65280&_)!=65280)break;o+=r.getUint16(o,!1)}}return m(-1)},s.onerror=t=>w(t),s.readAsArrayBuffer(g)})}function tn(g,m){const{width:w}=g,{height:s}=g,{maxWidthOrHeight:t}=m;let r,d=g;return isFinite(t)&&(w>t||s>t)&&([d,r]=Zt(w,s),w>s?(d.width=t,d.height=s/w*t):(d.width=w/s*t,d.height=t),r.drawImage(g,0,0,d.width,d.height),ut(g)),d}function rn(g,m){const{width:w}=g,{height:s}=g,[t,r]=Zt(w,s);switch(m>4&&m<9?(t.width=s,t.height=w):(t.width=w,t.height=s),m){case 2:r.transform(-1,0,0,1,w,0);break;case 3:r.transform(-1,0,0,-1,w,s);break;case 4:r.transform(1,0,0,-1,0,s);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,s,0);break;case 7:r.transform(0,-1,-1,0,s,w);break;case 8:r.transform(0,-1,1,0,0,w)}return r.drawImage(g,0,0,w,s),ut(g),t}function Mr(g,m,w=0){return new Promise(function(s,t){let r,d,o,_,p,i,e,a,c,l,k,C,x,N,P,M,L,y,S,f;function v(A=5){if(m.signal&&m.signal.aborted)throw m.signal.reason;r+=A,m.onProgress(Math.min(r,100))}function b(A){if(m.signal&&m.signal.aborted)throw m.signal.reason;r=Math.min(Math.max(A,r),100),m.onProgress(r)}return r=w,d=m.maxIteration||10,o=1024*m.maxSizeMB*1024,v(),Vt(g,m).then(function(A){try{return[,_]=A,v(),p=tn(_,m),v(),new Promise(function(D,I){var E;if(!(E=m.exifOrientation))return en(g).then(function(h){try{return E=h,T.call(this)}catch(u){return I(u)}}.bind(this),I);function T(){return D(E)}return T.call(this)}).then(function(D){try{return i=D,v(),It().then(function(I){try{return e=I?p:rn(p,i),v(),a=m.initialQuality||1,c=m.fileType||g.type,Gt(e,c,g.name,g.lastModified,a).then(function(E){try{{let h=function(){if(d--&&(P>o||P>x)){let q,R;return q=f?.95*S.width:S.width,R=f?.95*S.height:S.height,[L,y]=Zt(q,R),y.drawImage(S,0,0,q,R),a*=c==="image/png"?.85:.95,Gt(L,c,g.name,g.lastModified,a).then(function(U){try{return M=U,ut(S),S=L,P=M.size,b(Math.min(99,Math.floor((N-P)/(N-o)*100))),h}catch(K){return t(K)}},t)}return[1]},u=function(){return ut(S),ut(L),ut(p),ut(e),ut(_),b(100),s(M)};if(l=E,v(),k=l.size>o,C=l.size>g.size,!k&&!C)return b(100),s(l);var T;return x=g.size,N=l.size,P=N,S=e,f=!m.alwaysKeepResolution&&k,(T=function(q){for(;q;){if(q.then)return void q.then(T,t);try{if(q.pop){if(q.length)return q.pop()?u.call(this):q;q=h}else q=q.call(this)}catch(R){return t(R)}}}.bind(this))(h)}}catch(h){return t(h)}}.bind(this),t)}catch(E){return t(E)}}.bind(this),t)}catch(I){return t(I)}}.bind(this),t)}catch(D){return t(D)}}.bind(this),t)})}const pi=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let ur;function yi(g,m){return new Promise((w,s)=>{ur||(ur=function(d){const o=[];return o.push(d),URL.createObjectURL(new Blob(o))}(pi));const t=new Worker(ur);t.addEventListener("message",function(d){if(m.signal&&m.signal.aborted)t.terminate();else if(d.data.progress===void 0){if(d.data.error)return s(new Error(d.data.error)),void t.terminate();w(d.data.file),t.terminate()}else m.onProgress(d.data.progress)}),t.addEventListener("error",s),m.signal&&m.signal.addEventListener("abort",()=>{s(m.signal.reason),t.terminate()}),t.postMessage({file:g,imageCompressionLibUrl:m.libURL,options:{...m,onProgress:void 0,signal:void 0}})})}function je(g,m){return new Promise(function(w,s){let t,r,d,o,_,p;if(t={...m},d=0,{onProgress:o}=t,t.maxSizeMB=t.maxSizeMB||Number.POSITIVE_INFINITY,_=typeof t.useWebWorker!="boolean"||t.useWebWorker,delete t.useWebWorker,t.onProgress=c=>{d=c,typeof o=="function"&&o(d)},!(g instanceof Blob||g instanceof _i))return s(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(g.type))return s(new Error("The file given is not an image"));if(p=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!_||typeof Worker!="function"||p)return Mr(g,t).then(function(c){try{return r=c,a.call(this)}catch(l){return s(l)}}.bind(this),s);var i=function(){try{return a.call(this)}catch(c){return s(c)}}.bind(this),e=function(c){try{return Mr(g,t).then(function(l){try{return r=l,i()}catch(k){return s(k)}},s)}catch(l){return s(l)}};try{return t.libURL=t.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",yi(g,t).then(function(c){try{return r=c,i()}catch{return e()}},e)}catch{e()}function a(){try{r.name=g.name,r.lastModified=g.lastModified}catch{}try{t.preserveExif&&g.type==="image/jpeg"&&(!t.fileType||t.fileType&&t.fileType===g.type)&&(r=jr(g,r))}catch{}return w(r)}})}je.getDataUrlFromFile=Gr,je.getFilefromDataUrl=yr,je.loadImage=Zr,je.drawImageInCanvas=Jr,je.drawFileInCanvas=Vt,je.canvasToFile=Gt,je.getExifOrientation=en,je.handleMaxWidthOrHeight=tn,je.followExifOrientation=rn,je.cleanupCanvasMemory=ut,je.isAutoOrientationInBrowser=It,je.approximateBelowMaximumCanvasSizeOfBrowser=Xr,je.copyExifWithoutOrientation=jr,je.getBrowserName=At,je.version="2.0.2";const bi={maxSizeMB:.8,maxWidthOrHeight:2400,initialQuality:.9,useWebWorker:!0,compressionThresholdMB:1};async function wi(g,m,w={},s){const t={...bi,...w};try{let r=g;if(g.type.startsWith("image/")&&g.size>t.compressionThresholdMB*1024*1024){s?.("Compressing image...");try{const _=await je(g,{maxSizeMB:t.maxSizeMB,maxWidthOrHeight:t.maxWidthOrHeight,initialQuality:t.initialQuality,useWebWorker:t.useWebWorker});r=_;const p=(g.size/(1024*1024)).toFixed(2),i=(_.size/(1024*1024)).toFixed(2),e=((1-_.size/g.size)*100).toFixed(0);console.log(`Image compressed: ${p}MB → ${i}MB (${e}% smaller)`)}catch(_){console.warn("Image compression failed, uploading original:",_)}}return s?.("Uploading file..."),{success:!0,attachment:await Hn(r,m)}}catch(r){return console.error("File upload failed:",r),{success:!1,error:r instanceof Error?r.message:"Upload failed"}}}async function xi(g){try{const m=Bn(g.url);return await Ln(m),!0}catch(m){return console.error("Failed to remove attachment:",m),!1}}function Ei(g,m,w){return g.map(s=>s.id===m?{...s,name:w}:s)}function Ai(g,m=5){const w=g.type.startsWith("image/"),s=m*1024*1024;if(!w&&g.size>s){const t=(g.size/1048576).toFixed(2);return{valid:!1,error:`Non-image files must be under ${m}MB (selected file is ${t}MB)`}}return{valid:!0}}function Di(g){return{uploadAttachment:(m,w,s)=>wi(m,w,g,s),removeAttachment:xi,updateAttachmentName:Ei,validateFile:Ai}}function Cr(g,m){const[w,s]=m.split(":").map(Number);let t=ia(g,w);return t=sa(t,s),t}function Fr(g){return Array.from(new Set(g)).sort((m,w)=>m-w)}function ki(g,m){if(m.includes(g))return 0;const w=m.find(s=>s>g);return w!==void 0?w-g:7-g+m[0]}function Si(g,m,w){const s=new Date(g),t=wt(s,Ve),r=t.getDay(),d=ki(r,w);if(d===0)return{start_time:g,end_time:m};const o=jt(t,d),_=Dt(o,Ve);let p=m;if(m){const i=wt(new Date(m),Ve),e=jt(i,d);p=Dt(e,Ve).toISOString()}return{start_time:_.toISOString(),end_time:p}}function nn({eventItem:g,dateInput:m,startTimeInput:w,endTimeInput:s,attachments:t,isRecurring:r,recurrenceFrequency:d,recurrenceInterval:o,recurringDays:_,recurrenceEndDate:p,hasEndDate:i,monthlyType:e}){const a=!g.id,c={...g.meta_data??{}};g.category&&(c.category=g.category);const l=Hr(),k=l?mr(l.stores.currentUser):void 0;if(a){const y=l?mr(l.stores.userOrganizations):void 0,S=k?.displayName||k?.username,f=k?.id;S&&!c.submitted_by_name&&(c.submitted_by_name=S),f&&!c.submitted_by_user_id&&(c.submitted_by_user_id=f);const v=y?Array.from(y):[];v.length&&!c.submitted_by_organizations&&(c.submitted_by_organizations=v),c.submitted_at||(c.submitted_at=new Date().toISOString())}else{const y=k?.displayName||k?.username;y&&(c.edited_by_name=y),k?.id&&(c.edited_by_user_id=k.id),c.edited_at=new Date().toISOString()}const C=Object.keys(c).length?c:void 0,x={title:g.title,description:g.description,location:g.location,is_public:g.is_public??!0,event_type:g.event_type,meta_data:C,attachments:t.length>0?t:null};if(g.event_type!=="calendar_event")return{...x,start_time:void 0,end_time:void 0,is_all_day:void 0,recurrence_rule:void 0,recurrence_end_date:void 0};const N=m?Yt(m,"yyyy-MM-dd",new Date):new Date;let P,M;if(g.is_all_day){const y=Dt(N,Ve);P=y.toISOString(),M=y.toISOString()}else{const y=new Date(N.getTime()),S=new Date(N.getTime()),f=w?Cr(y,w):N,v=s?Cr(S,s):N;P=Dt(f,Ve).toISOString(),M=Dt(v,Ve).toISOString()}const L={...x,start_time:P,end_time:M,is_all_day:g.is_all_day};if(r&&L.start_time){if(d==="weekly"&&_.length>0){const S=Fr(_),f=Si(L.start_time,L.end_time,S);L.start_time=f.start_time,L.end_time=f.end_time}if(d==="daily"||d==="yearly"||d==="weekly"&&_.length>0||d==="monthly"){const{recurrence_rule:S,recurrence_end_date:f}=_r({frequency:d,interval:o,recurringDays:d==="weekly"?Fr(_):[],recurrenceEndDate:p,hasEndDate:i,monthlyType:e,startTime:L.start_time});L.recurrence_rule=S,L.recurrence_end_date=f}else L.recurrence_rule=void 0,L.recurrence_end_date=void 0}else L.recurrence_rule=void 0,L.recurrence_end_date=void 0;return L}async function Ii({id:g,...m}){const w=nn(m);return g?(m.eventItem.bishop_approval==="NO"&&Object.assign(w,{bishop_approval:null,bishop_approval_at:null,bishop_approval_by_user_id:null,first_counselor_approval:null,first_counselor_approval_at:null,first_counselor_approval_by_user_id:null,second_counselor_approval:null,second_counselor_approval_at:null,second_counselor_approval_by_user_id:null}),{action:"update",event:await kt(g,w)}):{action:"create",event:await Pr(w)}}async function Ti(g){await zr(g)}function Ri({event:g,newDate:m}){const w=g.start_time?new Date(g.start_time):new Date,s=g.end_time?new Date(g.end_time):new Date,[t,r,d]=m.split("-").map(Number),o=new Date(w);o.setFullYear(t,r-1,d);const _=new Date(s);return _.setFullYear(t,r-1,d),{...g,id:void 0,title:`CLONED - ${g.title}`,start_time:o.toISOString(),end_time:_.toISOString(),attachments:[],recurrence_rule:void 0,recurrence_end_date:void 0}}async function Mi(g,m,w){const s=await Pt(g);if(!s)throw new Error("Event not found");const t=s.recurrence_exceptions||[];t.includes(m)||t.push(m);const r=s.recurrence_overrides||{};r[m]={title:w.title,description:w.description,location:w.location,start_time:w.start_time,end_time:w.end_time,is_all_day:w.is_all_day,meta_data:w.meta_data},await kt(g,{recurrence_exceptions:t,recurrence_overrides:r})}async function Ci(g,m,w){const s=await Pt(g);if(!s||!s.recurrence_rule||!s.start_time)throw new Error("Event not found or is not recurring");const{parseRecurrenceRule:t,generateRecurrenceRule:r}=await $t(async()=>{const{parseRecurrenceRule:P,generateRecurrenceRule:M}=await Promise.resolve().then(()=>hr);return{parseRecurrenceRule:P,generateRecurrenceRule:M}},void 0,import.meta.url),d=t(s.recurrence_rule,s.recurrence_end_date);if(!d)throw new Error("Failed to parse recurrence rule");const o=He(new Date(s.start_time),"yyyy-MM-dd"),_=Yt(m,"yyyy-MM-dd",new Date),p=Yt(o,"yyyy-MM-dd",new Date);if(_<=p)return await kt(g,w),g;const i=jt(_,-1),e=He(i,"yyyy-MM-dd"),{recurrence_rule:a,recurrence_end_date:c}=r({frequency:d.frequency,interval:d.interval,recurringDays:d.recurringDays,recurrenceEndDate:e,hasEndDate:!0,monthlyType:d.monthlyType,startTime:s.start_time});await kt(g,{recurrence_rule:a,recurrence_end_date:c});const l=d.hasEndDate?d.recurrenceEndDate:"",{recurrence_rule:k,recurrence_end_date:C}=r({frequency:d.frequency,interval:d.interval,recurringDays:d.recurringDays,recurrenceEndDate:l,hasEndDate:d.hasEndDate,monthlyType:d.monthlyType,startTime:w.start_time||s.start_time}),x={...w,recurrence_rule:k,recurrence_end_date:C};return(await Pr(x))?.id||0}async function Fi(g,m){const w=await Pt(g);if(!w)throw new Error("Event not found");const s={title:m.title,description:m.description,location:m.location,event_type:m.event_type,meta_data:m.meta_data,attachments:m.attachments,is_all_day:m.is_all_day,start_time:w.start_time,end_time:w.end_time,recurrence_rule:w.recurrence_rule,recurrence_end_date:w.recurrence_end_date,recurrence_exceptions:[],recurrence_overrides:{}};await kt(g,s)}async function Ui(g,m){const w=await Pt(g);if(!w)throw new Error("Event not found");const s=w.recurrence_exceptions||[];s.includes(m)||s.push(m);const t=w.recurrence_overrides||{};t[m]&&delete t[m],await kt(g,{recurrence_exceptions:s,recurrence_overrides:t})}async function Oi(g,m){const w=await Pt(g);if(!w||!w.recurrence_rule||!w.start_time)throw new Error("Event not found or is not recurring");const s=Yt(m,"yyyy-MM-dd",new Date),t=jt(s,-1),r=He(t,"yyyy-MM-dd"),{parseRecurrenceRule:d}=await $t(async()=>{const{parseRecurrenceRule:e}=await Promise.resolve().then(()=>hr);return{parseRecurrenceRule:e}},void 0,import.meta.url),o=d(w.recurrence_rule,w.recurrence_end_date);if(!o)throw new Error("Failed to parse recurrence rule");const{generateRecurrenceRule:_}=await $t(async()=>{const{generateRecurrenceRule:e}=await Promise.resolve().then(()=>hr);return{generateRecurrenceRule:e}},void 0,import.meta.url),{recurrence_rule:p,recurrence_end_date:i}=_({frequency:o.frequency,interval:o.interval,recurringDays:o.recurringDays,recurrenceEndDate:r,hasEndDate:!0,monthlyType:o.monthlyType,startTime:w.start_time});await kt(g,{recurrence_rule:p,recurrence_end_date:i})}async function zi(g){await zr(g)}function Pi(){return{saveEvent:Ii,deleteEventById:Ti,cloneEventForDate:Ri,buildEventPayload:nn,saveSingleInstance:Mi,saveFutureInstances:Ci,saveAllInstances:Fi,deleteSingleInstance:Ui,deleteFutureInstances:Oi,deleteAllInstances:zi}}var Bi=le('<div class="alert alert-info d-flex align-items-center gap-2 mb-0" role="alert"><i class="bi bi-arrow-repeat"></i> <div><strong>Recurring Event</strong> <div class="small">Changes to this event will apply to all future occurrences.</div></div></div>'),Li=le('<button class="btn btn-primary btn-sm"><i class="bi bi-files"></i> <span class="ms-1">Clone</span></button>'),Hi=le("<!> <!>",1),Ni=le('<span class="badge bg-secondary-subtle text-secondary-emphasis"> </span>'),qi=le('<div class="card"><button type="button" class="btn btn-link text-start text-decoration-none d-flex align-items-center gap-3 p-3 w-100 submitter-chat-toggle svelte-zsu5u8"><i class="bi bi-chat-left-dots"></i> <div class="d-flex flex-column align-items-start"><span class="fw-semibold">Discussion with Bishopric</span> <small class="text-muted">Ask questions or respond to feedback</small></div> <div class="ms-auto d-flex align-items-center gap-2"><!> <i class="bi bi-chevron-right"></i></div></button></div> <!>',1),Wi=le('<div class="alert alert-info small mb-0 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All submissions require bishopric approval before they appear on the public calendar.</span></div> <!>',1),$i=le('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),Yi=le("<span>Save</span>"),ji=le("<span>Create</span>"),Qi=le('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),Ki=le('<button class="btn btn-primary position-relative"><!> <!></button>'),Vi=le('<div class="d-flex flex-column gap-4"><!> <div class="d-flex flex-column gap-3"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap"><h2 class="h5 mb-0">Event Details</h2> <!></div> <!></div> <!> <!> <!> <!> <div class="d-flex justify-content-between align-items-center gap-2 flex-row"><div class="d-flex flex-row gap-2"><!></div> <div class="d-flex flex-row gap-2"><button class="btn btn-secondary position-relative">Cancel</button> <!></div></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span></div> <!></div> <!> <!>',1);function zs(g,m){nt(m,!1);const w=()=>or(N,"$userOrganizations",r),s=()=>or(P,"$currentUser",r),t=()=>or(M,"$validationErrors",r),[r,d]=zn(),o=ce(),_=ce(),p=ce(),i=ce(),e=ce();let a=ge(m,"name",8,""),c=ge(m,"drawerId",8,""),l=ge(m,"eventItem",12,Kn),k=ge(m,"canDelete",8,!0),C=ge(m,"canCreate",8,!0);const{actions:{reload:x}}=Nn(),{stores:{userOrganizations:N,currentUser:P}}=Hr(),{validationErrors:M,validate:L,getErrorMessages:y,clearErrors:S}=ui(),{parseRecurrenceRule:f}=Yr(),{uploadAttachment:v,removeAttachment:b,updateAttachmentName:A,validateFile:D}=Di(),{saveEvent:I,deleteEventById:E,cloneEventForDate:T,buildEventPayload:h,saveSingleInstance:u,saveFutureInstances:q,saveAllInstances:R,deleteSingleInstance:U,deleteFutureInstances:K,deleteAllInstances:Y}=Pi();let $=ce(!1),H=ce(!1),F=ce(!1),ee=ce("weekly"),ue=ce(1),he=ce([]),fe=ce(""),ve=ce(!0),Ee=ce("date"),Ae=ce([]),ke=ce(!1),Q=ce(!1),Z=ce(void 0),V=ce(void 0),re=ce(!1),se=ce(null),ne=ce(!1),ae=ce(null),ie=ce(0),me=ce({title:"",description:"",start_time:"",end_time:"",location:"",is_all_day:!1,event_type:"announcement"}),ye=ce({message:"",type:"info"}),oe=ce(""),pe=ce(""),Me=ce(""),Be=ce({dateInput:"",startTimeInput:"",endTimeInput:"",isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"}),xe=ce(!1);const Ye=(te,j)=>te.length===j.length&&te.every((we,Re)=>we===j[Re]);let De=ce([]),Ce=ce(!1),qe=ce(!1);const Ne=`submitter-chat-form-${na()}`;let Pe=ce(null),Fe=null,$e=null;Nr(async()=>{typeof window<"u"&&($e=(await $t(()=>import("./DO0djbQe.js").then(j=>j.o),__vite__mapDeps([0,1]),import.meta.url)).default)}),Zn(()=>{st()});function mt(){if(!$e)return;const te=document.getElementById(Ne);if(!te)return;$e.getOrCreateInstance(te).show()}function it(te){const j=te??l()?.id??null;if(Fe||!j)return;const we=typeof window<"u"?localStorage.getItem("authToken"):null;we&&cr.realtime.setAuth(we),Fe=cr.channel(`submitter-comments-form-${j}`).on("postgres_changes",{event:"*",schema:"public",table:"event_submitter_comments",filter:`event_id=eq.${j}`},()=>{lt(j)}).subscribe()}function st(){Fe&&(cr.removeChannel(Fe),Fe=null)}async function lt(te){const j=te??l()?.id??null;if(j){n(qe)||O(Ce,!0);try{const we=await qn(j);j===(l()?.id??null)&&(O(De,we),O(qe,!0))}catch(we){console.error("Failed to load submitter comments:",we)}finally{j===(l()?.id??null)&&O(Ce,!1)}}}async function Xt(te){if(!l()?.id||!s()?.id)return;const j=s().displayName||s().username||"Unknown";await jn(l().id,s().id,j,te),await lt()}async function ot(te){await Yn(te),await lt()}const Ge=()=>{const te=`[data-bs-target="#${c()}"]`,j=document.querySelector(te);j&&j.click()},Ue=(te,j=0,we="info")=>{lr(ye,n(ye).message=te),lr(ye,n(ye).type=we),j&&setTimeout(()=>{lr(ye,n(ye).message="")},j)},Et=async te=>{const j=te.detail;if(!j)return;const we=D(j);if(!we.valid){Ue(we.error??"Invalid file selected",7e3,"danger");return}O(H,!0);try{const Re=await v(j,n(o)??"temp",et=>Ue(et));if(!Re.success||!Re.attachment)throw new Error(Re.error??"Upload failed");O(Ae,[...n(Ae),Re.attachment]),O(ke,!0),Ue("File uploaded!",3e3,"success")}catch(Re){console.error("File upload failed:",Re),Ue("Failed to upload file. Please try again.",7e3,"danger")}finally{O(H,!1)}},Bt=te=>{const{attachment:j,newName:we}=te.detail;O(Ae,A(n(Ae),j.id,we)),O(ke,!0),Ue("Attachment name updated!",3e3,"success")},ht=async te=>{const j=te.detail;if(j){O(H,!0);try{if(!await b(j))throw new Error("Failed to remove attachment");O(Ae,n(Ae).filter(Re=>Re.id!==j.id)),O(ke,!0),Ue("Attachment removed!",3e3,"success")}catch(we){console.error("Failed to remove attachment:",we),Ue("Failed to remove attachment. Please try again.",7e3,"danger")}finally{O(H,!1)}}},gt=async()=>{if(!n(o)){Ue("ID is not defined",0,"danger");return}try{await E(n(o)),await x(),_t("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{O($,!1),O(me,{...l(),id:n(o)}),Ue("Event Deleted",3e3,"success"),Ge()},800)}catch(te){_t("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{O($,!1),console.error("Delete failed:",te),Ue("Failed to delete event. Please try again.",7e3,"danger")},800)}},an=()=>!!l().recurrence_rule,sn=async()=>{const te=n(o)||l().meta_data?.recurring_parent_id;if(te&&n(Q)&&n(V)&&n(Z)){if(O(ae,null),O(ne,!0),await new Promise(j=>{const we=setInterval(()=>{n(ne)||(clearInterval(we),j())},50)}),!n(ae))return;O($,!0);try{n(ae)==="single"?await U(te,n(Z)):n(ae)==="future"?await K(te,n(Z)):n(ae)==="all"&&await Y(te),await x(),_t("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{O($,!1),O(me,{...l(),id:n(o)}),Ue("Event Deleted",3e3,"success"),Ge()},800)}catch(j){_t("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{O($,!1),console.error("Delete failed:",j),Ue("Failed to delete event. Please try again.",7e3,"danger")},800)}}else O($,!0),Xn({title:"Delete Confirmation",message:an()?"This recurring event and every occurrence, past and future, will be removed. You won't be able to undo this. Continue?":"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:j=>{j?gt():O($,!1)}})},ln=te=>{if(n(o))try{const j=T({event:l(),newDate:te});_t("clone_calendar_event_form_loaded","interaction","Clone Calendar Event Form Loaded",1),Ue("Event cloned. Review and click Create to save.",5e3,"success"),l(j),O(oe,j.start_time?He(new Date(j.start_time),"yyyy-MM-dd"):""),O(pe,j.start_time?He(new Date(j.start_time),"HH:mm"):""),O(Me,j.end_time?He(new Date(j.end_time),"HH:mm"):""),O(Ae,[]),O(F,!1),O(he,[]),O(fe,""),O(ve,!0),O(ke,!0),O(ie,void 0),O(me,{...j}),O(Be,{dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Me),isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"})}catch(j){console.error("Clone failed:",j),Ue("Failed to clone event. Please try again.",7e3,"danger")}},on=()=>{ci({title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",defaultDate:n(oe),callback:(te,j)=>{te&&j&&ln(j)}})},cn=async()=>{if(n(o)&&!n(p)){Ue("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!await L({title:l().title,event_type:l().event_type,category:l().category??"",description:l().description,location:l().location,is_all_day:l().is_all_day,dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Me),isRecurring:n(F),recurrenceFrequency:n(ee),recurringDays:n(F)?n(he):[],recurrenceEndDate:n(F)?n(fe):void 0,hasEndDate:n(ve)})){const we=y();we.length&&Ue(we.join(". ")+".  Please address accordingly.",0,"danger");return}const j=n(o)||l().meta_data?.recurring_parent_id;if(j&&n(Q)&&n(V)&&n(Z)){if(O(se,null),O(re,!0),await new Promise(Re=>{const et=setInterval(()=>{n(re)||(clearInterval(et),Re())},100)}),!n(se)||n($))return;Ue("Saving ..."),O($,!0);const we=h({eventItem:l(),dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Me),attachments:n(Ae),isRecurring:n(_)&&n(F),recurrenceFrequency:n(ee),recurrenceInterval:n(ue),recurringDays:n(F)?n(he):[],recurrenceEndDate:n(F)?n(fe):"",hasEndDate:n(ve),monthlyType:n(Ee)});try{let Re;n(se)==="single"?await u(j,n(Z),we):n(se)==="future"?Re=await q(j,n(Z),we):n(se)==="all"&&await R(j,we),await x(),await Fn(),_t("set_calendar_event_success","interaction",`Set Calendar Event Successful ${l().title}`,1),O($,!1),Re&&l({...l(),id:Re}),l(l().attachments=n(Ae),!0),O(me,{...l(),id:Re||j}),O(ke,!1),Ue("Saved",3e3,"success"),Ge()}catch(Re){_t("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${l().title}`,1),setTimeout(()=>{O($,!1),console.error("Save failed:",Re),Ue("Failed to save event. Please try again.",7e3,"danger")},800)}}else{if(n($))return;Ue("Saving ..."),O($,!0);try{const we=await I({id:n(o),eventItem:l(),dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Me),attachments:n(Ae),isRecurring:n(_)&&n(F),recurrenceFrequency:n(ee),recurrenceInterval:n(ue),recurringDays:n(F)?n(he):[],recurrenceEndDate:n(F)?n(fe):"",hasEndDate:n(ve),monthlyType:n(Ee)});we.event&&l({...l(),...we.event}),l(l().attachments=n(Ae),!0),await x(),_t("set_calendar_event_success","interaction",`Set Calendar Event Successful ${l().title}`,1),setTimeout(()=>{O($,!1),O(me,{...l(),id:n(o)}),O(ke,!1),Ue("Saved",3e3,"success"),Ge()},800)}catch(we){_t("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${l().title}`,1),setTimeout(()=>{O($,!1),console.error("Save failed:",we),Ue("Failed to save event. Please try again.",7e3,"danger")},800)}}};Ie(()=>G(l()),()=>{O(o,l().id)}),Ie(()=>G(l()),()=>{O(_,l().event_type==="calendar_event")}),Ie(()=>(n(_),n(F),n(he),n(fe)),()=>{!n(_)&&(n(F)||n(he).length>0||n(fe))&&(O(F,!1),O(ee,"weekly"),O(ue,1),O(he,[]),O(fe,""),O(ve,!0),O(Ee,"date"))}),Ie(()=>(G(l()),n(ie),n(me),n(ke),n(oe),n(pe),n(Me),n(F),n(ee),n(ue),n(he),n(fe),n(ve),n(Ee)),()=>{if(l()?.id!==n(ie)||l()?.start_time!==n(me).start_time||l()?.meta_data?.recurring_instance_index!==n(me).meta_data?.recurring_instance_index){O($,!0);const te=n(ke),j=l();setTimeout(()=>{const we=j.event_type==="calendar_event";if(O(oe,we&&j.start_time?He(new Date(j.start_time),"yyyy-MM-dd"):""),O(pe,we&&j.start_time?He(new Date(j.start_time),"HH:mm"):""),O(Me,we&&j.end_time?He(new Date(j.end_time),"HH:mm"):""),te||O(Ae,j.attachments?[...j.attachments]:[]),j.meta_data?.recurring_instance&&j.start_time?(O(V,j.recurrence_rule),O(Q,!0),O(Z,He(new Date(j.start_time),"yyyy-MM-dd"))):(O(V,void 0),O(Q,!1),O(Z,void 0)),j.recurrence_rule){const Re=f(j.recurrence_rule,j.recurrence_end_date);Re?(O(F,!0),O(ee,Re.frequency),O(ue,Re.interval),O(he,Re.recurringDays),O(fe,Re.recurrenceEndDate),O(ve,Re.hasEndDate),O(Ee,Re.monthlyType)):(O(F,!1),O(ee,"weekly"),O(ue,1),O(he,[]),O(fe,""),O(ve,!0),O(Ee,"date"))}else O(F,!1),O(ee,"weekly"),O(ue,1),O(he,[]),O(fe,""),O(ve,!0),O(Ee,"date");O(ie,j.id),O(me,{...j}),O($,!1),O(ke,!1),S(),O(Be,{dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Me),isRecurring:n(F),recurrenceFrequency:n(ee),recurrenceInterval:n(ue),recurringDays:[...n(he)],recurrenceEndDate:n(fe),hasEndDate:n(ve),monthlyType:n(Ee)})},200)}}),Ie(()=>(n(me),G(l()),n(Ae),n(oe),n(Be),n(pe),n(Me),n(F),n(ee),n(ue),n(he),n(fe),n(ve),n(Ee)),()=>{O(p,n(me).title!==l().title||n(me).start_time!==l().start_time||n(me).end_time!==l().end_time||n(me).description!==l().description||n(me).location!==l().location||n(me).is_public!==l().is_public||n(me).category!==l().category||n(me).is_all_day!==l().is_all_day||JSON.stringify(n(Ae))!==JSON.stringify(l().attachments||[])||n(me).recurrence_rule!==l().recurrence_rule||n(me).recurrence_end_date!==l().recurrence_end_date||n(oe)!==n(Be).dateInput||n(pe)!==n(Be).startTimeInput||n(Me)!==n(Be).endTimeInput||n(F)!==n(Be).isRecurring||n(ee)!==n(Be).recurrenceFrequency||n(ue)!==n(Be).recurrenceInterval||!Ye(n(he),n(Be).recurringDays)||n(fe)!==n(Be).recurrenceEndDate||n(ve)!==n(Be).hasEndDate||n(Ee)!==n(Be).monthlyType)}),Ie(()=>(w(),Oe),()=>{O(xe,w().has(Oe.Bishopric))}),Ie(()=>(G(l()),s()),()=>{O(i,!!l()?.id&&!!s()?.id&&l().meta_data?.submitted_by_user_id===s().id)}),Ie(()=>(n(i),n(xe)),()=>{O(e,n(i)&&!n(xe))}),Ie(()=>(n(e),G(l()),n(Pe)),()=>{const te=n(e)?l()?.id??null:null;te&&te!==n(Pe)?(O(Pe,te),O(De,[]),O(qe,!1),O(Ce,!1),st(),lt(te),it(te)):!te&&n(Pe)!==null&&(O(Pe,null),O(De,[]),O(qe,!1),O(Ce,!1),st())}),St(),vt();var br=Vi(),Jt=We(br),wr=B(Jt);{var dn=te=>{var j=Bi();J(te,j)};de(wr,te=>{G(l()),n(o),X(()=>l().recurrence_rule&&n(o))&&te(dn)})}var er=W(wr,2),tr=B(er),un=W(B(tr),2);{var fn=te=>{var j=Li();_e(()=>j.disabled=n($)||n(H)),Se("click",j,on),J(te,j)};de(un,te=>{n(o)&&te(fn)})}z(tr);var vn=W(tr,2);{let te=ct(()=>n($)||n(H));Ca(vn,{get disabled(){return n(te)},get name(){return a()},get validationErrors(){return t()},get title(){return l().title},set title(j){l(l().title=j,!0)},get eventType(){return l().event_type},set eventType(j){l(l().event_type=j,!0)},get category(){return l().category},set category(j){l(l().category=j,!0)},get isPublic(){return l().is_public},set isPublic(j){l(l().is_public=j,!0)},get description(){return l().description},set description(j){l(l().description=j,!0)},$$legacy:!0})}z(er);var xr=W(er,2);{var mn=te=>{var j=Hi(),we=We(j);{let et=ct(()=>n($)||n(H));Ba(we,{get disabled(){return n(et)},get name(){return a()},get validationErrors(){return t()},get dateInput(){return n(oe)},set dateInput(Le){O(oe,Le)},get startTimeInput(){return n(pe)},set startTimeInput(Le){O(pe,Le)},get endTimeInput(){return n(Me)},set endTimeInput(Le){O(Me,Le)},get isAllDay(){return l().is_all_day},set isAllDay(Le){l(l().is_all_day=Le,!0)},$$legacy:!0})}var Re=W(we,2);{let et=ct(()=>n($)||n(H));ja(Re,{get disabled(){return n(et)},get name(){return a()},get validationErrors(){return t()},get isRecurring(){return n(F)},set isRecurring(Le){O(F,Le)},get recurrenceFrequency(){return n(ee)},set recurrenceFrequency(Le){O(ee,Le)},get recurrenceInterval(){return n(ue)},set recurrenceInterval(Le){O(ue,Le)},get recurringDays(){return n(he)},set recurringDays(Le){O(he,Le)},get recurrenceEndDate(){return n(fe)},set recurrenceEndDate(Le){O(fe,Le)},get monthlyType(){return n(Ee)},set monthlyType(Le){O(Ee,Le)},get dateInput(){return n(oe)},set dateInput(Le){O(oe,Le)},$$legacy:!0})}J(te,j)};de(xr,te=>{n(_)&&te(mn)})}var Er=W(xr,2);{let te=ct(()=>n($)||n(H));ri(Er,{get attachments(){return n(Ae)},get uploadingFile(){return n(H)},get disabled(){return n(te)},$$events:{upload:Et,edit:Bt,remove:ht}})}var Ar=W(Er,2);{let te=ct(()=>n($)||n(H)),j=ct(()=>`${a()}-location`);Ka(Ar,{get disabled(){return n(te)},get name(){return n(j)},get value(){return l().location},set value(we){l(l().location=we,!0)},$$legacy:!0})}var Dr=W(Ar,2);{var hn=te=>{var j=Wi(),we=W(We(j),2);{var Re=et=>{var Le=qi(),Mt=We(Le),Qe=B(Mt),pt=W(B(Qe),4),Sn=B(pt);{var In=Ct=>{var Ft=Ni(),Tr=B(Ft,!0);z(Ft),_e(()=>be(Tr,(n(De),X(()=>n(De).length)))),J(Ct,Ft)};de(Sn,Ct=>{n(De),X(()=>n(De).length>0)&&Ct(In)})}Je(2),z(pt),z(Qe),z(Mt);var Tn=W(Mt,2);{let Ct=ct(()=>(G(l()),X(()=>l()?.title||"Event")));aa(Tn,{get id(){return Ne},subtitle:"Discussion with Bishopric",get title(){return n(Ct)},className:"submitter-chat-drawer-stacked",bodyClass:"overflow-hidden d-flex flex-column",children:(Ft,Tr)=>{{let Rn=ct(()=>(s(),X(()=>s()?.id??-1))),Mn=ct(()=>n($)||n(H));$n(Ft,{get comments(){return n(De)},get currentUserId(){return n(Rn)},onSend:Xt,onDelete:ot,get loading(){return n(Ce)},fullHeight:!0,get disabled(){return n(Mn)}})}},$$slots:{default:!0}})}_e(()=>Te(Qe,"aria-controls",Ne)),Se("click",Qe,mt),J(et,Le)};de(we,et=>{n(e)&&et(Re)})}J(te,j)};de(Dr,te=>{n(xe)||te(hn)})}var rr=W(Dr,2),nr=B(rr),gn=B(nr);{var _n=te=>{var j=$i();_e(()=>j.disabled=n($)||n(H)),Se("click",j,sn),J(te,j)};de(gn,te=>{(n(o)||n(Q))&&k()&&te(_n)})}z(nr);var kr=W(nr,2),ar=B(kr),pn=W(ar,2);{var yn=te=>{var j=Ki(),we=B(j);{var Re=Qe=>{var pt=Yi();J(Qe,pt)},et=Qe=>{var pt=ji();J(Qe,pt)};de(we,Qe=>{n(o)||n(Q)?Qe(Re):Qe(et,!1)})}var Le=W(we,2);{var Mt=Qe=>{var pt=Qi();J(Qe,pt)};de(Le,Qe=>{n(p)&&Qe(Mt)})}z(j),_e(()=>j.disabled=n($)||n(H)),Se("click",j,cn),J(te,j)};de(pn,te=>{(n(o)||n(Q)||C())&&te(yn)})}z(kr),z(rr);var ir=W(rr,2),Lt=B(ir),bn=B(Lt,!0);z(Lt);var sr=W(Lt,2);let Sr;var wn=B(sr);qr(wn,{size:"xs"}),z(sr),z(ir);var xn=W(ir,2);{var En=te=>{{let j=ct(()=>n($)||n(H));Wn(te,{get disabled(){return n(j)},get reloadEvents(){return x},get eventItem(){return l()},set eventItem(we){l(we)},$$legacy:!0})}};de(xn,te=>{n(xe)&&te(En)})}z(Jt);var Ir=W(Jt,2);{var An=te=>{ai(te,{get eventTitle(){return G(l()),X(()=>l().title)},get occurrenceDate(){return n(Z)},callback:j=>{O(se,j),O(re,!1)}})};de(Ir,te=>{n(re)&&n(Z)&&te(An)})}var Dn=W(Ir,2);{var kn=te=>{si(te,{get eventTitle(){return G(l()),X(()=>l().title)},get occurrenceDate(){return n(Z)},callback:j=>{O(ae,j),O(ne,!1)}})};de(Dn,te=>{n(ne)&&n(Z)&&te(kn)})}_e(()=>{ar.disabled=n($)||n(H),tt(Lt,1,`fw-lighter fst-italic text-${n(ye),X(()=>n(ye).type)??""}`,"svelte-zsu5u8"),be(bn,(n(ye),X(()=>n(ye).message))),Sr=tt(sr,1,"",null,Sr,{"d-none":!n($)})}),Se("click",ar,Ge),J(g,br),at(),d()}const Ur={SRS:[Oe.Stake],SEQ:[Oe.Stake],SYO:[Oe.Stake],SYW:[Oe.Stake],SYM:[Oe.Stake],SPR:[Oe.Stake],SSS:[Oe.Stake],SYA:[Oe.Stake],RES:[Oe.ReliefSociety],ELQ:[Oe.EldersQuorum],YOU:[Oe.YoungWomen,Oe.YoungMen],YOW:[Oe.YoungWomen],YWP:[Oe.YoungWomen],YWR:[Oe.YoungWomen],YWD:[Oe.YoungWomen],YOM:[Oe.YoungMen],YMD:[Oe.YoungMen],YMT:[Oe.YoungMen],YMP:[Oe.YoungMen],PRI:[Oe.Primary],PRN:[Oe.Primary],PRS:[Oe.Primary],PRC:[Oe.Primary],PRV:[Oe.Primary],SUS:[Oe.SundaySchool],YSA:[Oe.Stake]},Gi=g=>{const m=new Set,w=g.meta_data?.submitted_by_organizations;if(w?.length)return w.forEach(t=>m.add(t)),m;const s=g.meta_data?.category;return s&&Ur[s]&&Ur[s].forEach(t=>m.add(t)),m},Ps=(g,m)=>{if(!g)return!1;const{currentUserId:w,isPrivileged:s,canEditOwnOrgEvents:t,userOrganizations:r}=m;if(s)return!0;const d=g.meta_data?.submitted_by_user_id;if(w&&typeof d=="number"&&d===w)return!0;if(!t)return!1;const o=Gi(g);if(!o.size)return!1;for(const _ of o)if(r.has(_))return!0;return!1};var Zi=le('<span class="text-muted">•</span>'),Xi=le("<span> </span> <!>",1),Ji=le('<span class="text-muted">•</span>'),es=le('<em class="small fw-lighter svelte-1bpzga2"><!></em> <!>',1),ts=le('<em class="small fw-lighter text-decoration-underline svelte-1bpzga2"><!> details</em>'),rs=le('<div class="small text-muted posted-meta svelte-1bpzga2">Posted <!> <!></div>'),ns=le('<div class="small text-muted posted-meta svelte-1bpzga2">Last edited <!> <!></div>'),as=le('<div class="small svelte-1bpzga2"><!> <!> <!></div>'),is=le('<div class="attachment-image-container svelte-1bpzga2"><button type="button" class="attachment-image-button svelte-1bpzga2"><img class="attachment-image svelte-1bpzga2"/></button> <div class="attachment-image-label svelte-1bpzga2"><small class="text-muted"> </small></div></div>'),ss=le('<button type="button" class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-2"><i class="bi bi-file-pdf"></i> <span class="text-truncate" style="max-width: 150px;"> </span> <small class="text-muted"> </small></button>'),ls=le('<div class="mt-1 svelte-1bpzga2"><div class="fw-semibold small mb-1 svelte-1bpzga2">Attachments:</div> <div class="d-flex flex-wrap gap-2"></div></div>'),os=le('<div class="details-container svelte-1bpzga2"><!> <!></div>'),cs=le('<div class="announcement-thumbnail-container svelte-1bpzga2"><img class="announcement-thumbnail svelte-1bpzga2"/></div>'),ds=le('<div role="button" tabindex="0" class="d-flex flex-column gap-1 svelte-1bpzga2"><div class="d-flex gap-1"><div class="d-flex flex-column flex-grow-1 gap-1 svelte-1bpzga2"><div class="fw-bold svelte-1bpzga2"><!></div> <div class="flex d-flex align-items-center flex-wrap gap-2"><!> <!> <!></div> <!></div> <!></div></div>');function Bs(g,m){nt(m,!1);const w=ce(),s=ce(),t=ce(),r=ce(),d=ce(),o=ce(),_=ce(),p=ce(),i=ce();let e=ge(m,"item",8),a=ge(m,"showDetails",12,!1),c=ge(m,"searchQuery",8,"");const l=U=>U<1024?U+" B":U<1024*1024?(U/1024).toFixed(1)+" KB":(U/(1024*1024)).toFixed(1)+" MB",k=U=>U.startsWith("image/"),C=U=>{window.open(U,"_blank")},x=U=>{if(!U)return"";try{return He(Ut(U),"MMM d, yyyy 'at' h:mm a")}catch{return""}},N=()=>{n(s)&&a(!a())},P=U=>{n(s)&&(U.key==="Enter"||U.key===" ")&&N()};Ie(()=>G(e()),()=>{O(w,e().attachments&&e().attachments.length>0?e().attachments.find(U=>k(U.type)):void 0)}),Ie(()=>G(e()),()=>{O(s,!!(e().description||e().attachments&&e().attachments.length>0))}),Ie(()=>G(e()),()=>{O(t,e().meta_data?.submitted_at??e().created_at)}),Ie(()=>n(t),()=>{O(r,x(n(t)))}),Ie(()=>G(e()),()=>{O(d,e().meta_data?.submitted_by_name)}),Ie(()=>(n(r),n(d)),()=>{O(o,!!(n(r)||n(d)))}),Ie(()=>G(e()),()=>{O(_,x(e().meta_data?.edited_at))}),Ie(()=>G(e()),()=>{O(p,e().meta_data?.edited_by_name)}),Ie(()=>(n(_),n(p)),()=>{O(i,!!(n(_)||n(p)))}),St(),vt();var M=ds(),L=B(M),y=B(L),S=B(y),f=B(S);Tt(f,()=>(G(yt),G(e()),G(c()),X(()=>yt(e().title||"",c())))),z(S);var v=W(S,2),b=B(v);{var A=U=>{var K=Xi(),Y=We(K),$=B(Y,!0);z(Y);var H=W(Y,2);{var F=ee=>{var ue=Zi();J(ee,ue)};de(H,ee=>{G(e()),X(()=>e().location||e().description||e().attachments&&e().attachments.length>0)&&ee(F)})}_e((ee,ue)=>{tt(Y,1,`badge rounded-pill bg-color-${ee??""}`,"svelte-1bpzga2"),be($,ue)},[()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.color_number)),()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.label))]),J(U,K)};de(b,U=>{G(e()),X(()=>e()?.meta_data?.category)&&U(A)})}var D=W(b,2);{var I=U=>{var K=es(),Y=We(K),$=B(Y);Tt($,()=>(G(yt),G(e()),G(c()),X(()=>yt(e().location,c())))),z(Y);var H=W(Y,2);{var F=ee=>{var ue=Ji();J(ee,ue)};de(H,ee=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&ee(F)})}J(U,K)};de(D,U=>{G(e()),X(()=>e().location)&&U(I)})}var E=W(D,2);{var T=U=>{var K=ts(),Y=B(K);{var $=F=>{var ee=Ze("Hide");J(F,ee)},H=F=>{var ee=Ze("Show");J(F,ee)};de(Y,F=>{a()?F($):F(H,!1)})}Je(),z(K),J(U,K)};de(E,U=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&U(T)})}z(v);var h=W(v,2);{var u=U=>{var K=os(),Y=B(K);{var $=ee=>{var ue=as(),he=B(ue);Tt(he,()=>(G(qt),G(e()),G(c()),X(()=>qt(e().description,c()))));var fe=W(he,2);{var ve=ke=>{var Q=rs(),Z=W(B(Q));{var V=ne=>{var ae=Ze();_e(()=>be(ae,n(r))),J(ne,ae)};de(Z,ne=>{n(r)&&ne(V)})}var re=W(Z,2);{var se=ne=>{var ae=Ot(),ie=We(ae);{var me=oe=>{var pe=Ze();_e(()=>be(pe,`by ${n(d)??""}`)),J(oe,pe)},ye=oe=>{var pe=Ze();_e(()=>be(pe,`by ${n(d)??""}`)),J(oe,pe)};de(ie,oe=>{n(r)?oe(me):oe(ye,!1)})}J(ne,ae)};de(re,ne=>{n(d)&&ne(se)})}z(Q),J(ke,Q)};de(fe,ke=>{n(o)&&ke(ve)})}var Ee=W(fe,2);{var Ae=ke=>{var Q=ns(),Z=W(B(Q));{var V=ne=>{var ae=Ze();_e(()=>be(ae,n(_))),J(ne,ae)};de(Z,ne=>{n(_)&&ne(V)})}var re=W(Z,2);{var se=ne=>{var ae=Ze();_e(()=>be(ae,`by ${n(p)??""}`)),J(ne,ae)};de(re,ne=>{n(p)&&ne(se)})}z(Q),J(ke,Q)};de(Ee,ke=>{n(i)&&ke(Ae)})}z(ue),J(ee,ue)};de(Y,ee=>{G(e()),X(()=>e().description)&&ee($)})}var H=W(Y,2);{var F=ee=>{var ue=ls(),he=W(B(ue),2);zt(he,5,()=>(G(e()),X(()=>e().attachments)),fe=>fe.id,(fe,ve)=>{var Ee=Ot(),Ae=We(Ee);{var ke=Z=>{var V=is(),re=B(V),se=B(re);z(re);var ne=W(re,2),ae=B(ne),ie=B(ae,!0);z(ae),z(ne),z(V),_e(()=>{Te(re,"title",`Open ${n(ve),X(()=>n(ve).name)??""}`),Te(se,"src",(n(ve),X(()=>n(ve).url))),Te(se,"alt",(n(ve),X(()=>n(ve).name))),be(ie,(n(ve),X(()=>n(ve).name)))}),Se("click",re,Wt(()=>C(n(ve).url))),J(Z,V)},Q=Z=>{var V=ss(),re=W(B(V),2),se=B(re,!0);z(re);var ne=W(re,2),ae=B(ne);z(ne),z(V),_e(ie=>{Te(V,"title",`Open ${n(ve),X(()=>n(ve).name)??""}`),be(se,(n(ve),X(()=>n(ve).name))),be(ae,`(${ie??""})`)},[()=>(n(ve),X(()=>l(n(ve).size)))]),Se("click",V,Wt(()=>C(n(ve).url))),J(Z,V)};de(Ae,Z=>{n(ve),X(()=>k(n(ve).type))?Z(ke):Z(Q,!1)})}J(fe,Ee)}),z(he),z(ue),J(ee,ue)};de(H,ee=>{G(e()),X(()=>e().attachments&&e().attachments.length>0)&&ee(F)})}z(K),J(U,K)};de(h,U=>{a()&&U(u)})}z(y);var q=W(y,2);{var R=U=>{var K=cs(),Y=B(K);z(K),_e(()=>{Te(Y,"src",(n(w),X(()=>n(w).url))),Te(Y,"alt",(n(w),X(()=>n(w).name)))}),J(U,K)};de(q,U=>{n(w)&&U(R)})}z(L),z(M),_e(()=>Br(M,n(s)?"cursor: pointer;":"")),Se("keydown",M,P),Se("click",M,N),J(g,M),at()}export{zs as A,Os as E,Bs as a,Ps as c};
