const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BOsxNJ5s.js","./BWCcv1pC.js","./DIeogL5L.js","./DqgkBxsg.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./CuVcyAaV.js","./KiCntiD6.js","./CvOYN50o.js","./CDrl09S1.js","./DnVuGurV.js","./BJhH47Ua.js","./BUApaBEI.js","./BeNQ5BU7.js","./TQLXPvU9.js","../assets/Spinner.DTjfhZ6-.css","./pEAXO0Hl.js","./C7eOEiMq.js","./CzDGc265.js","./Drf-2KpF.js","./DwL8UaIJ.js","./DcWZ5Z_E.js","./Z1YyCaGw.js","./D9dADsae.js","./ByjMlHuk.js","../assets/BishopricApprovalSection.DRGo_BHg.css"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{o as je,w as va,g as Be}from"./CuVcyAaV.js";import{p as de,ai as G,n as u,m as t,aj as Ce,B as C,a as ue,E as R,s,c as n,D,r as a,u as r,f as mt,R as Wt,F as ve,C as Ne}from"./BWCcv1pC.js";import{p as qt,i as g,s as F,e as gt,b as It,a as Fe,d as ca,j as da}from"./KiCntiD6.js";import{e as ee,i as Te}from"./CvOYN50o.js";import{f as m,a as o,c as Ht,t as te}from"./DqgkBxsg.js";import{s as $t,e as ua,b as ma}from"./CDrl09S1.js";import{t as Ee,c as Ve,i as dt,p as xt,f as Jt,e as Ue,O as we,P as Ut,y as _a,A as be,z as pa}from"./DnVuGurV.js";import{s as xe}from"./CdEA5IGF.js";import{i as me}from"./BeNQ5BU7.js";import{C as Qe,c as Je}from"./Cl2REAJA.js";import{b as ae,h as Re,g as Ge,C as Ze,f as fa,i as ye,c as ge}from"./BOsxNJ5s.js";import{S as ke}from"./TQLXPvU9.js";import{v as Me,D as De}from"./pEAXO0Hl.js";import{_ as Ye}from"./CmsKOCeN.js";import{R as ce}from"./DcWZ5Z_E.js";import{P as ba}from"./BgB8pT2-.js";import{p as ya}from"./Cn0GwYpZ.js";import{c as ga,e as ha}from"./DwL8UaIJ.js";import{i as he}from"./CQhl2uTy.js";import{e as Ea}from"./Z1YyCaGw.js";import{a as ze}from"./D9dADsae.js";function Xe(w,_){const e=Ee(w);if(isNaN(_))return Ve(w,NaN);if(!_)return e;const i=e.getDate(),S=Ve(w,e.getTime());S.setMonth(e.getMonth()+_+1,0);const z=S.getDate();return i>=z?S:(e.setFullYear(S.getFullYear(),S.getMonth(),i),e)}function wa(w){const _=Ee(w);return _.setDate(1),_.setHours(0,0,0,0),_}function He(w,_){const e=Ee(w),i=Ee(_);return e.getFullYear()===i.getFullYear()&&e.getMonth()===i.getMonth()}function We(w){return he(w,ga(w))}function xa(w,_){return Xe(w,-1)}var ka=m('<div class="event-header-image svelte-lu3xbf"><img class="svelte-lu3xbf"/></div>'),Ma=m("<span> </span>"),Da=m('<button type="button" class="btn btn-sm btn-outline-primary"><i class="bi bi-pencil"></i> Edit</button>'),Ca=m('<p class="section-content svelte-lu3xbf"><span class="badge bg-secondary">All Day Event</span></p>'),Ia=m('<p class="section-content svelte-lu3xbf"> </p>'),$a=m('<p class="section-content svelte-lu3xbf"><strong> </strong></p> <!>',1),Oa=m('<p class="section-content text-muted svelte-lu3xbf"><i class="bi bi-arrow-repeat"></i> <!></p>'),Sa=m('<p class="section-content text-muted svelte-lu3xbf"><i class="bi bi-arrow-repeat"></i> Part of recurring event series</p>'),Aa=m('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-geo-alt"></i> Location</h6> <p class="section-content svelte-lu3xbf"> </p></div>'),Ta=m('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-card-text"></i> Description</h6> <div class="section-content event-description svelte-lu3xbf"><!></div></div>'),Ra=m('<div class="attachment-image-container svelte-lu3xbf"><button type="button" class="attachment-image-button svelte-lu3xbf"><img class="attachment-image svelte-lu3xbf"/></button> <div class="attachment-image-label svelte-lu3xbf"><small class="text-muted"> </small></div></div>'),Fa=m('<button type="button" class="btn btn-outline-secondary attachment-file-button svelte-lu3xbf"><i class="bi bi-file-pdf"></i> <span class="text-truncate svelte-lu3xbf"> </span> <small class="text-muted"> </small></button>'),Ua=m('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-paperclip"></i> Attachments</h6> <div class="attachments-grid svelte-lu3xbf"></div></div>'),Pa=m('<p class="metadata-item svelte-lu3xbf"><i class="bi bi-clock-history"></i> Posted <!> <!></p>'),La=m('<p class="metadata-item svelte-lu3xbf"><i class="bi bi-pencil-square"></i> Last edited <!> <!></p>'),Ba=m('<div class="event-section event-metadata svelte-lu3xbf"><!> <!></div>'),Na=m('<div class="event-details-view svelte-lu3xbf"><div class="event-header svelte-lu3xbf"><div class="event-header-content svelte-lu3xbf"><!> <div class="event-header-text svelte-lu3xbf"><h3 class="event-title svelte-lu3xbf"> </h3> <!></div></div> <!></div> <div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-calendar-event"></i> Date & Time</h6> <!> <!></div> <!> <!> <!> <!></div>');function ta(w,_){de(_,!1);const e=R(),i=R(),S=R(),z=R(),H=R(),W=R(),Z=R(),q=R(),k=R();let b=qt(_,"event",8),lt=qt(_,"onEdit",8,null),vt=qt(_,"canEdit",8,!1);const kt=c=>c.startsWith("image/"),Et=c=>c<1024?c+" B":c<1024*1024?(c/1024).toFixed(1)+" KB":(c/(1024*1024)).toFixed(1)+" MB",Ot=c=>{window.open(c,"_blank")},ht=c=>{if(!c)return"";try{return dt(xt(c),"MMM d, yyyy 'at' h:mm a")}catch{return""}},Tt=c=>{try{const v=ce.fromString(c).origOptions,E=v.interval||1,M=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],X=["","1st","2nd","3rd","4th","5th"];if(v.freq===ce.DAILY)return E===1?"Repeats daily":`Repeats every ${E} days`;if(v.freq===ce.WEEKLY){if(v.byweekday){const p=(Array.isArray(v.byweekday)?v.byweekday:[v.byweekday]).map(d=>{const y=typeof d=="number"?d:d.weekday,$=y===6?0:y+1;return M[$]});return E===1?p.length===1?`Repeats every ${p[0]}`:`Repeats on ${p.join(", ")}`:`Repeats every ${E} weeks on ${p.join(", ")}`}return E===1?"Repeats weekly":`Repeats every ${E} weeks`}if(v.freq===ce.MONTHLY){if(v.byweekday){const p=(Array.isArray(v.byweekday)?v.byweekday:[v.byweekday])[0];if(p&&typeof p=="object"&&"n"in p&&"weekday"in p){const d=p.weekday,y=d===6?0:d+1,$=p.n,N=X[$]||`${$}th`;return E===1?`Repeats on the ${N} ${M[y]} of the month`:`Repeats on the ${N} ${M[y]} every ${E} months`}}if(v.bymonthday){const l=Array.isArray(v.bymonthday)?v.bymonthday[0]:v.bymonthday,p=l===1?"st":l===2?"nd":l===3?"rd":"th";return E===1?`Repeats on the ${l}${p} of the month`:`Repeats on the ${l}${p} every ${E} months`}return E===1?"Repeats monthly":`Repeats every ${E} months`}if(v.freq===ce.YEARLY){if(v.bymonth&&v.bymonthday){const l=["","January","February","March","April","May","June","July","August","September","October","November","December"],p=Array.isArray(v.bymonth)?v.bymonth[0]:v.bymonth,d=Array.isArray(v.bymonthday)?v.bymonthday[0]:v.bymonthday,y=d===1?"st":d===2?"nd":d===3?"rd":"th";return E===1?`Repeats every ${l[p]} ${d}${y}`:`Repeats every ${E} years on ${l[p]} ${d}${y}`}return E===1?"Repeats yearly":`Repeats every ${E} years`}return"Repeats"}catch{return"Repeats"}};G(()=>u(b()),()=>{D(e,ae(b()?.meta_data?.category??""))}),G(()=>u(b()),()=>{D(i,b().meta_data?.submitted_at??b().created_at)}),G(()=>t(i),()=>{D(S,ht(t(i)))}),G(()=>u(b()),()=>{D(z,b().meta_data?.submitted_by_name)}),G(()=>(t(S),t(z)),()=>{D(H,!!(t(S)||t(z)))}),G(()=>u(b()),()=>{D(W,ht(b().meta_data?.edited_at))}),G(()=>u(b()),()=>{D(Z,b().meta_data?.edited_by_name)}),G(()=>(t(W),t(Z)),()=>{D(q,!!(t(W)||t(Z)))}),G(()=>u(b()),()=>{D(k,b().attachments?.find(c=>kt(c.type)))}),Ce(),me();var Mt=Na(),Rt=n(Mt),st=n(Rt),Kt=n(st);{var Nt=c=>{var f=ka(),v=n(f);a(f),C(()=>{$t(v,"src",(t(k),r(()=>t(k).url))),$t(v,"alt",(t(k),r(()=>t(k).name)))}),o(c,f)};g(Kt,c=>{t(k)&&c(Nt)})}var Ft=s(Kt,2),ft=n(Ft),Vt=n(ft,!0);a(ft);var Pt=s(ft,2);{var Lt=c=>{var f=Ma(),v=n(f,!0);a(f),C(()=>{Jt(f,1,`badge rounded-pill bg-color-${t(e),r(()=>t(e).color_number)??""}`,"svelte-lu3xbf"),F(v,(t(e),r(()=>t(e).label)))}),o(c,f)};g(Pt,c=>{t(e),r(()=>t(e)?.label)&&c(Lt)})}a(Ft),a(st);var Yt=s(st,2);{var zt=c=>{var f=Da();gt("click",f,function(...v){lt()?.apply(this,v)}),o(c,f)};g(Yt,c=>{vt()&&lt()&&c(zt)})}a(Rt);var Bt=s(Rt,2),T=s(n(Bt),2);{var h=c=>{var f=$a(),v=mt(f),E=n(v),M=n(E,!0);a(E),a(v);var X=s(v,2);{var l=d=>{var y=Ca();o(d,y)},p=d=>{var y=Ht(),$=mt(y);{var N=L=>{var Y=Ia(),wt=n(Y);a(Y),C((B,x)=>F(wt,`${B??""} - ${x??""}`),[()=>(u(dt),u(xt),u(b()),r(()=>dt(xt(b().start_time),"h:mm a"))),()=>(u(dt),u(xt),u(b()),r(()=>dt(xt(b().end_time),"h:mm a")))]),o(L,Y)};g($,L=>{u(b()),r(()=>b().start_time&&b().end_time)&&L(N)},!0)}o(d,y)};g(X,d=>{u(b()),r(()=>b().is_all_day)?d(l):d(p,!1)})}C(d=>F(M,d),[()=>(u(dt),u(xt),u(b()),r(()=>dt(xt(b().start_time),"EEEE, MMMM d, yyyy")))]),o(c,f)};g(T,c=>{u(b()),r(()=>b().start_time)&&c(h)})}var I=s(T,2);{var U=c=>{var f=Oa(),v=s(n(f)),E=s(v);{var M=X=>{var l=te();C(p=>F(l,`until ${p??""}`),[()=>(u(dt),u(xt),u(b()),r(()=>dt(xt(b().recurrence_end_date),"MMM d, yyyy")))]),o(X,l)};g(E,X=>{u(b()),r(()=>b().recurrence_end_date)&&X(M)})}a(f),C(X=>F(v,` ${X??""} `),[()=>(u(b()),r(()=>Tt(b().recurrence_rule)))]),o(c,f)},j=c=>{var f=Ht(),v=mt(f);{var E=M=>{var X=Sa();o(M,X)};g(v,M=>{u(b()),r(()=>b()?.meta_data?.recurring_instance)&&M(E)},!0)}o(c,f)};g(I,c=>{u(b()),r(()=>b().recurrence_rule)?c(U):c(j,!1)})}a(Bt);var ct=s(Bt,2);{var V=c=>{var f=Aa(),v=s(n(f),2),E=n(v,!0);a(v),a(f),C(()=>F(E,(u(b()),r(()=>b().location)))),o(c,f)};g(ct,c=>{u(b()),r(()=>b().location)&&c(V)})}var P=s(ct,2);{var A=c=>{var f=Ta(),v=s(n(f),2),E=n(v);Re(E,()=>(u(b()),r(()=>b().description))),a(v),a(f),o(c,f)};g(P,c=>{u(b()),r(()=>b().description)&&c(A)})}var ot=s(P,2);{var rt=c=>{var f=Ua(),v=s(n(f),2);ee(v,5,()=>(u(b()),r(()=>b().attachments)),E=>E.id,(E,M)=>{var X=Ht(),l=mt(X);{var p=y=>{var $=Ra(),N=n($),L=n(N);a(N);var Y=s(N,2),wt=n(Y),B=n(wt,!0);a(wt),a(Y),a($),C(()=>{$t(N,"title",`Open ${t(M),r(()=>t(M).name)??""}`),$t(L,"src",(t(M),r(()=>t(M).url))),$t(L,"alt",(t(M),r(()=>t(M).name))),F(B,(t(M),r(()=>t(M).name)))}),gt("click",N,()=>Ot(t(M).url)),o(y,$)},d=y=>{var $=Fa(),N=s(n($),2),L=n(N,!0);a(N);var Y=s(N,2),wt=n(Y);a(Y),a($),C(B=>{$t($,"title",`Open ${t(M),r(()=>t(M).name)??""}`),F(L,(t(M),r(()=>t(M).name))),F(wt,`(${B??""})`)},[()=>(t(M),r(()=>Et(t(M).size)))]),gt("click",$,()=>Ot(t(M).url)),o(y,$)};g(l,y=>{t(M),r(()=>kt(t(M).type))?y(p):y(d,!1)})}o(E,X)}),a(v),a(f),o(c,f)};g(ot,c=>{u(b()),r(()=>b().attachments&&b().attachments.length>0)&&c(rt)})}var Q=s(ot,2);{var it=c=>{var f=Ba(),v=n(f);{var E=l=>{var p=Pa(),d=s(n(p),2);{var y=L=>{var Y=te();C(()=>F(Y,t(S))),o(L,Y)};g(d,L=>{t(S)&&L(y)})}var $=s(d,2);{var N=L=>{var Y=te();C(()=>F(Y,`by ${t(z)??""}`)),o(L,Y)};g($,L=>{t(z)&&L(N)})}a(p),o(l,p)};g(v,l=>{t(H)&&l(E)})}var M=s(v,2);{var X=l=>{var p=La(),d=s(n(p),2);{var y=L=>{var Y=te();C(()=>F(Y,t(W))),o(L,Y)};g(d,L=>{t(W)&&L(y)})}var $=s(d,2);{var N=L=>{var Y=te();C(()=>F(Y,`by ${t(Z)??""}`)),o(L,Y)};g($,L=>{t(Z)&&L(N)})}a(p),o(l,p)};g(M,l=>{t(q)&&l(X)})}a(f),o(c,f)};g(Q,c=>{(t(H)||t(q))&&c(it)})}a(Mt),C(()=>F(Vt,(u(b()),r(()=>b().title)))),o(w,Mt),ue()}var Va=m('<button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add announcement"><i class="bi bi-plus"></i></button>'),Ya=m("<span> </span>"),za=m('<span class="announcement-location svelte-1yokbat"><i class="bi bi-geo-alt"></i> </span>'),Ha=m('<div class="announcement-thumbnail-container svelte-1yokbat"><img class="announcement-thumbnail svelte-1yokbat"/></div>'),Wa=m('<button type="button" class="btn btn-sm btn-outline-secondary" title="Edit announcement"><i class="bi bi-pencil"></i></button>'),qa=m('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="announcement-details-button svelte-1yokbat"><div class="announcement-title svelte-1yokbat"> </div> <div class="announcement-meta svelte-1yokbat"><!> <!></div></button> <!> <div class="announcement-actions svelte-1yokbat"><!></div></li>'),Ka=m('<div class="announcements-footer svelte-1yokbat"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),ja=m('<div class="announcements-list-container svelte-1yokbat"><ul class="list-group list-group-flush"></ul></div> <!>',1),Qa=m('<div class="no-announcements svelte-1yokbat"><!></div>'),Ja=m('<div class="announcements-container svelte-1yokbat"><div class="announcements-header svelte-1yokbat"><h2 class="announcements-title svelte-1yokbat">Announcements</h2> <div class="announcements-actions svelte-1yokbat"><!></div></div> <!></div>'),Ga=m('<div class="d-flex flex-column gap-4"><!></div>'),Za=m("<!> <!> <!>",1);function kn(w,_){de(_,!1);const e=()=>It(Kt,"$searchQuery",k),i=()=>It(st,"$announcements",k),S=()=>It(Et,"$currentUser",k),z=()=>It(Mt,"$userOrganizations",k),H=()=>It(Ot,"$currentUserHasPermission",k),W=()=>It(Tt,"$currentUserIsRoot",k),Z=()=>It(ht,"$currentUserIsAdmin",k),q=()=>It(Rt,"$ready",k),[k,b]=Fe(),lt=R(),vt=R(),kt=R(),{stores:{currentUser:Et,currentUserHasPermission:Ot,currentUserIsAdmin:ht,currentUserIsRoot:Tt,userOrganizations:Mt}}=Ue(),{stores:{ready:Rt,announcements:st,searchQuery:Kt},actions:{reload:Nt}}=Ge(),Ft={title:"Announcement",description:"",location:"",event_type:"announcement",is_public:!0},ft=Me(),Vt=Me();let Pt=R(!1),Lt=R(!1),Yt=R(),zt=R(!1),Bt=R(!1),T=R(!1),h=R(new Set),I=R(""),U=R({...Ft}),j=R({...Ft});const ct=5,V=5;let P=R(ct);function A(){D(P,t(P)+V)}const ot=d=>Je(d,{currentUserId:t(Yt),isPrivileged:t(Lt),canEditOwnOrgEvents:t(T),userOrganizations:t(h)}),rt=d=>d.startsWith("image/");je(async()=>{await Nt()});const Q=d=>{D(I,"Announcement Form"),D(U,{...d,category:d?.meta_data?.category})},it=d=>{D(j,d);const y=document.getElementById(Vt);y&&new window.bootstrap.Offcanvas(y).show()},c=d=>{Q(d);const y=document.getElementById(ft);y&&new window.bootstrap.Offcanvas(y).show()},f=()=>{const d=document.getElementById(Vt);if(d){const y=window.bootstrap.Offcanvas.getInstance(d);y&&y.hide()}Q(t(j)),setTimeout(()=>{const y=document.getElementById(ft);y&&new window.bootstrap.Offcanvas(y).show()},300)};G(()=>(e(),i(),t(P)),()=>{D(lt,e()?i()??[]:(i()??[]).slice(0,t(P)))}),G(()=>(e(),i(),t(P)),()=>{D(vt,!e()&&(i()?.length??0)>t(P))}),G(()=>S(),()=>{D(Yt,S()?.id)}),G(()=>t(Yt),()=>{D(Bt,!!t(Yt))}),G(()=>z(),()=>{D(h,z())}),G(()=>(t(h),we),()=>{D(zt,t(h).has(we.Bishopric))}),G(()=>(H(),Ut),()=>{D(T,H()(Ut.EditOwnOrgEvents))}),G(()=>(W(),Z(),t(zt),H(),Ut),()=>{D(Lt,W()||Z()||t(zt)||H()(Ut.EditAllEvents))}),G(()=>(t(Lt),H(),t(T),t(Bt)),()=>{D(Pt,t(Lt)||H()(Ut.CreateEvents)||t(T)||t(Bt))}),G(()=>(H(),Ut),()=>{D(kt,H()(Ut.DeleteEvents))}),Ce(),me();var v=Za(),E=mt(v);De(E,{get title(){return t(I)},get id(){return ft},children:(d,y)=>{Qe(d,{get eventItem(){return t(U)},get drawerId(){return ft},name:"announcement-item-form",get canDelete(){return t(kt)}})},$$slots:{default:!0}});var M=s(E,2);De(M,{title:"Announcement Details",get id(){return Vt},children:(d,y)=>{{let $=Wt(()=>(t(j),r(()=>ot(t(j)))));ta(d,{get event(){return t(j)},get canEdit(){return t($)},onEdit:f})}},$$slots:{default:!0}});var X=s(M,2);{var l=d=>{var y=Ja(),$=n(y),N=s(n($),2),L=n(N);{var Y=O=>{var K=Va();C(()=>{$t(K,"data-bs-target",`#${ft??""}`),$t(K,"aria-controls",ft)}),gt("click",K,()=>Q({...Ft,event_type:"announcement"})),o(O,K)};g(L,O=>{t(Pt)&&O(Y)})}a(N),a($);var wt=s($,2);{var B=O=>{var K=ja(),Dt=mt(K),bt=n(Dt);ee(bt,5,()=>t(lt),J=>J.id,(J,tt)=>{const St=Wt(()=>(t(tt),r(()=>t(tt).attachments?.find(yt=>rt(yt.type))))),pt=Wt(()=>(u(ae),t(tt),r(()=>ae(t(tt)?.meta_data?.category??""))));var At=qa(),Gt=n(At),et=s(Gt,2),Zt=n(et),jt=n(Zt,!0);a(Zt);var ne=s(Zt,2),oe=n(ne);{var se=yt=>{var Ct=Ya(),re=n(Ct,!0);a(Ct),C(()=>{Jt(Ct,1,`badge rounded-pill bg-color-${u(t(pt)),r(()=>t(pt).color_number)??""}`,"svelte-1yokbat"),F(re,(u(t(pt)),r(()=>t(pt).label)))}),o(yt,Ct)};g(oe,yt=>{u(t(pt)),r(()=>t(pt)?.label)&&yt(se)})}var ie=s(oe,2);{var Ie=yt=>{var Ct=za(),re=s(n(Ct));a(Ct),C(()=>F(re,` ${t(tt),r(()=>t(tt).location)??""}`)),o(yt,Ct)};g(ie,yt=>{t(tt),r(()=>t(tt).location)&&yt(Ie)})}a(ne),a(et);var le=s(et,2);{var _e=yt=>{var Ct=Ha(),re=n(Ct);a(Ct),C(()=>{$t(re,"src",(u(t(St)),r(()=>t(St).url))),$t(re,"alt",(u(t(St)),r(()=>t(St).name)))}),o(yt,Ct)};g(le,yt=>{t(St)&&yt(_e)})}var pe=s(le,2),fe=n(pe);{var $e=yt=>{var Ct=Wa();gt("click",Ct,xe(()=>c(t(tt)))),o(yt,Ct)};g(fe,yt=>{t(tt),r(()=>ot(t(tt)))&&yt($e)})}a(pe),a(At),C(()=>{Jt(Gt,1,`announcement-color-indicator bg-color-${u(t(pt)),r(()=>t(pt)?.color_number??0)??""}`,"svelte-1yokbat"),F(jt,(t(tt),r(()=>t(tt).title)))}),gt("click",et,()=>it(t(tt))),o(J,At)}),a(bt),a(Dt);var _t=s(Dt,2);{var nt=J=>{var tt=Ka(),St=n(tt),pt=n(St);a(St);var At=s(St,2);a(tt),C(()=>F(pt,`Showing ${t(P)??""} of ${i(),r(()=>i()?.length??0)??""}`)),gt("click",At,A),o(J,tt)};g(_t,J=>{t(vt)&&J(nt)})}o(O,K)},x=O=>{var K=Ht(),Dt=mt(K);{var bt=_t=>{var nt=Qa(),J=n(nt);{var tt=pt=>{var At=te("No announcements match your search.");o(pt,At)},St=pt=>{var At=te("There are no announcements yet.");o(pt,At)};g(J,pt=>{e()?pt(tt):pt(St,!1)})}a(nt),o(_t,nt)};g(Dt,_t=>{i(),r(()=>i()?.length===0)&&_t(bt)},!0)}o(O,K)};g(wt,O=>{t(lt),r(()=>t(lt).length)?O(B):O(x,!1)})}a(y),o(d,y)},p=d=>{var y=Ga(),$=n(y);ke($,{}),a(y),o(d,y)};g(X,d=>{q()?d(l):d(p,!1)})}o(w,v),ue(),b()}const ea={};for(const w of Object.values(Ze))w.key&&(ea[w.label.toLowerCase()]=w.key);const Xa=new Set(Object.values(Ze).map(w=>w.key).filter(Boolean));function tr(w){const _=w.trim();if(_)return Xa.has(_.toUpperCase())?_.toUpperCase():ea[_.toLowerCase()]}async function er(w){return new Promise((_,e)=>{ba.parse(w,{header:!0,skipEmptyLines:!0,complete:i=>{const S=i.data,z=i.meta.fields||[];_({data:S,columns:z})},error:i=>e(i)})})}function ar(w){return w.map(_=>{const e=_.toLowerCase().trim();return e==="title"||e==="event"||e==="event name"||e==="name"?{csvColumn:_,eventField:"title"}:e==="description"||e==="details"||e==="notes"?{csvColumn:_,eventField:"description"}:e==="start date"||e==="start_date"||e==="date"||e==="event date"?{csvColumn:_,eventField:"start_date"}:e==="start time"||e==="start_time"||e==="time"||e==="event time"?{csvColumn:_,eventField:"start_time"}:e==="end date"||e==="end_date"?{csvColumn:_,eventField:"end_date"}:e==="end time"||e==="end_time"?{csvColumn:_,eventField:"end_time"}:e==="location"||e==="place"||e==="venue"?{csvColumn:_,eventField:"location"}:e==="category"||e==="group"||e==="organization"||e==="org"?{csvColumn:_,eventField:"category"}:e==="all day"||e==="all_day"||e==="is_all_day"||e==="allday"?{csvColumn:_,eventField:"is_all_day"}:{csvColumn:_,eventField:null}})}function Xt(w,_,e){const i=_.find(S=>S.eventField===e);return i?(w[i.csvColumn]||"").trim():""}function qe(w){const _=["yyyy-MM-dd","MM/dd/yyyy","M/d/yyyy","MM-dd-yyyy","M-d-yyyy","MM/dd/yy","M/d/yy","yyyy/MM/dd","MMM d, yyyy","MMMM d, yyyy","MMM d yyyy","d MMM yyyy"];for(const e of _){const i=ya(w,e,new Date);if(_a(i))return i}return null}function Ke(w){const _=w.match(/^(\d{1,2}):(\d{2})$/);if(_){const i=parseInt(_[1],10),S=parseInt(_[2],10);if(i>=0&&i<=23&&S>=0&&S<=59)return{hours:i,minutes:S}}const e=w.match(/^(\d{1,2})(?::(\d{2}))?\s*(am|pm)$/i);if(e){let i=parseInt(e[1],10);const S=e[2]?parseInt(e[2],10):0,z=e[3].toLowerCase();if(i>=1&&i<=12&&S>=0&&S<=59)return z==="pm"&&i!==12&&(i+=12),z==="am"&&i===12&&(i=0),{hours:i,minutes:S}}return null}function rr(w){const _=w.toLowerCase().trim();return["true","yes","1","y","x"].includes(_)}function nr(w,_,e){const i=[],S=Xt(w,_,"title"),z=Xt(w,_,"description"),H=Xt(w,_,"start_date"),W=Xt(w,_,"start_time"),Z=Xt(w,_,"end_date"),q=Xt(w,_,"end_time"),k=Xt(w,_,"location"),b=Xt(w,_,"category"),lt=Xt(w,_,"is_all_day");if(!S)return i.push({row:e,field:"title",message:"Title is required"}),{event:null,errors:i};if(S.length<3)return i.push({row:e,field:"title",message:"Title must be at least 3 characters"}),{event:null,errors:i};if(S.length>255)return i.push({row:e,field:"title",message:"Title cannot exceed 255 characters"}),{event:null,errors:i};if(!H)return i.push({row:e,field:"start_date",message:"Start date is required"}),{event:null,errors:i};const vt=qe(H);if(!vt)return i.push({row:e,field:"start_date",message:`Invalid date format: "${H}"`}),{event:null,errors:i};const kt=lt?rr(lt):!W;let Et;if(!kt&&W){const st=Ke(W);if(!st)return i.push({row:e,field:"start_time",message:`Invalid time format: "${W}"`}),{event:null,errors:i};vt.setHours(st.hours,st.minutes,0,0),Et=ye(vt,be)}else vt.setHours(0,0,0,0),Et=ye(vt,be);let Ot;const ht=Z?qe(Z):new Date(vt);if(ht&&!kt&&q){const st=Ke(q);if(!st)return i.push({row:e,field:"end_time",message:`Invalid time format: "${q}"`}),{event:null,errors:i};ht.setHours(st.hours,st.minutes,0,0),Ot=ye(ht,be)}else if(!kt&&W)Ot=new Date(Et.getTime()+60*60*1e3);else{const st=ht||new Date(vt);st.setHours(23,59,59,0),Ot=ye(st,be)}let Tt;if(b&&(Tt=tr(b),!Tt))return i.push({row:e,field:"category",message:`Unknown category: "${b}"`}),{event:null,errors:i};if(k&&k.length>255)return i.push({row:e,field:"location",message:"Location cannot exceed 255 characters"}),{event:null,errors:i};const Mt={};return Tt&&(Mt.category=Tt),{event:{title:S,event_type:"calendar_event",start_time:Et.toISOString(),end_time:Ot.toISOString(),is_all_day:kt,is_public:!0,is_published:!1,meta_data:Mt,...z?{description:z}:{},...k?{location:k}:{}},errors:[]}}async function sr(w,_){const e={success:0,validationErrors:0,errors:[]},i=[];for(let W=0;W<w.length;W++){const{event:Z,errors:q}=nr(w[W],_,W+1);if(q.length>0){e.validationErrors++,e.errors.push(...q);continue}Z&&i.push(Z)}const S=Ue(),z=S?Be(S.stores.currentUser):void 0,H=S?Be(S.stores.userOrganizations):void 0;if(z){const W=z.displayName||z.username,Z=z.id,q=H?Array.from(H):[],k=new Date().toISOString();for(const b of i){const lt=b.meta_data||{};W&&(lt.submitted_by_name=W),Z&&(lt.submitted_by_user_id=Z),q.length&&(lt.submitted_by_organizations=q),lt.submitted_at=k,b.meta_data=lt}}return i.length>0&&(await fa(i),e.success=i.length),e}function or(){const w=va({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null});return{state:w,parseCsvFile:er,autoDetectMappings:ar,importEvents:sr,reset:()=>w.set({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null})}}var ir=m(`<p class="text-muted small mb-3">Upload a CSV file to bulk-import calendar events. Need a starting point? <a href="/sample-events.csv" download="">Download sample CSV template</a>.</p> <div class="mb-3"><label for="csvFile" class="form-label">Select CSV File</label> <input type="file" class="form-control" id="csvFile" accept=".csv"/></div> <div class="alert alert-warning small mb-3 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All imported events require <strong>bishopric approval</strong> before they appear on the
							public calendar.</span></div> <div class="alert alert-info small mb-0"><strong>Format Guide:</strong> <ul class="mb-0 mt-1"><li><strong>Required columns:</strong> Title, Date</li> <li><strong>Optional columns:</strong> Start Time, End Time, Location, Category, Description</li> <li>Dates: YYYY-MM-DD, MM/DD/YYYY, Jan 1, 2025, etc.</li> <li>Times: 7:00 PM, 19:00, etc. (omit for all-day events)</li> <li>Categories: Ward, Relief Society, Elders Quorum, Youth, Young Women, Young Men,
								Primary, etc.</li></ul></div>`,1),lr=m('<tr><td> </td><td><select class="form-select form-select-sm"><option>-- Skip --</option><option>Title</option><option>Description</option><option>Start Date</option><option>Start Time</option><option>End Date</option><option>End Time</option><option>Location</option><option>Category</option><option>All Day</option></select></td></tr>'),vr=m('<h6>Map CSV Columns to Event Fields</h6> <p class="text-muted"> </p> <table class="table table-sm"><thead><tr><th>CSV Column</th><th>Maps To</th></tr></thead><tbody></tbody></table>',1),cr=m('<div class="text-center py-5"><!> <p class="mt-3">Importing events...</p></div>'),dr=m("<li><strong> </strong> rows had validation errors</li>"),ur=m(`<div class="alert alert-info small">Imported events are <strong>unpublished</strong> and will need bishopric approval before
							they appear on the public calendar.</div>`),mr=m("<li> </li>"),_r=m("<li><em> </em></li>"),pr=m('<div class="alert alert-warning"><h6>Validation Errors:</h6> <ul class="mb-0" style="max-height: 200px; overflow-y: auto;"><!> <!></ul></div>'),fr=m('<div class="alert alert-success"><h6>Import Complete</h6> <ul class="mb-0"><li><strong> </strong> events imported successfully</li> <!></ul></div> <!> <!>',1),br=m('<button type="button" class="btn btn-secondary">Cancel</button>'),yr=m('<button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary"> </button>',1),gr=m('<button type="button" class="btn btn-secondary" disabled>Cancel</button> <button type="button" class="btn btn-primary" disabled><!> Importing...</button>',1),hr=m('<button type="button" class="btn btn-primary">Done</button>'),Er=m('<div class="modal-backdrop fade show"></div>'),wr=m('<div tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Import Events from CSV</h5> <button type="button" class="btn-close" aria-label="Close import modal"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><!></div></div></div></div> <!>',1);function xr(w,_){de(_,!1);const e=()=>It(Z,"$state",i),[i,S]=Fe();let z=qt(_,"isOpen",8,!1),H=qt(_,"onClose",8),W=qt(_,"onComplete",8);const{state:Z,parseCsvFile:q,autoDetectMappings:k,importEvents:b,reset:lt}=or();async function vt(h){const I=h.target.files?.[0];if(I)try{const{data:U,columns:j}=await q(I),ct=k(j);Z.update(V=>({...V,step:"mapping",csvData:U,csvColumns:j,columnMappings:ct}))}catch(U){console.error("Failed to parse CSV:",U),alert("Failed to parse CSV file. Please check the file format.")}}async function kt(){Z.update(h=>({...h,step:"importing"}));try{const h=await b(e().csvData,e().columnMappings);Z.update(I=>({...I,step:"complete",importResult:h})),W()()}catch(h){console.error("Failed to import events:",h),alert("Failed to import events. Please try again."),Z.update(I=>({...I,step:"mapping"}))}}function Et(){lt(),H()()}me();var Ot=wr(),ht=mt(Ot);let Tt;var Mt=n(ht),Rt=n(Mt),st=n(Rt),Kt=s(n(st),2);Kt.__click=Et,a(st);var Nt=s(st,2),Ft=n(Nt);{var ft=h=>{var I=ir(),U=s(mt(I),2),j=s(n(U),2);j.__change=vt,a(U),ve(4),o(h,I)},Vt=h=>{var I=Ht(),U=mt(I);{var j=V=>{var P=vr(),A=s(mt(P),2),ot=n(A);a(A);var rt=s(A,2),Q=s(n(rt));ee(Q,5,()=>(e(),r(()=>e().columnMappings)),Te,(it,c,f)=>{var v=lr(),E=n(v),M=n(E,!0);a(E);var X=s(E),l=n(X);C(()=>{t(c),Ne(()=>{})});var p=n(l);p.value=(p.__value=null)??"";var d=s(p);d.value=d.__value="title";var y=s(d);y.value=y.__value="description";var $=s(y);$.value=$.__value="start_date";var N=s($);N.value=N.__value="start_time";var L=s(N);L.value=L.__value="end_date";var Y=s(L);Y.value=Y.__value="end_time";var wt=s(Y);wt.value=wt.__value="location";var B=s(wt);B.value=B.__value="category";var x=s(B);x.value=x.__value="is_all_day",a(l),a(X),a(v),C(()=>F(M,(t(c),r(()=>t(c).csvColumn)))),ma(l,()=>t(c).eventField,O=>(t(c).eventField=O,Ne(()=>e()),da(i,"$state"))),o(it,v)}),a(Q),a(rt),C(()=>F(ot,`Found ${e(),r(()=>e().csvData.length)??""} rows in CSV`)),o(V,P)},ct=V=>{var P=Ht(),A=mt(P);{var ot=Q=>{var it=cr(),c=n(it);ke(c,{}),ve(2),a(it),o(Q,it)},rt=Q=>{var it=Ht(),c=mt(it);{var f=v=>{var E=fr(),M=mt(E),X=s(n(M),2),l=n(X),p=n(l),d=n(p,!0);a(p),ve(),a(l);var y=s(l,2);{var $=B=>{var x=dr(),O=n(x),K=n(O,!0);a(O),ve(),a(x),C(()=>F(K,(e(),r(()=>e().importResult.validationErrors)))),o(B,x)};g(y,B=>{e(),r(()=>e().importResult?.validationErrors&&e().importResult.validationErrors>0)&&B($)})}a(X),a(M);var N=s(M,2);{var L=B=>{var x=ur();o(B,x)};g(N,B=>{e(),r(()=>e().importResult?.success&&e().importResult.success>0)&&B(L)})}var Y=s(N,2);{var wt=B=>{var x=pr(),O=s(n(x),2),K=n(O);ee(K,1,()=>(e(),r(()=>e().importResult.errors.slice(0,10))),Te,(_t,nt)=>{var J=mr(),tt=n(J);a(J),C(()=>F(tt,`Row ${t(nt),r(()=>t(nt).row)??""}: ${t(nt),r(()=>t(nt).message)??""}`)),o(_t,J)});var Dt=s(K,2);{var bt=_t=>{var nt=_r(),J=n(nt),tt=n(J);a(J),a(nt),C(()=>F(tt,`... and ${e(),r(()=>e().importResult.errors.length-10)??""} more errors`)),o(_t,nt)};g(Dt,_t=>{e(),r(()=>e().importResult.errors.length>10)&&_t(bt)})}a(O),a(x),o(B,x)};g(Y,B=>{e(),r(()=>e().importResult?.errors&&e().importResult.errors.length>0)&&B(wt)})}C(()=>F(d,(e(),r(()=>e().importResult?.success||0)))),o(v,E)};g(c,v=>{e(),r(()=>e().step==="complete")&&v(f)},!0)}o(Q,it)};g(A,Q=>{e(),r(()=>e().step==="importing")?Q(ot):Q(rt,!1)},!0)}o(V,P)};g(U,V=>{e(),r(()=>e().step==="mapping")?V(j):V(ct,!1)},!0)}o(h,I)};g(Ft,h=>{e(),r(()=>e().step==="upload")?h(ft):h(Vt,!1)})}a(Nt);var Pt=s(Nt,2),Lt=n(Pt);{var Yt=h=>{var I=br();I.__click=Et,o(h,I)},zt=h=>{var I=Ht(),U=mt(I);{var j=V=>{var P=yr(),A=mt(P);A.__click=Et;var ot=s(A,2);ot.__click=kt;var rt=n(ot);a(ot),C(()=>F(rt,`Import ${e(),r(()=>e().csvData.length)??""} Events`)),o(V,P)},ct=V=>{var P=Ht(),A=mt(P);{var ot=Q=>{var it=gr(),c=s(mt(it),2),f=n(c);ke(f,{size:"sm"}),ve(),a(c),o(Q,it)},rt=Q=>{var it=Ht(),c=mt(it);{var f=v=>{var E=hr();E.__click=Et,o(v,E)};g(c,v=>{e(),r(()=>e().step==="complete")&&v(f)},!0)}o(Q,it)};g(A,Q=>{e(),r(()=>e().step==="importing")?Q(ot):Q(rt,!1)},!0)}o(V,P)};g(U,V=>{e(),r(()=>e().step==="mapping")?V(j):V(ct,!1)},!0)}o(h,I)};g(Lt,h=>{e(),r(()=>e().step==="upload")?h(Yt):h(zt,!1)})}a(Pt),a(Rt),a(Mt),a(ht);var Bt=s(ht,2);{var T=h=>{var I=Er();o(h,I)};g(Bt,h=>{z()&&h(T)})}C(()=>{Tt=Jt(ht,1,"modal fade",null,Tt,{show:z()}),ua(ht,`display: ${z()?"block":"none"}`)}),o(w,Ot),ue(),S()}ca(["click","change"]);var kr=m('<div class="calendar-day-header svelte-14mpkul"><span class="d-none d-md-inline"> </span> <span class="d-md-none"> </span></div>'),Mr=m('<button type="button"><span class="event-title svelte-14mpkul"> </span></button>'),Dr=m('<div class="more-events svelte-14mpkul"> </div>'),Cr=m('<div role="button" tabindex="0"><div class="day-number svelte-14mpkul"> </div> <div class="day-events svelte-14mpkul"><!> <!></div></div>'),Ir=m("<span> </span>"),$r=m('<span class="badge bg-secondary">All Day</span>'),Or=m('<span class="event-time svelte-14mpkul"> </span>'),Sr=m('<span class="event-location svelte-14mpkul"><i class="bi bi-geo-alt"></i> </span>'),Ar=m('<div class="event-thumbnail-container svelte-14mpkul"><img class="event-thumbnail svelte-14mpkul"/></div>'),Tr=m('<button type="button" class="btn btn-sm btn-outline-secondary" title="Edit event"><i class="bi bi-pencil"></i></button>'),Rr=m('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="event-details-button svelte-14mpkul"><div class="event-title-full svelte-14mpkul"> </div> <div class="event-meta svelte-14mpkul"><!> <!> <!></div></button> <!> <div class="event-actions svelte-14mpkul"><!></div></li>'),Fr=m('<div class="selected-day-events svelte-14mpkul"><div class="selected-day-header svelte-14mpkul"><h6 class="selected-day-title svelte-14mpkul"> </h6> <button type="button" class="btn btn-sm btn-outline-secondary" aria-label="Close"><i class="bi bi-x-lg"></i></button></div> <ul class="list-group list-group-flush"></ul></div>'),Ur=m('<div class="month-calendar svelte-14mpkul"><div class="calendar-header svelte-14mpkul"><h5 class="month-title svelte-14mpkul"> </h5> <div class="calendar-nav svelte-14mpkul"><button type="button" class="btn btn-sm btn-outline-secondary" aria-label="Previous month"><i class="bi bi-chevron-left"></i></button> <button type="button" class="btn btn-sm btn-outline-secondary" aria-label="Go to today">Today</button> <button type="button" class="btn btn-sm btn-outline-secondary" aria-label="Next month"><i class="bi bi-chevron-right"></i></button></div></div> <div class="calendar-grid svelte-14mpkul"><!> <!></div> <!></div>');function Pr(w,_){de(_,!1);const e=R(),i=R(),S=R();let z=qt(_,"events",24,()=>[]),H=qt(_,"onEventClick",8,()=>{}),W=qt(_,"onEventEdit",8,null),Z=qt(_,"canEditEvent",8,null),q=R(new Date),k=R(null);const b=T=>{t(k)&&he(t(k),T)?D(k,null):D(k,T)},lt=()=>{D(q,new Date)},vt=()=>{D(q,xa(t(q)))},kt=()=>{D(q,Xe(t(q),1))},Et=T=>{const h=dt(T,"yyyy-MM-dd");return t(S)[h]||[]},Ot=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ht=["S","M","T","W","T","F","S"],Tt=T=>T.startsWith("image/");G(()=>t(k),()=>{D(e,t(k)?Et(t(k)):[])}),G(()=>(t(q),ze),()=>{D(i,(()=>{const T=wa(t(q)),h=ha(t(q)),I=pa(T,{weekStartsOn:0}),U=Ea(h,{weekStartsOn:0}),j=[];let ct=I;for(;ct<=U;)j.push(ct),ct=ze(ct,1);return j})())}),G(()=>(u(z()),dt),()=>{D(S,z().reduce((T,h)=>{if(!h.start_time)return T;const I=xt(h.start_time),U=dt(I,"yyyy-MM-dd");return T[U]||(T[U]=[]),T[U].push(h),T},{}))}),Ce(),me();var Mt=Ur(),Rt=n(Mt),st=n(Rt),Kt=n(st,!0);a(st);var Nt=s(st,2),Ft=n(Nt),ft=s(Ft,2),Vt=s(ft,2);a(Nt),a(Rt);var Pt=s(Rt,2),Lt=n(Pt);ee(Lt,1,()=>Ot,Te,(T,h,I)=>{var U=kr(),j=n(U),ct=n(j,!0);a(j);var V=s(j,2),P=n(V,!0);a(V),a(U),C(()=>{F(ct,t(h)),F(P,r(()=>ht[I]))}),o(T,U)});var Yt=s(Lt,2);ee(Yt,1,()=>t(i),T=>dt(T,"yyyy-MM-dd"),(T,h)=>{const I=Wt(()=>(t(h),r(()=>Et(t(h))))),U=Wt(()=>(u(He),t(h),t(q),r(()=>He(t(h),t(q))))),j=Wt(()=>(u(We),t(h),r(()=>We(t(h))))),ct=Wt(()=>(t(k),u(he),t(h),r(()=>t(k)&&he(t(k),t(h)))));var V=Cr();let P;var A=n(V),ot=n(A,!0);a(A);var rt=s(A,2),Q=n(rt);ee(Q,1,()=>(u(t(I)),r(()=>t(I).slice(0,3))),f=>f.id??f.start_time,(f,v)=>{var E=Mr(),M=n(E),X=n(M,!0);a(M),a(E),C(l=>{Jt(E,1,`event-badge bg-color-${l??""}`,"svelte-14mpkul"),$t(E,"title",(t(v),r(()=>t(v).title))),F(X,(t(v),r(()=>t(v).title)))},[()=>(u(ae),t(v),r(()=>ae(t(v)?.meta_data?.category??"")?.color_number??0))]),gt("click",E,xe(()=>H()(t(v)))),o(f,E)});var it=s(Q,2);{var c=f=>{var v=Dr(),E=n(v);a(v),C(()=>F(E,`+${u(t(I)),r(()=>t(I).length-3)??""} more`)),o(f,v)};g(it,f=>{u(t(I)),r(()=>t(I).length>3)&&f(c)})}a(rt),a(V),C(f=>{P=Jt(V,1,"calendar-day svelte-14mpkul",null,P,{"other-month":!t(U),today:t(j),selected:t(ct),"has-events":t(I).length>0}),F(ot,f)},[()=>(u(dt),t(h),r(()=>dt(t(h),"d")))]),gt("click",V,()=>b(t(h))),gt("keydown",V,f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),b(t(h)))}),o(T,V)}),a(Pt);var zt=s(Pt,2);{var Bt=T=>{var h=Fr(),I=n(h),U=n(I),j=n(U,!0);a(U);var ct=s(U,2);a(I);var V=s(I,2);ee(V,5,()=>t(e),P=>P.id??P.start_time,(P,A)=>{const ot=Wt(()=>(t(A),r(()=>t(A).attachments?.find(x=>Tt(x.type))))),rt=Wt(()=>(u(ae),t(A),r(()=>ae(t(A)?.meta_data?.category??""))));var Q=Rr(),it=n(Q),c=s(it,2),f=n(c),v=n(f,!0);a(f);var E=s(f,2),M=n(E);{var X=x=>{var O=Ir(),K=n(O,!0);a(O),C(()=>{Jt(O,1,`badge rounded-pill bg-color-${u(t(rt)),r(()=>t(rt).color_number)??""}`,"svelte-14mpkul"),F(K,(u(t(rt)),r(()=>t(rt).label)))}),o(x,O)};g(M,x=>{u(t(rt)),r(()=>t(rt)?.label)&&x(X)})}var l=s(M,2);{var p=x=>{var O=$r();o(x,O)},d=x=>{var O=Ht(),K=mt(O);{var Dt=bt=>{var _t=Or(),nt=n(_t,!0);a(_t),C(J=>F(nt,J),[()=>(u(dt),u(xt),t(A),r(()=>dt(xt(t(A).start_time),"h:mm a")))]),o(bt,_t)};g(K,bt=>{t(A),r(()=>t(A).start_time)&&bt(Dt)},!0)}o(x,O)};g(l,x=>{t(A),r(()=>t(A).is_all_day)?x(p):x(d,!1)})}var y=s(l,2);{var $=x=>{var O=Sr(),K=s(n(O));a(O),C(()=>F(K,` ${t(A),r(()=>t(A).location)??""}`)),o(x,O)};g(y,x=>{t(A),r(()=>t(A).location)&&x($)})}a(E),a(c);var N=s(c,2);{var L=x=>{var O=Ar(),K=n(O);a(O),C(()=>{$t(K,"src",(u(t(ot)),r(()=>t(ot).url))),$t(K,"alt",(u(t(ot)),r(()=>t(ot).name)))}),o(x,O)};g(N,x=>{t(ot)&&x(L)})}var Y=s(N,2),wt=n(Y);{var B=x=>{var O=Tr();gt("click",O,xe(()=>W()&&W()(t(A)))),o(x,O)};g(wt,x=>{u(Z()),u(W()),t(A),r(()=>Z()&&W()&&Z()(t(A)))&&x(B)})}a(Y),a(Q),C(()=>{Jt(it,1,`event-color-indicator bg-color-${u(t(rt)),r(()=>t(rt)?.color_number??0)??""}`,"svelte-14mpkul"),F(v,(t(A),r(()=>t(A).title)))}),gt("click",c,()=>H()(t(A))),o(P,Q)}),a(V),a(h),C(P=>F(j,P),[()=>(u(dt),t(k),r(()=>dt(t(k),"EEEE, MMMM d, yyyy")))]),gt("click",ct,()=>D(k,null)),o(T,h)};g(zt,T=>{t(k),t(e),r(()=>t(k)&&t(e).length>0)&&T(Bt)})}a(Mt),C(T=>F(Kt,T),[()=>(u(dt),t(q),r(()=>dt(t(q),"MMMM yyyy")))]),gt("click",Ft,vt),gt("click",ft,lt),gt("click",Vt,kt),o(w,Mt),ue()}var Lr=m('<div class="dropdown"><button class="btn btn-sm btn-primary dropdown-toggle" type="button" id="addEventDropdown" data-bs-toggle="dropdown" aria-label="Add event actions" aria-expanded="false"><i class="bi bi-plus"></i></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="addEventDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-calendar-plus me-2"></i>Create Event</button></li> <li><button class="dropdown-item" type="button"><i class="bi bi-file-earmark-arrow-up me-2"></i>Import CSV</button></li></ul></div>'),Br=m("<span> </span>"),Nr=m('<span class="event-date svelte-1p8xa6u"> </span>'),Vr=m('<span class="badge bg-secondary">All Day</span>'),Yr=m('<span class="event-time svelte-1p8xa6u"> </span>'),zr=m('<span class="event-location svelte-1p8xa6u"><i class="bi bi-geo-alt"></i> <!></span>'),Hr=m('<div class="event-thumbnail-container svelte-1p8xa6u"><img class="event-thumbnail svelte-1p8xa6u"/></div>'),Wr=m('<button type="button" class="btn btn-sm btn-outline-secondary" title="Edit event"><i class="bi bi-pencil"></i></button>'),qr=m('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="event-details-button svelte-1p8xa6u"><div class="event-title-full svelte-1p8xa6u"><!></div> <div class="event-meta svelte-1p8xa6u"><!> <!> <!> <!></div></button> <!> <div class="event-actions svelte-1p8xa6u"><!></div></li>'),Kr=m('<div class="search-results svelte-1p8xa6u"><div class="search-results-header svelte-1p8xa6u"><h6 class="search-results-title svelte-1p8xa6u"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),jr=m('<div class="search-no-results svelte-1p8xa6u"> </div>'),Qr=m("<!> <!>",1),Jr=m('<div class="no-events svelte-1p8xa6u"><!></div>'),Gr=m('<div class="d-flex flex-column gap-2"><div class="calendar-header svelte-1p8xa6u"><h2 class="calendar-title svelte-1p8xa6u">Events</h2> <div class="calendar-actions svelte-1p8xa6u"><!></div></div> <!></div>'),Zr=m('<div class="d-flex flex-column gap-4"><!></div>'),Xr=m("<!> <!> <!> <!>",1);function Mn(w,_){de(_,!1);const e=()=>It(st,"$calendarEvents",k),i=()=>It(Kt,"$searchQuery",k),S=()=>It(Et,"$currentUser",k),z=()=>It(Mt,"$userOrganizations",k),H=()=>It(Ot,"$currentUserHasPermission",k),W=()=>It(Tt,"$currentUserIsRoot",k),Z=()=>It(ht,"$currentUserIsAdmin",k),q=()=>It(Rt,"$ready",k),[k,b]=Fe(),lt=R(),vt=R(),kt=R(),{stores:{currentUser:Et,currentUserHasPermission:Ot,currentUserIsAdmin:ht,currentUserIsRoot:Tt,userOrganizations:Mt}}=Ue(),{stores:{ready:Rt,calendarEvents:st,searchQuery:Kt},actions:{reload:Nt}}=Ge(),Ft={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let ft=qt(_,"formId",24,Me),Vt=qt(_,"detailsId",24,Me),Pt=R(!1),Lt=R(!1),Yt=R(),zt=R(!1),Bt=R(!1),T=R(new Set),h=R(""),I=R({...Ft}),U=R({...Ft}),j=R(!1);const ct=l=>Je(l,{currentUserId:t(Yt),isPrivileged:t(Lt),canEditOwnOrgEvents:t(Bt),userOrganizations:t(T)}),V=l=>l.startsWith("image/");function P(){Nt()}je(async()=>{await Nt()});const A=async l=>{if(D(h,"Item Form"),l?.meta_data?.recurring_instance&&l?.meta_data?.recurring_parent_id){const{getCalendarEvent:p}=await Ye(async()=>{const{getCalendarEvent:y}=await import("./BOsxNJ5s.js").then($=>$.x);return{getCalendarEvent:y}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),d=await p(l.meta_data.recurring_parent_id);if(d){D(I,{...d,category:d?.meta_data?.category,start_time:l.start_time,end_time:l.end_time,meta_data:{...d.meta_data,recurring_instance:!0,recurring_parent_id:l.meta_data.recurring_parent_id,recurring_instance_index:l.meta_data.recurring_instance_index}});return}}D(I,{...l,category:l?.meta_data?.category})},ot=async l=>{if(l?.meta_data?.recurring_instance&&l?.meta_data?.recurring_parent_id){const{getCalendarEvent:d}=await Ye(async()=>{const{getCalendarEvent:$}=await import("./BOsxNJ5s.js").then(N=>N.x);return{getCalendarEvent:$}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),y=await d(l.meta_data.recurring_parent_id);y?D(U,{...y,start_time:l.start_time,end_time:l.end_time,meta_data:{...y.meta_data,recurring_instance:!0,recurring_parent_id:l.meta_data.recurring_parent_id,recurring_instance_index:l.meta_data.recurring_instance_index}}):D(U,l)}else D(U,l);const p=document.getElementById(Vt());p&&new window.bootstrap.Offcanvas(p).show()},rt=async l=>{await A(l);const p=document.getElementById(ft());p&&new window.bootstrap.Offcanvas(p).show()},Q=async()=>{const l=document.getElementById(Vt());if(l){const p=window.bootstrap.Offcanvas.getInstance(l);p&&p.hide()}await A(t(U)),setTimeout(()=>{const p=document.getElementById(ft());p&&new window.bootstrap.Offcanvas(p).show()},300)};G(()=>(e(),xt),()=>{D(lt,(e()??[]).filter(l=>l.start_time?xt(l.start_time)>=new Date:!1))}),G(()=>(i(),t(lt)),()=>{D(vt,i()?t(lt).filter(l=>{const p=i().toLowerCase(),d=(l.title||"").toLowerCase(),y=(l.description||"").replace(/<[^>]*>/g,"").toLowerCase(),$=(l.location||"").toLowerCase();return d.includes(p)||y.includes(p)||$.includes(p)}):[])}),G(()=>S(),()=>{D(Yt,S()?.id)}),G(()=>z(),()=>{D(T,z())}),G(()=>(t(T),we),()=>{D(zt,t(T).has(we.Bishopric))}),G(()=>(H(),Ut),()=>{D(Bt,H()(Ut.EditOwnOrgEvents))}),G(()=>(W(),Z(),t(zt),H(),Ut),()=>{D(Lt,W()||Z()||t(zt)||H()(Ut.EditAllEvents))}),G(()=>(H(),Ut),()=>{D(Pt,H()(Ut.CreateEvents))}),G(()=>(H(),Ut),()=>{D(kt,H()(Ut.DeleteEvents))}),Ce(),me();var it=Xr(),c=mt(it);De(c,{get title(){return t(h)},get id(){return ft()},children:(l,p)=>{Qe(l,{get eventItem(){return t(I)},get drawerId(){return ft()},name:"event-item-form",get canDelete(){return t(kt)}})},$$slots:{default:!0}});var f=s(c,2);De(f,{title:"Event Details",get id(){return Vt()},children:(l,p)=>{{let d=Wt(()=>(t(U),r(()=>ct(t(U)))));ta(l,{get event(){return t(U)},get canEdit(){return t(d)},onEdit:Q})}},$$slots:{default:!0}});var v=s(f,2);xr(v,{get isOpen(){return t(j)},onClose:()=>D(j,!1),onComplete:P});var E=s(v,2);{var M=l=>{var p=Gr(),d=n(p),y=s(n(d),2),$=n(y);{var N=B=>{var x=Lr(),O=s(n(x),2),K=n(O),Dt=n(K);a(K);var bt=s(K,2),_t=n(bt);a(bt),a(O),a(x),C(()=>{$t(Dt,"data-bs-target",`#${ft()??""}`),$t(Dt,"aria-controls",ft())}),gt("click",Dt,()=>A({...Ft,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),gt("click",_t,()=>D(j,!0)),o(B,x)};g($,B=>{t(Pt)&&B(N)})}a(y),a(d);var L=s(d,2);{var Y=B=>{var x=Qr(),O=mt(x);{var K=nt=>{Pr(nt,{get events(){return t(lt)},onEventClick:J=>ot(J),onEventEdit:J=>rt(J),canEditEvent:J=>ct(J)})};g(O,nt=>{i()||nt(K)})}var Dt=s(O,2);{var bt=nt=>{var J=Kr(),tt=n(J),St=n(tt),pt=n(St);a(St),a(tt);var At=s(tt,2);ee(At,5,()=>t(vt),Gt=>Gt.id??Gt.start_time,(Gt,et)=>{const Zt=Wt(()=>(t(et),r(()=>t(et).attachments?.find(at=>V(at.type))))),jt=Wt(()=>(u(ae),t(et),r(()=>ae(t(et)?.meta_data?.category??""))));var ne=qr(),oe=n(ne),se=s(oe,2),ie=n(se),Ie=n(ie);Re(Ie,()=>(u(ge),t(et),i(),r(()=>ge(t(et).title,i())))),a(ie);var le=s(ie,2),_e=n(le);{var pe=at=>{var ut=Br(),Qt=n(ut,!0);a(ut),C(()=>{Jt(ut,1,`badge rounded-pill bg-color-${u(t(jt)),r(()=>t(jt).color_number)??""}`,"svelte-1p8xa6u"),F(Qt,(u(t(jt)),r(()=>t(jt).label)))}),o(at,ut)};g(_e,at=>{u(t(jt)),r(()=>t(jt)?.label)&&at(pe)})}var fe=s(_e,2);{var $e=at=>{var ut=Nr(),Qt=n(ut,!0);a(ut),C(Oe=>F(Qt,Oe),[()=>(u(dt),u(xt),t(et),r(()=>dt(xt(t(et).start_time),"MMM d, yyyy")))]),o(at,ut)};g(fe,at=>{t(et),r(()=>t(et).start_time)&&at($e)})}var yt=s(fe,2);{var Ct=at=>{var ut=Vr();o(at,ut)},re=at=>{var ut=Ht(),Qt=mt(ut);{var Oe=Se=>{var Ae=Yr(),ia=n(Ae,!0);a(Ae),C(la=>F(ia,la),[()=>(u(dt),u(xt),t(et),r(()=>dt(xt(t(et).start_time),"h:mm a")))]),o(Se,Ae)};g(Qt,Se=>{t(et),r(()=>t(et).start_time)&&Se(Oe)},!0)}o(at,ut)};g(yt,at=>{t(et),r(()=>t(et).is_all_day)?at(Ct):at(re,!1)})}var aa=s(yt,2);{var ra=at=>{var ut=zr(),Qt=s(n(ut),2);Re(Qt,()=>(u(ge),t(et),i(),r(()=>ge(t(et).location,i())))),a(ut),o(at,ut)};g(aa,at=>{t(et),r(()=>t(et).location)&&at(ra)})}a(le),a(se);var Pe=s(se,2);{var na=at=>{var ut=Hr(),Qt=n(ut);a(ut),C(()=>{$t(Qt,"src",(u(t(Zt)),r(()=>t(Zt).url))),$t(Qt,"alt",(u(t(Zt)),r(()=>t(Zt).name)))}),o(at,ut)};g(Pe,at=>{t(Zt)&&at(na)})}var Le=s(Pe,2),sa=n(Le);{var oa=at=>{var ut=Wr();gt("click",ut,xe(()=>rt(t(et)))),o(at,ut)};g(sa,at=>{t(et),r(()=>ct(t(et)))&&at(oa)})}a(Le),a(ne),C(()=>Jt(oe,1,`event-color-indicator bg-color-${u(t(jt)),r(()=>t(jt)?.color_number??0)??""}`,"svelte-1p8xa6u")),gt("click",se,()=>ot(t(et))),o(Gt,ne)}),a(At),a(J),C(()=>F(pt,`${t(vt),r(()=>t(vt).length)??""} event${t(vt),r(()=>t(vt).length===1?"":"s")??""} matching "${i()??""}"`)),o(nt,J)},_t=nt=>{var J=Ht(),tt=mt(J);{var St=pt=>{var At=jr(),Gt=n(At);a(At),C(()=>F(Gt,`No events match your search for "${i()??""}"`)),o(pt,At)};g(tt,pt=>{i()&&pt(St)},!0)}o(nt,J)};g(Dt,nt=>{i(),t(vt),r(()=>i()&&t(vt).length>0)?nt(bt):nt(_t,!1)})}o(B,x)},wt=B=>{var x=Jr(),O=n(x);{var K=bt=>{var _t=te("No events match your search.");o(bt,_t)},Dt=bt=>{var _t=te("There are no upcoming events scheduled.");o(bt,_t)};g(O,bt=>{i()?bt(K):bt(Dt,!1)})}a(x),o(B,x)};g(L,B=>{e(),r(()=>e()?.length)?B(Y):B(wt,!1)})}a(p),o(l,p)},X=l=>{var p=Zr(),d=n(p);ke(d,{}),a(p),o(l,p)};g(E,l=>{q()?l(M):l(X,!1)})}o(w,it),ue(),b()}export{kn as A,ta as C,Mn as E,wa as s};
