const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./C9DwZanS.js","./DimshypG.js","./DIeogL5L.js","./BpMnIePG.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./Bxf54LvK.js","./BxPd6b7X.js","./CM5fKw4-.js","./BJEhGyNp.js","./Db0dlTxz.js","./BUApaBEI.js","./PCWoV1YN.js","./CzOfpHr6.js","../assets/Spinner.DTjfhZ6-.css","./DQUjufRY.js","./BArOhmIA.js","./D0Xbco4o.js","./DjQMH9r6.js","./2cq0MecU.js","./naA3k6PG.js","./r7-tBYgy.js","./3eSYmCoD.js","./CPJvaOp1.js","./DSPc5bA6.js","./BWA50PjU.js","./lI6VyvQW.js","../assets/confirm.ChDpDKXb.css","./C2hsME61.js","./DkcAl3kJ.js","./H5Z437cD.js","../assets/CalendarEventForm.6P4cN81z.css","./tUu8UEjF.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{d as rs,o as Pa,g as ns}from"./Bxf54LvK.js";import{p as ft,ah as E,D as o,E as d,ai as Zt,c as a,s as n,r as t,u as s,m as e,a as bt,B as R,C as os,f as Ie,F as _a,R as Oe,aq as is,n as k,ar as ls}from"./DimshypG.js";import{f as c,a as i,c as Lt,t as pa}from"./BpMnIePG.js";import{a as ae,i as f,k as Vt,b as Gt,e as Y,s as z,p as Ze}from"./BxPd6b7X.js";import{i as mt}from"./PCWoV1YN.js";import{e as lt,i as Ca}from"./DQUjufRY.js";import{r as Ha,b as cs,s as Ke,i as La,c as ds,d as za,e as vs}from"./CM5fKw4-.js";import{b as us}from"./BArOhmIA.js";import{j as _s,g as ea,C as fa,k as ps,h as Ba,c as ca,b as Yt,a as Ia,l as da}from"./C9DwZanS.js";import{s as Na,C as fs,E as bs,A as ms,a as gs}from"./DFGnkmVw.js";import{z as Ma,v as Wa,B as ys,d as ma,p as le,h as $e,O as ba,P as Ae,e as pt,C as Oa}from"./BJEhGyNp.js";import{E as hs,c as Qa}from"./Chssgyz4.js";import{S as Va}from"./CzOfpHr6.js";import{v as Xt,D as Jt}from"./DkcAl3kJ.js";import{s as va}from"./BWA50PjU.js";import{e as ua}from"./CPJvaOp1.js";import{_ as Ta}from"./CmsKOCeN.js";import{s as Ka}from"./CdEA5IGF.js";import{B as ws}from"./DpuJJXI-.js";import{R as Kt}from"./3eSYmCoD.js";function qa(ue,C,M){const y=Ma(ue,M),B=Ma(C,M),ne=+y-Wa(y),D=+B-Wa(B);return Math.round((ne-D)/ys)}function xs(ue,C){return _s(ue,-C)}var Es=c('<button type="button" class="btn-clear-search svelte-14zxluq" aria-label="Clear search" title="Clear search"><i class="bi bi-x-lg"></i></button>'),ks=c("<option> </option>"),$s=c('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by organization"><option>All Organizations</option><!></select></div>'),As=c('<div class="col-12 col-md-auto"><button type="button" class="btn btn-primary w-100" aria-label="Clear all filters"><i class="bi bi-x-circle me-1"></i> Clear All</button></div>'),Ds=c('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><div class="search-input-wrapper svelte-14zxluq"><input type="text" class="form-control form-control" placeholder="Search..."/> <!></div></div> <!> <!></div></div>');function Ss(ue,C){ft(C,!1);const M=()=>ae(H,"$searchQuery",ne),y=()=>ae(G,"$organizationFilter",ne),B=()=>ae(w,"$currentOrganizations",ne),[ne,D]=Gt(),Z=d(),{stores:{currentOrganizations:w,organizationFilter:G,searchQuery:H}}=ea(),F=()=>{Vt(H,""),Vt(G,"")};E(()=>(M(),y()),()=>{o(Z,!!(M()||y()))}),Zt(),mt();var se=Ds(),Q=a(se),W=a(Q),T=a(W),ce=a(T);Ha(ce);var h=n(ce,2);{var X=x=>{var $=Es();Y("click",$,()=>Vt(H,"")),i(x,$)};f(h,x=>{M()&&x(X)})}t(T),t(W);var V=n(W,2);{var re=x=>{var $=$s(),ee=a($);R(()=>{y(),os(()=>{B()})});var A=a(ee);A.value=A.__value="";var Ue=n(A);lt(Ue,1,B,Ca,(we,Ce)=>{var Me=ks(),_e=a(Me,!0);t(Me);var te={};R(()=>{z(_e,(e(Ce),s(()=>e(Ce).label))),te!==(te=(e(Ce),s(()=>e(Ce).key)))&&(Me.value=(Me.__value=(e(Ce),s(()=>e(Ce).key)))??"")}),i(we,Me)}),t(ee),t($),cs(ee,y,we=>Vt(G,we)),i(x,$)};f(V,x=>{B(),s(()=>B().length)&&x(re)})}var We=n(V,2);{var Fe=x=>{var $=As(),ee=a($);t($),Y("click",ee,F),i(x,$)};f(We,x=>{e(Z)&&x(Fe)})}t(Q),t(se),us(ce,M,x=>Vt(H,x)),i(ue,se),bt(),D()}var Is=c('<p class="mb-0">No past events to delete.</p>'),Os=c('<p class="mb-2"><strong> </strong></p>'),Cs=c(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Ms=c("<!> <!>",1),Ts=c('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Ps(ue,C){ft(C,!1);let M=Ze(C,"deleted",8),y=Ze(C,"skipped",8),B=Ze(C,"callback",8);function ne(){B()()}mt();var D=Ts(),Z=a(D),w=a(Z),G=a(w),H=n(a(G),2);t(G);var F=n(G,2),se=a(F);{var Q=h=>{var X=Is();i(h,X)},W=h=>{var X=Ms(),V=Ie(X);{var re=x=>{var $=Os(),ee=a($),A=a(ee);t(ee),t($),R(()=>z(A,`✓ Deleted ${M()??""} past event${M()===1?"":"s"}.`)),i(x,$)};f(V,x=>{M()>0&&x(re)})}var We=n(V,2);{var Fe=x=>{var $=Cs(),ee=a($),A=a(ee),Ue=a(A);t(A),t(ee),_a(2),t($),R(()=>z(Ue,`⚠ Skipped ${y()??""} recurring event${y()===1?"":"s"}`)),i(x,$)};f(We,x=>{y()>0&&x(Fe)})}i(h,X)};f(se,h=>{M()===0&&y()===0?h(Q):h(W,!1)})}t(F);var T=n(F,2),ce=a(T);t(T),t(w),t(Z),t(D),Y("click",H,ne),Y("click",ce,ne),i(ue,D),bt()}var Rs=c(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Fs(ue,C){ft(C,!1);let M=Ze(C,"cutoffDate",8),y=Ze(C,"callback",8);function B(){y()(!0)}function ne(){y()(!1)}mt();var D=Rs(),Z=a(D),w=a(Z),G=a(w),H=n(a(G),2);t(G);var F=n(G,2),se=a(F),Q=a(se),W=a(Q);t(Q),t(se),_a(2),t(F);var T=n(F,2),ce=a(T),h=n(ce,2);t(T),t(w),t(Z),t(D),R(()=>z(W,`Are you sure you want to delete all events that occurred before ${M()??""}?`)),Y("click",H,ne),Y("click",ce,ne),Y("click",h,B),i(ue,D),bt()}var Us=c('<button class="btn btn-sm btn-primary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Ls=c('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),zs=c('<div class="d-flex align-items-center justify-content-end ms-auto"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),Bs=c('<div class="d-flex flex-row align-items-start gap-3 w-100"><div class="flex-grow-1"><!></div> <!></div>'),Ns=c('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Ws=c('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),qs=c('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),js=c('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),Hs=c('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),Qs=c('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Vs=c('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Ks=c('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Ys=c('<div class="card-body text-muted small">No past events available.</div>'),Xs=c('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-primary">Hide</button></div></div></div> <!></div>'),Js=c('<div class="d-flex flex-column gap-4"><!></div>'),Zs=c("<!> <!> <!> <!>",1);function Gs(ue,C){ft(C,!1);const M=()=>ae(Ce,"$weeksExpanded",F),y=()=>ae(Mt,"$allPastEvents",F),B=()=>ae(x,"$currentUser",F),ne=()=>ae(A,"$userOrganizations",F),D=()=>ae(Fe,"$currentUserHasPermission",F),Z=()=>ae(ee,"$currentUserIsRoot",F),w=()=>ae($,"$currentUserIsAdmin",F),G=()=>ae(Ue,"$ready",F),H=()=>ae(Me,"$searchQuery",F),[F,se]=Gt(),Q=d(),W=d(),T=d(),ce=d(),h=d(),X=d(),V=d(),re=d(),We=d(),{stores:{currentUserHasPermission:Fe,currentUser:x,currentUserIsAdmin:$,currentUserIsRoot:ee,userOrganizations:A}}=ma(),{stores:{ready:Ue,dbData:we,weeksExpanded:Ce,searchQuery:Me},actions:{reload:_e}}=ea(),te={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let ie=Ze(C,"formId",24,Xt),N=d(!1),et=d(!1),ct=d(),gt=d(!1),yt=d(!1),st=d(!1),rt=d(new Set),tt=d(!1),Ot=d(""),Ct=d({...te}),ht=d(!1),l=d(""),g=d(!1),S=d({deleted:0,skipped:0});const q=4,xe=4;let pe=d(q),Le=d(!1);const U=va();let ze=d({});function qe(u){return e(Q).includes(u)}function wt(u){const p=e(ze)[u]??qe(u);o(ze,{...e(ze),[u]:!p})}const dt=u=>{o(Ot,"Event Item"),o(Ct,{...u,organization:u?.meta_data?.organization??""})},Mt=rs(we,u=>{const p=va();return(u??[]).filter(_=>!(_.event_type!=="calendar_event"||!_.start_time||le(_.start_time)>=p||_.recurrence_rule&&(!_.recurrence_end_date||_.recurrence_end_date&&le(_.recurrence_end_date)>=p)))}),r=u=>Qa(u,{currentUserId:e(ct),isPrivileged:e(et),canEditOwnOrgEvents:e(st),userOrganizations:e(rt)});let v=d(!1);function b(){o(pe,e(pe)+xe)}function P(){o(pe,520),o(Le,!0)}function me(){o(pe,q),o(Le,!1)}const at=()=>{if(!e(N)||e(tt)||!ns(ee)||!e(re))return;const u=va();o(l,$e(u,"MMM d, yyyy")),o(ht,!0)};async function ge(u){if(o(ht,!1),!u)return;const p=va();o(tt,!0);try{const _=await ps(p);await _e(),o(S,_),o(g,!0)}catch(_){console.error("Failed to delete past events",_),alert("Failed to delete past events. Please try again.")}finally{o(tt,!1)}}function L(){o(g,!1)}Pa(async()=>{await _e()}),E(()=>(y(),e(pe)),()=>{o(T,(y()??[]).filter(u=>{if(!u.start_time)return!1;const p=le(u.start_time),_=xs(U,e(pe));return p>=_&&p<U}))}),E(()=>(e(T),$e),()=>{o(h,(()=>{const u=new Map;for(const p of e(T)){if(!p.start_time)continue;const _=le(p.start_time),I=Ma(_,{weekStartsOn:1}),ye=ua(_,{weekStartsOn:1}),de=$e(I,"yyyy-MM-dd"),Ee=`${$e(I,"MMM d")} – ${$e(ye,"MMM d")}`;let oe=u.get(de);oe||(oe={key:de,label:Ee,days:new Map},u.set(de,oe));const fe=$e(_,"yyyy-MM-dd");let Pe=oe.days.get(fe);Pe||(Pe={key:fe,displayDay:$e(_,"EEE"),displayDate:$e(_,"MMM d"),events:[]},oe.days.set(fe,Pe)),Pe.events.push(p)}return Array.from(u.values()).sort((p,_)=>p.key<_.key?1:-1).map(p=>({key:p.key,label:p.label,days:Array.from(p.days.values()).sort((_,I)=>_.key<I.key?1:-1).map(_=>({..._,events:_.events.slice().sort((I,ye)=>{const de=I.is_all_day?0:1,Ee=ye.is_all_day?0:1;if(de!==Ee)return de-Ee;const oe=I.start_time?le(I.start_time).getTime():Number.MAX_SAFE_INTEGER,fe=ye.start_time?le(ye.start_time).getTime():Number.MAX_SAFE_INTEGER;return oe-fe})}))}))})())}),E(()=>e(h),()=>{o(Q,(()=>{if(e(h).length===0)return[];const u=[];return e(h)[0]&&u.push(e(h)[0].key),e(h)[1]&&u.push(e(h)[1].key),u})())}),E(()=>(M(),e(ze)),()=>{o(W,u=>M()?!0:e(ze)[u]!==void 0?e(ze)[u]:qe(u))}),E(()=>e(T),()=>{o(ce,e(T).length)}),E(()=>(e(h),$e),()=>{o(X,e(h).reduce((u,p)=>{const _=le(p.key),I=ua(_,{weekStartsOn:1}),ye=$e(I,"yyyy-MM"),de=$e(I,"MMMM yyyy");return u[ye]||(u[ye]={label:de,weeks:[]}),u[ye].weeks.push(p),u},{}))}),E(()=>B(),()=>{o(ct,B()?.id)}),E(()=>ne(),()=>{o(rt,ne())}),E(()=>e(ct),()=>{o(yt,!!e(ct))}),E(()=>(e(rt),ba),()=>{o(gt,e(rt).has(ba.Bishopric))}),E(()=>(D(),Ae),()=>{o(st,D()(Ae.EditOwnOrgEvents))}),E(()=>(Z(),w(),e(gt),D(),Ae),()=>{o(et,Z()||w()||e(gt)||D()(Ae.EditAllEvents))}),E(()=>(e(et),D(),e(st),e(yt)),()=>{o(N,e(et)||D()(Ae.CreateEvents)||e(st)||e(yt))}),E(()=>(D(),Ae),()=>{o(V,D()(Ae.DeleteEvents))}),E(()=>e(T),()=>{o(re,e(T).length>0)}),E(()=>(y(),e(T)),()=>{o(We,y().length>e(T).length)}),Zt(),mt();var De=Zs(),Te=Ie(De);Jt(Te,{get title(){return e(Ot)},get id(){return ie()},children:(u,p)=>{fa(u,{get eventItem(){return e(Ct)},get drawerId(){return ie()},name:"past-event-item-form",get canDelete(){return e(V)}})},$$slots:{default:!0}});var Ye=n(Te,2);{var nt=u=>{var p=Lt(),_=Ie(p);{var I=de=>{var Ee=Lt(),oe=Ie(Ee);{var fe=ke=>{var je=Us(),Et=n(a(je));t(je),R(()=>z(Et,` Show Past Events (${y(),s(()=>y().length)??""})`)),Y("click",je,()=>o(v,!0)),i(ke,je)},Pe=ke=>{var je=Xs(),Et=a(je),ta=a(Et),aa=n(a(ta),2),J=a(aa);{var K=ve=>{var He=Ls(),Xe=a(He);{var kt=Se=>{var Ne=pa("Deleting…");i(Se,Ne)},$t=Se=>{var Ne=pa();R(()=>z(Ne,`Delete All (${e(ce)??""})`)),i(Se,Ne)};f(Xe,Se=>{e(tt)?Se(kt):Se($t,!1)})}t(He),R(()=>He.disabled=e(tt)),Y("click",He,at),i(ve,He)};f(J,ve=>{Z()&&e(re)&&ve(K)})}var be=n(J,2);t(aa),t(ta),t(Et);var m=n(Et,2);{var Be=ve=>{var He=Ks(),Xe=Ie(He);lt(Xe,5,()=>(e(X),s(()=>Object.entries(e(X)))),([Se,Ne])=>Se,(Se,Ne)=>{var it=is(()=>ls(e(Ne),2));let vt=()=>e(it)[1];var At=js(),ut=Ie(At),Nt=a(ut,!0);t(ut);var Je=n(ut,2);lt(Je,1,()=>(vt(),s(()=>vt().weeks)),Qe=>Qe.key,(Qe,he)=>{const Tt=Oe(()=>(k(le),e(he),s(()=>le(e(he).key)))),Dt=Oe(()=>(k(ua),k(e(Tt)),s(()=>ua(e(Tt),{weekStartsOn:1})))),sa=Oe(()=>(k(Na),k(e(Dt)),s(()=>Na(e(Dt))))),ga=Oe(()=>(k(qa),k(e(Dt)),k(e(sa)),s(()=>qa(e(Dt),e(sa),{weekStartsOn:1})+1))),Wt=Oe(()=>(e(W),e(he),s(()=>e(W)(e(he).key)))),_t=Oe(()=>(e(he),s(()=>e(he).days.reduce((Ge,oa)=>Ge+oa.events.length,0))));var Pt=qs(),qt=Ie(Pt),St=a(qt);let ra;var Rt=a(St),It=a(Rt),jt=n(It,2),ya=a(jt);t(jt),t(Rt);var Ht=n(Rt,2);let na;var O=a(Ht,!0);t(Ht),t(St),t(qt);var j=n(qt,2);{var Ve=Ge=>{var oa=Lt(),Ya=Ie(oa);{var Xa=Ft=>{var ia=Lt(),Za=Ie(ia);lt(Za,1,()=>(e(he),s(()=>e(he).days)),ha=>ha.key,(ha,Ut)=>{var wa=Ns(),Ra=a(wa),xa=a(Ra),Ea=a(xa),Ga=a(Ea,!0);t(Ea);var Fa=n(Ea,2),es=a(Fa,!0);t(Fa),t(xa);var Ua=n(xa,2);lt(Ua,5,()=>(e(Ut),s(()=>e(Ut).events)),Qt=>Qt.id??`${Qt.start_time}-${Qt.meta_data?.recurring_instance_index??0}`,(Qt,la)=>{var ka=Bs(),$a=a(ka),ts=a($a);hs(ts,{get item(){return e(la)},showDate:!1,get searchQuery(){return H()}}),t($a);var as=n($a,2);{var ss=Aa=>{var Da=zs(),Sa=a(Da);t(Da),R(()=>{Ke(Sa,"data-bs-target",`#${ie()??""}`),Ke(Sa,"aria-controls",ie())}),Y("click",Sa,()=>dt(e(la))),i(Aa,Da)};f(as,Aa=>{e(la),s(()=>r(e(la)))&&Aa(ss)})}t(ka),i(Qt,ka)}),t(Ua),t(Ra),t(wa),R(()=>{z(Ga,(e(Ut),s(()=>e(Ut).displayDay))),z(es,(e(Ut),s(()=>e(Ut).displayDate)))}),i(ha,wa)}),i(Ft,ia)},Ja=Ft=>{var ia=Ws();i(Ft,ia)};f(Ya,Ft=>{e(he),s(()=>e(he).days.length)?Ft(Xa):Ft(Ja,!1)})}i(Ge,oa)};f(j,Ge=>{e(Wt)&&Ge(Ve)})}R(()=>{ra=pt(St,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,ra,{"text-muted":e(_t)===0}),Ke(St,"title",e(Wt)?"Click to collapse week":"Click to expand week"),pt(It,1,`bi ${e(Wt)?"bi-chevron-up":"bi-chevron-down"}`),z(ya,`Week ${e(ga)??""} [${e(_t)??""} Event${e(_t)===1?"":"s"}]`),na=pt(Ht,1,"",null,na,{"opacity-50":e(_t)===0}),z(O,(e(he),s(()=>e(he).label)))}),Y("click",St,()=>wt(e(he).key)),i(Qe,Pt)}),R(()=>z(Nt,(vt(),s(()=>vt().label)))),i(Se,At)}),t(Xe);var kt=n(Xe,2);{var $t=Se=>{var Ne=Vs(),it=a(Ne),vt=a(it);t(it);var At=n(it,2);{var ut=Je=>{var Qe=Hs();Y("click",Qe,me),i(Je,Qe)},Nt=Je=>{var Qe=Qs(),he=a(Qe),Tt=n(he,2);t(Qe),Y("click",he,b),Y("click",Tt,P),i(Je,Qe)};f(At,Je=>{e(Le)?Je(ut):Je(Nt,!1)})}t(Ne),R(()=>z(vt,`Showing ${e(T),s(()=>e(T)?.length??0)??""} of ${y(),s(()=>y()?.length??0)??""}`)),i(Se,Ne)};f(kt,Se=>{(e(We)||e(Le))&&Se($t)})}i(ve,He)},Re=ve=>{var He=Ys();i(ve,He)};f(m,ve=>{e(h),s(()=>e(h).length)?ve(Be):ve(Re,!1)})}t(je),Y("click",be,()=>o(v,!1)),i(ke,je)};f(oe,ke=>{e(v)?ke(Pe,!1):ke(fe)})}i(de,Ee)},ye=de=>{var Ee=Js(),oe=a(Ee);Va(oe,{}),t(Ee),i(de,Ee)};f(_,de=>{G()?de(I):de(ye,!1)})}i(u,p)};f(Ye,u=>{Z()&&u(nt)})}var xt=n(Ye,2);{var ot=u=>{Fs(u,{get cutoffDate(){return e(l)},callback:ge})};f(xt,u=>{e(ht)&&u(ot)})}var zt=n(xt,2);{var Bt=u=>{Ps(u,{get deleted(){return e(S),s(()=>e(S).deleted)},get skipped(){return e(S),s(()=>e(S).skipped)},callback:L})};f(zt,u=>{e(g)&&u(Bt)})}i(ue,De),bt(),se()}var er=c("<span> </span>"),tr=c('<span class="badge bg-secondary">All Day</span>'),ar=c('<span class="result-time svelte-1xkw8oa"> </span>'),sr=c('<span class="result-date svelte-1xkw8oa"> </span> <!>',1),rr=c('<span class="result-location svelte-1xkw8oa"><i class="bi bi-geo-alt"></i> <!></span>'),nr=c('<div class="result-thumbnail-container svelte-1xkw8oa"><img class="result-thumbnail svelte-1xkw8oa"/></div>'),or=c('<div class="result-actions svelte-1xkw8oa"><button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i></button></div>'),ir=c('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="result-details-button svelte-1xkw8oa"><div class="result-header svelte-1xkw8oa"><div class="result-title svelte-1xkw8oa"><!></div> <span class="result-type-badge badge bg-secondary-subtle text-secondary-emphasis svelte-1xkw8oa"> </span></div> <div class="result-meta svelte-1xkw8oa"><!> <!> <!></div></button> <!> <!></li>'),lr=c('<div class="unified-search-results svelte-1xkw8oa"><div class="search-results-header svelte-1xkw8oa"><h6 class="search-results-title svelte-1xkw8oa"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),cr=c('<div class="no-search-results svelte-1xkw8oa"> </div>'),dr=c("<!> <!> <!>",1);function vr(ue,C){ft(C,!1);const M=()=>ae(W,"$currentUser",H),y=()=>ae(X,"$userOrganizations",H),B=()=>ae(T,"$currentUserHasPermission",H),ne=()=>ae(h,"$currentUserIsRoot",H),D=()=>ae(ce,"$currentUserIsAdmin",H),Z=()=>ae(V,"$calendarEvents",H),w=()=>ae(We,"$searchQuery",H),G=()=>ae(re,"$announcements",H),[H,F]=Gt(),se=d(),Q=d(),{stores:{currentUser:W,currentUserHasPermission:T,currentUserIsAdmin:ce,currentUserIsRoot:h,userOrganizations:X}}=ma(),{stores:{calendarEvents:V,announcements:re,searchQuery:We}}=ea(),Fe=Xt(),x=Xt();let $=d(!1),ee=d(),A=d(!1),Ue=d(!1),we=d(new Set),Ce=d(""),Me=d({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),_e=d({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),te=d(!1);const ie=l=>Qa(l,{currentUserId:e(ee),isPrivileged:e($),canEditOwnOrgEvents:e(Ue),userOrganizations:e(we)}),N=l=>l.startsWith("image/"),et=async l=>{const g=l.itemType==="announcement"?"announcement":"calendar_event";if(o(Ce,`${l.itemType==="announcement"?"Announcement":"Event"} Form`),l?.meta_data?.recurring_instance&&l?.meta_data?.recurring_parent_id){const{getCalendarEvent:S}=await Ta(async()=>{const{getCalendarEvent:xe}=await import("./C9DwZanS.js").then(pe=>pe.n);return{getCalendarEvent:xe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),q=await S(l.meta_data.recurring_parent_id);if(q){o(Me,{...q,organization:q?.meta_data?.organization??"",event_type:g,start_time:l.start_time,end_time:l.end_time,meta_data:{...q.meta_data,recurring_instance:!0,recurring_parent_id:l.meta_data.recurring_parent_id,recurring_instance_index:l.meta_data.recurring_instance_index}});return}}o(Me,{...l,organization:l?.meta_data?.organization??"",event_type:g})},ct=async l=>{if(l?.meta_data?.recurring_instance&&l?.meta_data?.recurring_parent_id){const{getCalendarEvent:S}=await Ta(async()=>{const{getCalendarEvent:xe}=await import("./C9DwZanS.js").then(pe=>pe.n);return{getCalendarEvent:xe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url),q=await S(l.meta_data.recurring_parent_id);q?o(_e,{...q,start_time:l.start_time,end_time:l.end_time,meta_data:{...q.meta_data,recurring_instance:!0,recurring_parent_id:l.meta_data.recurring_parent_id,recurring_instance_index:l.meta_data.recurring_instance_index}}):o(_e,l)}else o(_e,l);const g=document.getElementById(x);g&&new window.bootstrap.Offcanvas(g).show()},gt=async l=>{await et(l);const g=document.getElementById(Fe);g&&new window.bootstrap.Offcanvas(g).show()},yt=async()=>{const l=document.getElementById(x);if(l){const g=window.bootstrap.Offcanvas.getInstance(l);g&&g.hide()}await et(e(_e)),setTimeout(()=>{const g=document.getElementById(Fe);g&&new window.bootstrap.Offcanvas(g).show()},300)};E(()=>M(),()=>{o(ee,M()?.id)}),E(()=>y(),()=>{o(we,y())}),E(()=>(e(we),ba),()=>{o(A,e(we).has(ba.Bishopric))}),E(()=>(B(),Ae),()=>{o(Ue,B()(Ae.EditOwnOrgEvents))}),E(()=>(ne(),D(),e(A),B(),Ae),()=>{o($,ne()||D()||e(A)||B()(Ae.EditAllEvents))}),E(()=>(B(),Ae),()=>{o(te,B()(Ae.DeleteEvents))}),E(()=>(Z(),le),()=>{o(se,(Z()??[]).filter(l=>l.start_time?le(l.start_time)>=new Date:!1))}),E(()=>(w(),e(se),G(),le),()=>{o(Q,w()?[...e(se).filter(l=>{const g=w().toLowerCase(),S=(l.title||"").toLowerCase(),q=(l.description||"").replace(/<[^>]*>/g,"").toLowerCase(),xe=(l.location||"").toLowerCase();return S.includes(g)||q.includes(g)||xe.includes(g)}).map(l=>({...l,itemType:"event"})),...(G()??[]).filter(l=>{const g=w().toLowerCase(),S=(l.title||"").toLowerCase(),q=(l.description||"").replace(/<[^>]*>/g,"").toLowerCase(),xe=(l.location||"").toLowerCase();return S.includes(g)||q.includes(g)||xe.includes(g)}).map(l=>({...l,itemType:"announcement"}))].sort((l,g)=>{const S=l.start_time?le(l.start_time).getTime():0,q=g.start_time?le(g.start_time).getTime():0;return S===0&&q!==0?-1:S!==0&&q===0?1:S-q}):[])}),Zt(),mt();var st=dr(),rt=Ie(st);Jt(rt,{get title(){return e(Ce)},get id(){return Fe},children:(l,g)=>{fa(l,{get eventItem(){return e(Me)},get drawerId(){return Fe},name:"unified-search-form",get canDelete(){return e(te)}})},$$slots:{default:!0}});var tt=n(rt,2);Jt(tt,{title:"Details",get id(){return x},children:(l,g)=>{{let S=Oe(()=>(e(_e),s(()=>ie(e(_e)))));fs(l,{get event(){return e(_e)},get canEdit(){return e(S)},onEdit:yt})}},$$slots:{default:!0}});var Ot=n(tt,2);{var Ct=l=>{var g=lr(),S=a(g),q=a(S),xe=a(q);t(q),t(S);var pe=n(S,2);lt(pe,5,()=>e(Q),Le=>Le.id??Le.start_time??Math.random(),(Le,U)=>{const ze=Oe(()=>(e(U),s(()=>e(U).attachments?.find(p=>N(p.type))))),qe=Oe(()=>(k(Yt),e(U),s(()=>Yt(e(U)?.meta_data?.organization??"")))),wt=Oe(()=>(e(U),s(()=>e(U).itemType==="event")));var dt=ir(),Mt=a(dt),r=n(Mt,2),v=a(r),b=a(v),P=a(b);Ba(P,()=>(k(ca),e(U),w(),s(()=>ca(e(U).title,w())))),t(b);var me=n(b,2),at=a(me,!0);t(me),t(v);var ge=n(v,2),L=a(ge);{var De=p=>{var _=er(),I=a(_,!0);t(_),R(()=>{pt(_,1,`badge rounded-pill bg-color-${k(e(qe)),s(()=>e(qe).color_number)??""}`,"svelte-1xkw8oa"),z(I,(k(e(qe)),s(()=>e(qe).label)))}),i(p,_)};f(L,p=>{k(e(qe)),s(()=>e(qe)?.label)&&p(De)})}var Te=n(L,2);{var Ye=p=>{var _=sr(),I=Ie(_),ye=a(I,!0);t(I);var de=n(I,2);{var Ee=fe=>{var Pe=tr();i(fe,Pe)},oe=fe=>{var Pe=ar(),ke=a(Pe,!0);t(Pe),R(je=>z(ke,je),[()=>(k($e),k(le),e(U),s(()=>$e(le(e(U).start_time),"h:mm a")))]),i(fe,Pe)};f(de,fe=>{e(U),s(()=>e(U).is_all_day)?fe(Ee):fe(oe,!1)})}R(fe=>z(ye,fe),[()=>(k($e),k(le),e(U),s(()=>$e(le(e(U).start_time),"MMM d, yyyy")))]),i(p,_)};f(Te,p=>{e(U),s(()=>e(U).start_time)&&p(Ye)})}var nt=n(Te,2);{var xt=p=>{var _=rr(),I=n(a(_),2);Ba(I,()=>(k(ca),e(U),w(),s(()=>ca(e(U).location,w())))),t(_),i(p,_)};f(nt,p=>{e(U),s(()=>e(U).location)&&p(xt)})}t(ge),t(r);var ot=n(r,2);{var zt=p=>{var _=nr(),I=a(_);t(_),R(()=>{Ke(I,"src",(k(e(ze)),s(()=>e(ze).url))),Ke(I,"alt",(k(e(ze)),s(()=>e(ze).name)))}),i(p,_)};f(ot,p=>{e(ze)&&p(zt)})}var Bt=n(ot,2);{var u=p=>{var _=or(),I=a(_);t(_),R(()=>Ke(I,"title",`Edit ${e(wt)?"event":"announcement"}`)),Y("click",I,Ka(()=>gt(e(U)))),i(p,_)};f(Bt,p=>{e(U),s(()=>ie(e(U)))&&p(u)})}t(dt),R(()=>{pt(Mt,1,`result-color-indicator bg-color-${k(e(qe)),s(()=>e(qe)?.color_number??0)??""}`,"svelte-1xkw8oa"),z(at,e(wt)?"Event":"Announcement")}),Y("click",r,()=>ct(e(U))),i(Le,dt)}),t(pe),t(g),R(()=>z(xe,`${e(Q),s(()=>e(Q).length)??""} result${e(Q),s(()=>e(Q).length===1?"":"s")??""} matching "${w()??""}"`)),i(l,g)},ht=l=>{var g=Lt(),S=Ie(g);{var q=xe=>{var pe=cr(),Le=a(pe);t(pe),R(()=>z(Le,`No results match your search for "${w()??""}"`)),i(xe,pe)};f(S,xe=>{w()&&xe(q)},!0)}i(l,g)};f(Ot,l=>{w(),e(Q),s(()=>w()&&e(Q).length>0)?l(Ct):l(ht,!1)})}i(ue,st),bt(),F()}var ur=c("<!> <!> <!>",1),_r=c('<div class="d-flex flex-column gap-4"><!> <!></div>');function ja(ue,C){ft(C,!1);const M=()=>ae(ne,"$searchQuery",y),[y,B]=Gt(),{stores:{searchQuery:ne}}=ea();let D=Ze(C,"showAnnouncements",8,!0),Z=Ze(C,"showSearch",8,!0);mt();var w=_r(),G=a(w);{var H=W=>{Ss(W,{})};f(G,W=>{Z()&&W(H)})}var F=n(G,2);{var se=W=>{vr(W,{})},Q=W=>{var T=ur(),ce=Ie(T);{var h=re=>{ms(re,{})};f(ce,re=>{D()&&re(h)})}var X=n(ce,2);bs(X,{});var V=n(X,2);Gs(V,{}),i(W,T)};f(F,W=>{Z()&&M()?W(se):W(Q,!1)})}t(w),i(ue,w),bt(),B()}var pr=c('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),fr=c('<i class="bi bi-arrow-clockwise"></i>'),br=c('<i class="bi bi-arrow-clockwise me-1"></i>Refresh',1),mr=c("<option> </option>"),gr=c("<option> </option>"),yr=c('<div class="py-5 text-center text-muted"><!></div>'),hr=c('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),wr=c("<span> </span>"),xr=c('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),Er=c('<span><i class="bi bi-geo-alt"></i> </span>'),kr=c('<span><i class="bi bi-arrow-repeat"></i> </span>'),$r=c('<span><i class="bi bi-calendar3"></i> </span>'),Ar=c('<span class="text-muted small"> </span>'),Dr=c('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2 flex-shrink-0"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-primary d-flex align-items-center gap-1" type="button" title="Edit this submission"><i class="bi bi-pencil-square"></i> <span class="d-none d-sm-inline">Edit</span></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),Sr=c('<div class="d-flex flex-column gap-3"></div>'),Ir=c('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="d-flex flex-column gap-3"><div class="submissions-action-bar d-flex justify-content-end gap-2"><div class="dropdown"><button class="btn btn-success btn-sm dropdown-toggle" type="button" id="createEventDropdown" data-bs-toggle="dropdown" aria-label="Create event actions" aria-expanded="false"><i class="bi bi-plus"></i> <span class="d-none d-md-inline ms-1">Create Event</span></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="createEventDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-calendar-plus me-2"></i>Create Event</button></li> <li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-megaphone me-2"></i>Create Announcement</button></li></ul></div> <button class="btn btn-outline-secondary btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#my-submissions-actions-panel" aria-expanded="false" aria-controls="my-submissions-actions-panel"><i class="bi bi-gear"></i> <span class="d-none d-md-inline ms-1">Actions</span></button></div> <div id="my-submissions-actions-panel" class="collapse"><div class="d-flex flex-column gap-2 p-3 border rounded bg-body-tertiary"><button class="btn btn-success btn-sm" type="button"><i class="bi bi-file-earmark-arrow-up me-1"></i>Import CSV</button> <button class="btn btn-primary btn-sm"><!></button></div></div></div> <div class="d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center gap-3"><div class="input-group input-group-sm my-submissions-search flex-grow-1 svelte-9fakr"><input class="form-control" type="search" placeholder="Search title, category, or location"/></div> <div class="d-flex flex-column flex-sm-row gap-2"><div class="filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div> <div class="filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div></div> <!></div></div>'),Or=c('<div class="text-muted">Select a submission to edit.</div>'),Cr=c("<!> <!> <!> <!>",1);function Mr(ue,C){ft(C,!1);const M=()=>ae(ce,"$currentUserStore",D),y=()=>ae(h,"$currentUserHasPermission",D),B=()=>ae(W,"$dbData",D),ne=()=>ae(Q,"$ready",D),[D,Z]=Gt(),w=d(),G=d(),H=d(),F=d(),se=d(),{stores:{ready:Q,dbData:W},actions:{reload:T}}=ea(),{stores:{currentUser:ce,currentUserHasPermission:h}}=ma();let X=d({...Oa});const V=`create-event-form-${Xt()}`;let re=d(!1);const We=()=>{o(re,!1)},Fe=async()=>{o(re,!1),await T()};let x=d(!1),$=d([]),ee=d([]),A=d(null);const Ue=Xt();let we=null;const Ce={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},Me={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},_e={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},te=[{value:"all",label:"All Statuses"},{value:"pending",label:_e.pending},{value:"needs_review",label:_e.needs_review},{value:"approved",label:_e.approved},{value:"published",label:_e.published}],ie=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}];let N=d({search:"",statusFilter:"all",typeFilter:"all"});Pa(async()=>{o(x,!0),await T(),o(x,!1),typeof window<"u"&&(we=(await Ta(()=>import("./tUu8UEjF.js").then(v=>v.o),__vite__mapDeps([33,29]),import.meta.url)).default)});const et=r=>{const v=r.meta_data?.submitted_at??r.created_at;if(!v)return 0;try{return le(v).getTime()}catch(b){return console.warn("Failed to parse submission timestamp",b),0}},ct=r=>{const v=r.meta_data?.submitted_at??r.created_at;if(!v)return"—";try{return $e(le(v),"MMM d, yyyy 'at' h:mm a")}catch(b){return console.warn("Failed to format submission timestamp",b),"—"}},gt=r=>{if(!r.start_time)return"—";try{return $e(le(r.start_time),"MMM d, yyyy 'at' h:mm a")}catch(v){return console.warn("Failed to format event date",v),"—"}},yt=r=>r.replace(/<[^>]*>/g,""),st=(r,v)=>r.length<=v?r:r.substring(0,v).trimEnd()+"…",rt=r=>r.description?st(yt(r.description).trim(),120):"",tt=r=>{try{const b=Kt.fromString(r).origOptions,P=b.interval||1,me=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],at=["","1st","2nd","3rd","4th","5th"];if(b.freq===Kt.DAILY)return P===1?"Repeats daily":`Repeats every ${P} days`;if(b.freq===Kt.WEEKLY){if(b.byweekday){const L=(Array.isArray(b.byweekday)?b.byweekday:[b.byweekday]).map(De=>{const Te=typeof De=="number"?De:De.weekday,Ye=Te===6?0:Te+1;return me[Ye]});return P===1?L.length===1?`Repeats every ${L[0]}`:`Repeats on ${L.join(", ")}`:`Repeats every ${P} weeks on ${L.join(", ")}`}return P===1?"Repeats weekly":`Repeats every ${P} weeks`}if(b.freq===Kt.MONTHLY){if(b.byweekday){const L=(Array.isArray(b.byweekday)?b.byweekday:[b.byweekday])[0];if(L&&typeof L=="object"&&"n"in L&&"weekday"in L){const De=L.weekday,Te=De===6?0:De+1,Ye=L.n,nt=at[Ye]||`${Ye}th`;return P===1?`Repeats on the ${nt} ${me[Te]} of the month`:`Repeats on the ${nt} ${me[Te]} every ${P} months`}}if(b.bymonthday){const ge=Array.isArray(b.bymonthday)?b.bymonthday[0]:b.bymonthday,L=ge===1?"st":ge===2?"nd":ge===3?"rd":"th";return P===1?`Repeats on the ${ge}${L} of the month`:`Repeats on the ${ge}${L} every ${P} months`}return P===1?"Repeats monthly":`Repeats every ${P} months`}return b.freq===Kt.YEARLY?P===1?"Repeats yearly":`Repeats every ${P} years`:"Repeats"}catch{return"Repeats"}},Ot=(r,v)=>{const b=v.trim().toLowerCase();if(!b)return!0;const P=r.meta_data?.organization?Yt(r.meta_data.organization)?.label??"":"";return[r.title??"",r.description??"",r.location??"",P??""].join(" ").toLowerCase().includes(b)},Ct=(r,v)=>v==="all"?!0:v==="events"?r.event_type==="calendar_event":r.event_type==="announcement",ht=(r,v)=>v==="all"?!0:Ia(r)===v;function l(r){o(N,{...e(N),...r})}const g=r=>{const v=new Set,b=[];for(const P of r){const me=P.meta_data?.recurring_parent_id;if(P.meta_data?.recurring_instance&&me!=null){if(v.has(me))continue;v.add(me)}b.push(P)}return b},S=r=>r.meta_data?.recurring_parent_id!=null?`recurring-${r.meta_data.recurring_parent_id}`:`id-${r.id}`,q=r=>{o(A,r);const v=document.getElementById(Ue);v&&we&&we.getOrCreateInstance(v).show()},xe=(r,v)=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),q(v))},pe=async()=>{o(x,!0),await T(),o(x,!1)};E(()=>M(),()=>{o(w,M())}),E(()=>(y(),Ae),()=>{o(G,y()(Ae.DeleteEvents)||y()(Ae.DeleteOwnEvents))}),E(()=>(B(),e(w)),()=>{o($,g((B()??[]).filter(r=>{const v=r.meta_data?.submitted_by_user_id;return v&&e(w)?.id&&v===e(w).id}).sort((r,v)=>et(v)-et(r))))}),E(()=>{},()=>{o(H,"status-filter-select-submissions")}),E(()=>{},()=>{o(F,"type-filter-select-submissions")}),E(()=>(e($),e(N)),()=>{o(ee,e($).filter(r=>ht(r,e(N).statusFilter)).filter(r=>Ct(r,e(N).typeFilter)).filter(r=>Ot(r,e(N).search)))}),E(()=>(e(A),e($)),()=>{e(A)&&!e($).some(r=>S(r)===S(e(A)))&&o(A,null)}),E(()=>e(A),()=>{o(se,e(A)?{...e(A),id:e(A).id??e(A).meta_data?.recurring_parent_id,organization:e(A).meta_data?.organization??""}:null)}),Zt(),mt();var Le=Cr(),U=Ie(Le);{var ze=r=>{var v=pr(),b=a(v);Va(b,{}),t(v),i(r,v)},qe=r=>{var v=Ir(),b=a(v),P=a(b),me=a(P),at=n(a(me),2),ge=a(at),L=a(ge);t(ge);var De=n(ge,2),Te=a(De);t(De),t(at),t(me),_a(2),t(P);var Ye=n(P,2),nt=a(Ye),xt=a(nt),ot=n(xt,2),zt=a(ot);{var Bt=J=>{var K=fr();i(J,K)},u=J=>{var K=br();_a(),i(J,K)};f(zt,J=>{e(x)?J(Bt):J(u,!1)})}t(ot),t(nt),t(Ye),t(b);var p=n(b,2),_=a(p),I=a(_),ye=a(I);Ha(ye),t(I);var de=n(I,2),Ee=a(de),oe=a(Ee);lt(oe,5,()=>te,Ca,(J,K)=>{var be=mr(),m=a(be,!0);t(be);var Be={};R(()=>{z(m,(e(K),s(()=>e(K).label))),Be!==(Be=(e(K),s(()=>e(K).value)))&&(be.value=(be.__value=(e(K),s(()=>e(K).value)))??"")}),i(J,be)}),t(oe);var fe;La(oe),t(Ee);var Pe=n(Ee,2),ke=a(Pe);lt(ke,5,()=>ie,Ca,(J,K)=>{var be=gr(),m=a(be,!0);t(be);var Be={};R(()=>{z(m,(e(K),s(()=>e(K).label))),Be!==(Be=(e(K),s(()=>e(K).value)))&&(be.value=(be.__value=(e(K),s(()=>e(K).value)))??"")}),i(J,be)}),t(ke);var je;La(ke),t(Pe),t(de),t(_);var Et=n(_,2);{var ta=J=>{var K=yr(),be=a(K);{var m=Re=>{var ve=pa("You haven't submitted any events or announcements yet.");i(Re,ve)},Be=Re=>{var ve=pa("No submissions match your current filters.");i(Re,ve)};f(be,Re=>{e($),s(()=>e($).length===0)?Re(m):Re(Be,!1)})}t(K),i(J,K)},aa=J=>{var K=Sr();lt(K,5,()=>e(ee),be=>S(be),(be,m)=>{const Be=Oe(()=>(k(Ia),e(m),s(()=>Ia(e(m))))),Re=Oe(()=>(k(e(Be)),s(()=>Me[e(Be)]))),ve=Oe(()=>(e(m),k(Yt),s(()=>e(m).meta_data?.organization?Yt(e(m).meta_data.organization):null))),He=Oe(()=>(e(m),s(()=>rt(e(m)))));var Xe=Dr(),kt=a(Xe),$t=a(kt),Se=a($t,!0);t($t);var Ne=n($t,2),it=a(Ne),vt=a(it,!0);t(it);var At=n(it,2);t(Ne),t(kt);var ut=n(kt,2);{var Nt=O=>{var j=hr(),Ve=a(j,!0);t(j),R(()=>z(Ve,e(He))),i(O,j)};f(ut,O=>{e(He)&&O(Nt)})}var Je=n(ut,2),Qe=a(Je);{var he=O=>{var j=wr(),Ve=a(j,!0);t(j),R(()=>{pt(j,1,`badge rounded-pill bg-color-${k(e(ve)),s(()=>e(ve).color_number)??""}`,"svelte-9fakr"),z(Ve,(k(e(ve)),s(()=>e(ve).label)))}),i(O,j)},Tt=O=>{var j=xr();i(O,j)};f(Qe,O=>{e(ve)?O(he):O(Tt,!1)})}var Dt=n(Qe,2);{var sa=O=>{var j=Er(),Ve=n(a(j));t(j),R(()=>z(Ve,` ${e(m),s(()=>e(m).location)??""}`)),i(O,j)};f(Dt,O=>{e(m),s(()=>e(m).location)&&O(sa)})}var ga=n(Dt,2);{var Wt=O=>{var j=kr(),Ve=n(a(j));t(j),R(Ge=>z(Ve,` ${Ge??""}`),[()=>(e(m),s(()=>tt(e(m).recurrence_rule)))]),i(O,j)};f(ga,O=>{e(m),s(()=>e(m).recurrence_rule)&&O(Wt)})}t(Je);var _t=n(Je,2),Pt=a(_t),qt=n(a(Pt));t(Pt);var St=n(Pt,2);{var ra=O=>{var j=$r(),Ve=n(a(j));t(j),R(Ge=>z(Ve,` Event ${Ge??""}`),[()=>(e(m),s(()=>gt(e(m))))]),i(O,j)};f(St,O=>{e(m),s(()=>e(m).event_type==="calendar_event")&&O(ra)})}t(_t);var Rt=n(_t,2),It=a(Rt),jt=a(It),ya=n(jt,1,!0);t(It);var Ht=n(It,2);{var na=O=>{var j=Ar(),Ve=a(j);t(j),R(Ge=>z(Ve,`Approvals: ${Ge??""} of 3`),[()=>(k(da),e(m),s(()=>da(e(m))))]),i(O,j)};f(Ht,O=>{k(da),e(m),s(()=>da(e(m))>0)&&O(na)})}t(Rt),t(Xe),R(O=>{vs(Xe,`border-left: 4px solid ${k(e(Be)),s(()=>Ce[e(Be)])??""}`),z(Se,(e(m),s(()=>e(m).title))),z(vt,(e(m),s(()=>e(m).event_type==="calendar_event"?"Event":"Announcement"))),Ke(At,"aria-label",(e(m),s(()=>`Edit ${e(m).title}`))),z(qt,` Submitted ${O??""}`),pt(It,1,(k(e(Re)),s(()=>`badge ${e(Re).class}`)),"svelte-9fakr"),pt(jt,1,(k(e(Re)),s(()=>`bi ${e(Re).icon} me-1`)),"svelte-9fakr"),z(ya,(k(e(Re)),s(()=>e(Re).text)))},[()=>(e(m),s(()=>ct(e(m))))]),Y("click",At,Ka(()=>q(e(m)))),Y("click",Xe,()=>q(e(m))),Y("keydown",Xe,O=>xe(O,e(m))),i(be,Xe)}),t(K),i(J,K)};f(Et,J=>{e(ee),s(()=>e(ee).length===0)?J(ta):J(aa,!1)})}t(p),t(v),R(()=>{Ke(L,"data-bs-target",`#${V}`),Ke(L,"aria-controls",V),Ke(Te,"data-bs-target",`#${V}`),Ke(Te,"aria-controls",V),ot.disabled=e(x),ds(ye,(e(N),s(()=>e(N).search))),Ke(oe,"id",e(H)),fe!==(fe=(e(N),s(()=>e(N).statusFilter)))&&(oe.value=(oe.__value=(e(N),s(()=>e(N).statusFilter)))??"",za(oe,(e(N),s(()=>e(N).statusFilter)))),Ke(ke,"id",e(F)),je!==(je=(e(N),s(()=>e(N).typeFilter)))&&(ke.value=(ke.__value=(e(N),s(()=>e(N).typeFilter)))??"",za(ke,(e(N),s(()=>e(N).typeFilter))))}),Y("click",L,()=>{o(X,{...Oa,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})}),Y("click",Te,()=>{o(X,{...Oa,event_type:"announcement"})}),Y("click",xt,()=>o(re,!0)),Y("click",ot,pe),Y("input",ye,J=>l({search:J.currentTarget.value})),Y("change",oe,J=>l({statusFilter:J.currentTarget.value})),Y("change",ke,J=>l({typeFilter:J.currentTarget.value})),i(r,v)};f(U,r=>{ne()?r(qe,!1):r(ze)})}var wt=n(U,2);{let r=Oe(()=>(e(A),s(()=>e(A)?`Edit: ${e(A).title}`:"Submission Details")));Jt(wt,{get id(){return Ue},get title(){return e(r)},children:(v,b)=>{var P=Lt(),me=Ie(P);{var at=L=>{fa(L,{get eventItem(){return e(se)},get drawerId(){return Ue},name:"my-submission-form",get canDelete(){return e(G)},canCreate:!1})},ge=L=>{var De=Or();i(L,De)};f(me,L=>{e(se)?L(at):L(ge,!1)})}i(v,P)},$$slots:{default:!0}})}var dt=n(wt,2);{let r=Oe(()=>(e(X),s(()=>e(X).event_type==="announcement"?"Create Announcement":"Create Event")));Jt(dt,{get id(){return V},get title(){return e(r)},children:(v,b)=>{fa(v,{get eventItem(){return e(X)},get drawerId(){return V},name:"create-form",canCreate:!0})},$$slots:{default:!0}})}var Mt=n(dt,2);gs(Mt,{onClose:We,onComplete:Fe,get isOpen(){return e(re)},set isOpen(r){o(re,r)},$$legacy:!0}),i(ue,Le),bt(),Z()}var Tr=c('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),Pr=c('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),Rr=c('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),Fr=c('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),Ur=c('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1),Lr=c('<div class="calendar-section svelte-1oi0f59"><!></div>');function ln(ue,C){ft(C,!1);const M=d(),y=d(),B=d(),{stores:{currentUserHasPermission:ne,authenticated:D}}=ma();let Z=Ze(C,"showApprovals",8,!0),w=Ze(C,"showMySubmissions",8,!0),G=Ze(C,"showAnnouncements",8,!0),H=Ze(C,"showSearch",8,!0),F=d(!1),se=d(!1);Pa(()=>{const h=ne.subscribe(V=>{const re=Z()&&V(Ae.ManageWardBusiness);o(F,re)}),X=D.subscribe(V=>{o(se,V)});return()=>{h(),X()}}),E(()=>(k(Z()),e(F)),()=>{o(M,Z()&&e(F))}),E(()=>(k(w()),e(se)),()=>{o(y,w()&&e(se))}),E(()=>(e(M),e(y)),()=>{o(B,e(M)||e(y))}),Zt(),mt();var Q=Lr(),W=a(Q);{var T=h=>{var X=Ur(),V=Ie(X),re=a(V),We=n(a(re),2);{var Fe=te=>{var ie=Tr();i(te,ie)};f(We,te=>{e(y)&&te(Fe)})}var x=n(We,2);{var $=te=>{var ie=Pr();i(te,ie)};f(x,te=>{e(M)&&te($)})}t(re),t(V);var ee=n(V,2),A=a(ee),Ue=a(A);ja(Ue,{get showAnnouncements(){return G()},get showSearch(){return H()}}),t(A);var we=n(A,2);{var Ce=te=>{var ie=Rr(),N=a(ie);Mr(N,{}),t(ie),i(te,ie)};f(we,te=>{e(y)&&te(Ce)})}var Me=n(we,2);{var _e=te=>{var ie=Fr(),N=a(ie);ws(N,{}),t(ie),i(te,ie)};f(Me,te=>{e(M)&&te(_e)})}t(ee),i(h,X)},ce=h=>{ja(h,{get showAnnouncements(){return G()},get showSearch(){return H()}})};f(W,h=>{e(B)?h(T):h(ce,!1)})}t(Q),i(ue,Q),bt()}export{ln as C};
