const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D84_1tz-.js","./SWWSvUpQ.js","./DIeogL5L.js","./D8ekX_8E.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./WW5OsAH7.js","./CU3XCoqN.js","./YJAcq9su.js","./B1m2beNT.js","./DfEdrAuv.js","./BSjSVmR1.js","./BUApaBEI.js","./Bgyk9asy.js","./CY-LwuyL.js","../assets/Spinner.DTjfhZ6-.css","./CxlEckD_.js","./mnkQx8ai.js","./CvxMDV_e.js","./Cc3l00Qu.js","./CLW8lAXk.js","./HwD2OxZt.js","./TGSTPOf-.js","./BDvsiuh0.js","./DstOQaN9.js","../assets/BishopricApprovalSection.DRGo_BHg.css","./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{d as ar,o as Sa,g as rr}from"./WW5OsAH7.js";import{p as _t,ah as $,D as s,E as v,ai as Kt,c as a,s as o,r as t,u as r,m as e,a as pt,B as C,C as sr,f as Ie,F as Ia,R as Ae,aq as nr,n as D,ar as or}from"./SWWSvUpQ.js";import{f as l,a as i,c as Ut,t as ca}from"./D8ekX_8E.js";import{a as te,i as m,k as qt,b as Yt,e as Y,s as R,p as Ve}from"./CU3XCoqN.js";import{i as ft}from"./Bgyk9asy.js";import{e as ot,i as $a}from"./YJAcq9su.js";import{r as za,b as ir,s as qe,i as lr,c as cr,d as vr,e as dr}from"./B1m2beNT.js";import{b as ur}from"./CvxMDV_e.js";import{e as _r,g as Xt,i as pr,h as Pa,d as sa,b as Ht,a as na,j as oa}from"./D84_1tz-.js";import{s as Ra,C as fr,E as br,A as mr,a as gr}from"./caXEPIrI.js";import{z as Aa,v as Ua,B as yr,e as ua,p as ve,i as $e,O as va,P as De,f as it,C as Ea}from"./DfEdrAuv.js";import{C as da,E as hr,c as Ba}from"./A1UPiuGv.js";import{S as Na}from"./CY-LwuyL.js";import{v as Qt,D as Vt}from"./CxlEckD_.js";import{s as ia}from"./DstOQaN9.js";import{e as la}from"./TGSTPOf-.js";import{_ as Da}from"./CmsKOCeN.js";import{s as Wa}from"./CdEA5IGF.js";import{B as wr}from"./CLHo3aCG.js";import{R as jt}from"./HwD2OxZt.js";function Fa(_e,U,F){const w=Aa(_e,F),N=Aa(U,F),se=+w-Ua(w),M=+N-Ua(N);return Math.round((se-M)/yr)}function xr(_e,U){return _r(_e,-U)}var kr=l('<button type="button" class="btn-clear-search svelte-14zxluq" aria-label="Clear search" title="Clear search"><i class="bi bi-x-lg"></i></button>'),Er=l("<option> </option>"),$r=l('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by organization"><option>All Organizations</option><!></select></div>'),Ar=l('<div class="col-12 col-md-auto"><button type="button" class="btn btn-primary w-100" aria-label="Clear all filters"><i class="bi bi-x-circle me-1"></i> Clear All</button></div>'),Dr=l('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><div class="search-input-wrapper svelte-14zxluq"><input type="text" class="form-control form-control" placeholder="Search..."/> <!></div></div> <!> <!></div></div>');function Sr(_e,U){_t(U,!1);const F=()=>te(K,"$searchQuery",se),w=()=>te(Z,"$organizationFilter",se),N=()=>te(A,"$currentOrganizations",se),[se,M]=Yt(),J=v(),{stores:{currentOrganizations:A,organizationFilter:Z,searchQuery:K}}=Xt(),S=()=>{qt(K,""),qt(Z,"")};$(()=>(F(),w()),()=>{s(J,!!(F()||w()))}),Kt(),ft();var ae=Dr(),W=a(ae),H=a(W),q=a(H),le=a(q);za(le);var k=o(le,2);{var ce=L=>{var T=kr();Y("click",T,()=>qt(K,"")),i(L,T)};m(k,L=>{F()&&L(ce)})}t(q),t(H);var X=o(H,2);{var G=L=>{var T=$r(),Q=a(T);C(()=>{w(),sr(()=>{N()})});var ne=a(Q);ne.value=ne.__value="";var ee=o(ne);ot(ee,1,N,$a,(xe,ke)=>{var Oe=Er(),Se=a(Oe,!0);t(Oe);var j={};C(()=>{R(Se,(e(ke),r(()=>e(ke).label))),j!==(j=(e(ke),r(()=>e(ke).key)))&&(Oe.value=(Oe.__value=(e(ke),r(()=>e(ke).key)))??"")}),i(xe,Oe)}),t(Q),t(T),ir(Q,w,xe=>qt(Z,xe)),i(L,T)};m(X,L=>{N(),r(()=>N().length)&&L(G)})}var we=o(X,2);{var Ue=L=>{var T=Ar(),Q=a(T);t(T),Y("click",Q,S),i(L,T)};m(we,L=>{e(J)&&L(Ue)})}t(W),t(ae),ur(le,F,L=>qt(K,L)),i(_e,ae),pt(),M()}var Ir=l('<p class="mb-0">No past events to delete.</p>'),Or=l('<p class="mb-2"><strong> </strong></p>'),Cr=l(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Mr=l("<!> <!>",1),Tr=l('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Pr(_e,U){_t(U,!1);let F=Ve(U,"deleted",8),w=Ve(U,"skipped",8),N=Ve(U,"callback",8);function se(){N()()}ft();var M=Tr(),J=a(M),A=a(J),Z=a(A),K=o(a(Z),2);t(Z);var S=o(Z,2),ae=a(S);{var W=k=>{var ce=Ir();i(k,ce)},H=k=>{var ce=Mr(),X=Ie(ce);{var G=L=>{var T=Or(),Q=a(T),ne=a(Q);t(Q),t(T),C(()=>R(ne,`✓ Deleted ${F()??""} past event${F()===1?"":"s"}.`)),i(L,T)};m(X,L=>{F()>0&&L(G)})}var we=o(X,2);{var Ue=L=>{var T=Cr(),Q=a(T),ne=a(Q),ee=a(ne);t(ne),t(Q),Ia(2),t(T),C(()=>R(ee,`⚠ Skipped ${w()??""} recurring event${w()===1?"":"s"}`)),i(L,T)};m(we,L=>{w()>0&&L(Ue)})}i(k,ce)};m(ae,k=>{F()===0&&w()===0?k(W):k(H,!1)})}t(S);var q=o(S,2),le=a(q);t(q),t(A),t(J),t(M),Y("click",K,se),Y("click",le,se),i(_e,M),pt()}var Rr=l(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Ur(_e,U){_t(U,!1);let F=Ve(U,"cutoffDate",8),w=Ve(U,"callback",8);function N(){w()(!0)}function se(){w()(!1)}ft();var M=Rr(),J=a(M),A=a(J),Z=a(A),K=o(a(Z),2);t(Z);var S=o(Z,2),ae=a(S),W=a(ae),H=a(W);t(W),t(ae),Ia(2),t(S);var q=o(S,2),le=a(q),k=o(le,2);t(q),t(A),t(J),t(M),C(()=>R(H,`Are you sure you want to delete all events that occurred before ${F()??""}?`)),Y("click",K,se),Y("click",le,se),Y("click",k,N),i(_e,M),pt()}var Fr=l('<button class="btn btn-sm btn-primary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Lr=l('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),zr=l('<div class="d-flex align-items-center justify-content-end ms-auto"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),Br=l('<div class="d-flex flex-row align-items-start gap-3 w-100"><div class="flex-grow-1"><!></div> <!></div>'),Nr=l('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Wr=l('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),qr=l('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),jr=l('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),Hr=l('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),Qr=l('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Vr=l('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Kr=l('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Yr=l('<div class="card-body text-muted small">No past events available.</div>'),Xr=l('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-primary">Hide</button></div></div></div> <!></div>'),Jr=l('<div class="d-flex flex-column gap-4"><!></div>'),Zr=l("<!> <!> <!> <!>",1);function Gr(_e,U){_t(U,!1);const F=()=>te(ke,"$weeksExpanded",S),w=()=>te(yt,"$allPastEvents",S),N=()=>te(L,"$currentUser",S),se=()=>te(ne,"$userOrganizations",S),M=()=>te(Ue,"$currentUserHasPermission",S),J=()=>te(Q,"$currentUserIsRoot",S),A=()=>te(T,"$currentUserIsAdmin",S),Z=()=>te(ee,"$ready",S),K=()=>te(Oe,"$searchQuery",S),[S,ae]=Yt(),W=v(),H=v(),q=v(),le=v(),k=v(),ce=v(),X=v(),G=v(),we=v(),{stores:{currentUserHasPermission:Ue,currentUser:L,currentUserIsAdmin:T,currentUserIsRoot:Q,userOrganizations:ne}}=ua(),{stores:{ready:ee,dbData:xe,weeksExpanded:ke,searchQuery:Oe},actions:{reload:Se}}=Xt(),j={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let oe=Ve(U,"formId",24,Qt),Ze=v(!1),je=v(!1),de=v(),lt=v(!1),bt=v(!1),at=v(!1),rt=v(new Set),Ge=v(!1),Dt=v(""),St=v({...j}),mt=v(!1),c=v(""),y=v(!1),z=v({deleted:0,skipped:0});const V=4,pe=4;let fe=v(V),We=v(!1);const b=ia();let Ce=v({});function Fe(u){return e(W).includes(u)}function It(u){const f=e(Ce)[u]??Fe(u);s(Ce,{...e(Ce),[u]:!f})}const gt=u=>{s(Dt,"Event Item"),s(St,{...u,organization:u?.meta_data?.organization??""})},yt=ar(xe,u=>{const f=ia();return(u??[]).filter(p=>!(p.event_type!=="calendar_event"||!p.start_time||ve(p.start_time)>=f||p.recurrence_rule&&(!p.recurrence_end_date||p.recurrence_end_date&&ve(p.recurrence_end_date)>=f)))}),st=u=>Ba(u,{currentUserId:e(de),isPrivileged:e(je),canEditOwnOrgEvents:e(at),userOrganizations:e(rt)});let nt=v(!1);function n(){s(fe,e(fe)+pe)}function d(){s(fe,520),s(We,!0)}function g(){s(fe,V),s(We,!1)}const I=()=>{if(!e(Ze)||e(Ge)||!rr(Q)||!e(G))return;const u=ia();s(c,$e(u,"MMM d, yyyy")),s(mt,!0)};async function re(u){if(s(mt,!1),!u)return;const f=ia();s(Ge,!0);try{const p=await pr(f);await Se(),s(z,p),s(y,!0)}catch(p){console.error("Failed to delete past events",p),alert("Failed to delete past events. Please try again.")}finally{s(Ge,!1)}}function Ke(){s(y,!1)}Sa(async()=>{await Se()}),$(()=>(w(),e(fe)),()=>{s(q,(w()??[]).filter(u=>{if(!u.start_time)return!1;const f=ve(u.start_time),p=xr(b,e(fe));return f>=p&&f<b}))}),$(()=>(e(q),$e),()=>{s(k,(()=>{const u=new Map;for(const f of e(q)){if(!f.start_time)continue;const p=ve(f.start_time),E=Aa(p,{weekStartsOn:1}),Ee=la(p,{weekStartsOn:1}),me=$e(E,"yyyy-MM-dd"),Te=`${$e(E,"MMM d")} – ${$e(Ee,"MMM d")}`;let Pe=u.get(me);Pe||(Pe={key:me,label:Te,days:new Map},u.set(me,Pe));const x=$e(p,"yyyy-MM-dd");let h=Pe.days.get(x);h||(h={key:x,displayDay:$e(p,"EEE"),displayDate:$e(p,"MMM d"),events:[]},Pe.days.set(x,h)),h.events.push(f)}return Array.from(u.values()).sort((f,p)=>f.key<p.key?1:-1).map(f=>({key:f.key,label:f.label,days:Array.from(f.days.values()).sort((p,E)=>p.key<E.key?1:-1).map(p=>({...p,events:p.events.slice().sort((E,Ee)=>{const me=E.is_all_day?0:1,Te=Ee.is_all_day?0:1;if(me!==Te)return me-Te;const Pe=E.start_time?ve(E.start_time).getTime():Number.MAX_SAFE_INTEGER,x=Ee.start_time?ve(Ee.start_time).getTime():Number.MAX_SAFE_INTEGER;return Pe-x})}))}))})())}),$(()=>e(k),()=>{s(W,(()=>{if(e(k).length===0)return[];const u=[];return e(k)[0]&&u.push(e(k)[0].key),e(k)[1]&&u.push(e(k)[1].key),u})())}),$(()=>(F(),e(Ce)),()=>{s(H,u=>F()?!0:e(Ce)[u]!==void 0?e(Ce)[u]:Fe(u))}),$(()=>e(q),()=>{s(le,e(q).length)}),$(()=>(e(k),$e),()=>{s(ce,e(k).reduce((u,f)=>{const p=ve(f.key),E=la(p,{weekStartsOn:1}),Ee=$e(E,"yyyy-MM"),me=$e(E,"MMMM yyyy");return u[Ee]||(u[Ee]={label:me,weeks:[]}),u[Ee].weeks.push(f),u},{}))}),$(()=>N(),()=>{s(de,N()?.id)}),$(()=>se(),()=>{s(rt,se())}),$(()=>e(de),()=>{s(bt,!!e(de))}),$(()=>(e(rt),va),()=>{s(lt,e(rt).has(va.Bishopric))}),$(()=>(M(),De),()=>{s(at,M()(De.EditOwnOrgEvents))}),$(()=>(J(),A(),e(lt),M(),De),()=>{s(je,J()||A()||e(lt)||M()(De.EditAllEvents))}),$(()=>(e(je),M(),e(at),e(bt)),()=>{s(Ze,e(je)||M()(De.CreateEvents)||e(at)||e(bt))}),$(()=>(M(),De),()=>{s(X,M()(De.DeleteEvents))}),$(()=>e(q),()=>{s(G,e(q).length>0)}),$(()=>(w(),e(q)),()=>{s(we,w().length>e(q).length)}),Kt(),ft();var be=Zr(),P=Ie(be);Vt(P,{get title(){return e(Dt)},get id(){return oe()},children:(u,f)=>{da(u,{get eventItem(){return e(St)},get drawerId(){return oe()},name:"past-event-item-form",get canDelete(){return e(X)}})},$$slots:{default:!0}});var Me=o(P,2);{var Ye=u=>{var f=Ut(),p=Ie(f);{var E=me=>{var Te=Ut(),Pe=Ie(Te);{var x=ie=>{var _=Fr(),ge=o(a(_));t(_),C(()=>R(ge,` Show Past Events (${w(),r(()=>w().length)??""})`)),Y("click",_,()=>s(nt,!0)),i(ie,_)},h=ie=>{var _=Xr(),ge=a(_),ye=a(ge),Re=o(a(ye),2),Je=a(Re);{var He=Le=>{var Qe=Lr(),ct=a(Qe);{var Ct=he=>{var ze=ca("Deleting…");i(he,ze)},Lt=he=>{var ze=ca();C(()=>R(ze,`Delete All (${e(le)??""})`)),i(he,ze)};m(ct,he=>{e(Ge)?he(Ct):he(Lt,!1)})}t(Qe),C(()=>Qe.disabled=e(Ge)),Y("click",Qe,I),i(Le,Qe)};m(Je,Le=>{J()&&e(G)&&Le(He)})}var wt=o(Je,2);t(Re),t(ye),t(ge);var Ft=o(ge,2);{var _a=Le=>{var Qe=Kr(),ct=Ie(Qe);ot(ct,5,()=>(e(ce),r(()=>Object.entries(e(ce)))),([he,ze])=>he,(he,ze)=>{var xt=nr(()=>or(e(ze),2));let vt=()=>e(xt)[1];var kt=jr(),Et=Ie(kt),zt=a(Et,!0);t(Et);var tt=o(Et,2);ot(tt,1,()=>(vt(),r(()=>vt().weeks)),Be=>Be.key,(Be,ue)=>{const Mt=Ae(()=>(D(ve),e(ue),r(()=>ve(e(ue).key)))),Tt=Ae(()=>(D(la),D(e(Mt)),r(()=>la(e(Mt),{weekStartsOn:1})))),Zt=Ae(()=>(D(Ra),D(e(Tt)),r(()=>Ra(e(Tt))))),Gt=Ae(()=>(D(Fa),D(e(Tt)),D(e(Zt)),r(()=>Fa(e(Tt),e(Zt),{weekStartsOn:1})+1))),dt=Ae(()=>(e(H),e(ue),r(()=>e(H)(e(ue).key)))),$t=Ae(()=>(e(ue),r(()=>e(ue).days.reduce((Nt,ta)=>Nt+ta.events.length,0))));var ea=qr(),Bt=Ie(ea),At=a(Bt);let O;var B=a(At),Ne=a(B),ut=o(Ne,2),qa=a(ut);t(ut),t(B);var pa=o(B,2);let Oa;var ja=a(pa,!0);t(pa),t(At),t(Bt);var Ha=o(Bt,2);{var Qa=Nt=>{var ta=Ut(),Va=Ie(ta);{var Ka=Pt=>{var aa=Ut(),Xa=Ie(aa);ot(Xa,1,()=>(e(ue),r(()=>e(ue).days)),fa=>fa.key,(fa,Rt)=>{var ba=Nr(),Ca=a(ba),ma=a(Ca),ga=a(ma),Ja=a(ga,!0);t(ga);var Ma=o(ga,2),Za=a(Ma,!0);t(Ma),t(ma);var Ta=o(ma,2);ot(Ta,5,()=>(e(Rt),r(()=>e(Rt).events)),Wt=>Wt.id??`${Wt.start_time}-${Wt.meta_data?.recurring_instance_index??0}`,(Wt,ra)=>{var ya=Br(),ha=a(ya),Ga=a(ha);hr(Ga,{get item(){return e(ra)},showDate:!1,get searchQuery(){return K()}}),t(ha);var er=o(ha,2);{var tr=wa=>{var xa=zr(),ka=a(xa);t(xa),C(()=>{qe(ka,"data-bs-target",`#${oe()??""}`),qe(ka,"aria-controls",oe())}),Y("click",ka,()=>gt(e(ra))),i(wa,xa)};m(er,wa=>{e(ra),r(()=>st(e(ra)))&&wa(tr)})}t(ya),i(Wt,ya)}),t(Ta),t(Ca),t(ba),C(()=>{R(Ja,(e(Rt),r(()=>e(Rt).displayDay))),R(Za,(e(Rt),r(()=>e(Rt).displayDate)))}),i(fa,ba)}),i(Pt,aa)},Ya=Pt=>{var aa=Wr();i(Pt,aa)};m(Va,Pt=>{e(ue),r(()=>e(ue).days.length)?Pt(Ka):Pt(Ya,!1)})}i(Nt,ta)};m(Ha,Nt=>{e(dt)&&Nt(Qa)})}C(()=>{O=it(At,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,O,{"text-muted":e($t)===0}),qe(At,"title",e(dt)?"Click to collapse week":"Click to expand week"),it(Ne,1,`bi ${e(dt)?"bi-chevron-up":"bi-chevron-down"}`),R(qa,`Week ${e(Gt)??""} [${e($t)??""} Event${e($t)===1?"":"s"}]`),Oa=it(pa,1,"",null,Oa,{"opacity-50":e($t)===0}),R(ja,(e(ue),r(()=>e(ue).label)))}),Y("click",At,()=>It(e(ue).key)),i(Be,ea)}),C(()=>R(zt,(vt(),r(()=>vt().label)))),i(he,kt)}),t(ct);var Ct=o(ct,2);{var Lt=he=>{var ze=Vr(),xt=a(ze),vt=a(xt);t(xt);var kt=o(xt,2);{var Et=tt=>{var Be=Hr();Y("click",Be,g),i(tt,Be)},zt=tt=>{var Be=Qr(),ue=a(Be),Mt=o(ue,2);t(Be),Y("click",ue,n),Y("click",Mt,d),i(tt,Be)};m(kt,tt=>{e(We)?tt(Et):tt(zt,!1)})}t(ze),C(()=>R(vt,`Showing ${e(q),r(()=>e(q)?.length??0)??""} of ${w(),r(()=>w()?.length??0)??""}`)),i(he,ze)};m(Ct,he=>{(e(we)||e(We))&&he(Lt)})}i(Le,Qe)},Jt=Le=>{var Qe=Yr();i(Le,Qe)};m(Ft,Le=>{e(k),r(()=>e(k).length)?Le(_a):Le(Jt,!1)})}t(_),Y("click",wt,()=>s(nt,!1)),i(ie,_)};m(Pe,ie=>{e(nt)?ie(h,!1):ie(x)})}i(me,Te)},Ee=me=>{var Te=Jr(),Pe=a(Te);Na(Pe,{}),t(Te),i(me,Te)};m(p,me=>{Z()?me(E):me(Ee,!1)})}i(u,f)};m(Me,u=>{J()&&u(Ye)})}var Xe=o(Me,2);{var et=u=>{Ur(u,{get cutoffDate(){return e(c)},callback:re})};m(Xe,u=>{e(mt)&&u(et)})}var Ot=o(Xe,2);{var ht=u=>{Pr(u,{get deleted(){return e(z),r(()=>e(z).deleted)},get skipped(){return e(z),r(()=>e(z).skipped)},callback:Ke})};m(Ot,u=>{e(y)&&u(ht)})}i(_e,be),pt(),ae()}var es=l("<span> </span>"),ts=l('<span class="badge bg-secondary">All Day</span>'),as=l('<span class="result-time svelte-1xkw8oa"> </span>'),rs=l('<span class="result-date svelte-1xkw8oa"> </span> <!>',1),ss=l('<span class="result-location svelte-1xkw8oa"><i class="bi bi-geo-alt"></i> <!></span>'),ns=l('<div class="result-thumbnail-container svelte-1xkw8oa"><img class="result-thumbnail svelte-1xkw8oa"/></div>'),os=l('<div class="result-actions svelte-1xkw8oa"><button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i></button></div>'),is=l('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="result-details-button svelte-1xkw8oa"><div class="result-header svelte-1xkw8oa"><div class="result-title svelte-1xkw8oa"><!></div> <span class="result-type-badge badge bg-secondary-subtle text-secondary-emphasis svelte-1xkw8oa"> </span></div> <div class="result-meta svelte-1xkw8oa"><!> <!> <!></div></button> <!> <!></li>'),ls=l('<div class="unified-search-results svelte-1xkw8oa"><div class="search-results-header svelte-1xkw8oa"><h6 class="search-results-title svelte-1xkw8oa"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),cs=l('<div class="no-search-results svelte-1xkw8oa"> </div>'),vs=l("<!> <!> <!>",1);function ds(_e,U){_t(U,!1);const F=()=>te(H,"$currentUser",K),w=()=>te(ce,"$userOrganizations",K),N=()=>te(q,"$currentUserHasPermission",K),se=()=>te(k,"$currentUserIsRoot",K),M=()=>te(le,"$currentUserIsAdmin",K),J=()=>te(X,"$calendarEvents",K),A=()=>te(we,"$searchQuery",K),Z=()=>te(G,"$announcements",K),[K,S]=Yt(),ae=v(),W=v(),{stores:{currentUser:H,currentUserHasPermission:q,currentUserIsAdmin:le,currentUserIsRoot:k,userOrganizations:ce}}=ua(),{stores:{calendarEvents:X,announcements:G,searchQuery:we}}=Xt(),Ue=Qt(),L=Qt();let T=v(!1),Q=v(),ne=v(!1),ee=v(!1),xe=v(new Set),ke=v(""),Oe=v({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),Se=v({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),j=v(!1);const oe=c=>Ba(c,{currentUserId:e(Q),isPrivileged:e(T),canEditOwnOrgEvents:e(ee),userOrganizations:e(xe)}),Ze=c=>c.startsWith("image/"),je=async c=>{const y=c.itemType==="announcement"?"announcement":"calendar_event";if(s(ke,`${c.itemType==="announcement"?"Announcement":"Event"} Form`),c?.meta_data?.recurring_instance&&c?.meta_data?.recurring_parent_id){const{getCalendarEvent:z}=await Da(async()=>{const{getCalendarEvent:pe}=await import("./D84_1tz-.js").then(fe=>fe.y);return{getCalendarEvent:pe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),V=await z(c.meta_data.recurring_parent_id);if(V){s(Oe,{...V,organization:V?.meta_data?.organization??"",event_type:y,start_time:c.start_time,end_time:c.end_time,meta_data:{...V.meta_data,recurring_instance:!0,recurring_parent_id:c.meta_data.recurring_parent_id,recurring_instance_index:c.meta_data.recurring_instance_index}});return}}s(Oe,{...c,organization:c?.meta_data?.organization??"",event_type:y})},de=async c=>{if(c?.meta_data?.recurring_instance&&c?.meta_data?.recurring_parent_id){const{getCalendarEvent:z}=await Da(async()=>{const{getCalendarEvent:pe}=await import("./D84_1tz-.js").then(fe=>fe.y);return{getCalendarEvent:pe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),V=await z(c.meta_data.recurring_parent_id);V?s(Se,{...V,start_time:c.start_time,end_time:c.end_time,meta_data:{...V.meta_data,recurring_instance:!0,recurring_parent_id:c.meta_data.recurring_parent_id,recurring_instance_index:c.meta_data.recurring_instance_index}}):s(Se,c)}else s(Se,c);const y=document.getElementById(L);y&&new window.bootstrap.Offcanvas(y).show()},lt=async c=>{await je(c);const y=document.getElementById(Ue);y&&new window.bootstrap.Offcanvas(y).show()},bt=async()=>{const c=document.getElementById(L);if(c){const y=window.bootstrap.Offcanvas.getInstance(c);y&&y.hide()}await je(e(Se)),setTimeout(()=>{const y=document.getElementById(Ue);y&&new window.bootstrap.Offcanvas(y).show()},300)};$(()=>F(),()=>{s(Q,F()?.id)}),$(()=>w(),()=>{s(xe,w())}),$(()=>(e(xe),va),()=>{s(ne,e(xe).has(va.Bishopric))}),$(()=>(N(),De),()=>{s(ee,N()(De.EditOwnOrgEvents))}),$(()=>(se(),M(),e(ne),N(),De),()=>{s(T,se()||M()||e(ne)||N()(De.EditAllEvents))}),$(()=>(N(),De),()=>{s(j,N()(De.DeleteEvents))}),$(()=>(J(),ve),()=>{s(ae,(J()??[]).filter(c=>c.start_time?ve(c.start_time)>=new Date:!1))}),$(()=>(A(),e(ae),Z(),ve),()=>{s(W,A()?[...e(ae).filter(c=>{const y=A().toLowerCase(),z=(c.title||"").toLowerCase(),V=(c.description||"").replace(/<[^>]*>/g,"").toLowerCase(),pe=(c.location||"").toLowerCase();return z.includes(y)||V.includes(y)||pe.includes(y)}).map(c=>({...c,itemType:"event"})),...(Z()??[]).filter(c=>{const y=A().toLowerCase(),z=(c.title||"").toLowerCase(),V=(c.description||"").replace(/<[^>]*>/g,"").toLowerCase(),pe=(c.location||"").toLowerCase();return z.includes(y)||V.includes(y)||pe.includes(y)}).map(c=>({...c,itemType:"announcement"}))].sort((c,y)=>{const z=c.start_time?ve(c.start_time).getTime():0,V=y.start_time?ve(y.start_time).getTime():0;return z===0&&V!==0?-1:z!==0&&V===0?1:z-V}):[])}),Kt(),ft();var at=vs(),rt=Ie(at);Vt(rt,{get title(){return e(ke)},get id(){return Ue},children:(c,y)=>{da(c,{get eventItem(){return e(Oe)},get drawerId(){return Ue},name:"unified-search-form",get canDelete(){return e(j)}})},$$slots:{default:!0}});var Ge=o(rt,2);Vt(Ge,{title:"Details",get id(){return L},children:(c,y)=>{{let z=Ae(()=>(e(Se),r(()=>oe(e(Se)))));fr(c,{get event(){return e(Se)},get canEdit(){return e(z)},onEdit:bt})}},$$slots:{default:!0}});var Dt=o(Ge,2);{var St=c=>{var y=ls(),z=a(y),V=a(z),pe=a(V);t(V),t(z);var fe=o(z,2);ot(fe,5,()=>e(W),We=>We.id??We.start_time??Math.random(),(We,b)=>{const Ce=Ae(()=>(e(b),r(()=>e(b).attachments?.find(f=>Ze(f.type))))),Fe=Ae(()=>(D(Ht),e(b),r(()=>Ht(e(b)?.meta_data?.organization??"")))),It=Ae(()=>(e(b),r(()=>e(b).itemType==="event")));var gt=is(),yt=a(gt),st=o(yt,2),nt=a(st),n=a(nt),d=a(n);Pa(d,()=>(D(sa),e(b),A(),r(()=>sa(e(b).title,A())))),t(n);var g=o(n,2),I=a(g,!0);t(g),t(nt);var re=o(nt,2),Ke=a(re);{var be=f=>{var p=es(),E=a(p,!0);t(p),C(()=>{it(p,1,`badge rounded-pill bg-color-${D(e(Fe)),r(()=>e(Fe).color_number)??""}`,"svelte-1xkw8oa"),R(E,(D(e(Fe)),r(()=>e(Fe).label)))}),i(f,p)};m(Ke,f=>{D(e(Fe)),r(()=>e(Fe)?.label)&&f(be)})}var P=o(Ke,2);{var Me=f=>{var p=rs(),E=Ie(p),Ee=a(E,!0);t(E);var me=o(E,2);{var Te=x=>{var h=ts();i(x,h)},Pe=x=>{var h=as(),ie=a(h,!0);t(h),C(_=>R(ie,_),[()=>(D($e),D(ve),e(b),r(()=>$e(ve(e(b).start_time),"h:mm a")))]),i(x,h)};m(me,x=>{e(b),r(()=>e(b).is_all_day)?x(Te):x(Pe,!1)})}C(x=>R(Ee,x),[()=>(D($e),D(ve),e(b),r(()=>$e(ve(e(b).start_time),"MMM d, yyyy")))]),i(f,p)};m(P,f=>{e(b),r(()=>e(b).start_time)&&f(Me)})}var Ye=o(P,2);{var Xe=f=>{var p=ss(),E=o(a(p),2);Pa(E,()=>(D(sa),e(b),A(),r(()=>sa(e(b).location,A())))),t(p),i(f,p)};m(Ye,f=>{e(b),r(()=>e(b).location)&&f(Xe)})}t(re),t(st);var et=o(st,2);{var Ot=f=>{var p=ns(),E=a(p);t(p),C(()=>{qe(E,"src",(D(e(Ce)),r(()=>e(Ce).url))),qe(E,"alt",(D(e(Ce)),r(()=>e(Ce).name)))}),i(f,p)};m(et,f=>{e(Ce)&&f(Ot)})}var ht=o(et,2);{var u=f=>{var p=os(),E=a(p);t(p),C(()=>qe(E,"title",`Edit ${e(It)?"event":"announcement"}`)),Y("click",E,Wa(()=>lt(e(b)))),i(f,p)};m(ht,f=>{e(b),r(()=>oe(e(b)))&&f(u)})}t(gt),C(()=>{it(yt,1,`result-color-indicator bg-color-${D(e(Fe)),r(()=>e(Fe)?.color_number??0)??""}`,"svelte-1xkw8oa"),R(I,e(It)?"Event":"Announcement")}),Y("click",st,()=>de(e(b))),i(We,gt)}),t(fe),t(y),C(()=>R(pe,`${e(W),r(()=>e(W).length)??""} result${e(W),r(()=>e(W).length===1?"":"s")??""} matching "${A()??""}"`)),i(c,y)},mt=c=>{var y=Ut(),z=Ie(y);{var V=pe=>{var fe=cs(),We=a(fe);t(fe),C(()=>R(We,`No results match your search for "${A()??""}"`)),i(pe,fe)};m(z,pe=>{A()&&pe(V)},!0)}i(c,y)};m(Dt,c=>{A(),e(W),r(()=>A()&&e(W).length>0)?c(St):c(mt,!1)})}i(_e,at),pt(),S()}var us=l("<!> <!> <!>",1),_s=l('<div class="d-flex flex-column gap-4"><!> <!></div>');function La(_e,U){_t(U,!1);const F=()=>te(se,"$searchQuery",w),[w,N]=Yt(),{stores:{searchQuery:se}}=Xt();let M=Ve(U,"showAnnouncements",8,!0),J=Ve(U,"showSearch",8,!0);ft();var A=_s(),Z=a(A);{var K=H=>{Sr(H,{})};m(Z,H=>{J()&&H(K)})}var S=o(Z,2);{var ae=H=>{ds(H,{})},W=H=>{var q=us(),le=Ie(q);{var k=G=>{mr(G,{})};m(le,G=>{M()&&G(k)})}var ce=o(le,2);br(ce,{});var X=o(ce,2);Gr(X,{}),i(H,q)};m(S,H=>{J()&&F()?H(ae):H(W,!1)})}t(A),i(_e,A),pt(),N()}var ps=l('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),fs=l('<i class="bi bi-arrow-clockwise"></i>'),bs=l('<i class="bi bi-arrow-clockwise me-1"></i>Refresh',1),ms=l('<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"> </span>'),gs=l('<button type="button" role="tab"> <!></button>'),ys=l("<option> </option>"),hs=l('<div class="py-5 text-center text-muted"><!></div>'),ws=l('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),xs=l("<span> </span>"),ks=l('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),Es=l('<span><i class="bi bi-geo-alt"></i> </span>'),$s=l('<span><i class="bi bi-arrow-repeat"></i> </span>'),As=l('<span><i class="bi bi-calendar3"></i> </span>'),Ds=l('<span class="text-muted small"> </span>'),Ss=l('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-primary" type="button"><i class="bi bi-pencil-square"></i></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),Is=l('<div class="d-flex flex-column gap-3"></div>'),Os=l('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="d-flex flex-column gap-3"><div class="submissions-action-buttons svelte-9fakr"><button class="btn btn-success btn-sm" type="button" data-bs-toggle="offcanvas"><i class="bi bi-calendar-plus me-1"></i>Event</button> <button class="btn btn-success btn-sm" type="button"><i class="bi bi-file-earmark-arrow-up me-1"></i>Import</button> <button class="btn btn-success btn-sm" type="button" data-bs-toggle="offcanvas"><i class="bi bi-megaphone me-1"></i>Announce</button> <button class="btn btn-primary btn-sm"><!></button></div> <div class="submissions-status-tabs nav nav-tabs gap-4 svelte-9fakr" role="tablist"></div></div> <div class="d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3"><div class="input-group input-group-sm my-submissions-search svelte-9fakr"><input class="form-control svelte-9fakr" type="search" placeholder="Search title, category, or location"/></div> <div class="type-filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div> <!></div></div>'),Cs=l('<div class="text-muted">Select a submission to edit.</div>'),Ms=l("<!> <!> <!> <!>",1);function Ts(_e,U){_t(U,!1);const F=()=>te(k,"$currentUserStore",M),w=()=>te(ce,"$currentUserHasPermission",M),N=()=>te(q,"$dbData",M),se=()=>te(H,"$ready",M),[M,J]=Yt(),A=v(),Z=v(),K=v(),S=v(),ae=v(),W=v(),{stores:{ready:H,dbData:q},actions:{reload:le}}=Xt(),{stores:{currentUser:k,currentUserHasPermission:ce}}=ua();let X=v({...Ea});const G=`create-event-form-${Qt()}`;let we=v(!1);const Ue=()=>{s(we,!1)},L=async()=>{s(we,!1),await le()};let T=v(!1),Q=v([]),ne=v([]),ee=v(null);const xe=Qt();let ke=null;const Oe={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},Se={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},j={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},oe=[{value:"pending",label:j.pending},{value:"needs_review",label:j.needs_review},{value:"approved",label:j.approved},{value:"published",label:j.published}],Ze=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}],je=()=>({search:"",typeFilter:"all"});let de=v({pending:je(),needs_review:je(),approved:je(),published:je()});Sa(async()=>{s(T,!0),await le(),s(T,!1),typeof window<"u"&&(ke=(await Da(()=>import("./DO0djbQe.js").then(d=>d.o),__vite__mapDeps([27,28]),import.meta.url)).default)});const lt=n=>{const d=n.meta_data?.submitted_at??n.created_at;if(!d)return 0;try{return ve(d).getTime()}catch(g){return console.warn("Failed to parse submission timestamp",g),0}},bt=n=>{const d=n.meta_data?.submitted_at??n.created_at;if(!d)return"—";try{return $e(ve(d),"MMM d, yyyy 'at' h:mm a")}catch(g){return console.warn("Failed to format submission timestamp",g),"—"}},at=n=>{if(!n.start_time)return"—";try{return $e(ve(n.start_time),"MMM d, yyyy 'at' h:mm a")}catch(d){return console.warn("Failed to format event date",d),"—"}},rt=n=>n.replace(/<[^>]*>/g,""),Ge=(n,d)=>n.length<=d?n:n.substring(0,d).trimEnd()+"…",Dt=n=>n.description?Ge(rt(n.description).trim(),120):"",St=n=>{try{const g=jt.fromString(n).origOptions,I=g.interval||1,re=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ke=["","1st","2nd","3rd","4th","5th"];if(g.freq===jt.DAILY)return I===1?"Repeats daily":`Repeats every ${I} days`;if(g.freq===jt.WEEKLY){if(g.byweekday){const P=(Array.isArray(g.byweekday)?g.byweekday:[g.byweekday]).map(Me=>{const Ye=typeof Me=="number"?Me:Me.weekday,Xe=Ye===6?0:Ye+1;return re[Xe]});return I===1?P.length===1?`Repeats every ${P[0]}`:`Repeats on ${P.join(", ")}`:`Repeats every ${I} weeks on ${P.join(", ")}`}return I===1?"Repeats weekly":`Repeats every ${I} weeks`}if(g.freq===jt.MONTHLY){if(g.byweekday){const P=(Array.isArray(g.byweekday)?g.byweekday:[g.byweekday])[0];if(P&&typeof P=="object"&&"n"in P&&"weekday"in P){const Me=P.weekday,Ye=Me===6?0:Me+1,Xe=P.n,et=Ke[Xe]||`${Xe}th`;return I===1?`Repeats on the ${et} ${re[Ye]} of the month`:`Repeats on the ${et} ${re[Ye]} every ${I} months`}}if(g.bymonthday){const be=Array.isArray(g.bymonthday)?g.bymonthday[0]:g.bymonthday,P=be===1?"st":be===2?"nd":be===3?"rd":"th";return I===1?`Repeats on the ${be}${P} of the month`:`Repeats on the ${be}${P} every ${I} months`}return I===1?"Repeats monthly":`Repeats every ${I} months`}return g.freq===jt.YEARLY?I===1?"Repeats yearly":`Repeats every ${I} years`:"Repeats"}catch{return"Repeats"}},mt=(n,d)=>{const g=d.trim().toLowerCase();if(!g)return!0;const I=n.meta_data?.organization?Ht(n.meta_data.organization)?.label??"":"";return[n.title??"",n.description??"",n.location??"",I??""].join(" ").toLowerCase().includes(g)},c=(n,d)=>d==="all"?!0:d==="events"?n.event_type==="calendar_event":n.event_type==="announcement";function y(n,d){s(de,{...e(de),[n]:{...e(de)[n],...d}})}const z=n=>{const d=new Set,g=[];for(const I of n){const re=I.meta_data?.recurring_parent_id;if(I.meta_data?.recurring_instance&&re!=null){if(d.has(re))continue;d.add(re)}g.push(I)}return g},V=n=>n.meta_data?.recurring_parent_id!=null?`recurring-${n.meta_data.recurring_parent_id}`:`id-${n.id}`,pe=n=>{s(ee,n);const d=document.getElementById(xe);d&&ke&&ke.getOrCreateInstance(d).show()},fe=(n,d)=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),pe(d))},We=async()=>{s(T,!0),await le(),s(T,!1)};let b=v("pending");$(()=>F(),()=>{s(A,F())}),$(()=>(w(),De),()=>{s(Z,w()(De.DeleteEvents)||w()(De.DeleteOwnEvents))}),$(()=>(N(),e(A)),()=>{s(Q,z((N()??[]).filter(n=>{const d=n.meta_data?.submitted_by_user_id;return d&&e(A)?.id&&d===e(A).id}).sort((n,d)=>lt(d)-lt(n))))}),$(()=>e(b),()=>{s(K,`type-filter-select-submissions-${e(b)}`)}),$(()=>(e(Q),na),()=>{s(S,oe.reduce((n,d)=>(n[d.value]=e(Q).filter(g=>na(g)===d.value),n),{}))}),$(()=>(e(de),e(S)),()=>{s(ae,oe.reduce((n,d)=>{const g=e(de)[d.value],I=(e(S)[d.value]??[]).filter(re=>c(re,g.typeFilter));return n[d.value]=I.filter(re=>mt(re,g.search)),n},{}))}),$(()=>(e(ae),e(b)),()=>{s(ne,e(ae)[e(b)]??[])}),$(()=>(e(ee),e(Q)),()=>{e(ee)&&!e(Q).some(n=>V(n)===V(e(ee)))&&s(ee,null)}),$(()=>e(ee),()=>{s(W,e(ee)?{...e(ee),id:e(ee).id??e(ee).meta_data?.recurring_parent_id,organization:e(ee).meta_data?.organization??""}:null)}),Kt(),ft();var Ce=Ms(),Fe=Ie(Ce);{var It=n=>{var d=ps(),g=a(d);Na(g,{}),t(d),i(n,d)},gt=n=>{var d=Os(),g=a(d),I=a(g),re=a(I),Ke=o(re,2),be=o(Ke,2),P=o(be,2),Me=a(P);{var Ye=x=>{var h=fs();i(x,h)},Xe=x=>{var h=bs();Ia(),i(x,h)};m(Me,x=>{e(T)?x(Ye):x(Xe,!1)})}t(P),t(I);var et=o(I,2);ot(et,5,()=>oe,$a,(x,h)=>{const ie=Ae(()=>(e(S),e(h),r(()=>(e(S)[e(h).value]??[]).length)));var _=gs(),ge=a(_),ye=o(ge);{var Re=Je=>{var He=ms(),wt=a(He,!0);t(He),C(()=>R(wt,e(ie))),i(Je,He)};m(ye,Je=>{e(ie)>0&&Je(Re)})}t(_),C(()=>{it(_,1,(e(b),e(h),r(()=>`nav-link position-relative ${e(b)===e(h).value?"active":""}`)),"svelte-9fakr"),qe(_,"aria-selected",(e(b),e(h),r(()=>e(b)===e(h).value))),R(ge,`${e(h),r(()=>e(h).label)??""} `)}),Y("click",_,()=>s(b,e(h).value)),i(x,_)}),t(et),t(g);var Ot=o(g,2),ht=a(Ot),u=a(ht),f=a(u);za(f),t(u);var p=o(u,2),E=a(p);ot(E,5,()=>Ze,$a,(x,h)=>{var ie=ys(),_=a(ie,!0);t(ie);var ge={};C(()=>{R(_,(e(h),r(()=>e(h).label))),ge!==(ge=(e(h),r(()=>e(h).value)))&&(ie.value=(ie.__value=(e(h),r(()=>e(h).value)))??"")}),i(x,ie)}),t(E);var Ee;lr(E),t(p),t(ht);var me=o(ht,2);{var Te=x=>{var h=hs(),ie=a(h);{var _=ye=>{var Re=ca("You haven't submitted any events or announcements yet.");i(ye,Re)},ge=ye=>{var Re=ca();C(Je=>R(Re,`No ${Je??""} submissions match your current filters.`),[()=>(e(b),r(()=>j[e(b)].toLowerCase()))]),i(ye,Re)};m(ie,ye=>{e(Q),r(()=>e(Q).length===0)?ye(_):ye(ge,!1)})}t(h),i(x,h)},Pe=x=>{var h=Is();ot(h,5,()=>e(ne),ie=>V(ie),(ie,_)=>{const ge=Ae(()=>(D(na),e(_),r(()=>na(e(_))))),ye=Ae(()=>(D(e(ge)),r(()=>Se[e(ge)]))),Re=Ae(()=>(e(_),D(Ht),r(()=>e(_).meta_data?.organization?Ht(e(_).meta_data.organization):null))),Je=Ae(()=>(e(_),r(()=>Dt(e(_)))));var He=Ss(),wt=a(He),Ft=a(wt),_a=a(Ft,!0);t(Ft);var Jt=o(Ft,2),Le=a(Jt),Qe=a(Le,!0);t(Le);var ct=o(Le,2);t(Jt),t(wt);var Ct=o(wt,2);{var Lt=O=>{var B=ws(),Ne=a(B,!0);t(B),C(()=>R(Ne,e(Je))),i(O,B)};m(Ct,O=>{e(Je)&&O(Lt)})}var he=o(Ct,2),ze=a(he);{var xt=O=>{var B=xs(),Ne=a(B,!0);t(B),C(()=>{it(B,1,`badge rounded-pill bg-color-${D(e(Re)),r(()=>e(Re).color_number)??""}`,"svelte-9fakr"),R(Ne,(D(e(Re)),r(()=>e(Re).label)))}),i(O,B)},vt=O=>{var B=ks();i(O,B)};m(ze,O=>{e(Re)?O(xt):O(vt,!1)})}var kt=o(ze,2);{var Et=O=>{var B=Es(),Ne=o(a(B));t(B),C(()=>R(Ne,` ${e(_),r(()=>e(_).location)??""}`)),i(O,B)};m(kt,O=>{e(_),r(()=>e(_).location)&&O(Et)})}var zt=o(kt,2);{var tt=O=>{var B=$s(),Ne=o(a(B));t(B),C(ut=>R(Ne,` ${ut??""}`),[()=>(e(_),r(()=>St(e(_).recurrence_rule)))]),i(O,B)};m(zt,O=>{e(_),r(()=>e(_).recurrence_rule)&&O(tt)})}t(he);var Be=o(he,2),ue=a(Be),Mt=o(a(ue));t(ue);var Tt=o(ue,2);{var Zt=O=>{var B=As(),Ne=o(a(B));t(B),C(ut=>R(Ne,` Event ${ut??""}`),[()=>(e(_),r(()=>at(e(_))))]),i(O,B)};m(Tt,O=>{e(_),r(()=>e(_).event_type==="calendar_event")&&O(Zt)})}t(Be);var Gt=o(Be,2),dt=a(Gt),$t=a(dt),ea=o($t,1,!0);t(dt);var Bt=o(dt,2);{var At=O=>{var B=Ds(),Ne=a(B);t(B),C(ut=>R(Ne,`Approvals: ${ut??""} of 3`),[()=>(D(oa),e(_),r(()=>oa(e(_))))]),i(O,B)};m(Bt,O=>{D(oa),e(_),r(()=>oa(e(_))>0)&&O(At)})}t(Gt),t(He),C(O=>{dr(He,`border-left: 4px solid ${D(e(ge)),r(()=>Oe[e(ge)])??""}`),R(_a,(e(_),r(()=>e(_).title))),R(Qe,(e(_),r(()=>e(_).event_type==="calendar_event"?"Event":"Announcement"))),qe(ct,"aria-label",(e(_),r(()=>`Edit ${e(_).title}`))),R(Mt,` Submitted ${O??""}`),it(dt,1,(D(e(ye)),r(()=>`badge ${e(ye).class}`)),"svelte-9fakr"),it($t,1,(D(e(ye)),r(()=>`bi ${e(ye).icon} me-1`)),"svelte-9fakr"),R(ea,(D(e(ye)),r(()=>e(ye).text)))},[()=>(e(_),r(()=>bt(e(_))))]),Y("click",ct,Wa(()=>pe(e(_)))),Y("click",He,()=>pe(e(_))),Y("keydown",He,O=>fe(O,e(_))),i(ie,He)}),t(h),i(x,h)};m(me,x=>{e(ne),r(()=>e(ne).length===0)?x(Te):x(Pe,!1)})}t(Ot),t(d),C(()=>{qe(re,"data-bs-target",`#${G}`),qe(re,"aria-controls",G),qe(be,"data-bs-target",`#${G}`),qe(be,"aria-controls",G),P.disabled=e(T),cr(f,(e(de),e(b),r(()=>e(de)[e(b)].search))),qe(E,"id",e(K)),Ee!==(Ee=(e(de),e(b),r(()=>e(de)[e(b)].typeFilter)))&&(E.value=(E.__value=(e(de),e(b),r(()=>e(de)[e(b)].typeFilter)))??"",vr(E,(e(de),e(b),r(()=>e(de)[e(b)].typeFilter))))}),Y("click",re,()=>{s(X,{...Ea,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})}),Y("click",Ke,()=>s(we,!0)),Y("click",be,()=>{s(X,{...Ea,event_type:"announcement"})}),Y("click",P,We),Y("input",f,x=>y(e(b),{search:x.currentTarget.value})),Y("change",E,x=>y(e(b),{typeFilter:x.currentTarget.value})),i(n,d)};m(Fe,n=>{se()?n(gt,!1):n(It)})}var yt=o(Fe,2);{let n=Ae(()=>(e(ee),r(()=>e(ee)?`Edit: ${e(ee).title}`:"Submission Details")));Vt(yt,{get id(){return xe},get title(){return e(n)},children:(d,g)=>{var I=Ut(),re=Ie(I);{var Ke=P=>{da(P,{get eventItem(){return e(W)},get drawerId(){return xe},name:"my-submission-form",get canDelete(){return e(Z)},canCreate:!1})},be=P=>{var Me=Cs();i(P,Me)};m(re,P=>{e(W)?P(Ke):P(be,!1)})}i(d,I)},$$slots:{default:!0}})}var st=o(yt,2);{let n=Ae(()=>(e(X),r(()=>e(X).event_type==="announcement"?"Create Announcement":"Create Event")));Vt(st,{get id(){return G},get title(){return e(n)},children:(d,g)=>{da(d,{get eventItem(){return e(X)},get drawerId(){return G},name:"create-form",canCreate:!0})},$$slots:{default:!0}})}var nt=o(st,2);gr(nt,{onClose:Ue,onComplete:L,get isOpen(){return e(we)},set isOpen(n){s(we,n)},$$legacy:!0}),i(_e,Ce),pt(),J()}var Ps=l('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),Rs=l('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),Us=l('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),Fs=l('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),Ls=l('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1),zs=l('<div class="calendar-section svelte-1oi0f59"><!></div>');function cn(_e,U){_t(U,!1);const F=v(),w=v(),N=v(),{stores:{currentUserHasPermission:se,authenticated:M}}=ua();let J=Ve(U,"showApprovals",8,!0),A=Ve(U,"showMySubmissions",8,!0),Z=Ve(U,"showAnnouncements",8,!0),K=Ve(U,"showSearch",8,!0),S=v(!1),ae=v(!1);Sa(()=>{const k=se.subscribe(X=>{const G=J()&&X(De.ManageWardBusiness);s(S,G)}),ce=M.subscribe(X=>{s(ae,X)});return()=>{k(),ce()}}),$(()=>(D(J()),e(S)),()=>{s(F,J()&&e(S))}),$(()=>(D(A()),e(ae)),()=>{s(w,A()&&e(ae))}),$(()=>(e(F),e(w)),()=>{s(N,e(F)||e(w))}),Kt(),ft();var W=zs(),H=a(W);{var q=k=>{var ce=Ls(),X=Ie(ce),G=a(X),we=o(a(G),2);{var Ue=j=>{var oe=Ps();i(j,oe)};m(we,j=>{e(w)&&j(Ue)})}var L=o(we,2);{var T=j=>{var oe=Rs();i(j,oe)};m(L,j=>{e(F)&&j(T)})}t(G),t(X);var Q=o(X,2),ne=a(Q),ee=a(ne);La(ee,{get showAnnouncements(){return Z()},get showSearch(){return K()}}),t(ne);var xe=o(ne,2);{var ke=j=>{var oe=Us(),Ze=a(oe);Ts(Ze,{}),t(oe),i(j,oe)};m(xe,j=>{e(w)&&j(ke)})}var Oe=o(xe,2);{var Se=j=>{var oe=Fs(),Ze=a(oe);wr(Ze,{}),t(oe),i(j,oe)};m(Oe,j=>{e(F)&&j(Se)})}t(Q),i(k,ce)},le=k=>{La(k,{get showAnnouncements(){return Z()},get showSearch(){return K()}})};m(H,k=>{e(N)?k(q):k(le,!1)})}t(W),i(_e,W),pt()}export{cn as C};
