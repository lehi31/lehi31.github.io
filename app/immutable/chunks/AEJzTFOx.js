const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BbwhhYVZ.js","./SWWSvUpQ.js","./DIeogL5L.js","./D8ekX_8E.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./WW5OsAH7.js","./CU3XCoqN.js","./YJAcq9su.js","./CopVGF8H.js","./5a-TXARV.js","./bTbH5yGl.js","./BUApaBEI.js","./Bgyk9asy.js","./DcMM934u.js","../assets/Spinner.DTjfhZ6-.css","./8x2zR2yh.js","./mnkQx8ai.js","./CvxMDV_e.js","./Cc3l00Qu.js","./DnigS3JR.js","./e-9Zuv9U.js","./C9a7Bs1A.js","./-eAKtzkN.js","./auZsMbDf.js","../assets/BishopricApprovalSection.DRGo_BHg.css","./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{d as tr,o as xa,g as ar}from"./WW5OsAH7.js";import{p as ct,ah as x,D as l,E as f,ai as Lt,c as a,s as c,r as t,u as s,m as e,a as dt,B as I,C as rr,f as De,F as Fa,R as Ie,aq as sr,n as A,ar as nr}from"./SWWSvUpQ.js";import{f as _,a as i,c as At,t as Dt}from"./D8ekX_8E.js";import{a as ee,i as m,k as Ut,b as Bt,e as ae,s as P,p as We}from"./CU3XCoqN.js";import{i as vt}from"./Bgyk9asy.js";import{e as et,i as ya}from"./YJAcq9su.js";import{r as za,b as or,s as at,i as ir,c as lr,d as cr,e as dr}from"./CopVGF8H.js";import{b as vr}from"./CvxMDV_e.js";import{e as ur,g as Wt,i as _r,h as Ta,d as Kt,b as zt,a as Yt,j as Xt}from"./BbwhhYVZ.js";import{s as Ca,C as fr,E as pr,A as mr}from"./Cbu2mhsw.js";import{z as ha,v as Pa,B as br,e as aa,p as ce,i as xe,O as Gt,P as Ee,f as tt}from"./5a-TXARV.js";import{C as Ea,E as gr,c as La}from"./BTM46rcH.js";import{S as Ba}from"./DcMM934u.js";import{v as ea,D as ta}from"./8x2zR2yh.js";import{s as Jt}from"./auZsMbDf.js";import{e as Zt}from"./C9a7Bs1A.js";import{_ as wa}from"./CmsKOCeN.js";import{s as Wa}from"./CdEA5IGF.js";import{B as yr}from"./DXR_p5ec.js";import{R as Ft}from"./e-9Zuv9U.js";function Ra(_e,M,T){const y=ha(_e,T),R=ha(M,T),re=+y-Pa(y),O=+R-Pa(R);return Math.round((re-O)/br)}function hr(_e,M){return ur(_e,-M)}var wr=_('<button type="button" class="btn-clear-search svelte-14zxluq" aria-label="Clear search" title="Clear search"><i class="bi bi-x-lg"></i></button>'),xr=_("<option> </option>"),Er=_('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by organization"><option>All Organizations</option><!></select></div>'),kr=_('<div class="col-12 col-md-auto"><button type="button" class="btn btn-primary w-100" aria-label="Clear all filters"><i class="bi bi-x-circle me-1"></i> Clear All</button></div>'),$r=_('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><div class="search-input-wrapper svelte-14zxluq"><input type="text" class="form-control form-control" placeholder="Search..."/> <!></div></div> <!> <!></div></div>');function Ar(_e,M){ct(M,!1);const T=()=>ee(H,"$searchQuery",re),y=()=>ee(Z,"$organizationFilter",re),R=()=>ee(E,"$currentOrganizations",re),[re,O]=Bt(),J=f(),{stores:{currentOrganizations:E,organizationFilter:Z,searchQuery:H}}=Wt(),D=()=>{Ut(H,""),Ut(Z,"")};x(()=>(T(),y()),()=>{l(J,!!(T()||y()))}),Lt(),vt();var te=$r(),U=a(te),W=a(U),F=a(W),ie=a(F);za(ie);var w=c(ie,2);{var ne=S=>{var z=wr();ae("click",z,()=>Ut(H,"")),i(S,z)};m(w,S=>{T()&&S(ne)})}t(F),t(W);var Q=c(W,2);{var Y=S=>{var z=Er(),oe=a(z);I(()=>{y(),rr(()=>{R()})});var de=a(oe);de.value=de.__value="";var $e=c(de);et($e,1,R,ya,(we,Se)=>{var me=xr(),N=a(me,!0);t(me);var X={};I(()=>{P(N,(e(Se),s(()=>e(Se).label))),X!==(X=(e(Se),s(()=>e(Se).key)))&&(me.value=(me.__value=(e(Se),s(()=>e(Se).key)))??"")}),i(we,me)}),t(oe),t(z),or(oe,y,we=>Ut(Z,we)),i(S,z)};m(Q,S=>{R(),s(()=>R().length)&&S(Y)})}var ke=c(Q,2);{var V=S=>{var z=kr(),oe=a(z);t(z),ae("click",oe,D),i(S,z)};m(ke,S=>{e(J)&&S(V)})}t(U),t(te),vr(ie,T,S=>Ut(H,S)),i(_e,te),dt(),O()}var Dr=_('<p class="mb-0">No past events to delete.</p>'),Sr=_('<p class="mb-2"><strong> </strong></p>'),Or=_(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Ir=_("<!> <!>",1),Mr=_('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Tr(_e,M){ct(M,!1);let T=We(M,"deleted",8),y=We(M,"skipped",8),R=We(M,"callback",8);function re(){R()()}vt();var O=Mr(),J=a(O),E=a(J),Z=a(E),H=c(a(Z),2);t(Z);var D=c(Z,2),te=a(D);{var U=w=>{var ne=Dr();i(w,ne)},W=w=>{var ne=Ir(),Q=De(ne);{var Y=S=>{var z=Sr(),oe=a(z),de=a(oe);t(oe),t(z),I(()=>P(de,`✓ Deleted ${T()??""} past event${T()===1?"":"s"}.`)),i(S,z)};m(Q,S=>{T()>0&&S(Y)})}var ke=c(Q,2);{var V=S=>{var z=Or(),oe=a(z),de=a(oe),$e=a(de);t(de),t(oe),Fa(2),t(z),I(()=>P($e,`⚠ Skipped ${y()??""} recurring event${y()===1?"":"s"}`)),i(S,z)};m(ke,S=>{y()>0&&S(V)})}i(w,ne)};m(te,w=>{T()===0&&y()===0?w(U):w(W,!1)})}t(D);var F=c(D,2),ie=a(F);t(F),t(E),t(J),t(O),ae("click",H,re),ae("click",ie,re),i(_e,O),dt()}var Cr=_(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Pr(_e,M){ct(M,!1);let T=We(M,"cutoffDate",8),y=We(M,"callback",8);function R(){y()(!0)}function re(){y()(!1)}vt();var O=Cr(),J=a(O),E=a(J),Z=a(E),H=c(a(Z),2);t(Z);var D=c(Z,2),te=a(D),U=a(te),W=a(U);t(U),t(te),Fa(2),t(D);var F=c(D,2),ie=a(F),w=c(ie,2);t(F),t(E),t(J),t(O),I(()=>P(W,`Are you sure you want to delete all events that occurred before ${T()??""}?`)),ae("click",H,re),ae("click",ie,re),ae("click",w,R),i(_e,O),dt()}var Rr=_('<button class="btn btn-sm btn-primary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Ur=_('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),Fr=_('<div class="d-flex align-items-center justify-content-end ms-auto"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),zr=_('<div class="d-flex flex-row align-items-start gap-3 w-100"><div class="flex-grow-1"><!></div> <!></div>'),Lr=_('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Br=_('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),Wr=_('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),Nr=_('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),jr=_('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),qr=_('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Hr=_('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Qr=_('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Vr=_('<div class="card-body text-muted small">No past events available.</div>'),Kr=_('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-primary">Hide</button></div></div></div> <!></div>'),Yr=_('<div class="d-flex flex-column gap-4"><!></div>'),Xr=_("<!> <!> <!> <!>",1);function Jr(_e,M){ct(M,!1);const T=()=>ee(Se,"$weeksExpanded",D),y=()=>ee(se,"$allPastEvents",D),R=()=>ee(S,"$currentUser",D),re=()=>ee(de,"$userOrganizations",D),O=()=>ee(V,"$currentUserHasPermission",D),J=()=>ee(oe,"$currentUserIsRoot",D),E=()=>ee(z,"$currentUserIsAdmin",D),Z=()=>ee($e,"$ready",D),H=()=>ee(me,"$searchQuery",D),[D,te]=Bt(),U=f(),W=f(),F=f(),ie=f(),w=f(),ne=f(),Q=f(),Y=f(),ke=f(),{stores:{currentUserHasPermission:V,currentUser:S,currentUserIsAdmin:z,currentUserIsRoot:oe,userOrganizations:de}}=aa(),{stores:{ready:$e,dbData:we,weeksExpanded:Se,searchQuery:me},actions:{reload:N}}=Wt(),X={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let le=We(M,"formId",24,ea),He=f(!1),Ye=f(!1),rt=f(),ut=f(!1),_t=f(!1),Xe=f(!1),Je=f(new Set),Ne=f(!1),yt=f(""),st=f({...X}),Ze=f(!1),v=f(""),g=f(!1),p=f({deleted:0,skipped:0});const K=4,be=4;let fe=f(K),Ce=f(!1);const L=Jt();let o=f({});function u(n){return e(U).includes(n)}function b(n){const d=e(o)[n]??u(n);l(o,{...e(o),[n]:!d})}const k=n=>{l(yt,"Event Item"),l(st,{...n,organization:n?.meta_data?.organization??""})},se=tr(we,n=>{const d=Jt();return(n??[]).filter(r=>!(r.event_type!=="calendar_event"||!r.start_time||ce(r.start_time)>=d||r.recurrence_rule&&(!r.recurrence_end_date||r.recurrence_end_date&&ce(r.recurrence_end_date)>=d)))}),Oe=n=>La(n,{currentUserId:e(rt),isPrivileged:e(Ye),canEditOwnOrgEvents:e(Xe),userOrganizations:e(Je)});let pe=f(!1);function B(){l(fe,e(fe)+be)}function Me(){l(fe,520),l(Ce,!0)}function Pe(){l(fe,K),l(Ce,!1)}const je=()=>{if(!e(He)||e(Ne)||!ar(oe)||!e(Y))return;const n=Jt();l(v,xe(n,"MMM d, yyyy")),l(Ze,!0)};async function qe(n){if(l(Ze,!1),!n)return;const d=Jt();l(Ne,!0);try{const r=await _r(d);await N(),l(p,r),l(g,!0)}catch(r){console.error("Failed to delete past events",r),alert("Failed to delete past events. Please try again.")}finally{l(Ne,!1)}}function nt(){l(g,!1)}xa(async()=>{await N()}),x(()=>(y(),e(fe)),()=>{l(F,(y()??[]).filter(n=>{if(!n.start_time)return!1;const d=ce(n.start_time),r=hr(L,e(fe));return d>=r&&d<L}))}),x(()=>(e(F),xe),()=>{l(w,(()=>{const n=new Map;for(const d of e(F)){if(!d.start_time)continue;const r=ce(d.start_time),h=ha(r,{weekStartsOn:1}),j=Zt(r,{weekStartsOn:1}),q=xe(h,"yyyy-MM-dd"),ge=`${xe(h,"MMM d")} – ${xe(j,"MMM d")}`;let ve=n.get(q);ve||(ve={key:q,label:ge,days:new Map},n.set(q,ve));const ue=xe(r,"yyyy-MM-dd");let Ae=ve.days.get(ue);Ae||(Ae={key:ue,displayDay:xe(r,"EEE"),displayDate:xe(r,"MMM d"),events:[]},ve.days.set(ue,Ae)),Ae.events.push(d)}return Array.from(n.values()).sort((d,r)=>d.key<r.key?1:-1).map(d=>({key:d.key,label:d.label,days:Array.from(d.days.values()).sort((r,h)=>r.key<h.key?1:-1).map(r=>({...r,events:r.events.slice().sort((h,j)=>{const q=h.is_all_day?0:1,ge=j.is_all_day?0:1;if(q!==ge)return q-ge;const ve=h.start_time?ce(h.start_time).getTime():Number.MAX_SAFE_INTEGER,ue=j.start_time?ce(j.start_time).getTime():Number.MAX_SAFE_INTEGER;return ve-ue})}))}))})())}),x(()=>e(w),()=>{l(U,(()=>{if(e(w).length===0)return[];const n=[];return e(w)[0]&&n.push(e(w)[0].key),e(w)[1]&&n.push(e(w)[1].key),n})())}),x(()=>(T(),e(o)),()=>{l(W,n=>T()?!0:e(o)[n]!==void 0?e(o)[n]:u(n))}),x(()=>e(F),()=>{l(ie,e(F).length)}),x(()=>(e(w),xe),()=>{l(ne,e(w).reduce((n,d)=>{const r=ce(d.key),h=Zt(r,{weekStartsOn:1}),j=xe(h,"yyyy-MM"),q=xe(h,"MMMM yyyy");return n[j]||(n[j]={label:q,weeks:[]}),n[j].weeks.push(d),n},{}))}),x(()=>R(),()=>{l(rt,R()?.id)}),x(()=>re(),()=>{l(Je,re())}),x(()=>e(rt),()=>{l(_t,!!e(rt))}),x(()=>(e(Je),Gt),()=>{l(ut,e(Je).has(Gt.Bishopric))}),x(()=>(O(),Ee),()=>{l(Xe,O()(Ee.EditOwnOrgEvents))}),x(()=>(J(),E(),e(ut),O(),Ee),()=>{l(Ye,J()||E()||e(ut)||O()(Ee.EditAllEvents))}),x(()=>(e(Ye),O(),e(Xe),e(_t)),()=>{l(He,e(Ye)||O()(Ee.CreateEvents)||e(Xe)||e(_t))}),x(()=>(O(),Ee),()=>{l(Q,O()(Ee.DeleteEvents))}),x(()=>e(F),()=>{l(Y,e(F).length>0)}),x(()=>(y(),e(F)),()=>{l(ke,y().length>e(F).length)}),Lt(),vt();var ot=Xr(),it=De(ot);ta(it,{get title(){return e(yt)},get id(){return le()},children:(n,d)=>{Ea(n,{get eventItem(){return e(st)},get drawerId(){return le()},name:"past-event-item-form",get canDelete(){return e(Q)}})},$$slots:{default:!0}});var Re=c(it,2);{var ht=n=>{var d=At(),r=De(d);{var h=q=>{var ge=At(),ve=De(ge);{var ue=Qe=>{var Ue=Rr(),Ge=c(a(Ue));t(Ue),I(()=>P(Ge,` Show Past Events (${y(),s(()=>y().length)??""})`)),ae("click",Ue,()=>l(pe,!0)),i(Qe,Ue)},Ae=Qe=>{var Ue=Kr(),Ge=a(Ue),Nt=a(Ge),Ot=c(a(Nt),2),It=a(Ot);{var ra=Fe=>{var Le=Ur(),ft=a(Le);{var Tt=ye=>{var ze=Dt("Deleting…");i(ye,ze)},pt=ye=>{var ze=Dt();I(()=>P(ze,`Delete All (${e(ie)??""})`)),i(ye,ze)};m(ft,ye=>{e(Ne)?ye(Tt):ye(pt,!1)})}t(Le),I(()=>Le.disabled=e(Ne)),ae("click",Le,je),i(Fe,Le)};m(It,Fe=>{J()&&e(Y)&&Fe(ra)})}var Mt=c(It,2);t(Ot),t(Nt),t(Ge);var jt=c(Ge,2);{var sa=Fe=>{var Le=Qr(),ft=De(Le);et(ft,5,()=>(e(ne),s(()=>Object.entries(e(ne)))),([ye,ze])=>ye,(ye,ze)=>{var mt=sr(()=>nr(e(ze),2));let lt=()=>e(mt)[1];var bt=Nr(),Ve=De(bt),Et=a(Ve,!0);t(Ve);var Ke=c(Ve,2);et(Ke,1,()=>(lt(),s(()=>lt().weeks)),Be=>Be.key,(Be,he)=>{const $=Ie(()=>(A(ce),e(he),s(()=>ce(e(he).key)))),C=Ie(()=>(A(Zt),A(e($)),s(()=>Zt(e($),{weekStartsOn:1})))),Te=Ie(()=>(A(Ca),A(e(C)),s(()=>Ca(e(C))))),gt=Ie(()=>(A(Ra),A(e(C)),A(e(Te)),s(()=>Ra(e(C),e(Te),{weekStartsOn:1})+1))),oa=Ie(()=>(e(W),e(he),s(()=>e(W)(e(he).key)))),qt=Ie(()=>(e(he),s(()=>e(he).days.reduce((Pt,Ht)=>Pt+Ht.events.length,0))));var ka=Wr(),ia=De(ka),Ct=a(ia);let $a;var la=a(Ct),Aa=a(la),Da=c(Aa,2),Na=a(Da);t(Da),t(la);var ca=c(la,2);let Sa;var ja=a(ca,!0);t(ca),t(Ct),t(ia);var qa=c(ia,2);{var Ha=Pt=>{var Ht=At(),Qa=De(Ht);{var Va=kt=>{var Qt=At(),Ya=De(Qt);et(Ya,1,()=>(e(he),s(()=>e(he).days)),da=>da.key,(da,$t)=>{var va=Lr(),Oa=a(va),ua=a(Oa),_a=a(ua),Xa=a(_a,!0);t(_a);var Ia=c(_a,2),Ja=a(Ia,!0);t(Ia),t(ua);var Ma=c(ua,2);et(Ma,5,()=>(e($t),s(()=>e($t).events)),Rt=>Rt.id??`${Rt.start_time}-${Rt.meta_data?.recurring_instance_index??0}`,(Rt,Vt)=>{var fa=zr(),pa=a(fa),Za=a(pa);gr(Za,{get item(){return e(Vt)},showDate:!1,get searchQuery(){return H()}}),t(pa);var Ga=c(pa,2);{var er=ma=>{var ba=Fr(),ga=a(ba);t(ba),I(()=>{at(ga,"data-bs-target",`#${le()??""}`),at(ga,"aria-controls",le())}),ae("click",ga,()=>k(e(Vt))),i(ma,ba)};m(Ga,ma=>{e(Vt),s(()=>Oe(e(Vt)))&&ma(er)})}t(fa),i(Rt,fa)}),t(Ma),t(Oa),t(va),I(()=>{P(Xa,(e($t),s(()=>e($t).displayDay))),P(Ja,(e($t),s(()=>e($t).displayDate)))}),i(da,va)}),i(kt,Qt)},Ka=kt=>{var Qt=Br();i(kt,Qt)};m(Qa,kt=>{e(he),s(()=>e(he).days.length)?kt(Va):kt(Ka,!1)})}i(Pt,Ht)};m(qa,Pt=>{e(oa)&&Pt(Ha)})}I(()=>{$a=tt(Ct,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,$a,{"text-muted":e(qt)===0}),at(Ct,"title",e(oa)?"Click to collapse week":"Click to expand week"),tt(Aa,1,`bi ${e(oa)?"bi-chevron-up":"bi-chevron-down"}`),P(Na,`Week ${e(gt)??""} [${e(qt)??""} Event${e(qt)===1?"":"s"}]`),Sa=tt(ca,1,"",null,Sa,{"opacity-50":e(qt)===0}),P(ja,(e(he),s(()=>e(he).label)))}),ae("click",Ct,()=>b(e(he).key)),i(Be,ka)}),I(()=>P(Et,(lt(),s(()=>lt().label)))),i(ye,bt)}),t(ft);var Tt=c(ft,2);{var pt=ye=>{var ze=Hr(),mt=a(ze),lt=a(mt);t(mt);var bt=c(mt,2);{var Ve=Ke=>{var Be=jr();ae("click",Be,Pe),i(Ke,Be)},Et=Ke=>{var Be=qr(),he=a(Be),$=c(he,2);t(Be),ae("click",he,B),ae("click",$,Me),i(Ke,Be)};m(bt,Ke=>{e(Ce)?Ke(Ve):Ke(Et,!1)})}t(ze),I(()=>P(lt,`Showing ${e(F),s(()=>e(F)?.length??0)??""} of ${y(),s(()=>y()?.length??0)??""}`)),i(ye,ze)};m(Tt,ye=>{(e(ke)||e(Ce))&&ye(pt)})}i(Fe,Le)},na=Fe=>{var Le=Vr();i(Fe,Le)};m(jt,Fe=>{e(w),s(()=>e(w).length)?Fe(sa):Fe(na,!1)})}t(Ue),ae("click",Mt,()=>l(pe,!1)),i(Qe,Ue)};m(ve,Qe=>{e(pe)?Qe(Ae,!1):Qe(ue)})}i(q,ge)},j=q=>{var ge=Yr(),ve=a(ge);Ba(ve,{}),t(ge),i(q,ge)};m(r,q=>{Z()?q(h):q(j,!1)})}i(n,d)};m(Re,n=>{J()&&n(ht)})}var wt=c(Re,2);{var xt=n=>{Pr(n,{get cutoffDate(){return e(v)},callback:qe})};m(wt,n=>{e(Ze)&&n(xt)})}var St=c(wt,2);{var G=n=>{Tr(n,{get deleted(){return e(p),s(()=>e(p).deleted)},get skipped(){return e(p),s(()=>e(p).skipped)},callback:nt})};m(St,n=>{e(g)&&n(G)})}i(_e,ot),dt(),te()}var Zr=_("<span> </span>"),Gr=_('<span class="badge bg-secondary">All Day</span>'),es=_('<span class="result-time svelte-1xkw8oa"> </span>'),ts=_('<span class="result-date svelte-1xkw8oa"> </span> <!>',1),as=_('<span class="result-location svelte-1xkw8oa"><i class="bi bi-geo-alt"></i> <!></span>'),rs=_('<div class="result-thumbnail-container svelte-1xkw8oa"><img class="result-thumbnail svelte-1xkw8oa"/></div>'),ss=_('<div class="result-actions svelte-1xkw8oa"><button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i></button></div>'),ns=_('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="result-details-button svelte-1xkw8oa"><div class="result-header svelte-1xkw8oa"><div class="result-title svelte-1xkw8oa"><!></div> <span class="result-type-badge badge bg-secondary-subtle text-secondary-emphasis svelte-1xkw8oa"> </span></div> <div class="result-meta svelte-1xkw8oa"><!> <!> <!></div></button> <!> <!></li>'),os=_('<div class="unified-search-results svelte-1xkw8oa"><div class="search-results-header svelte-1xkw8oa"><h6 class="search-results-title svelte-1xkw8oa"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),is=_('<div class="no-search-results svelte-1xkw8oa"> </div>'),ls=_("<!> <!> <!>",1);function cs(_e,M){ct(M,!1);const T=()=>ee(W,"$currentUser",H),y=()=>ee(ne,"$userOrganizations",H),R=()=>ee(F,"$currentUserHasPermission",H),re=()=>ee(w,"$currentUserIsRoot",H),O=()=>ee(ie,"$currentUserIsAdmin",H),J=()=>ee(Q,"$calendarEvents",H),E=()=>ee(ke,"$searchQuery",H),Z=()=>ee(Y,"$announcements",H),[H,D]=Bt(),te=f(),U=f(),{stores:{currentUser:W,currentUserHasPermission:F,currentUserIsAdmin:ie,currentUserIsRoot:w,userOrganizations:ne}}=aa(),{stores:{calendarEvents:Q,announcements:Y,searchQuery:ke}}=Wt(),V=ea(),S=ea();let z=f(!1),oe=f(),de=f(!1),$e=f(!1),we=f(new Set),Se=f(""),me=f({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),N=f({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),X=f(!1);const le=v=>La(v,{currentUserId:e(oe),isPrivileged:e(z),canEditOwnOrgEvents:e($e),userOrganizations:e(we)}),He=v=>v.startsWith("image/"),Ye=async v=>{const g=v.itemType==="announcement"?"announcement":"calendar_event";if(l(Se,`${v.itemType==="announcement"?"Announcement":"Event"} Form`),v?.meta_data?.recurring_instance&&v?.meta_data?.recurring_parent_id){const{getCalendarEvent:p}=await wa(async()=>{const{getCalendarEvent:be}=await import("./BbwhhYVZ.js").then(fe=>fe.x);return{getCalendarEvent:be}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),K=await p(v.meta_data.recurring_parent_id);if(K){l(me,{...K,organization:K?.meta_data?.organization??"",event_type:g,start_time:v.start_time,end_time:v.end_time,meta_data:{...K.meta_data,recurring_instance:!0,recurring_parent_id:v.meta_data.recurring_parent_id,recurring_instance_index:v.meta_data.recurring_instance_index}});return}}l(me,{...v,organization:v?.meta_data?.organization??"",event_type:g})},rt=async v=>{if(v?.meta_data?.recurring_instance&&v?.meta_data?.recurring_parent_id){const{getCalendarEvent:p}=await wa(async()=>{const{getCalendarEvent:be}=await import("./BbwhhYVZ.js").then(fe=>fe.x);return{getCalendarEvent:be}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),K=await p(v.meta_data.recurring_parent_id);K?l(N,{...K,start_time:v.start_time,end_time:v.end_time,meta_data:{...K.meta_data,recurring_instance:!0,recurring_parent_id:v.meta_data.recurring_parent_id,recurring_instance_index:v.meta_data.recurring_instance_index}}):l(N,v)}else l(N,v);const g=document.getElementById(S);g&&new window.bootstrap.Offcanvas(g).show()},ut=async v=>{await Ye(v);const g=document.getElementById(V);g&&new window.bootstrap.Offcanvas(g).show()},_t=async()=>{const v=document.getElementById(S);if(v){const g=window.bootstrap.Offcanvas.getInstance(v);g&&g.hide()}await Ye(e(N)),setTimeout(()=>{const g=document.getElementById(V);g&&new window.bootstrap.Offcanvas(g).show()},300)};x(()=>T(),()=>{l(oe,T()?.id)}),x(()=>y(),()=>{l(we,y())}),x(()=>(e(we),Gt),()=>{l(de,e(we).has(Gt.Bishopric))}),x(()=>(R(),Ee),()=>{l($e,R()(Ee.EditOwnOrgEvents))}),x(()=>(re(),O(),e(de),R(),Ee),()=>{l(z,re()||O()||e(de)||R()(Ee.EditAllEvents))}),x(()=>(R(),Ee),()=>{l(X,R()(Ee.DeleteEvents))}),x(()=>(J(),ce),()=>{l(te,(J()??[]).filter(v=>v.start_time?ce(v.start_time)>=new Date:!1))}),x(()=>(E(),e(te),Z(),ce),()=>{l(U,E()?[...e(te).filter(v=>{const g=E().toLowerCase(),p=(v.title||"").toLowerCase(),K=(v.description||"").replace(/<[^>]*>/g,"").toLowerCase(),be=(v.location||"").toLowerCase();return p.includes(g)||K.includes(g)||be.includes(g)}).map(v=>({...v,itemType:"event"})),...(Z()??[]).filter(v=>{const g=E().toLowerCase(),p=(v.title||"").toLowerCase(),K=(v.description||"").replace(/<[^>]*>/g,"").toLowerCase(),be=(v.location||"").toLowerCase();return p.includes(g)||K.includes(g)||be.includes(g)}).map(v=>({...v,itemType:"announcement"}))].sort((v,g)=>{const p=v.start_time?ce(v.start_time).getTime():0,K=g.start_time?ce(g.start_time).getTime():0;return p===0&&K!==0?-1:p!==0&&K===0?1:p-K}):[])}),Lt(),vt();var Xe=ls(),Je=De(Xe);ta(Je,{get title(){return e(Se)},get id(){return V},children:(v,g)=>{Ea(v,{get eventItem(){return e(me)},get drawerId(){return V},name:"unified-search-form",get canDelete(){return e(X)}})},$$slots:{default:!0}});var Ne=c(Je,2);ta(Ne,{title:"Details",get id(){return S},children:(v,g)=>{{let p=Ie(()=>(e(N),s(()=>le(e(N)))));fr(v,{get event(){return e(N)},get canEdit(){return e(p)},onEdit:_t})}},$$slots:{default:!0}});var yt=c(Ne,2);{var st=v=>{var g=os(),p=a(g),K=a(p),be=a(K);t(K),t(p);var fe=c(p,2);et(fe,5,()=>e(U),Ce=>Ce.id??Ce.start_time??Math.random(),(Ce,L)=>{const o=Ie(()=>(e(L),s(()=>e(L).attachments?.find(d=>He(d.type))))),u=Ie(()=>(A(zt),e(L),s(()=>zt(e(L)?.meta_data?.organization??"")))),b=Ie(()=>(e(L),s(()=>e(L).itemType==="event")));var k=ns(),se=a(k),Oe=c(se,2),pe=a(Oe),B=a(pe),Me=a(B);Ta(Me,()=>(A(Kt),e(L),E(),s(()=>Kt(e(L).title,E())))),t(B);var Pe=c(B,2),je=a(Pe,!0);t(Pe),t(pe);var qe=c(pe,2),nt=a(qe);{var ot=d=>{var r=Zr(),h=a(r,!0);t(r),I(()=>{tt(r,1,`badge rounded-pill bg-color-${A(e(u)),s(()=>e(u).color_number)??""}`,"svelte-1xkw8oa"),P(h,(A(e(u)),s(()=>e(u).label)))}),i(d,r)};m(nt,d=>{A(e(u)),s(()=>e(u)?.label)&&d(ot)})}var it=c(nt,2);{var Re=d=>{var r=ts(),h=De(r),j=a(h,!0);t(h);var q=c(h,2);{var ge=ue=>{var Ae=Gr();i(ue,Ae)},ve=ue=>{var Ae=es(),Qe=a(Ae,!0);t(Ae),I(Ue=>P(Qe,Ue),[()=>(A(xe),A(ce),e(L),s(()=>xe(ce(e(L).start_time),"h:mm a")))]),i(ue,Ae)};m(q,ue=>{e(L),s(()=>e(L).is_all_day)?ue(ge):ue(ve,!1)})}I(ue=>P(j,ue),[()=>(A(xe),A(ce),e(L),s(()=>xe(ce(e(L).start_time),"MMM d, yyyy")))]),i(d,r)};m(it,d=>{e(L),s(()=>e(L).start_time)&&d(Re)})}var ht=c(it,2);{var wt=d=>{var r=as(),h=c(a(r),2);Ta(h,()=>(A(Kt),e(L),E(),s(()=>Kt(e(L).location,E())))),t(r),i(d,r)};m(ht,d=>{e(L),s(()=>e(L).location)&&d(wt)})}t(qe),t(Oe);var xt=c(Oe,2);{var St=d=>{var r=rs(),h=a(r);t(r),I(()=>{at(h,"src",(A(e(o)),s(()=>e(o).url))),at(h,"alt",(A(e(o)),s(()=>e(o).name)))}),i(d,r)};m(xt,d=>{e(o)&&d(St)})}var G=c(xt,2);{var n=d=>{var r=ss(),h=a(r);t(r),I(()=>at(h,"title",`Edit ${e(b)?"event":"announcement"}`)),ae("click",h,Wa(()=>ut(e(L)))),i(d,r)};m(G,d=>{e(L),s(()=>le(e(L)))&&d(n)})}t(k),I(()=>{tt(se,1,`result-color-indicator bg-color-${A(e(u)),s(()=>e(u)?.color_number??0)??""}`,"svelte-1xkw8oa"),P(je,e(b)?"Event":"Announcement")}),ae("click",Oe,()=>rt(e(L))),i(Ce,k)}),t(fe),t(g),I(()=>P(be,`${e(U),s(()=>e(U).length)??""} result${e(U),s(()=>e(U).length===1?"":"s")??""} matching "${E()??""}"`)),i(v,g)},Ze=v=>{var g=At(),p=De(g);{var K=be=>{var fe=is(),Ce=a(fe);t(fe),I(()=>P(Ce,`No results match your search for "${E()??""}"`)),i(be,fe)};m(p,be=>{E()&&be(K)},!0)}i(v,g)};m(yt,v=>{E(),e(U),s(()=>E()&&e(U).length>0)?v(st):v(Ze,!1)})}i(_e,Xe),dt(),D()}var ds=_("<!> <!> <!>",1),vs=_('<div class="d-flex flex-column gap-4"><!> <!></div>');function Ua(_e,M){ct(M,!1);const T=()=>ee(re,"$searchQuery",y),[y,R]=Bt(),{stores:{searchQuery:re}}=Wt();let O=We(M,"showAnnouncements",8,!0),J=We(M,"showSearch",8,!0);vt();var E=vs(),Z=a(E);{var H=W=>{Ar(W,{})};m(Z,W=>{J()&&W(H)})}var D=c(Z,2);{var te=W=>{cs(W,{})},U=W=>{var F=ds(),ie=De(F);{var w=Y=>{mr(Y,{})};m(ie,Y=>{O()&&Y(w)})}var ne=c(ie,2);pr(ne,{});var Q=c(ne,2);Jr(Q,{}),i(W,F)};m(D,W=>{J()&&T()?W(te):W(U,!1)})}t(E),i(_e,E),dt(),R()}var us=_('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),_s=_('<button type="button" role="tab"> </button>'),fs=_("<option> </option>"),ps=_('<div class="py-5 text-center text-muted"><!></div>'),ms=_('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),bs=_("<span> </span>"),gs=_('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),ys=_('<span><i class="bi bi-geo-alt"></i> </span>'),hs=_('<span><i class="bi bi-arrow-repeat"></i> </span>'),ws=_('<span><i class="bi bi-calendar3"></i> </span>'),xs=_('<span class="text-muted small"> </span>'),Es=_('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-primary" type="button"><i class="bi bi-pencil-square"></i></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),ks=_('<div class="d-flex flex-column gap-3"></div>'),$s=_('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="card"><div class="card-header d-flex flex-column gap-3"><div class="d-flex flex-md-row align-items-center justify-content-between gap-2"><div class="mb-0">My Submissions</div> <button class="btn btn-primary btn-sm"><!></button></div> <div class="submissions-status-tabs nav nav-pills gap-2" role="tablist"></div></div> <div class="card-body d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3"><div class="input-group input-group-sm my-submissions-search svelte-9fakr"><input class="form-control svelte-9fakr" type="search" placeholder="Search title, category, or location"/></div> <div class="type-filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div> <!></div></div></div>'),As=_('<div class="text-muted">Select a submission to edit.</div>'),Ds=_("<!> <!>",1);function Ss(_e,M){ct(M,!1);const T=()=>ee(w,"$currentUserStore",O),y=()=>ee(ne,"$currentUserHasPermission",O),R=()=>ee(F,"$dbData",O),re=()=>ee(W,"$ready",O),[O,J]=Bt(),E=f(),Z=f(),H=f(),D=f(),te=f(),U=f(),{stores:{ready:W,dbData:F},actions:{reload:ie}}=Wt(),{stores:{currentUser:w,currentUserHasPermission:ne}}=aa();let Q=f(!1),Y=f([]),ke=f([]),V=f(null);const S=ea();let z=null;const oe={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},de={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},$e={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},we=[{value:"pending",label:$e.pending},{value:"needs_review",label:$e.needs_review},{value:"approved",label:$e.approved},{value:"published",label:$e.published}],Se=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}],me=()=>({search:"",typeFilter:"all"});let N=f({pending:me(),needs_review:me(),approved:me(),published:me()});xa(async()=>{l(Q,!0),await ie(),l(Q,!1),typeof window<"u"&&(z=(await wa(()=>import("./DO0djbQe.js").then(u=>u.o),__vite__mapDeps([27,28]),import.meta.url)).default)});const X=o=>{const u=o.meta_data?.submitted_at??o.created_at;if(!u)return 0;try{return ce(u).getTime()}catch(b){return console.warn("Failed to parse submission timestamp",b),0}},le=o=>{const u=o.meta_data?.submitted_at??o.created_at;if(!u)return"—";try{return xe(ce(u),"MMM d, yyyy 'at' h:mm a")}catch(b){return console.warn("Failed to format submission timestamp",b),"—"}},He=o=>{if(!o.start_time)return"—";try{return xe(ce(o.start_time),"MMM d, yyyy 'at' h:mm a")}catch(u){return console.warn("Failed to format event date",u),"—"}},Ye=o=>o.replace(/<[^>]*>/g,""),rt=(o,u)=>o.length<=u?o:o.substring(0,u).trimEnd()+"…",ut=o=>o.description?rt(Ye(o.description).trim(),120):"",_t=o=>{try{const b=Ft.fromString(o).origOptions,k=b.interval||1,se=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Oe=["","1st","2nd","3rd","4th","5th"];if(b.freq===Ft.DAILY)return k===1?"Repeats daily":`Repeats every ${k} days`;if(b.freq===Ft.WEEKLY){if(b.byweekday){const B=(Array.isArray(b.byweekday)?b.byweekday:[b.byweekday]).map(Me=>{const Pe=typeof Me=="number"?Me:Me.weekday,je=Pe===6?0:Pe+1;return se[je]});return k===1?B.length===1?`Repeats every ${B[0]}`:`Repeats on ${B.join(", ")}`:`Repeats every ${k} weeks on ${B.join(", ")}`}return k===1?"Repeats weekly":`Repeats every ${k} weeks`}if(b.freq===Ft.MONTHLY){if(b.byweekday){const B=(Array.isArray(b.byweekday)?b.byweekday:[b.byweekday])[0];if(B&&typeof B=="object"&&"n"in B&&"weekday"in B){const Me=B.weekday,Pe=Me===6?0:Me+1,je=B.n,qe=Oe[je]||`${je}th`;return k===1?`Repeats on the ${qe} ${se[Pe]} of the month`:`Repeats on the ${qe} ${se[Pe]} every ${k} months`}}if(b.bymonthday){const pe=Array.isArray(b.bymonthday)?b.bymonthday[0]:b.bymonthday,B=pe===1?"st":pe===2?"nd":pe===3?"rd":"th";return k===1?`Repeats on the ${pe}${B} of the month`:`Repeats on the ${pe}${B} every ${k} months`}return k===1?"Repeats monthly":`Repeats every ${k} months`}return b.freq===Ft.YEARLY?k===1?"Repeats yearly":`Repeats every ${k} years`:"Repeats"}catch{return"Repeats"}},Xe=(o,u)=>{const b=u.trim().toLowerCase();if(!b)return!0;const k=o.meta_data?.organization?zt(o.meta_data.organization)?.label??"":"";return[o.title??"",o.description??"",o.location??"",k??""].join(" ").toLowerCase().includes(b)},Je=(o,u)=>u==="all"?!0:u==="events"?o.event_type==="calendar_event":o.event_type==="announcement";function Ne(o,u){l(N,{...e(N),[o]:{...e(N)[o],...u}})}const yt=o=>{const u=new Set,b=[];for(const k of o){const se=k.meta_data?.recurring_parent_id;if(k.meta_data?.recurring_instance&&se!=null){if(u.has(se))continue;u.add(se)}b.push(k)}return b},st=o=>o.meta_data?.recurring_parent_id!=null?`recurring-${o.meta_data.recurring_parent_id}`:`id-${o.id}`,Ze=o=>{l(V,o);const u=document.getElementById(S);u&&z&&z.getOrCreateInstance(u).show()},v=(o,u)=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),Ze(u))},g=async()=>{l(Q,!0),await ie(),l(Q,!1)};let p=f("pending");x(()=>T(),()=>{l(E,T())}),x(()=>(y(),Ee),()=>{l(Z,y()(Ee.DeleteEvents)||y()(Ee.DeleteOwnEvents))}),x(()=>(R(),e(E)),()=>{l(Y,yt((R()??[]).filter(o=>{const u=o.meta_data?.submitted_by_user_id;return u&&e(E)?.id&&u===e(E).id}).sort((o,u)=>X(o)-X(u))))}),x(()=>e(p),()=>{l(H,`type-filter-select-submissions-${e(p)}`)}),x(()=>(e(Y),Yt),()=>{l(D,we.reduce((o,u)=>(o[u.value]=e(Y).filter(b=>Yt(b)===u.value),o),{}))}),x(()=>(e(N),e(D)),()=>{l(te,we.reduce((o,u)=>{const b=e(N)[u.value],k=(e(D)[u.value]??[]).filter(se=>Je(se,b.typeFilter));return o[u.value]=k.filter(se=>Xe(se,b.search)),o},{}))}),x(()=>(e(te),e(p)),()=>{l(ke,e(te)[e(p)]??[])}),x(()=>(e(V),e(Y)),()=>{e(V)&&!e(Y).some(o=>st(o)===st(e(V)))&&l(V,null)}),x(()=>e(V),()=>{l(U,e(V)?{...e(V),id:e(V).id??e(V).meta_data?.recurring_parent_id,organization:e(V).meta_data?.organization??""}:null)}),Lt(),vt();var K=Ds(),be=De(K);{var fe=o=>{var u=us(),b=a(u);Ba(b,{}),t(u),i(o,u)},Ce=o=>{var u=$s(),b=a(u),k=a(b),se=a(k),Oe=c(a(se),2),pe=a(Oe);{var B=G=>{var n=Dt("Refreshing…");i(G,n)},Me=G=>{var n=Dt("Refresh");i(G,n)};m(pe,G=>{e(Q)?G(B):G(Me,!1)})}t(Oe),t(se);var Pe=c(se,2);et(Pe,5,()=>we,ya,(G,n)=>{var d=_s(),r=a(d);t(d),I(()=>{tt(d,1,(e(p),e(n),s(()=>`nav-link ${e(p)===e(n).value?"active":""}`)),"svelte-9fakr"),at(d,"aria-selected",(e(p),e(n),s(()=>e(p)===e(n).value))),P(r,`${e(n),s(()=>e(n).label)??""} (${e(D),e(n),s(()=>(e(D)[e(n).value]??[]).length)??""})`)}),ae("click",d,()=>l(p,e(n).value)),i(G,d)}),t(Pe),t(k);var je=c(k,2),qe=a(je),nt=a(qe),ot=a(nt);za(ot),t(nt);var it=c(nt,2),Re=a(it);et(Re,5,()=>Se,ya,(G,n)=>{var d=fs(),r=a(d,!0);t(d);var h={};I(()=>{P(r,(e(n),s(()=>e(n).label))),h!==(h=(e(n),s(()=>e(n).value)))&&(d.value=(d.__value=(e(n),s(()=>e(n).value)))??"")}),i(G,d)}),t(Re);var ht;ir(Re),t(it),t(qe);var wt=c(qe,2);{var xt=G=>{var n=ps(),d=a(n);{var r=j=>{var q=Dt("You haven't submitted any events or announcements yet.");i(j,q)},h=j=>{var q=Dt();I(ge=>P(q,`No ${ge??""} submissions match your current filters.`),[()=>(e(p),s(()=>$e[e(p)].toLowerCase()))]),i(j,q)};m(d,j=>{e(Y),s(()=>e(Y).length===0)?j(r):j(h,!1)})}t(n),i(G,n)},St=G=>{var n=ks();et(n,5,()=>e(ke),d=>st(d),(d,r)=>{const h=Ie(()=>(A(Yt),e(r),s(()=>Yt(e(r))))),j=Ie(()=>(A(e(h)),s(()=>de[e(h)]))),q=Ie(()=>(e(r),A(zt),s(()=>e(r).meta_data?.organization?zt(e(r).meta_data.organization):null))),ge=Ie(()=>(e(r),s(()=>ut(e(r)))));var ve=Es(),ue=a(ve),Ae=a(ue),Qe=a(Ae,!0);t(Ae);var Ue=c(Ae,2),Ge=a(Ue),Nt=a(Ge,!0);t(Ge);var Ot=c(Ge,2);t(Ue),t(ue);var It=c(ue,2);{var ra=$=>{var C=ms(),Te=a(C,!0);t(C),I(()=>P(Te,e(ge))),i($,C)};m(It,$=>{e(ge)&&$(ra)})}var Mt=c(It,2),jt=a(Mt);{var sa=$=>{var C=bs(),Te=a(C,!0);t(C),I(()=>{tt(C,1,`badge rounded-pill bg-color-${A(e(q)),s(()=>e(q).color_number)??""}`,"svelte-9fakr"),P(Te,(A(e(q)),s(()=>e(q).label)))}),i($,C)},na=$=>{var C=gs();i($,C)};m(jt,$=>{e(q)?$(sa):$(na,!1)})}var Fe=c(jt,2);{var Le=$=>{var C=ys(),Te=c(a(C));t(C),I(()=>P(Te,` ${e(r),s(()=>e(r).location)??""}`)),i($,C)};m(Fe,$=>{e(r),s(()=>e(r).location)&&$(Le)})}var ft=c(Fe,2);{var Tt=$=>{var C=hs(),Te=c(a(C));t(C),I(gt=>P(Te,` ${gt??""}`),[()=>(e(r),s(()=>_t(e(r).recurrence_rule)))]),i($,C)};m(ft,$=>{e(r),s(()=>e(r).recurrence_rule)&&$(Tt)})}t(Mt);var pt=c(Mt,2),ye=a(pt),ze=c(a(ye));t(ye);var mt=c(ye,2);{var lt=$=>{var C=ws(),Te=c(a(C));t(C),I(gt=>P(Te,` Event ${gt??""}`),[()=>(e(r),s(()=>He(e(r))))]),i($,C)};m(mt,$=>{e(r),s(()=>e(r).event_type==="calendar_event")&&$(lt)})}t(pt);var bt=c(pt,2),Ve=a(bt),Et=a(Ve),Ke=c(Et,1,!0);t(Ve);var Be=c(Ve,2);{var he=$=>{var C=xs(),Te=a(C);t(C),I(gt=>P(Te,`Approvals: ${gt??""} of 3`),[()=>(A(Xt),e(r),s(()=>Xt(e(r))))]),i($,C)};m(Be,$=>{A(Xt),e(r),s(()=>Xt(e(r))>0)&&$(he)})}t(bt),t(ve),I($=>{dr(ve,`border-left: 4px solid ${A(e(h)),s(()=>oe[e(h)])??""}`),P(Qe,(e(r),s(()=>e(r).title))),P(Nt,(e(r),s(()=>e(r).event_type==="calendar_event"?"Event":"Announcement"))),at(Ot,"aria-label",(e(r),s(()=>`Edit ${e(r).title}`))),P(ze,` Submitted ${$??""}`),tt(Ve,1,(A(e(j)),s(()=>`badge ${e(j).class}`)),"svelte-9fakr"),tt(Et,1,(A(e(j)),s(()=>`bi ${e(j).icon} me-1`)),"svelte-9fakr"),P(Ke,(A(e(j)),s(()=>e(j).text)))},[()=>(e(r),s(()=>le(e(r))))]),ae("click",Ot,Wa(()=>Ze(e(r)))),ae("click",ve,()=>Ze(e(r))),ae("keydown",ve,$=>v($,e(r))),i(d,ve)}),t(n),i(G,n)};m(wt,G=>{e(ke),s(()=>e(ke).length===0)?G(xt):G(St,!1)})}t(je),t(b),t(u),I(()=>{Oe.disabled=e(Q),lr(ot,(e(N),e(p),s(()=>e(N)[e(p)].search))),at(Re,"id",e(H)),ht!==(ht=(e(N),e(p),s(()=>e(N)[e(p)].typeFilter)))&&(Re.value=(Re.__value=(e(N),e(p),s(()=>e(N)[e(p)].typeFilter)))??"",cr(Re,(e(N),e(p),s(()=>e(N)[e(p)].typeFilter))))}),ae("click",Oe,g),ae("input",ot,G=>Ne(e(p),{search:G.currentTarget.value})),ae("change",Re,G=>Ne(e(p),{typeFilter:G.currentTarget.value})),i(o,u)};m(be,o=>{re()?o(Ce,!1):o(fe)})}var L=c(be,2);{let o=Ie(()=>(e(V),s(()=>e(V)?`Edit: ${e(V).title}`:"Submission Details")));ta(L,{get id(){return S},get title(){return e(o)},children:(u,b)=>{var k=At(),se=De(k);{var Oe=B=>{Ea(B,{get eventItem(){return e(U)},get drawerId(){return S},name:"my-submission-form",get canDelete(){return e(Z)},canCreate:!1})},pe=B=>{var Me=As();i(B,Me)};m(se,B=>{e(U)?B(Oe):B(pe,!1)})}i(u,k)},$$slots:{default:!0}})}i(_e,K),dt(),J()}var Os=_('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),Is=_('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),Ms=_('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),Ts=_('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),Cs=_('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1),Ps=_('<div class="calendar-section svelte-1oi0f59"><!></div>');function rn(_e,M){ct(M,!1);const T=f(),y=f(),R=f(),{stores:{currentUserHasPermission:re,authenticated:O}}=aa();let J=We(M,"showApprovals",8,!0),E=We(M,"showMySubmissions",8,!0),Z=We(M,"showAnnouncements",8,!0),H=We(M,"showSearch",8,!0),D=f(!1),te=f(!1);xa(()=>{const w=re.subscribe(Q=>{const Y=J()&&Q(Ee.ManageWardBusiness);l(D,Y)}),ne=O.subscribe(Q=>{l(te,Q)});return()=>{w(),ne()}}),x(()=>(A(J()),e(D)),()=>{l(T,J()&&e(D))}),x(()=>(A(E()),e(te)),()=>{l(y,E()&&e(te))}),x(()=>(e(T),e(y)),()=>{l(R,e(T)||e(y))}),Lt(),vt();var U=Ps(),W=a(U);{var F=w=>{var ne=Cs(),Q=De(ne),Y=a(Q),ke=c(a(Y),2);{var V=X=>{var le=Os();i(X,le)};m(ke,X=>{e(T)&&X(V)})}var S=c(ke,2);{var z=X=>{var le=Is();i(X,le)};m(S,X=>{e(y)&&X(z)})}t(Y),t(Q);var oe=c(Q,2),de=a(oe),$e=a(de);Ua($e,{get showAnnouncements(){return Z()},get showSearch(){return H()}}),t(de);var we=c(de,2);{var Se=X=>{var le=Ms(),He=a(le);yr(He,{}),t(le),i(X,le)};m(we,X=>{e(T)&&X(Se)})}var me=c(we,2);{var N=X=>{var le=Ts(),He=a(le);Ss(He,{}),t(le),i(X,le)};m(me,X=>{e(y)&&X(N)})}t(oe),i(w,ne)},ie=w=>{Ua(w,{get showAnnouncements(){return Z()},get showSearch(){return H()}})};m(W,w=>{e(R)?w(F):w(ie,!1)})}t(U),i(_e,U),dt()}export{rn as C};
