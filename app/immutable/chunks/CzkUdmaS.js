const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BS0ntuGW.js","./NZTpNUN0.js","./69_IOA4Y.js","./DIeogL5L.js","./JKZwkikK.js","./BxjzTaz1.js","./JDsN5plM.js","./DjNGvcU6.js","./B2BlSr7K.js","./B3-FYswd.js","./BJj6FIip.js","./CdnrWOl7.js","./BUApaBEI.js","./CdEA5IGF.js","./b8c_lO2i.js","./BQqQrYRK.js","./-RTKyBzb.js","../assets/Spinner.DTjfhZ6-.css","./BL6gm64P.js","./C_E5hxn_.js","./Bk8fdyPk.js","./r7-tBYgy.js","./C3UQkrtL.js","./CJoaubO9.js","../assets/confirm.ChDpDKXb.css","./BvzMQ0uj.js","./CmsKOCeN.js","../assets/AnnouncementWidgetItem.BsTuXRho.css"])))=>i.map(i=>d[i]);
import{_ as sa}from"./CmsKOCeN.js";import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{o as Ae}from"./DjNGvcU6.js";import{p as Se,aj as O,ak as De,f as L,g as t,a as Ie,E as m,s as u,D as d,c as n,r as a,u as v,t as B,R as bt,am as ra,w as et,an as oa}from"./JKZwkikK.js";import{p as ia,i as b,a as Oe,b as lt,e as X,s as it}from"./BxjzTaz1.js";import{e as St,i as la}from"./B2BlSr7K.js";import{f as l,a as o,c as ve}from"./JDsN5plM.js";import{s as z}from"./B3-FYswd.js";import{k as at,l as xe,m as da,t as ca,g as Te,p as P,f as h,P as yt,c as de}from"./BJj6FIip.js";import{i as We}from"./b8c_lO2i.js";import{g as Ne,A as je,c as ce,e as At,a as Ce,E as va,b as _a}from"./BS0ntuGW.js";import{S as Pe}from"./-RTKyBzb.js";import{v as Le,D as Re}from"./CTbmmusu.js";import{s as ma}from"./C3UQkrtL.js";function Me(nt,T,y){const w=at(nt,y),J=at(T,y),st=+w-xe(w),Q=+J-xe(J);return Math.round((st-Q)/da)}function $e(nt){const T=ca(nt);return T.setDate(1),T.setHours(0,0,0,0),T}var ua=l('<button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add event"><i class="bi bi-plus"></i></button>'),fa=l('<div class="event-actions svelte-i4p9jq"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit event"><i class="bi bi-pencil-square"></i></button></div>'),ga=l('<div class="daily-event-row svelte-i4p9jq"><div class="event-content svelte-i4p9jq"><!></div> <!></div>'),pa=l('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-i4p9jq"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),ba=l('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),ya=l('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),Ea=l('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),ka=l('<ul class="list-group list-group-flush border-top-0"></ul>'),ha=l('<div class="card-body text-muted small">There are no upcoming events this month.</div>'),wa=l('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),xa=l('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Ma=l('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),$a=l("<!> <!>",1),Aa=l('<div class="card-body text-muted small">There are no upcoming events scheduled.</div>'),Sa=l('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap"><span>Events</span> <div class="d-flex align-items-center gap-2 flex-wrap justify-content-end"><!> <!></div></div></div> <!></div>'),Da=l('<div class="d-flex flex-column gap-4"><!></div>'),Ia=l("<!> <!>",1);function en(nt,T){Se(T,!1);const y=()=>lt(q,"$weeksExpanded",Q),w=()=>lt(Ut,"$calendarEvents",Q),J=()=>lt(Ot,"$currentUserHasPermission",Q),st=()=>lt(Ft,"$ready",Q),[Q,dt]=Oe(),ct=m(),Dt=m(),It=m(),Et=m(),R=m(),Y=m(),A=m(),vt=m(),_t=m(),{stores:{currentUserHasPermission:Ot}}=Te(),{stores:{ready:Ft,calendarEvents:Ut,weeksExpanded:q},actions:{reload:Kt}}=Ne(),kt={title:"Event",description:"",location:"",event_type:"calendar_event"};let H=ia(T,"formId",24,Le),mt=m(!1),Tt=m(""),ht=m({...kt});const Wt=8,x=8;let g=m(Wt),W=m(!1);const Z=ma();let F=m({});function Nt(e){return e===t(Dt)||e===t(It)}function Vt(e){const s=t(F)[e]??Nt(e);d(F,{...t(F),[e]:!s})}const Bt=e=>{const s=new Map;for(const i of e){if(!i.start_time)continue;const r=P(i.start_time);if(Number.isNaN(r.getTime()))continue;const c=at(r,{weekStartsOn:1}),E=At(r,{weekStartsOn:1}),p=h(c,"yyyy-MM-dd"),ut=`${h(c,"MMM d")} – ${h(E,"MMM d")}`;let K=s.get(p);K||(K={key:p,label:ut,days:new Map},s.set(p,K));const f=h(r,"yyyy-MM-dd");let k=K.days.get(f);k||(k={key:f,displayDay:h(r,"EEE"),displayDate:h(r,"MMM d"),events:[]},K.days.set(f,k)),k.events.push(i)}const _=i=>{const r=h(i,"yyyy-MM-dd");s.has(r)||s.set(r,{key:r,label:`${h(i,"MMM d")} – ${h(At(i,{weekStartsOn:1}),"MMM d")}`,days:new Map})},M=Array.from(s.values());if(M.length){const i=M.reduce((E,p)=>p.key>E?p.key:E,M[0].key),r=P(i);let c=at(new Date,{weekStartsOn:1});if(c>r)_(c);else for(;c<=r;)_(c),c=ce(c,1)}return Array.from(s.values()).sort((i,r)=>i.key<r.key?-1:i.key>r.key?1:0).map(i=>({key:i.key,label:i.label,days:Array.from(i.days.values()).sort((r,c)=>r.key<c.key?-1:r.key>c.key?1:0).map(r=>({...r,events:r.events.slice().sort((c,E)=>{const p=c.is_all_day?0:1,ut=E.is_all_day?0:1;if(p!==ut)return p-ut;const K=c.start_time?P(c.start_time).getTime():Number.MAX_SAFE_INTEGER,f=E.start_time?P(E.start_time).getTime():Number.MAX_SAFE_INTEGER;return K-f})}))}))};function Xt(){d(g,t(g)+x)}function zt(){d(g,520),d(W,!0)}function S(){d(g,Wt),d(W,!1)}Ae(async()=>{d(mt,J()(yt.CreateEvents)||J()(yt.EditOwnOrgEvents)||J()(yt.EditAllEvents)),await Kt()});const D=async e=>{if(d(Tt,"Item Form"),e?.meta_data?.recurring_instance&&e?.meta_data?.recurring_parent_id){const{getCalendarEvent:s}=await sa(async()=>{const{getCalendarEvent:M}=await import("./BS0ntuGW.js").then(i=>i.h);return{getCalendarEvent:M}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url),_=await s(e.meta_data.recurring_parent_id);if(_){d(ht,{..._,category:_?.meta_data?.category,start_time:e.start_time,end_time:e.end_time,meta_data:{..._.meta_data,recurring_instance:!0,recurring_parent_id:e.meta_data.recurring_parent_id,recurring_instance_index:e.meta_data.recurring_instance_index}});return}}d(ht,{...e,category:e?.meta_data?.category})};O(()=>t(g),()=>{d(ct,ce(Z,t(g)))}),O(()=>at,()=>{d(Dt,h(at(Z,{weekStartsOn:1}),"yyyy-MM-dd"))}),O(()=>at,()=>{d(It,h(ce(at(Z,{weekStartsOn:1}),1),"yyyy-MM-dd"))}),O(()=>(y(),t(F)),()=>{d(Et,e=>y()?!0:t(F)[e]!==void 0?t(F)[e]:Nt(e))}),O(()=>(w(),t(ct)),()=>{d(R,(w()??[]).filter(e=>{if(!e.start_time)return!1;const s=P(e.start_time);return s>=Z&&s<=t(ct)}))}),O(()=>(w(),P),()=>{d(Y,(w()??[]).filter(e=>e.start_time?P(e.start_time)>=Z:!1))}),O(()=>t(R),()=>{d(A,Bt(t(R)))}),O(()=>(t(Y),t(R)),()=>{d(vt,t(Y).length>t(R).length)}),O(()=>(t(A),h),()=>{d(_t,t(A).reduce((e,s)=>{const _=P(s.key),M=At(_,{weekStartsOn:1}),i=h(M,"yyyy-MM"),r=h(M,"MMMM yyyy");return e[i]||(e[i]={label:r,weeks:[]}),e[i].weeks.push(s),e},{}))}),De(),We();var I=Ia(),N=L(I);Re(N,{get title(){return t(Tt)},get id(){return H()},children:(e,s)=>{je(e,{get eventItem(){return t(ht)},get drawerId(){return H()},name:"event-item-form"})},$$slots:{default:!0}});var rt=u(N,2);{var U=e=>{var s=Sa(),_=n(s),M=n(_),i=u(n(M),2),r=n(i);Ce(r,{});var c=u(r,2);{var E=f=>{var k=ua();B(()=>{z(k,"data-bs-target",`#${H()??""}`),z(k,"aria-controls",H())}),X("click",k,()=>D({...kt,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),o(f,k)};b(c,f=>{t(mt)&&f(E)})}a(i),a(M),a(_);var p=u(_,2);{var ut=f=>{var k=$a(),_e=L(k);{var qe=j=>{var V=ka();St(V,5,()=>(t(_t),v(()=>Object.entries(t(_t)))),([ot,jt])=>ot,(ot,jt)=>{var Jt=ra(()=>oa(t(jt),2));let ft=()=>t(Jt)[1];var Ct=Ea(),C=L(Ct),tt=n(C,!0);a(C);var Pt=u(C,2);St(Pt,1,()=>(ft(),v(()=>ft().weeks)),wt=>wt.key,(wt,$)=>{const me=bt(()=>(et(P),t($),v(()=>P(t($).key)))),Lt=bt(()=>(et(At),et(t(me)),v(()=>At(t(me),{weekStartsOn:1})))),ue=bt(()=>(et($e),et(t(Lt)),v(()=>$e(t(Lt))))),Ke=bt(()=>(et(Me),et(t(Lt)),et(t(ue)),v(()=>Me(t(Lt),t(ue),{weekStartsOn:1})+1))),Qt=bt(()=>(t(Et),t($),v(()=>t(Et)(t($).key)))),Rt=bt(()=>(t($),v(()=>t($).days.reduce((Mt,qt)=>Mt+qt.events.length,0))));var fe=ya(),Yt=L(fe),xt=n(Yt);let ge;var Zt=n(xt),pe=n(Zt),be=u(pe,2),Ve=n(be);a(be),a(Zt);var Gt=u(Zt,2);let ye;var Be=n(Gt,!0);a(Gt),a(xt),a(Yt);var Xe=u(Yt,2);{var ze=Mt=>{var qt=ve(),Je=L(qt);{var Qe=gt=>{var Ht=ve(),Ze=L(Ht);St(Ze,1,()=>(t($),v(()=>t($).days)),te=>te.key,(te,pt)=>{var ee=pa(),Ee=n(ee),ae=n(Ee),ne=n(ae),Ge=n(ne,!0);a(ne);var ke=u(ne,2),ta=n(ke,!0);a(ke),a(ae);var he=u(ae,2);St(he,5,()=>(t(pt),v(()=>t(pt).events)),$t=>$t.id??`${$t.start_time}-${$t.meta_data?.recurring_instance_index??0}`,($t,we)=>{var se=ga(),re=n(se),ea=n(re);va(ea,{get item(){return t(we)},showDate:!1}),a(re);var aa=u(re,2);{var na=oe=>{var ie=fa(),le=n(ie);a(ie),B(()=>{z(le,"data-bs-target",`#${H()??""}`),z(le,"aria-controls",H())}),X("click",le,()=>D(t(we))),o(oe,ie)};b(aa,oe=>{t(mt)&&oe(na)})}a(se),o($t,se)}),a(he),a(Ee),a(ee),B(()=>{it(Ge,(t(pt),v(()=>t(pt).displayDay))),it(ta,(t(pt),v(()=>t(pt).displayDate)))}),o(te,ee)}),o(gt,Ht)},Ye=gt=>{var Ht=ba();o(gt,Ht)};b(Je,gt=>{t($),v(()=>t($).days.length)?gt(Qe):gt(Ye,!1)})}o(Mt,qt)};b(Xe,Mt=>{t(Qt)&&Mt(ze)})}B(()=>{ge=de(xt,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-i4p9jq",null,ge,{"text-muted":t(Rt)===0}),z(xt,"title",t(Qt)?"Click to collapse week":"Click to expand week"),de(pe,1,`bi ${t(Qt)?"bi-chevron-up":"bi-chevron-down"}`),it(Ve,`Week ${t(Ke)??""} [${t(Rt)??""} Event${t(Rt)===1?"":"s"}]`),ye=de(Gt,1,"",null,ye,{"opacity-50":t(Rt)===0}),it(Be,(t($),v(()=>t($).label)))}),X("click",xt,()=>Vt(t($).key)),o(wt,fe)}),B(()=>it(tt,(ft(),v(()=>ft().label)))),o(ot,Ct)}),a(V),o(j,V)},He=j=>{var V=ha();o(j,V)};b(_e,j=>{t(A),v(()=>t(A).length)?j(qe):j(He,!1)})}var Fe=u(_e,2);{var Ue=j=>{var V=Ma(),ot=n(V),jt=n(ot);a(ot);var Jt=u(ot,2);{var ft=C=>{var tt=wa();X("click",tt,S),o(C,tt)},Ct=C=>{var tt=xa(),Pt=n(tt),wt=u(Pt,2);a(tt),X("click",Pt,Xt),X("click",wt,zt),o(C,tt)};b(Jt,C=>{t(W)?C(ft):C(Ct,!1)})}a(V),B(()=>it(jt,`Showing ${t(R),v(()=>t(R).length)??""} of ${t(Y),v(()=>t(Y).length)??""} future events`)),o(j,V)};b(Fe,j=>{(t(vt)||t(W))&&j(Ue)})}o(f,k)},K=f=>{var k=Aa();o(f,k)};b(p,f=>{w(),v(()=>w()?.length)?f(ut):f(K,!1)})}a(s),o(e,s)},G=e=>{var s=Da(),_=n(s);Pe(_,{}),a(s),o(e,s)};b(rt,e=>{st()?e(U):e(G,!1)})}o(nt,I),Ie(),dt()}var Oa=l('<!> <button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add announcement"><i class="bi bi-plus"></i></button>',1),Ta=l('<div class="announcement-actions svelte-1axao39"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit announcement"><i class="bi bi-pencil-square"></i></button></div>'),Wa=l('<li class="list-group-item py-2"><div class="announcement-row svelte-1axao39"><div class="announcement-content svelte-1axao39"><!></div> <!></div></li>'),Na=l('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),ja=l('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Ca=l('<div class="card-body"><div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> No announcements yet.</div></div>'),Pa=l('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center"><span>Announcements</span> <div class="d-flex align-items-center gap-2"><!></div></div></div> <!></div>'),La=l('<div class="d-flex flex-column gap-4"><!></div>'),Ra=l("<!> <!>",1);function an(nt,T){Se(T,!1);const y=()=>lt(Et,"$announcements",st),w=()=>lt(Dt,"$currentUserHasPermission",st),J=()=>lt(It,"$ready",st),[st,Q]=Oe(),dt=m(),ct=m(),{stores:{currentUserHasPermission:Dt}}=Te(),{stores:{ready:It,announcements:Et},actions:{reload:R}}=Ne(),Y={title:"Announcement",description:"",location:"",event_type:"announcement"},A=Le();let vt=m(!1),_t=m(""),Ot=m({...Y});const Ft=5,Ut=5;let q=m(Ft);function Kt(){d(q,t(q)+Ut)}Ae(async()=>{d(vt,w()(yt.CreateEvents)||w()(yt.EditOwnOrgEvents)||w()(yt.EditAllEvents)),await R()});const kt=x=>{d(_t,"Announcement Form"),d(Ot,{...x,category:x?.meta_data?.category})};O(()=>(y(),t(q)),()=>{d(dt,(y()??[]).slice(0,t(q)))}),O(()=>(y(),t(q)),()=>{d(ct,(y()?.length??0)>t(q))}),De(),We();var H=Ra(),mt=L(H);Re(mt,{get title(){return t(_t)},get id(){return A},children:(x,g)=>{je(x,{get eventItem(){return t(Ot)},get drawerId(){return A},name:"announcement-item-form"})},$$slots:{default:!0}});var Tt=u(mt,2);{var ht=x=>{var g=Pa(),W=n(g),Z=n(W),F=u(n(Z),2),Nt=n(F);{var Vt=S=>{var D=Oa(),I=L(D);Ce(I,{});var N=u(I,2);B(()=>{z(N,"data-bs-target",`#${A??""}`),z(N,"aria-controls",A)}),X("click",N,()=>kt({...Y,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),o(S,D)};b(Nt,S=>{t(vt)&&S(Vt)})}a(F),a(Z),a(W);var Bt=u(W,2);{var Xt=S=>{var D=ja(),I=L(D);St(I,5,()=>t(dt),la,(U,G)=>{var e=Wa(),s=n(e),_=n(s),M=n(_);_a(M,{get item(){return t(G)}}),a(_);var i=u(_,2);{var r=c=>{var E=Ta(),p=n(E);a(E),B(()=>{z(p,"data-bs-target",`#${A??""}`),z(p,"aria-controls",A)}),X("click",p,()=>kt(t(G))),o(c,E)};b(i,c=>{t(vt)&&c(r)})}a(s),a(e),o(U,e)}),a(I);var N=u(I,2);{var rt=U=>{var G=Na(),e=n(G),s=n(e);a(e);var _=u(e,2);a(G),B(()=>it(s,`Showing ${t(q)??""} of ${y(),v(()=>y()?.length??0)??""}`)),X("click",_,Kt),o(U,G)};b(N,U=>{t(ct)&&U(rt)})}o(S,D)},zt=S=>{var D=ve(),I=L(D);{var N=rt=>{var U=Ca();o(rt,U)};b(I,rt=>{y(),v(()=>y()?.length===0)&&rt(N)},!0)}o(S,D)};b(Bt,S=>{t(dt),v(()=>t(dt).length)?S(Xt):S(zt,!1)})}a(g),o(x,g)},Wt=x=>{var g=La(),W=n(g);Pe(W,{}),a(g),o(x,g)};b(Tt,x=>{J()?x(ht):x(Wt,!1)})}o(nt,H),Ie(),Q()}export{an as A,en as E,Me as d,$e as s};
