const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D3Za5WVB.js","./CPOcesE7.js","./DIeogL5L.js","./YsHTGu5k.js","./NZTpNUN0.js","./69_IOA4Y.js","./opPvMm1W.js","./DHXte27T.js","./DAwrR-3T.js","./BC54fyhh.js","./WMDXKID8.js","./BumJcB3f.js","./BUApaBEI.js","./C2Q_9cr2.js","./DwmScgcp.js","../assets/Spinner.DTjfhZ6-.css","./DvoWelOD.js","./oOlFimUz.js","../assets/BishopricApprovalSection.B-dYZRxm.css"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{o as Yt}from"./DHXte27T.js";import{p as Zt,ai as v,g as e,aj as Gt,f as ee,a as ea,E as i,s as p,D as a,c as s,r,u,t as te,R as Se,an as wa,w as ve,ao as Ma}from"./CPOcesE7.js";import{b,i as y,a as ta,e as ae,s as pe,p as $a}from"./opPvMm1W.js";import{e as Je,i as Ia}from"./DAwrR-3T.js";import{f as d,a as o,c as Rt,t as De}from"./YsHTGu5k.js";import{s as re}from"./BC54fyhh.js";import{i as aa}from"./C2Q_9cr2.js";import{k as de,l as Vt,m as Oa,t as Aa,g as ra,O as mt,P as w,p as V,f as x,c as Nt}from"./WMDXKID8.js";import{A as na,b as Sa,c as sa,a as Da,E as Ua}from"./DIlLOA3e.js";import{g as oa,c as Pt,e as Xe}from"./D3Za5WVB.js";import{S as ia}from"./DwmScgcp.js";import{v as la,D as ca}from"./D7gM6UT6.js";import{_ as Ta}from"./CmsKOCeN.js";import{s as Wa}from"./oOlFimUz.js";function Xt(ue,z,S){const m=de(ue,S),B=de(z,S),me=+m-Vt(m),M=+B-Vt(B);return Math.round((me-M)/Oa)}function Jt(ue){const z=Aa(ue);return z.setDate(1),z.setHours(0,0,0,0),z}var Na=d('<button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add announcement"><i class="bi bi-plus"></i></button>'),Pa=d('<div class="announcement-actions svelte-1axao39"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit announcement"><i class="bi bi-pencil-square"></i></button></div>'),Ra=d('<li class="list-group-item py-2"><div class="announcement-row svelte-1axao39"><div class="announcement-content svelte-1axao39"><!></div> <!></div></li>'),Ca=d('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),ja=d('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),La=d('<div class="card-body text-muted small"><!></div>'),za=d('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center"><span>Announcements</span> <!></div></div> <!></div>'),Ba=d('<div class="d-flex flex-column gap-4"><!></div>'),qa=d("<!> <!>",1);function xr(ue,z){Zt(z,!1);const S=()=>b(et,"$searchQuery",q),m=()=>b(Ne,"$announcements",q),B=()=>b(Ze,"$currentUser",q),me=()=>b(_e,"$userOrganizations",q),M=()=>b(We,"$currentUserHasPermission",q),N=()=>b(X,"$currentUserIsRoot",q),Ue=()=>b(H,"$currentUserIsAdmin",q),Ye=()=>b(Ge,"$ready",q),[q,P]=ta(),ye=i(),be=i(),Te=i(),{stores:{currentUser:Ze,currentUserHasPermission:We,currentUserIsAdmin:H,currentUserIsRoot:X,userOrganizations:_e}}=ra(),{stores:{ready:Ge,announcements:Ne,searchQuery:et},actions:{reload:_t}}=oa(),tt={title:"Announcement",description:"",location:"",event_type:"announcement",is_public:!0},ne=la();let at=i(!1),Ee=i(!1),he=i(),Pe=i(!1),Re=i(!1),ke=i(!1),xe=i(new Set),Ce=i(""),J=i({...tt});const rt=5,we=5;let D=i(rt);function je(){a(D,e(D)+we)}const Le=g=>sa(g,{currentUserId:e(he),isPrivileged:e(Ee),canEditOwnOrgEvents:e(ke),userOrganizations:e(xe)});Yt(async()=>{await _t()});const fe=g=>{a(Ce,"Announcement Form"),a(J,{...g,category:g?.meta_data?.category})};v(()=>(S(),m(),e(D)),()=>{a(ye,S()?m()??[]:(m()??[]).slice(0,e(D)))}),v(()=>(S(),m(),e(D)),()=>{a(be,!S()&&(m()?.length??0)>e(D))}),v(()=>B(),()=>{a(he,B()?.id)}),v(()=>e(he),()=>{a(Re,!!e(he))}),v(()=>me(),()=>{a(xe,me())}),v(()=>(e(xe),mt),()=>{a(Pe,e(xe).has(mt.Bishopric))}),v(()=>(M(),w),()=>{a(ke,M()(w.EditOwnOrgEvents))}),v(()=>(N(),Ue(),e(Pe),M(),w),()=>{a(Ee,N()||Ue()||e(Pe)||M()(w.EditAllEvents))}),v(()=>(e(Ee),M(),e(ke),e(Re)),()=>{a(at,e(Ee)||M()(w.CreateEvents)||e(ke)||e(Re))}),v(()=>(M(),w),()=>{a(Te,M()(w.DeleteEvents))}),Gt(),aa();var ge=qa(),ze=ee(ge);ca(ze,{get title(){return e(Ce)},get id(){return ne},children:(g,$)=>{na(g,{get eventItem(){return e(J)},get drawerId(){return ne},name:"announcement-item-form",get canDelete(){return e(Te)}})},$$slots:{default:!0}});var Be=p(ze,2);{var nt=g=>{var $=za(),Q=s($),Y=s(Q),st=p(s(Y),2);{var gt=U=>{var T=Na();te(()=>{re(T,"data-bs-target",`#${ne??""}`),re(T,"aria-controls",ne)}),ae("click",T,()=>fe({...tt,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),o(U,T)};y(st,U=>{e(at)&&U(gt)})}r(Y),r(Q);var pt=p(Q,2);{var yt=U=>{var T=ja(),se=ee(T);Je(se,5,()=>e(ye),Ia,(R,W)=>{var C=Ra(),t=s(C),n=s(t),f=s(n);Sa(f,{get item(){return e(W)},get searchQuery(){return S()}}),r(n);var I=p(n,2);{var c=l=>{var _=Pa(),k=s(_);r(_),te(()=>{re(k,"data-bs-target",`#${ne??""}`),re(k,"aria-controls",ne)}),ae("click",k,()=>fe(e(W))),o(l,_)};y(I,l=>{e(W),u(()=>Le(e(W)))&&l(c)})}r(t),r(C),o(R,C)}),r(se);var Me=p(se,2);{var oe=R=>{var W=Ca(),C=s(W),t=s(C);r(C);var n=p(C,2);r(W),te(()=>pe(t,`Showing ${e(D)??""} of ${m(),u(()=>m()?.length??0)??""}`)),ae("click",n,je),o(R,W)};y(Me,R=>{e(be)&&R(oe)})}o(U,T)},bt=U=>{var T=Rt(),se=ee(T);{var Me=oe=>{var R=La(),W=s(R);{var C=n=>{var f=De("No announcements match your search.");o(n,f)},t=n=>{var f=De("There are no announcements yet.");o(n,f)};y(W,n=>{S()?n(C):n(t,!1)})}r(R),o(oe,R)};y(se,oe=>{m(),u(()=>m()?.length===0)&&oe(Me)},!0)}o(U,T)};y(pt,U=>{e(ye),u(()=>e(ye).length)?U(yt):U(bt,!1)})}r($),o(g,$)},ft=g=>{var $=Ba(),Q=s($);ia(Q,{}),r($),o(g,$)};y(Be,g=>{Ye()?g(nt):g(ft,!1)})}o(ue,ge),ea(),P()}var Ha=d('<button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add event"><i class="bi bi-plus"></i></button>'),Qa=d('<div class="event-actions svelte-i4p9jq"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit event"><i class="bi bi-pencil-square"></i></button></div>'),Fa=d('<div class="daily-event-row svelte-i4p9jq"><div class="event-content svelte-i4p9jq"><!></div> <!></div>'),Ka=d('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-i4p9jq"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Va=d('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),Xa=d('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),Ja=d('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),Ya=d('<ul class="list-group list-group-flush border-top-0"></ul>'),Za=d('<div class="card-body text-muted small"><!></div>'),Ga=d('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),er=d('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),tr=d('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),ar=d("<!> <!>",1),rr=d('<div class="card-body text-muted small"><!></div>'),nr=d('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center"><span>Events</span> <div class="d-flex align-items-center gap-2"><!> <!></div></div></div> <!></div>'),sr=d('<div class="d-flex flex-column gap-4"><!></div>'),or=d("<!> <!>",1);function wr(ue,z){Zt(z,!1);const S=()=>b(Re,"$weeksExpanded",P),m=()=>b(ke,"$searchQuery",P),B=()=>b(Pe,"$calendarEvents",P),me=()=>b(_t,"$currentUser",P),M=()=>b(Ee,"$userOrganizations",P),N=()=>b(tt,"$currentUserHasPermission",P),Ue=()=>b(at,"$currentUserIsRoot",P),Ye=()=>b(ne,"$currentUserIsAdmin",P),q=()=>b(he,"$ready",P),[P,ye]=ta(),be=i(),Te=i(),Ze=i(),We=i(),H=i(),X=i(),_e=i(),Ge=i(),Ne=i(),et=i(),{stores:{currentUser:_t,currentUserHasPermission:tt,currentUserIsAdmin:ne,currentUserIsRoot:at,userOrganizations:Ee}}=ra(),{stores:{ready:he,calendarEvents:Pe,weeksExpanded:Re,searchQuery:ke},actions:{reload:xe}}=oa(),Ce={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let J=$a(z,"formId",24,la),rt=i(!1),we=i(!1),D=i(),je=i(!1),Le=i(!1),fe=i(!1),ge=i(new Set),ze=i(""),Be=i({...Ce});const nt=8,ft=8;let g=i(nt),$=i(!1);const Q=Wa();let Y=i({});function st(t){return t===e(Te)||t===e(Ze)}function gt(t){const n=e(Y)[t]??st(t);a(Y,{...e(Y),[t]:!n})}const pt=t=>{const n=new Map;for(const c of t){if(!c.start_time)continue;const l=V(c.start_time);if(Number.isNaN(l.getTime()))continue;const _=de(l,{weekStartsOn:1}),k=Xe(l,{weekStartsOn:1}),j=x(_,"yyyy-MM-dd"),$e=`${x(_,"MMM d")} – ${x(k,"MMM d")}`;let Z=n.get(j);Z||(Z={key:j,label:$e,days:new Map},n.set(j,Z));const E=x(l,"yyyy-MM-dd");let h=Z.days.get(E);h||(h={key:E,displayDay:x(l,"EEE"),displayDate:x(l,"MMM d"),events:[]},Z.days.set(E,h)),h.events.push(c)}const f=c=>{const l=x(c,"yyyy-MM-dd");n.has(l)||n.set(l,{key:l,label:`${x(c,"MMM d")} – ${x(Xe(c,{weekStartsOn:1}),"MMM d")}`,days:new Map})},I=Array.from(n.values());if(I.length){const c=I.reduce((k,j)=>j.key>k?j.key:k,I[0].key),l=V(c);let _=de(new Date,{weekStartsOn:1});if(_>l)f(_);else for(;_<=l;)f(_),_=Pt(_,1)}return Array.from(n.values()).sort((c,l)=>c.key<l.key?-1:c.key>l.key?1:0).map(c=>({key:c.key,label:c.label,days:Array.from(c.days.values()).sort((l,_)=>l.key<_.key?-1:l.key>_.key?1:0).map(l=>({...l,events:l.events.slice().sort((_,k)=>{const j=_.is_all_day?0:1,$e=k.is_all_day?0:1;if(j!==$e)return j-$e;const Z=_.start_time?V(_.start_time).getTime():Number.MAX_SAFE_INTEGER,E=k.start_time?V(k.start_time).getTime():Number.MAX_SAFE_INTEGER;return Z-E})}))}))};function yt(){a(g,e(g)+ft)}function bt(){a(g,520),a($,!0)}function U(){a(g,nt),a($,!1)}const T=t=>sa(t,{currentUserId:e(D),isPrivileged:e(we),canEditOwnOrgEvents:e(fe),userOrganizations:e(ge)});Yt(async()=>{await xe()});const se=async t=>{if(a(ze,"Item Form"),t?.meta_data?.recurring_instance&&t?.meta_data?.recurring_parent_id){const{getCalendarEvent:n}=await Ta(async()=>{const{getCalendarEvent:I}=await import("./D3Za5WVB.js").then(c=>c.s);return{getCalendarEvent:I}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]),import.meta.url),f=await n(t.meta_data.recurring_parent_id);if(f){a(Be,{...f,category:f?.meta_data?.category,start_time:t.start_time,end_time:t.end_time,meta_data:{...f.meta_data,recurring_instance:!0,recurring_parent_id:t.meta_data.recurring_parent_id,recurring_instance_index:t.meta_data.recurring_instance_index}});return}}a(Be,{...t,category:t?.meta_data?.category})};v(()=>e(g),()=>{a(be,Pt(Q,e(g)))}),v(()=>de,()=>{a(Te,x(de(Q,{weekStartsOn:1}),"yyyy-MM-dd"))}),v(()=>de,()=>{a(Ze,x(Pt(de(Q,{weekStartsOn:1}),1),"yyyy-MM-dd"))}),v(()=>(S(),m(),e(Y)),()=>{a(We,t=>S()||m()?!0:e(Y)[t]!==void 0?e(Y)[t]:st(t))}),v(()=>(B(),V),()=>{a(H,(B()??[]).filter(t=>t.start_time?V(t.start_time)>=Q:!1))}),v(()=>(m(),e(H),e(be)),()=>{a(X,m()?e(H):e(H).filter(t=>V(t.start_time)<=e(be)))}),v(()=>e(X),()=>{a(_e,pt(e(X)))}),v(()=>(m(),e(H),e(X)),()=>{a(Ge,!m()&&e(H).length>e(X).length)}),v(()=>(e(_e),x),()=>{a(Ne,e(_e).reduce((t,n)=>{const f=V(n.key),I=Xe(f,{weekStartsOn:1}),c=x(I,"yyyy-MM"),l=x(I,"MMMM yyyy");return t[c]||(t[c]={label:l,weeks:[]}),t[c].weeks.push(n),t},{}))}),v(()=>me(),()=>{a(D,me()?.id)}),v(()=>e(D),()=>{a(Le,!!e(D))}),v(()=>M(),()=>{a(ge,M())}),v(()=>(e(ge),mt),()=>{a(je,e(ge).has(mt.Bishopric))}),v(()=>(N(),w),()=>{a(fe,N()(w.EditOwnOrgEvents))}),v(()=>(Ue(),Ye(),e(je),N(),w),()=>{a(we,Ue()||Ye()||e(je)||N()(w.EditAllEvents))}),v(()=>(e(we),N(),e(fe),e(Le)),()=>{a(rt,e(we)||N()(w.CreateEvents)||e(fe)||e(Le))}),v(()=>(N(),w),()=>{a(et,N()(w.DeleteEvents))}),Gt(),aa();var Me=or(),oe=ee(Me);ca(oe,{get title(){return e(ze)},get id(){return J()},children:(t,n)=>{na(t,{get eventItem(){return e(Be)},get drawerId(){return J()},name:"event-item-form",get canDelete(){return e(et)}})},$$slots:{default:!0}});var R=p(oe,2);{var W=t=>{var n=nr(),f=s(n),I=s(f),c=p(s(I),2),l=s(c);Da(l,{});var _=p(l,2);{var k=E=>{var h=Ha();te(()=>{re(h,"data-bs-target",`#${J()??""}`),re(h,"aria-controls",J())}),ae("click",h,()=>se({...Ce,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),o(E,h)};y(_,E=>{e(rt)&&E(k)})}r(c),r(I),r(f);var j=p(f,2);{var $e=E=>{var h=ar(),ot=ee(h);{var Et=F=>{var L=Ya();Je(L,5,()=>(e(Ne),u(()=>Object.entries(e(Ne)))),([G,Ie])=>G,(G,Ie)=>{var He=wa(()=>Ma(e(Ie),2));let O=()=>e(He)[1];var le=Ja(),K=ee(le),ce=s(K,!0);r(K);var it=p(K,2);Je(it,1,()=>(O(),u(()=>O().weeks)),Qe=>Qe.key,(Qe,A)=>{const Ct=Se(()=>(ve(V),e(A),u(()=>V(e(A).key)))),lt=Se(()=>(ve(Xe),ve(e(Ct)),u(()=>Xe(e(Ct),{weekStartsOn:1})))),jt=Se(()=>(ve(Jt),ve(e(lt)),u(()=>Jt(e(lt))))),va=Se(()=>(ve(Xt),ve(e(lt)),ve(e(jt)),u(()=>Xt(e(lt),e(jt),{weekStartsOn:1})+1))),kt=Se(()=>(e(We),e(A),u(()=>e(We)(e(A).key)))),ct=Se(()=>(e(A),u(()=>e(A).days.reduce((Ke,vt)=>Ke+vt.events.length,0))));var Lt=Xa(),xt=ee(Lt),Fe=s(xt);let zt;var wt=s(Fe),Bt=s(wt),qt=p(Bt,2),da=s(qt);r(qt),r(wt);var Mt=p(wt,2);let Ht;var ua=s(Mt,!0);r(Mt),r(Fe),r(xt);var ma=p(xt,2);{var _a=Ke=>{var vt=Rt(),fa=ee(vt);{var ga=Oe=>{var dt=Rt(),ya=ee(dt);Je(ya,1,()=>(e(A),u(()=>e(A).days)),$t=>$t.key,($t,Ae)=>{var It=Ka(),Qt=s(It),Ot=s(Qt),At=s(Ot),ba=s(At,!0);r(At);var Ft=p(At,2),Ea=s(Ft,!0);r(Ft),r(Ot);var Kt=p(Ot,2);Je(Kt,5,()=>(e(Ae),u(()=>e(Ae).events)),Ve=>Ve.id??`${Ve.start_time}-${Ve.meta_data?.recurring_instance_index??0}`,(Ve,ut)=>{var St=Fa(),Dt=s(St),ha=s(Dt);Ua(ha,{get item(){return e(ut)},showDate:!1,get searchQuery(){return m()}}),r(Dt);var ka=p(Dt,2);{var xa=Ut=>{var Tt=Qa(),Wt=s(Tt);r(Tt),te(()=>{re(Wt,"data-bs-target",`#${J()??""}`),re(Wt,"aria-controls",J())}),ae("click",Wt,()=>se(e(ut))),o(Ut,Tt)};y(ka,Ut=>{e(ut),u(()=>T(e(ut)))&&Ut(xa)})}r(St),o(Ve,St)}),r(Kt),r(Qt),r(It),te(()=>{pe(ba,(e(Ae),u(()=>e(Ae).displayDay))),pe(Ea,(e(Ae),u(()=>e(Ae).displayDate)))}),o($t,It)}),o(Oe,dt)},pa=Oe=>{var dt=Va();o(Oe,dt)};y(fa,Oe=>{e(A),u(()=>e(A).days.length)?Oe(ga):Oe(pa,!1)})}o(Ke,vt)};y(ma,Ke=>{e(kt)&&Ke(_a)})}te(()=>{zt=Nt(Fe,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-i4p9jq",null,zt,{"text-muted":e(ct)===0}),re(Fe,"title",e(kt)?"Click to collapse week":"Click to expand week"),Nt(Bt,1,`bi ${e(kt)?"bi-chevron-up":"bi-chevron-down"}`),pe(da,`Week ${e(va)??""} [${e(ct)??""} Event${e(ct)===1?"":"s"}]`),Ht=Nt(Mt,1,"",null,Ht,{"opacity-50":e(ct)===0}),pe(ua,(e(A),u(()=>e(A).label)))}),ae("click",Fe,()=>gt(e(A).key)),o(Qe,Lt)}),te(()=>pe(ce,(O(),u(()=>O().label)))),o(G,le)}),r(L),o(F,L)},ht=F=>{var L=Za(),G=s(L);{var Ie=O=>{var le=De("No events match your search.");o(O,le)},He=O=>{var le=De("There are no upcoming events this month.");o(O,le)};y(G,O=>{m()?O(Ie):O(He,!1)})}r(L),o(F,L)};y(ot,F=>{e(_e),u(()=>e(_e).length)?F(Et):F(ht,!1)})}var ie=p(ot,2);{var qe=F=>{var L=tr(),G=s(L),Ie=s(G);r(G);var He=p(G,2);{var O=K=>{var ce=Ga();ae("click",ce,U),o(K,ce)},le=K=>{var ce=er(),it=s(ce),Qe=p(it,2);r(ce),ae("click",it,yt),ae("click",Qe,bt),o(K,ce)};y(He,K=>{e($)?K(O):K(le,!1)})}r(L),te(()=>pe(Ie,`Showing ${e(X),u(()=>e(X).length)??""} of ${e(H),u(()=>e(H).length)??""} future events`)),o(F,L)};y(ie,F=>{(e(Ge)||e($))&&F(qe)})}o(E,h)},Z=E=>{var h=rr(),ot=s(h);{var Et=ie=>{var qe=De("No events match your search.");o(ie,qe)},ht=ie=>{var qe=De("There are no upcoming events scheduled.");o(ie,qe)};y(ot,ie=>{m()?ie(Et):ie(ht,!1)})}r(h),o(E,h)};y(j,E=>{B(),u(()=>B()?.length)?E($e):E(Z,!1)})}r(n),o(t,n)},C=t=>{var n=sr(),f=s(n);ia(f,{}),r(n),o(t,n)};y(R,t=>{q()?t(W):t(C,!1)})}o(ue,Me),ea(),ye()}export{xr as A,wr as E,Xt as d,Jt as s};
