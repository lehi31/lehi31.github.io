const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{p as dt,ai as ze,D as F,E as oe,n as te,m as i,aj as It,c as H,s as j,u as J,r as B,B as pe,a as ut,f as Qe,F as Je,C as dr,ap as Mn,R as st,as as nr,v as Cn}from"./BWCcv1pC.js";import{p as me,i as he,e as Ie,s as xe,m as Fn,u as Un,b as ar,a as On}from"./KiCntiD6.js";import{f as ue,a as re,c as ir,t as wt}from"./DqgkBxsg.js";import{e as $t,i as Or}from"./CvOYN50o.js";import{h as sr,c as Ut,b as Ot,t as _t,e as kr,D as Pn,i as Et,l as Bn,m as Ln,u as zn,n as Pr,o as Mt,p as At,q as Br,g as Hn,r as Nn,B as qn,s as Wn,v as Yn,w as jn}from"./BOsxNJ5s.js";import{e as $n,s as Oe,b as ur,r as Ve}from"./CDrl09S1.js";import{t as Lr,f as et,j as Qn,i as Ne,p as Pt,A as Ke,e as zr,G as Vn,O as Fe,a as lr}from"./DnVuGurV.js";import{s as Tr}from"./CdEA5IGF.js";import{i as gt}from"./BeNQ5BU7.js";import{R as Ue}from"./DcWZ5Z_E.js";import{_ as zt}from"./CmsKOCeN.js";import{c as Kn,o as Hr,w as Gn,g as fr,a as Zn}from"./CuVcyAaV.js";import{S as Nr}from"./TQLXPvU9.js";import{b as ct,a as mr,c as or}from"./CzDGc265.js";import{b as St}from"./DAqDie1R.js";import{b as pt}from"./Drf-2KpF.js";import{t as ht}from"./r7-tBYgy.js";import{c as Xn}from"./BpWKR3N1.js";import{c as Jn,a as lt,e as Rr,f as ea,d as ta,V as ra}from"./Bai7YTd4.js";import{p as Ht}from"./Cn0GwYpZ.js";import{a as Nt}from"./D9dADsae.js";import{v as na,D as aa}from"./pEAXO0Hl.js";function ia(g,m){const x=Lr(g);return x.setHours(m),x}function sa(g,m){const x=Lr(g);return x.setMinutes(m),x}var la=ue('<div style="min-width: 85px !important;"><strong> </strong> <div><small class="d-block"> </small></div></div>'),oa=ue('<span class="d-block text-uppercase small fw-semibold svelte-lx28z">All Day</span>'),ca=ue('<span class="d-block small svelte-lx28z"> </span>'),da=ue('<span class="text-muted">•</span>'),ua=ue("<span> </span> <!>",1),fa=ue('<span class="text-muted">•</span>'),va=ue('<span class="text-muted small svelte-lx28z"><i class="bi bi-arrow-repeat"></i> </span> <!>',1),ma=ue('<span class="text-muted">•</span>'),ha=ue('<span class="text-muted small svelte-lx28z"><i class="bi bi-arrow-repeat"></i> Recurring event</span> <!>',1),ga=ue('<span class="text-muted">•</span>'),ya=ue('<em class="small fw-lighter svelte-lx28z"><!></em> <!>',1),_a=ue('<em class="small fw-lighter text-decoration-underline svelte-lx28z"><!> details</em>'),pa=ue('<div class="small svelte-lx28z"><!></div>'),ba=ue('<div class="attachment-image-container svelte-lx28z"><button type="button" class="attachment-image-button svelte-lx28z"><img class="attachment-image svelte-lx28z"/></button> <div class="attachment-image-label svelte-lx28z"><small class="text-muted"> </small></div></div>'),wa=ue('<button type="button" class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-2"><i class="bi bi-file-pdf"></i> <span class="text-truncate" style="max-width: 150px;"> </span> <small class="text-muted"> </small></button>'),xa=ue('<div class="mt-1 svelte-lx28z"><div class="fw-semibold small mb-1 svelte-lx28z">Attachments:</div> <div class="d-flex flex-wrap gap-2"></div></div>'),Ea=ue('<div class="small text-muted posted-meta svelte-lx28z">Posted <!> <!></div>'),Aa=ue('<div class="small text-muted posted-meta svelte-lx28z">Last edited <!> <!></div>'),Da=ue('<div class="details-container svelte-lx28z"><!> <!> <!> <!></div>'),Sa=ue('<div class="event-thumbnail-container svelte-lx28z"><img class="event-thumbnail svelte-lx28z"/></div>'),Ia=ue('<div role="button" tabindex="0"><!> <div class="d-flex gap-1"><div class="d-flex flex-column flex-grow-1 gap-1 svelte-lx28z"><div class="fw-bold svelte-lx28z"><!></div> <!> <div class="flex d-flex align-items-center flex-wrap gap-2"><!> <!> <!> <!></div> <!></div> <!></div></div>');function ws(g,m){dt(m,!1);const x=oe(),s=oe(),e=oe(),r=oe(),d=oe(),o=oe(),y=oe(),_=oe(),a=oe();let t=me(m,"item",8),n=me(m,"showDetails",12,!1),c=me(m,"showDate",8,!0),l=me(m,"searchQuery",8,"");const S=Q=>{if(!Q)return"";const Z=Pt(Q),V=_t(Z,Ke);return Ne(V,"h:mm aa")},M=Q=>{if(!Q)return"";const Z=Pt(Q),V=_t(Z,Ke);return Ne(V,"EEE")},w=Q=>{if(!Q)return"";const Z=Pt(Q),V=_t(Z,Ke);return Ne(V,"MMM, dd")},L=()=>{i(s)&&n(!n())},U=Q=>{i(s)&&(Q.key==="Enter"||Q.key===" ")&&L()},C=Q=>Q<1024?Q+" B":Q<1024*1024?(Q/1024).toFixed(1)+" KB":(Q/(1024*1024)).toFixed(1)+" MB",P=Q=>Q.startsWith("image/"),p=Q=>{window.open(Q,"_blank")},I=Q=>{if(!Q)return"";try{return Ne(Pt(Q),"MMM d, yyyy 'at' h:mm a")}catch{return""}},f=Q=>{try{const V=Ue.fromString(Q).origOptions,ee=V.interval||1,ie=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],le=["","1st","2nd","3rd","4th","5th"];if(V.freq===Ue.DAILY)return ee===1?"Repeats daily":`Repeats every ${ee} days`;if(V.freq===Ue.WEEKLY){if(V.byweekday){const X=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday]).map(ce=>{const ge=typeof ce=="number"?ce:ce.weekday,se=ge===6?0:ge+1;return ie[se]});return ee===1?X.length===1?`Repeats every ${X[0]}`:`Repeats on ${X.join(", ")}`:`Repeats every ${ee} weeks on ${X.join(", ")}`}return ee===1?"Repeats weekly":`Repeats every ${ee} weeks`}if(V.freq===Ue.MONTHLY){if(V.byweekday){const X=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday])[0];if(X&&typeof X=="object"&&"n"in X&&"weekday"in X){const ce=X.weekday,ge=ce===6?0:ce+1,se=X.n,_e=le[se]||`${se}th`;return ee===1?`Repeats on the ${_e} ${ie[ge]} of the month`:`Repeats on the ${_e} ${ie[ge]} every ${ee} months`}}if(V.bymonthday){const ne=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,X=ne===1?"st":ne===2?"nd":ne===3?"rd":"th";return ee===1?`Repeats on the ${ne}${X} of the month`:`Repeats on the ${ne}${X} every ${ee} months`}return ee===1?"Repeats monthly":`Repeats every ${ee} months`}if(V.freq===Ue.YEARLY){if(V.bymonth&&V.bymonthday){const ne=["","January","February","March","April","May","June","July","August","September","October","November","December"],X=Array.isArray(V.bymonth)?V.bymonth[0]:V.bymonth,ce=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,ge=ce===1?"st":ce===2?"nd":ce===3?"rd":"th";return ee===1?`Repeats every ${ne[X]} ${ce}${ge}`:`Repeats every ${ee} years on ${ne[X]} ${ce}${ge}`}return ee===1?"Repeats yearly":`Repeats every ${ee} years`}return"Repeats"}catch{return"Repeats"}};let v=oe("");ze(()=>te(c()),()=>{F(v,c()?"d-flex flex-sm-column flex-md-row flex-lg-row flex-xl-row gap-1":"d-flex flex-column gap-1")}),ze(()=>te(t()),()=>{F(x,t().attachments?.find(Q=>P(Q.type)))}),ze(()=>te(t()),()=>{F(s,!!(t().description||t().attachments&&t().attachments.length>0))}),ze(()=>te(t()),()=>{F(e,t().meta_data?.submitted_at??t().created_at)}),ze(()=>i(e),()=>{F(r,I(i(e)))}),ze(()=>te(t()),()=>{F(d,t().meta_data?.submitted_by_name)}),ze(()=>(i(r),i(d)),()=>{F(o,!!(i(r)||i(d)))}),ze(()=>te(t()),()=>{F(y,I(t().meta_data?.edited_at))}),ze(()=>te(t()),()=>{F(_,t().meta_data?.edited_by_name)}),ze(()=>(i(y),i(_)),()=>{F(a,!!(i(y)||i(_)))}),It(),gt();var b=Ia(),A=H(b);{var D=Q=>{var Z=la(),V=H(Z),ee=H(V,!0);B(V);var ie=j(V,2),le=H(ie),ne=H(le,!0);B(le),B(ie),B(Z),pe((X,ce)=>{xe(ee,X),xe(ne,ce)},[()=>(te(t()),J(()=>M(t().start_time))),()=>(te(t()),J(()=>w(t().start_time)))]),re(Q,Z)};he(A,Q=>{c()&&Q(D)})}var k=j(A,2),E=H(k),T=H(E),h=H(T);sr(h,()=>(te(Ut),te(t()),te(l()),J(()=>Ut(t().title||"",l())))),B(T);var u=j(T,2);{var z=Q=>{var Z=oa();re(Q,Z)},R=Q=>{var Z=ca(),V=H(Z);B(Z),pe((ee,ie)=>xe(V,`${ee??""} to ${ie??""}`),[()=>(te(t()),J(()=>S(t().start_time))),()=>(te(t()),J(()=>S(t().end_time)))]),re(Q,Z)};he(u,Q=>{te(t()),J(()=>t().is_all_day)?Q(z):Q(R,!1)})}var W=j(u,2),G=H(W);{var $=Q=>{var Z=ua(),V=Qe(Z),ee=H(V,!0);B(V);var ie=j(V,2);{var le=ne=>{var X=da();re(ne,X)};he(ie,ne=>{te(t()),J(()=>t().recurrence_rule||t()?.meta_data?.recurring_instance||t().location||t().description||t().attachments&&t().attachments.length>0)&&ne(le)})}pe((ne,X)=>{et(V,1,`badge rounded-pill bg-color-${ne??""}`,"svelte-lx28z"),xe(ee,X)},[()=>(te(Ot),te(t()),J(()=>Ot(t()?.meta_data?.category)?.color_number)),()=>(te(Ot),te(t()),J(()=>Ot(t()?.meta_data?.category)?.label))]),re(Q,Z)};he(G,Q=>{te(t()),J(()=>t()?.meta_data?.category)&&Q($)})}var q=j(G,2);{var N=Q=>{var Z=va(),V=Qe(Z),ee=j(H(V));B(V);var ie=j(V,2);{var le=ne=>{var X=fa();re(ne,X)};he(ie,ne=>{te(t()),J(()=>t().location||t().description||t().attachments&&t().attachments.length>0)&&ne(le)})}pe(ne=>xe(ee,` ${ne??""}`),[()=>(te(t()),J(()=>f(t().recurrence_rule)))]),re(Q,Z)},O=Q=>{var Z=ir(),V=Qe(Z);{var ee=ie=>{var le=ha(),ne=j(Qe(le),2);{var X=ce=>{var ge=ma();re(ce,ge)};he(ne,ce=>{te(t()),J(()=>t().location||t().description||t().attachments&&t().attachments.length>0)&&ce(X)})}re(ie,le)};he(V,ie=>{te(t()),J(()=>t()?.meta_data?.recurring_instance)&&ie(ee)},!0)}re(Q,Z)};he(q,Q=>{te(t()),J(()=>t().recurrence_rule)?Q(N):Q(O,!1)})}var ae=j(q,2);{var ve=Q=>{var Z=ya(),V=Qe(Z),ee=H(V);sr(ee,()=>(te(Ut),te(t()),te(l()),J(()=>Ut(t().location,l())))),B(V);var ie=j(V,2);{var le=ne=>{var X=ga();re(ne,X)};he(ie,ne=>{te(t()),J(()=>t().description||t().attachments&&t().attachments.length>0)&&ne(le)})}re(Q,Z)};he(ae,Q=>{te(t()),J(()=>t().location)&&Q(ve)})}var fe=j(ae,2);{var de=Q=>{var Z=_a(),V=H(Z);{var ee=le=>{var ne=wt("Hide");re(le,ne)},ie=le=>{var ne=wt("Show");re(le,ne)};he(V,le=>{n()?le(ee):le(ie,!1)})}Je(),B(Z),re(Q,Z)};he(fe,Q=>{te(t()),J(()=>t().description||t().attachments&&t().attachments.length>0)&&Q(de)})}B(W);var we=j(W,2);{var De=Q=>{var Z=Da(),V=H(Z);{var ee=se=>{var _e=pa(),ke=H(_e);sr(ke,()=>(te(kr),te(t()),te(l()),J(()=>kr(t().description,l())))),B(_e),re(se,_e)};he(V,se=>{te(t()),J(()=>t().description)&&se(ee)})}var ie=j(V,2);{var le=se=>{var _e=xa(),ke=j(H(_e),2);$t(ke,5,()=>(te(t()),J(()=>t().attachments)),Be=>Be.id,(Be,be)=>{var Ye=ir(),Ee=Qe(Ye);{var Re=He=>{var Pe=ba(),Me=H(Pe),We=H(Me);B(Me);var ft=j(Me,2),rt=H(ft),nt=H(rt,!0);B(rt),B(ft),B(Pe),pe(()=>{Oe(Me,"title",`Open ${i(be),J(()=>i(be).name)??""}`),Oe(We,"src",(i(be),J(()=>i(be).url))),Oe(We,"alt",(i(be),J(()=>i(be).name))),xe(nt,(i(be),J(()=>i(be).name)))}),Ie("click",Me,Tr(()=>p(i(be).url))),re(He,Pe)},qe=He=>{var Pe=wa(),Me=j(H(Pe),2),We=H(Me,!0);B(Me);var ft=j(Me,2),rt=H(ft);B(ft),B(Pe),pe(nt=>{Oe(Pe,"title",`Open ${i(be),J(()=>i(be).name)??""}`),xe(We,(i(be),J(()=>i(be).name))),xe(rt,`(${nt??""})`)},[()=>(i(be),J(()=>C(i(be).size)))]),Ie("click",Pe,Tr(()=>p(i(be).url))),re(He,Pe)};he(Ee,He=>{i(be),J(()=>P(i(be).type))?He(Re):He(qe,!1)})}re(Be,Ye)}),B(ke),B(_e),re(se,_e)};he(ie,se=>{te(t()),J(()=>t().attachments&&t().attachments.length>0)&&se(le)})}var ne=j(ie,2);{var X=se=>{var _e=Ea(),ke=j(H(_e));{var Be=Ee=>{var Re=wt();pe(()=>xe(Re,i(r))),re(Ee,Re)};he(ke,Ee=>{i(r)&&Ee(Be)})}var be=j(ke,2);{var Ye=Ee=>{var Re=ir(),qe=Qe(Re);{var He=Me=>{var We=wt();pe(()=>xe(We,`by ${i(d)??""}`)),re(Me,We)},Pe=Me=>{var We=wt();pe(()=>xe(We,`by ${i(d)??""}`)),re(Me,We)};he(qe,Me=>{i(r)?Me(He):Me(Pe,!1)})}re(Ee,Re)};he(be,Ee=>{i(d)&&Ee(Ye)})}B(_e),re(se,_e)};he(ne,se=>{i(o)&&se(X)})}var ce=j(ne,2);{var ge=se=>{var _e=Aa(),ke=j(H(_e));{var Be=Ee=>{var Re=wt();pe(()=>xe(Re,i(y))),re(Ee,Re)};he(ke,Ee=>{i(y)&&Ee(Be)})}var be=j(ke,2);{var Ye=Ee=>{var Re=wt();pe(()=>xe(Re,`by ${i(_)??""}`)),re(Ee,Re)};he(be,Ee=>{i(_)&&Ee(Ye)})}B(_e),re(se,_e)};he(ce,se=>{i(a)&&se(ge)})}B(Z),re(Q,Z)};he(we,Q=>{n()&&Q(De)})}B(E);var Ae=j(E,2);{var Te=Q=>{var Z=Sa(),V=H(Z);B(Z),pe(()=>{Oe(V,"src",(i(x),J(()=>i(x).url))),Oe(V,"alt",(i(x),J(()=>i(x).name)))}),re(Q,Z)};he(Ae,Q=>{i(x)&&Q(Te)})}B(k),B(b),pe(()=>{et(b,1,Qn(i(v)),"svelte-lx28z"),$n(b,i(s)?"cursor: pointer;":"")}),Ie("keydown",b,U),Ie("click",b,L),re(g,b),ut()}var ka=ue('<div class="invalid-feedback d-block"> </div>'),Ta=ue("<option> </option>"),Ra=ue('<div class="invalid-feedback d-block"> </div>'),Ma=ue(`<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Title*</div> <input type="text" placeholder="" required/> <!> <small class="fw-lighter fst-italic">Displayed publicly on the calendar and announcements page. e.g. Ward Conference, Ward BBQ
			Night</small></div> <div class="d-flex flex-column gap-2"><div>Type*</div> <select class="form-select" aria-label="Select Type"><option>Calendar Event</option><option>Announcement</option></select></div> <div class="d-flex flex-column gap-2"><div>Organization*</div> <select class="form-select" aria-label="Select Category"></select> <small class="fw-lighter fst-italic">Displayed as a public badge on the event listing.</small></div> <div class="d-flex flex-column gap-2"><div>Visibility</div> <div class="form-check form-switch"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">Public (visible without login)</label></div> <small class="fw-lighter fst-italic">Turn off to restrict this event/announcement to logged-in users only.</small></div> <div class="d-flex flex-column gap-2"><div>Description</div> <textarea rows="4" placeholder="Event description (optional)"></textarea> <!> <small class="fw-lighter fst-italic">Shown publicly when viewers expand the event details. Supports basic HTML formatting.</small></div></div>`);function Ca(g,m){dt(m,!1);const x=oe(),s=oe();let e=me(m,"title",12,""),r=me(m,"eventType",12,"calendar_event"),d=me(m,"category",12,""),o=me(m,"isPublic",12,!0),y=me(m,"description",12,""),_=me(m,"disabled",8,!1),a=me(m,"name",8,"event"),t=me(m,"validationErrors",24,()=>({})),n=oe(),c=oe();function l(){i(n)?.focus()}function S(){i(c)?.focus()}ze(()=>te(t()),()=>{F(x,!!t().title)}),ze(()=>te(t()),()=>{F(s,!!t().description)}),It();var M={focusTitle:l,focusDescription:S};gt();var w=Ma(),L=H(w),U=j(H(L),2);Ve(U);let C;pt(U,$=>F(n,$),()=>i(n));var P=j(U,2);{var p=$=>{var q=ka(),N=H(q,!0);B(q),pe(()=>xe(N,(te(t()),J(()=>t().title)))),re($,q)};he(P,$=>{te(t()),J(()=>t().title)&&$(p)})}Je(2),B(L);var I=j(L,2),f=j(H(I),2);pe(()=>{r(),dr(()=>{_()})});var v=H(f);v.value=v.__value="calendar_event";var b=j(v);b.value=b.__value="announcement",B(f),B(I);var A=j(I,2),D=j(H(A),2);pe(()=>{d(),dr(()=>{_()})}),$t(D,5,()=>Pn,Or,($,q)=>{var N=Ta(),O=H(N,!0);B(N);var ae={};pe(()=>{xe(O,(i(q),J(()=>i(q).label))),ae!==(ae=(i(q),J(()=>i(q).key)))&&(N.value=(N.__value=(i(q),J(()=>i(q).key)))??"")}),re($,N)}),B(D),Je(2),B(A);var k=j(A,2),E=j(H(k),2),T=H(E);Ve(T);var h=j(T,2);B(E),Je(2),B(k);var u=j(k,2),z=j(H(u),2);Mn(z);let R;pt(z,$=>F(c,$),()=>i(c));var W=j(z,2);{var G=$=>{var q=Ra(),N=H(q,!0);B(q),pe(()=>xe(N,(te(t()),J(()=>t().description)))),re($,q)};he(W,$=>{te(t()),J(()=>t().description)&&$(G)})}return Je(2),B(u),B(w),pe(()=>{Oe(U,"name",`${a()??""}-title`),C=et(U,1,"form-control",null,C,{"is-invalid":i(x)}),U.disabled=_(),f.disabled=_(),D.disabled=_(),Oe(T,"id",`${a()??""}-is-public`),T.disabled=_(),Oe(h,"for",`${a()??""}-is-public`),Oe(z,"name",`${a()??""}-description`),R=et(z,1,"form-control",null,R,{"is-invalid":i(s)}),z.disabled=_()}),Ie("focus",U,()=>i(n).select()),ct(U,e),ur(f,r),ur(D,d),mr(T,o),Ie("focus",z,()=>i(c).select()),ct(z,y),re(g,w),St(m,"focusTitle",l),St(m,"focusDescription",S),ut(M)}var Fa=ue('<div class="invalid-feedback d-block"> </div>'),Ua=ue('<div class="invalid-feedback d-block"> </div>'),Oa=ue('<div class="invalid-feedback d-block"> </div>'),Pa=ue('<div class="d-flex flex-column gap-4 ps-4"><div class="d-flex flex-column gap-2"><div>Start time*</div> <input type="time" required/> <!></div> <div class="d-flex flex-column gap-2"><div>End time*</div> <input type="time" required/> <!></div></div>'),Ba=ue('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Date*</div> <input type="date" required/> <!></div> <div><div class="form-check d-flex align-items-center gap-2"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">All Day Event</label></div></div> <!></div>');function La(g,m){dt(m,!1);const x=oe(),s=oe(),e=oe();let r=me(m,"dateInput",12,""),d=me(m,"startTimeInput",12,""),o=me(m,"endTimeInput",12,""),y=me(m,"isAllDay",12,!1),_=me(m,"disabled",8,!1),a=me(m,"name",8,"event"),t=me(m,"validationErrors",24,()=>({})),n=oe(),c=oe(),l=oe();function S(){i(n)?.focus()}function M(){i(c)?.focus()}function w(){i(l)?.focus()}ze(()=>te(t()),()=>{F(x,!!t().dateInput)}),ze(()=>te(t()),()=>{F(s,!!t().startTimeInput)}),ze(()=>te(t()),()=>{F(e,!!t().endTimeInput)}),It();var L={focusDate:S,focusStartTime:M,focusEndTime:w};gt();var U=Ba(),C=H(U),P=j(H(C),2);Ve(P);let p;pt(P,T=>F(n,T),()=>i(n));var I=j(P,2);{var f=T=>{var h=Fa(),u=H(h,!0);B(h),pe(()=>xe(u,(te(t()),J(()=>t().dateInput)))),re(T,h)};he(I,T=>{te(t()),J(()=>t().dateInput)&&T(f)})}B(C);var v=j(C,2),b=H(v),A=H(b);Ve(A);var D=j(A,2);B(b),B(v);var k=j(v,2);{var E=T=>{var h=Pa(),u=H(h),z=j(H(u),2);Ve(z),Oe(z,"step",900);let R;pt(z,ve=>F(c,ve),()=>i(c));var W=j(z,2);{var G=ve=>{var fe=Ua(),de=H(fe,!0);B(fe),pe(()=>xe(de,(te(t()),J(()=>t().startTimeInput)))),re(ve,fe)};he(W,ve=>{te(t()),J(()=>t().startTimeInput)&&ve(G)})}B(u);var $=j(u,2),q=j(H($),2);Ve(q),Oe(q,"step",900);let N;pt(q,ve=>F(l,ve),()=>i(l));var O=j(q,2);{var ae=ve=>{var fe=Oa(),de=H(fe,!0);B(fe),pe(()=>xe(de,(te(t()),J(()=>t().endTimeInput)))),re(ve,fe)};he(O,ve=>{te(t()),J(()=>t().endTimeInput)&&ve(ae)})}B($),B(h),pe(()=>{Oe(z,"name",`${a()??""}-start-time`),R=et(z,1,"form-control",null,R,{"is-invalid":i(s)}),z.disabled=_(),Oe(q,"name",`${a()??""}-end-time`),N=et(q,1,"form-control",null,N,{"is-invalid":i(e)}),q.disabled=_()}),Ie("focus",z,()=>i(c).select()),ct(z,d),Ie("focus",q,()=>i(l).select()),ct(q,o),re(T,h)};he(k,T=>{y()||T(E)})}return B(U),pe(()=>{Oe(P,"name",`${a()??""}-date`),p=et(P,1,"form-control",null,p,{"is-invalid":i(x)}),P.disabled=_(),Oe(A,"id",`${a()??""}-all-day-check`),A.disabled=_(),Oe(D,"for",`${a()??""}-all-day-check`)}),Ie("focus",P,()=>i(n).select()),ct(P,r),mr(A,y),re(g,U),St(m,"focusDate",S),St(m,"focusStartTime",M),St(m,"focusEndTime",w),ut(L)}var za=ue('<div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div>'),Ha=ue('<div class="invalid-feedback d-block"> </div>'),Na=ue('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold">Repeat on these days<span class="text-danger">*</span></div> <div class="d-flex flex-wrap gap-2"></div> <!> <small class="text-muted">Select at least one day when this event repeats</small></div>'),qa=ue('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Monthly recurrence">Monthly recurrence</div> <div class="d-flex flex-column gap-2"><div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div></div></div>'),Wa=ue('<div class="invalid-feedback d-block"> </div>'),Ya=ue('<div class="d-flex flex-column gap-3 ps-4"><div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Repeat pattern">Repeat pattern</div> <div class="row g-2 align-items-center"><div class="col-auto"><span class="text-muted">Every</span></div> <div class="col-auto"><input type="number" class="form-control" min="1" max="99" style="width: 80px;"/></div> <div class="col-auto"><select class="form-select"><option> </option><option> </option><option> </option><option> </option></select></div></div></div> <!> <!> <div class="d-flex flex-column gap-2"><label class="form-label fw-semibold">Repeat until<span class="text-danger">*</span></label> <input type="date" required/> <!> <small class="text-muted">The last date this event will occur</small></div></div>'),ja=ue('<div class="d-flex flex-column gap-3"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label fw-semibold">Make this a recurring event</label></div> <!></div>');function $a(g,m){dt(m,!1);const x=[],s=[];let e=me(m,"isRecurring",12,!1),r=me(m,"recurrenceFrequency",12,"weekly"),d=me(m,"recurrenceInterval",12,1),o=me(m,"recurringDays",28,()=>[]),y=me(m,"recurrenceEndDate",12,""),_=me(m,"monthlyType",12,"date"),a=me(m,"dateInput",8,""),t=me(m,"disabled",8,!1),n=me(m,"name",8,"event"),c=me(m,"validationErrors",24,()=>({}));const l=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];function S(I){if(!I)return"Same weekday of the month";try{const f=new Date(I),v=Ne(f,"EEEE"),b=Math.ceil(f.getDate()/7);return`${["","1st","2nd","3rd","4th","5th"][b]} ${v} of the month`}catch{return"Same weekday of the month"}}function M(I){if(!I)return 1;try{return I.split("-").map(Number)[2]}catch{return 1}}gt();var w=ja(),L=H(w),U=H(L);Ve(U);var C=j(U,2);B(L);var P=j(L,2);{var p=I=>{var f=Ya(),v=H(f),b=j(H(v),2),A=j(H(b),2),D=H(A);Ve(D),B(A);var k=j(A,2),E=H(k);pe(()=>{r(),dr(()=>{t(),d()})});var T=H(E),h=H(T,!0);B(T),T.value=T.__value="daily";var u=j(T),z=H(u,!0);B(u),u.value=u.__value="weekly";var R=j(u),W=H(R,!0);B(R),R.value=R.__value="monthly";var G=j(R),$=H(G,!0);B(G),G.value=G.__value="yearly",B(E),B(k),B(b),B(v);var q=j(v,2);{var N=Te=>{var Q=Na(),Z=j(H(Q),2);$t(Z,5,()=>l,Or,(ie,le)=>{var ne=za(),X=H(ne);Ve(X);var ce,ge=j(X,2),se=H(ge,!0);B(ge),B(ne),pe(()=>{Oe(X,"id",`${n()??""}-day-${i(le),J(()=>i(le).value)??""}`),X.disabled=t(),ce!==(ce=(i(le),J(()=>i(le).value)))&&(X.value=(X.__value=(i(le),J(()=>i(le).value)))??""),Oe(ge,"for",`${n()??""}-day-${i(le),J(()=>i(le).value)??""}`),xe(se,(i(le),J(()=>i(le).label)))}),or(x,[],X,()=>(i(le),J(()=>i(le).value),o()),o),re(ie,ne)}),B(Z);var V=j(Z,2);{var ee=ie=>{var le=Ha(),ne=H(le,!0);B(le),pe(()=>xe(ne,(te(c()),J(()=>c().recurringDays)))),re(ie,le)};he(V,ie=>{te(c()),J(()=>c().recurringDays)&&ie(ee)})}Je(2),B(Q),re(Te,Q)};he(q,Te=>{r()==="weekly"&&Te(N)})}var O=j(q,2);{var ae=Te=>{var Q=qa(),Z=j(H(Q),2),V=H(Z),ee=H(V);Ve(ee),ee.value=ee.__value="date";var ie=j(ee,2),le=H(ie);B(ie),B(V);var ne=j(V,2),X=H(ne);Ve(X),X.value=X.__value="weekday";var ce=j(X,2),ge=H(ce);B(ce),B(ne),B(Z),B(Q),pe((se,_e)=>{Oe(ee,"id",`${n()??""}-monthly-date`),ee.disabled=t(),Oe(ie,"for",`${n()??""}-monthly-date`),xe(le,`On day ${se??""} of the month`),Oe(X,"id",`${n()??""}-monthly-weekday`),X.disabled=t(),Oe(ce,"for",`${n()??""}-monthly-weekday`),xe(ge,`On the ${_e??""}`)},[()=>(te(a()),J(()=>M(a()))),()=>(te(a()),J(()=>S(a())))]),or(s,[],ee,_,_),or(s,[],X,_,_),re(Te,Q)};he(O,Te=>{r()==="monthly"&&Te(ae)})}var ve=j(O,2),fe=H(ve),de=j(fe,2);Ve(de);let we;var De=j(de,2);{var Ae=Te=>{var Q=Wa(),Z=H(Q,!0);B(Q),pe(()=>xe(Z,(te(c()),J(()=>c().recurrenceEndDate)))),re(Te,Q)};he(De,Te=>{te(c()),J(()=>c().recurrenceEndDate)&&Te(Ae)})}Je(2),B(ve),B(f),pe(()=>{D.disabled=t(),E.disabled=t(),xe(h,d()===1?"day":"days"),xe(z,d()===1?"week":"weeks"),xe(W,d()===1?"month":"months"),xe($,d()===1?"year":"years"),Oe(fe,"for",`${n()??""}-recurrence-end-date`),we=et(de,1,"form-control",null,we,{"is-invalid":!!c().recurrenceEndDate}),Oe(de,"id",`${n()??""}-recurrence-end-date`),de.disabled=t()}),ct(D,d),ur(E,r),ct(de,y),re(I,f)};he(P,I=>{e()&&I(p)})}B(w),pe(()=>{Oe(U,"id",`${n()??""}-is-recurring`),U.disabled=t(),Oe(C,"for",`${n()??""}-is-recurring`)}),mr(U,e),re(g,w),ut()}var Qa=ue('<div class="d-flex flex-column gap-2"><div>Location</div> <input type="text" class="form-control" placeholder="Event location (optional)"/> <small class="fw-lighter fst-italic">Displayed publicly on the event listing. e.g. Cultural Hall, Stake Center</small></div>');function Va(g,m){dt(m,!1);let x=me(m,"value",12,""),s=me(m,"disabled",8,!1),e=me(m,"name",8,"location"),r=oe();function d(){i(r)?.focus()}var o={focus:d},y=Qa(),_=j(H(y),2);return Ve(_),pt(_,a=>F(r,a),()=>i(r)),Je(2),B(y),pe(()=>{Oe(_,"name",e()),_.disabled=s()}),Ie("focus",_,()=>i(r).select()),ct(_,x),re(g,y),St(m,"focus",d),ut(o)}var Ka=ue('<input type="text" class="form-control form-control-sm"/> <small class="text-muted"> </small>',1),Ga=ue('<div class="fw-semibold"> </div> <small class="text-muted"> </small>',1),Za=ue('<button type="button" class="btn btn-sm btn-success" title="Save"><i class="bi bi-check-lg"></i></button> <button type="button" class="btn btn-sm btn-secondary" title="Cancel"><i class="bi bi-x-lg"></i></button>',1),Xa=ue('<button type="button" class="btn btn-sm btn-outline-primary" title="Edit name"><i class="bi bi-pencil"></i></button> <button type="button" class="btn btn-sm btn-outline-danger" title="Delete"><i class="bi bi-trash"></i></button>',1),Ja=ue('<div class="d-flex align-items-center gap-2 p-2 border rounded"><div class="flex-grow-1"><!></div> <!></div>'),ei=ue('<div class="d-flex flex-column gap-2 mb-2"></div>'),ti=ue('<div class="d-flex flex-column gap-2"><div>Attachments</div> <!> <div class="d-flex flex-column gap-2"><div class="d-flex gap-2 align-items-center"><input type="file" class="form-control" accept="image/*,application/pdf"/> <!></div> <small class="fw-lighter fst-italic">Publicly visible in the event details. Max 5MB per file. Supports: images, PDFs</small></div></div>');function ri(g,m){dt(m,!1);let x=me(m,"attachments",24,()=>[]),s=me(m,"disabled",8,!1),e=me(m,"uploadingFile",8,!1);const r=Kn();let d=oe(),o=oe(null),y=oe("");const _=I=>{if(I===0)return"0 Bytes";const f=1024,v=["Bytes","KB","MB"],b=Math.floor(Math.log(I)/Math.log(f));return Math.round(I/Math.pow(f,b)*100)/100+" "+v[b]},a=I=>{const f=I.target;f.files&&f.files[0]&&(r("upload",f.files[0]),f.value="")},t=I=>{F(o,I.id),F(y,I.name)},n=I=>{i(y).trim()&&i(y)!==I.name&&r("edit",{attachment:I,newName:i(y).trim()}),F(o,null),F(y,"")},c=()=>{F(o,null),F(y,"")},l=I=>{r("remove",I)};gt();var S=ti(),M=j(H(S),2);{var w=I=>{var f=ei();$t(f,5,x,v=>v.id,(v,b)=>{var A=Ja(),D=H(A),k=H(D);{var E=R=>{var W=Ka(),G=Qe(W);Ve(G);var $=j(G,2),q=H($,!0);B($),pe(N=>{G.disabled=s(),xe(q,N)},[()=>(i(b),J(()=>_(i(b).size)))]),ct(G,()=>i(y),N=>F(y,N)),Ie("keydown",G,N=>{N.key==="Enter"&&n(i(b)),N.key==="Escape"&&c()}),re(R,W)},T=R=>{var W=Ga(),G=Qe(W),$=H(G,!0);B(G);var q=j(G,2),N=H(q,!0);B(q),pe(O=>{xe($,(i(b),J(()=>i(b).name))),xe(N,O)},[()=>(i(b),J(()=>_(i(b).size)))]),re(R,W)};he(k,R=>{i(o),i(b),J(()=>i(o)===i(b).id)?R(E):R(T,!1)})}B(D);var h=j(D,2);{var u=R=>{var W=Za(),G=Qe(W),$=j(G,2);pe(()=>{G.disabled=s(),$.disabled=s()}),Ie("click",G,()=>n(i(b))),Ie("click",$,c),re(R,W)},z=R=>{var W=Xa(),G=Qe(W),$=j(G,2);pe(()=>{G.disabled=s(),$.disabled=s()}),Ie("click",G,()=>t(i(b))),Ie("click",$,()=>l(i(b))),re(R,W)};he(h,R=>{i(o),i(b),J(()=>i(o)===i(b).id)?R(u):R(z,!1)})}B(A),re(v,A)}),B(f),re(I,f)};he(M,I=>{te(x()),J(()=>x().length>0)&&I(w)})}var L=j(M,2),U=H(L),C=H(U);pt(C,I=>F(d,I),()=>i(d));var P=j(C,2);{var p=I=>{Nr(I,{size:"sm"})};he(P,I=>{e()&&I(p)})}B(U),Je(2),B(L),B(S),pe(()=>C.disabled=s()||e()),Ie("change",C,a),re(g,S),ut()}var ni=ue('<div class="modal svelte-xtxevo" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Edit Recurring Event</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">How would you like to edit it?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">The entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function ai(g,m){dt(m,!1);const x=oe();let s=me(m,"eventTitle",8),e=me(m,"occurrenceDate",8),r=me(m,"callback",8);function d(A){r()(A)}function o(){r()(null)}ze(()=>(te(e()),Ne),()=>{F(x,(()=>{try{const[A,D,k]=e().split("-").map(Number),E=new Date(A,D-1,k);return Ne(E,"EEEE, MMMM d, yyyy")}catch{return e()}})())}),It(),gt();var y=ni(),_=H(y),a=H(_),t=H(a),n=j(H(t),2);B(t);var c=j(t,2),l=H(c),S=H(l),M=H(S);B(S),Je(),B(l);var w=j(l,4),L=H(w),U=j(H(L),2),C=H(U,!0);B(U),B(L);var P=j(L,2),p=j(H(P),2),I=H(p);B(p),B(P);var f=j(P,2);B(w),B(c);var v=j(c,2),b=H(v);B(v),B(a),B(_),B(y),pe(()=>{xe(M,`"${s()??""}"`),xe(C,i(x)),xe(I,`From ${i(x)??""} onwards`)}),Ie("click",n,o),Ie("click",L,()=>d("single")),Ie("click",P,()=>d("future")),Ie("click",f,()=>d("all")),Ie("click",b,o),re(g,y),ut()}var ii=ue('<div class="modal svelte-gu1ski" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Recurring Event</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">What would you like to delete?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">Delete the entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function si(g,m){dt(m,!1);const x=oe();let s=me(m,"eventTitle",8),e=me(m,"occurrenceDate",8),r=me(m,"callback",8);function d(A){r()(A)}function o(){r()(null)}ze(()=>(te(e()),Ne),()=>{F(x,(()=>{try{const[A,D,k]=e().split("-").map(Number),E=new Date(A,D-1,k);return Ne(E,"EEEE, MMMM d, yyyy")}catch{return e()}})())}),It(),gt();var y=ii(),_=H(y),a=H(_),t=H(a),n=j(H(t),2);B(t);var c=j(t,2),l=H(c),S=H(l),M=H(S);B(S),Je(),B(l);var w=j(l,4),L=H(w),U=j(H(L),2),C=H(U,!0);B(U),B(L);var P=j(L,2),p=j(H(P),2),I=H(p);B(p),B(P);var f=j(P,2);B(w),B(c);var v=j(c,2),b=H(v);B(v),B(a),B(_),B(y),pe(()=>{xe(M,`"${s()??""}"`),xe(C,i(x)),xe(I,`From ${i(x)??""} onwards`)}),Ie("click",n,o),Ie("click",L,()=>d("single")),Ie("click",P,()=>d("future")),Ie("click",f,()=>d("all")),Ie("click",b,o),re(g,y),ut()}var li=ue('<div class="modal fade" tabindex="-1" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div> <div class="modal-body"><p> </p> <div class="mb-3"><label for="cloneDate" class="form-label">Event Date</label> <input type="date" class="form-control" id="cloneDate"/></div></div> <div class="modal-footer"><button type="button"> </button> <button type="button"> </button></div></div></div></div>');function oi(g,m){dt(m,!1);let x=me(m,"title",8,"Clone Event"),s=me(m,"message",8,"Select a date for the cloned event:"),e=me(m,"confirmButtonLabel",8,"Clone"),r=me(m,"confirmButtonCSS",8,"btn-primary"),d=me(m,"rejectButtonLabel",8,"Cancel"),o=me(m,"rejectButtonCSS",8,"btn-secondary"),y=me(m,"defaultDate",8,void 0),_=me(m,"callback",8,()=>{}),a=oe(),t=oe(y()||Ne(new Date,"yyyy-MM-dd")),n=!1,c;Hr(()=>{const h=window.bootstrap.Modal;new h(i(a)).show(),i(a).addEventListener("hidden.bs.modal",()=>{n?_()(!0,c):_()(!1)})});function l(){n=!0,c=i(t),window.bootstrap.Modal.getInstance(i(a)).hide()}function S(){n=!1,window.bootstrap.Modal.getInstance(i(a)).hide()}gt();var M=li(),w=H(M),L=H(w),U=H(L),C=H(U),P=H(C,!0);B(C),Je(2),B(U);var p=j(U,2),I=H(p),f=H(I,!0);B(I);var v=j(I,2),b=j(H(v),2);Ve(b),B(v),B(p);var A=j(p,2),D=H(A),k=H(D,!0);B(D);var E=j(D,2),T=H(E,!0);B(E),B(A),B(L),B(w),B(M),pt(M,h=>F(a,h),()=>i(a)),pe(()=>{xe(P,x()),xe(f,s()),et(D,1,`btn ${o()??""}`),xe(k,d()),et(E,1,`btn ${r()??""}`),xe(T,e())}),ct(b,()=>i(t),h=>F(t,h)),Ie("click",D,S),Ie("click",E,l),re(g,M),ut()}let Bt;function ci(g){if(typeof document>"u")return;const m=document.createElement("div");document.body.appendChild(m);const x={title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",rejectButtonLabel:"Cancel",rejectButtonCSS:"btn-secondary",callback:()=>{console.log("callback")}};g.title&&(x.title=g.title),g.message&&(x.message=g.message),g.confirmButtonLabel&&(x.confirmButtonLabel=g.confirmButtonLabel),g.confirmButtonCSS&&(x.confirmButtonCSS=g.confirmButtonCSS),g.rejectButtonLabel&&(x.rejectButtonLabel=g.rejectButtonLabel),g.rejectButtonCSS&&(x.rejectButtonCSS=g.rejectButtonCSS),g.defaultDate&&(x.defaultDate=g.defaultDate),x.callback=(s,e)=>{console.log("Clone confirm result:",s,e),Bt&&(Un(Bt),Bt=void 0),m.remove(),g.callback&&typeof g.callback=="function"&&g.callback(s,e)},Bt=Fn(oi,{target:m,props:x})}const di=Jn().shape({title:lt().required("Title is required").min(3,"Title must be at least 3 characters").max(255,"Title cannot exceed 255 characters"),event_type:lt().oneOf(["calendar_event","announcement"],"Invalid event type").required("Event type is required"),category:lt().required("Category is required"),description:lt().nullable().max(1e4,"Description is too long"),location:lt().nullable().max(255,"Location cannot exceed 255 characters"),dateInput:lt().when("event_type",{is:"calendar_event",then:g=>g.required("Date is required"),otherwise:g=>g.nullable()}),startTimeInput:lt().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("Start time is required"),otherwise:g=>g.nullable()}),endTimeInput:lt().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("End time is required"),otherwise:g=>g.nullable()}),isRecurring:Rr(),recurrenceFrequency:lt().oneOf(["daily","weekly","monthly","yearly"]).nullable(),recurringDays:ea().of(ta().min(0).max(6)).when(["isRecurring","recurrenceFrequency"],{is:(g,m)=>g&&m==="weekly",then:g=>g.min(1,"Select at least one day for weekly recurring events").required(),otherwise:g=>g.nullable()}),hasEndDate:Rr(),recurrenceEndDate:lt().when(["isRecurring","hasEndDate"],{is:(g,m)=>g&&m,then:g=>g.required("End date is required").test("is-future","End date must be in the future",function(m){if(!m)return!1;const x=new Date(m),s=new Date;return s.setHours(0,0,0,0),x>=s}),otherwise:g=>g.nullable()})});function ui(){const g=Gn({});async function m(e){try{return await di.validate(e,{abortEarly:!1}),g.set({}),!0}catch(r){if(r instanceof ra){const d={};return r.inner.forEach(o=>{o.path&&(d[o.path]=o.message)}),g.set(d),!1}return!1}}function x(){g.set({})}function s(){return Object.values(fr(g)).filter(r=>r.length>0)}return{validationErrors:g,validate:m,clearErrors:x,getErrorMessages:s}}function hr(g){const{frequency:m,interval:x,recurringDays:s,recurrenceEndDate:e,hasEndDate:r,monthlyType:d,startTime:o}=g,y={0:Ue.SU,1:Ue.MO,2:Ue.TU,3:Ue.WE,4:Ue.TH,5:Ue.FR,6:Ue.SA},_={daily:Ue.DAILY,weekly:Ue.WEEKLY,monthly:Ue.MONTHLY,yearly:Ue.YEARLY},a=new Date(o),t=_t(a,Ke),n=new Date(t);n.setHours(12,0,0,0);const c=Et(n,Ke),l={freq:_[m],interval:x,dtstart:c};if(r&&e){const M=new Date(`${e}T23:59:59.999`),w=Et(M,Ke);l.until=w}if(m==="weekly"&&s.length>0)l.byweekday=s.map(M=>y[M]);else if(m==="monthly")if(d==="date")l.bymonthday=[n.getDate()];else{const M=Math.ceil(n.getDate()/7),w=n.getDay(),L=[Ue.SU,Ue.MO,Ue.TU,Ue.WE,Ue.TH,Ue.FR,Ue.SA];l.byweekday=[L[w].nth(M)]}else m==="yearly"&&(l.bymonth=[n.getMonth()+1],l.bymonthday=[n.getDate()]);return{recurrence_rule:new Ue(l).toString(),recurrence_end_date:r&&e?l.until.toISOString():void 0}}function qr(g,m){try{const s=Ue.fromString(g).origOptions,e={6:0,0:1,1:2,2:3,3:4,4:5,5:6},r={[Ue.DAILY]:"daily",[Ue.WEEKLY]:"weekly",[Ue.MONTHLY]:"monthly",[Ue.YEARLY]:"yearly"},d=(s.freq!==void 0?r[s.freq]:null)||"weekly",o=s.interval||1;let y=[],_="date";s.byweekday&&d==="weekly"&&(y=(Array.isArray(s.byweekday)?s.byweekday:[s.byweekday]).map(n=>{const c=typeof n=="number"?n:n.weekday;return e[c]})),d==="monthly"&&(s.bymonthday&&Array.isArray(s.bymonthday)&&s.bymonthday.length>0?_="date":s.byweekday&&(_="weekday"));let a="",t=!1;if(m){t=!0;const n=_t(new Date(m),Ke);a=Ne(n,"yyyy-MM-dd")}else if(s.until){t=!0;const n=_t(s.until,Ke);a=Ne(n,"yyyy-MM-dd")}return{frequency:d,interval:o,recurringDays:y,recurrenceEndDate:a,hasEndDate:t,monthlyType:_}}catch(x){return console.error("Failed to parse recurrence rule:",x),null}}function Wr(){return{recurrence_rule:void 0,recurrence_end_date:void 0}}function Yr(){return{generateRecurrenceRule:hr,parseRecurrenceRule:qr,clearRecurrence:Wr}}const vr=Object.freeze(Object.defineProperty({__proto__:null,clearRecurrence:Wr,generateRecurrenceRule:hr,parseRecurrenceRule:qr,useRecurrenceLogic:Yr},Symbol.toStringTag,{value:"Module"}));function fi(g,m){return m.forEach(function(x){x&&typeof x!="string"&&!Array.isArray(x)&&Object.keys(x).forEach(function(s){if(s!=="default"&&!(s in g)){var e=Object.getOwnPropertyDescriptor(x,s);Object.defineProperty(g,s,e.get?e:{enumerable:!0,get:function(){return x[s]}})}})}),Object.freeze(g)}function jr(g,m){return new Promise(function(x,s){let e;return vi(g).then(function(r){try{return e=r,x(new Blob([m.slice(0,2),e,m.slice(2)],{type:"image/jpeg"}))}catch(d){return s(d)}},s)})}const vi=g=>new Promise((m,x)=>{const s=new FileReader;s.addEventListener("load",({target:{result:e}})=>{const r=new DataView(e);let d=0;if(r.getUint16(d)!==65496)return x("not a valid JPEG");for(d+=2;;){const o=r.getUint16(d);if(o===65498)break;const y=r.getUint16(d+2);if(o===65505&&r.getUint32(d+4)===1165519206){const _=d+10;let a;switch(r.getUint16(_)){case 18761:a=!0;break;case 19789:a=!1;break;default:return x("TIFF header contains invalid endian")}if(r.getUint16(_+2,a)!==42)return x("TIFF header contains invalid version");const t=r.getUint32(_+4,a),n=_+t+2+12*r.getUint16(_+t,a);for(let c=_+t+2;c<n;c+=12)if(r.getUint16(c,a)==274){if(r.getUint16(c+2,a)!==3)return x("Orientation data type is invalid");if(r.getUint32(c+4,a)!==1)return x("Orientation data count is invalid");r.setUint16(c+8,1,a);break}return m(e.slice(d,d+2+y))}d+=2+y}return m(new Blob)}),s.readAsArrayBuffer(g)});var qt={},mi={get exports(){return qt},set exports(g){qt=g}};(function(g){var m,x,s={};mi.exports=s,s.parse=function(e,r){for(var d=s.bin.readUshort,o=s.bin.readUint,y=0,_={},a=new Uint8Array(e),t=a.length-4;o(a,t)!=101010256;)t--;y=t,y+=4;var n=d(a,y+=4);d(a,y+=2);var c=o(a,y+=2),l=o(a,y+=4);y+=4,y=l;for(var S=0;S<n;S++){o(a,y),y+=4,y+=4,y+=4,o(a,y+=4),c=o(a,y+=4);var M=o(a,y+=4),w=d(a,y+=4),L=d(a,y+2),U=d(a,y+4);y+=6;var C=o(a,y+=8);y+=4,y+=w+L+U,s._readLocal(a,C,_,c,M,r)}return _},s._readLocal=function(e,r,d,o,y,_){var a=s.bin.readUshort,t=s.bin.readUint;t(e,r),a(e,r+=4),a(e,r+=2);var n=a(e,r+=2);t(e,r+=2),t(e,r+=4),r+=4;var c=a(e,r+=8),l=a(e,r+=2);r+=2;var S=s.bin.readUTF8(e,r,c);if(r+=c,r+=l,_)d[S]={size:y,csize:o};else{var M=new Uint8Array(e.buffer,r);if(n==0)d[S]=new Uint8Array(M.buffer.slice(r,r+o));else{if(n!=8)throw"unknown compression method: "+n;var w=new Uint8Array(y);s.inflateRaw(M,w),d[S]=w}}},s.inflateRaw=function(e,r){return s.F.inflate(e,r)},s.inflate=function(e,r){return e[0],e[1],s.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),r)},s.deflate=function(e,r){r==null&&(r={level:6});var d=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[d]=120,o[d+1]=156,d+=2,d=s.F.deflateRaw(e,o,d,r.level);var y=s.adler(e,0,e.length);return o[d+0]=y>>>24&255,o[d+1]=y>>>16&255,o[d+2]=y>>>8&255,o[d+3]=y>>>0&255,new Uint8Array(o.buffer,0,d+4)},s.deflateRaw=function(e,r){r==null&&(r={level:6});var d=new Uint8Array(50+Math.floor(1.1*e.length)),o=s.F.deflateRaw(e,d,o,r.level);return new Uint8Array(d.buffer,0,o)},s.encode=function(e,r){r==null&&(r=!1);var d=0,o=s.bin.writeUint,y=s.bin.writeUshort,_={};for(var a in e){var t=!s._noNeed(a)&&!r,n=e[a],c=s.crc.crc(n,0,n.length);_[a]={cpr:t,usize:n.length,crc:c,file:t?s.deflateRaw(n):n}}for(var a in _)d+=_[a].file.length+30+46+2*s.bin.sizeUTF8(a);d+=22;var l=new Uint8Array(d),S=0,M=[];for(var a in _){var w=_[a];M.push(S),S=s._writeHeader(l,S,a,w,0)}var L=0,U=S;for(var a in _)w=_[a],M.push(S),S=s._writeHeader(l,S,a,w,1,M[L++]);var C=S-U;return o(l,S,101010256),S+=4,y(l,S+=4,L),y(l,S+=2,L),o(l,S+=2,C),o(l,S+=4,U),S+=4,S+=2,l.buffer},s._noNeed=function(e){var r=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(r)!=-1},s._writeHeader=function(e,r,d,o,y,_){var a=s.bin.writeUint,t=s.bin.writeUshort,n=o.file;return a(e,r,y==0?67324752:33639248),r+=4,y==1&&(r+=2),t(e,r,20),t(e,r+=2,0),t(e,r+=2,o.cpr?8:0),a(e,r+=2,0),a(e,r+=4,o.crc),a(e,r+=4,n.length),a(e,r+=4,o.usize),t(e,r+=4,s.bin.sizeUTF8(d)),t(e,r+=2,0),r+=2,y==1&&(r+=2,r+=2,a(e,r+=6,_),r+=4),r+=s.bin.writeUTF8(e,r,d),y==0&&(e.set(n,r),r+=n.length),r},s.crc={table:function(){for(var e=new Uint32Array(256),r=0;r<256;r++){for(var d=r,o=0;o<8;o++)1&d?d=3988292384^d>>>1:d>>>=1;e[r]=d}return e}(),update:function(e,r,d,o){for(var y=0;y<o;y++)e=s.crc.table[255&(e^r[d+y])]^e>>>8;return e},crc:function(e,r,d){return 4294967295^s.crc.update(4294967295,e,r,d)}},s.adler=function(e,r,d){for(var o=1,y=0,_=r,a=r+d;_<a;){for(var t=Math.min(_+5552,a);_<t;)y+=o+=e[_++];o%=65521,y%=65521}return y<<16|o},s.bin={readUshort:function(e,r){return e[r]|e[r+1]<<8},writeUshort:function(e,r,d){e[r]=255&d,e[r+1]=d>>8&255},readUint:function(e,r){return 16777216*e[r+3]+(e[r+2]<<16|e[r+1]<<8|e[r])},writeUint:function(e,r,d){e[r]=255&d,e[r+1]=d>>8&255,e[r+2]=d>>16&255,e[r+3]=d>>24&255},readASCII:function(e,r,d){for(var o="",y=0;y<d;y++)o+=String.fromCharCode(e[r+y]);return o},writeASCII:function(e,r,d){for(var o=0;o<d.length;o++)e[r+o]=d.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,r,d){for(var o,y="",_=0;_<d;_++)y+="%"+s.bin.pad(e[r+_].toString(16));try{o=decodeURIComponent(y)}catch{return s.bin.readASCII(e,r,d)}return o},writeUTF8:function(e,r,d){for(var o=d.length,y=0,_=0;_<o;_++){var a=d.charCodeAt(_);if(!(4294967168&a))e[r+y]=a,y++;else if(!(4294965248&a))e[r+y]=192|a>>6,e[r+y+1]=128|a>>0&63,y+=2;else if(!(4294901760&a))e[r+y]=224|a>>12,e[r+y+1]=128|a>>6&63,e[r+y+2]=128|a>>0&63,y+=3;else{if(4292870144&a)throw"e";e[r+y]=240|a>>18,e[r+y+1]=128|a>>12&63,e[r+y+2]=128|a>>6&63,e[r+y+3]=128|a>>0&63,y+=4}}return y},sizeUTF8:function(e){for(var r=e.length,d=0,o=0;o<r;o++){var y=e.charCodeAt(o);if(!(4294967168&y))d++;else if(!(4294965248&y))d+=2;else if(!(4294901760&y))d+=3;else{if(4292870144&y)throw"e";d+=4}}return d}},s.F={},s.F.deflateRaw=function(e,r,d,o){var y=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],_=s.F.U,a=s.F._goodIndex;s.F._hash;var t=s.F._putsE,n=0,c=d<<3,l=0,S=e.length;if(o==0){for(;n<S;)t(r,c,n+(A=Math.min(65535,S-n))==S?1:0),c=s.F._copyExact(e,n,A,r,c+8),n+=A;return c>>>3}var M=_.lits,w=_.strt,L=_.prev,U=0,C=0,P=0,p=0,I=0,f=0;for(S>2&&(w[f=s.F._hash(e,0)]=0),n=0;n<S;n++){if(I=f,n+1<S-2){f=s.F._hash(e,n+1);var v=n+1&32767;L[v]=w[f],w[f]=v}if(l<=n){(U>14e3||C>26697)&&S-n>100&&(l<n&&(M[U]=n-l,U+=2,l=n),c=s.F._writeBlock(n==S-1||l==S?1:0,M,U,p,e,P,n-P,r,c),U=C=p=0,P=n);var b=0;n<S-2&&(b=s.F._bestMatch(e,n,L,I,Math.min(y[2],S-n),y[3]));var A=b>>>16,D=65535&b;if(b!=0){D=65535&b;var k=a(A=b>>>16,_.of0);_.lhst[257+k]++;var E=a(D,_.df0);_.dhst[E]++,p+=_.exb[k]+_.dxb[E],M[U]=A<<23|n-l,M[U+1]=D<<16|k<<8|E,U+=2,l=n+A}else _.lhst[e[n]]++;C++}}for(P==n&&e.length!=0||(l<n&&(M[U]=n-l,U+=2,l=n),c=s.F._writeBlock(1,M,U,p,e,P,n-P,r,c),U=0,C=0,U=C=p=0,P=n);7&c;)c++;return c>>>3},s.F._bestMatch=function(e,r,d,o,y,_){var a=32767&r,t=d[a],n=a-t+32768&32767;if(t==a||o!=s.F._hash(e,r-n))return 0;for(var c=0,l=0,S=Math.min(32767,r);n<=S&&--_!=0&&t!=a;){if(c==0||e[r+c]==e[r+c-n]){var M=s.F._howLong(e,r,n);if(M>c){if(l=n,(c=M)>=y)break;n+2<M&&(M=n+2);for(var w=0,L=0;L<M-2;L++){var U=r-n+L+32768&32767,C=U-d[U]+32768&32767;C>w&&(w=C,t=U)}}}n+=(a=t)-(t=d[a])+32768&32767}return c<<16|l},s.F._howLong=function(e,r,d){if(e[r]!=e[r-d]||e[r+1]!=e[r+1-d]||e[r+2]!=e[r+2-d])return 0;var o=r,y=Math.min(e.length,r+258);for(r+=3;r<y&&e[r]==e[r-d];)r++;return r-o},s.F._hash=function(e,r){return(e[r]<<8|e[r+1])+(e[r+2]<<4)&65535},s.saved=0,s.F._writeBlock=function(e,r,d,o,y,_,a,t,n){var c,l,S,M,w,L,U,C,P,p=s.F.U,I=s.F._putsF,f=s.F._putsE;p.lhst[256]++,l=(c=s.F.getTrees())[0],S=c[1],M=c[2],w=c[3],L=c[4],U=c[5],C=c[6],P=c[7];var v=32+(n+3&7?8-(n+3&7):0)+(a<<3),b=o+s.F.contSize(p.fltree,p.lhst)+s.F.contSize(p.fdtree,p.dhst),A=o+s.F.contSize(p.ltree,p.lhst)+s.F.contSize(p.dtree,p.dhst);A+=14+3*U+s.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var D=0;D<286;D++)p.lhst[D]=0;for(D=0;D<30;D++)p.dhst[D]=0;for(D=0;D<19;D++)p.ihst[D]=0;var k=v<b&&v<A?0:b<A?1:2;if(I(t,n,e),I(t,n+1,k),n+=3,k==0){for(;7&n;)n++;n=s.F._copyExact(y,_,a,t,n)}else{var E,T;if(k==1&&(E=p.fltree,T=p.fdtree),k==2){s.F.makeCodes(p.ltree,l),s.F.revCodes(p.ltree,l),s.F.makeCodes(p.dtree,S),s.F.revCodes(p.dtree,S),s.F.makeCodes(p.itree,M),s.F.revCodes(p.itree,M),E=p.ltree,T=p.dtree,f(t,n,w-257),f(t,n+=5,L-1),f(t,n+=5,U-4),n+=4;for(var h=0;h<U;h++)f(t,n+3*h,p.itree[1+(p.ordr[h]<<1)]);n+=3*U,n=s.F._codeTiny(C,p.itree,t,n),n=s.F._codeTiny(P,p.itree,t,n)}for(var u=_,z=0;z<d;z+=2){for(var R=r[z],W=R>>>23,G=u+(8388607&R);u<G;)n=s.F._writeLit(y[u++],E,t,n);if(W!=0){var $=r[z+1],q=$>>16,N=$>>8&255,O=255&$;f(t,n=s.F._writeLit(257+N,E,t,n),W-p.of0[N]),n+=p.exb[N],I(t,n=s.F._writeLit(O,T,t,n),q-p.df0[O]),n+=p.dxb[O],u+=W}}n=s.F._writeLit(256,E,t,n)}return n},s.F._copyExact=function(e,r,d,o,y){var _=y>>>3;return o[_]=d,o[_+1]=d>>>8,o[_+2]=255-o[_],o[_+3]=255-o[_+1],_+=4,o.set(new Uint8Array(e.buffer,r,d),_),y+(d+4<<3)},s.F.getTrees=function(){for(var e=s.F.U,r=s.F._hufTree(e.lhst,e.ltree,15),d=s.F._hufTree(e.dhst,e.dtree,15),o=[],y=s.F._lenCodes(e.ltree,o),_=[],a=s.F._lenCodes(e.dtree,_),t=0;t<o.length;t+=2)e.ihst[o[t]]++;for(t=0;t<_.length;t+=2)e.ihst[_[t]]++;for(var n=s.F._hufTree(e.ihst,e.itree,7),c=19;c>4&&e.itree[1+(e.ordr[c-1]<<1)]==0;)c--;return[r,d,n,y,a,c,o,_]},s.F.getSecond=function(e){for(var r=[],d=0;d<e.length;d+=2)r.push(e[d+1]);return r},s.F.nonZero=function(e){for(var r="",d=0;d<e.length;d+=2)e[d+1]!=0&&(r+=(d>>1)+",");return r},s.F.contSize=function(e,r){for(var d=0,o=0;o<r.length;o++)d+=r[o]*e[1+(o<<1)];return d},s.F._codeTiny=function(e,r,d,o){for(var y=0;y<e.length;y+=2){var _=e[y],a=e[y+1];o=s.F._writeLit(_,r,d,o);var t=_==16?2:_==17?3:7;_>15&&(s.F._putsE(d,o,a,t),o+=t)}return o},s.F._lenCodes=function(e,r){for(var d=e.length;d!=2&&e[d-1]==0;)d-=2;for(var o=0;o<d;o+=2){var y=e[o+1],_=o+3<d?e[o+3]:-1,a=o+5<d?e[o+5]:-1,t=o==0?-1:e[o-1];if(y==0&&_==y&&a==y){for(var n=o+5;n+2<d&&e[n+2]==y;)n+=2;(c=Math.min(n+1-o>>>1,138))<11?r.push(17,c-3):r.push(18,c-11),o+=2*c-2}else if(y==t&&_==y&&a==y){for(n=o+5;n+2<d&&e[n+2]==y;)n+=2;var c=Math.min(n+1-o>>>1,6);r.push(16,c-3),o+=2*c-2}else r.push(y,0)}return d>>>1},s.F._hufTree=function(e,r,d){var o=[],y=e.length,_=r.length,a=0;for(a=0;a<_;a+=2)r[a]=0,r[a+1]=0;for(a=0;a<y;a++)e[a]!=0&&o.push({lit:a,f:e[a]});var t=o.length,n=o.slice(0);if(t==0)return 0;if(t==1){var c=o[0].lit;return n=c==0?1:0,r[1+(c<<1)]=1,r[1+(n<<1)]=1,1}o.sort(function(C,P){return C.f-P.f});var l=o[0],S=o[1],M=0,w=1,L=2;for(o[0]={lit:-1,f:l.f+S.f,l,r:S,d:0};w!=t-1;)l=M!=w&&(L==t||o[M].f<o[L].f)?o[M++]:o[L++],S=M!=w&&(L==t||o[M].f<o[L].f)?o[M++]:o[L++],o[w++]={lit:-1,f:l.f+S.f,l,r:S};var U=s.F.setDepth(o[w-1],0);for(U>d&&(s.F.restrictDepth(n,d,U),U=d),a=0;a<t;a++)r[1+(n[a].lit<<1)]=n[a].d;return U},s.F.setDepth=function(e,r){return e.lit!=-1?(e.d=r,r):Math.max(s.F.setDepth(e.l,r+1),s.F.setDepth(e.r,r+1))},s.F.restrictDepth=function(e,r,d){var o=0,y=1<<d-r,_=0;for(e.sort(function(t,n){return n.d==t.d?t.f-n.f:n.d-t.d}),o=0;o<e.length&&e[o].d>r;o++){var a=e[o].d;e[o].d=r,_+=y-(1<<d-a)}for(_>>>=d-r;_>0;)(a=e[o].d)<r?(e[o].d++,_-=1<<r-a-1):o++;for(;o>=0;o--)e[o].d==r&&_<0&&(e[o].d--,_++);_!=0&&console.log("debt left")},s.F._goodIndex=function(e,r){var d=0;return r[16|d]<=e&&(d|=16),r[8|d]<=e&&(d|=8),r[4|d]<=e&&(d|=4),r[2|d]<=e&&(d|=2),r[1|d]<=e&&(d|=1),d},s.F._writeLit=function(e,r,d,o){return s.F._putsF(d,o,r[e<<1]),o+r[1+(e<<1)]},s.F.inflate=function(e,r){var d=Uint8Array;if(e[0]==3&&e[1]==0)return r||new d(0);var o=s.F,y=o._bitsF,_=o._bitsE,a=o._decodeTiny,t=o.makeCodes,n=o.codes2map,c=o._get17,l=o.U,S=r==null;S&&(r=new d(e.length>>>2<<3));for(var M,w,L=0,U=0,C=0,P=0,p=0,I=0,f=0,v=0,b=0;L==0;)if(L=y(e,b,1),U=y(e,b+1,2),b+=3,U!=0){if(S&&(r=s.F._check(r,v+(1<<17))),U==1&&(M=l.flmap,w=l.fdmap,I=511,f=31),U==2){C=_(e,b,5)+257,P=_(e,b+5,5)+1,p=_(e,b+10,4)+4,b+=14;for(var A=0;A<38;A+=2)l.itree[A]=0,l.itree[A+1]=0;var D=1;for(A=0;A<p;A++){var k=_(e,b+3*A,3);l.itree[1+(l.ordr[A]<<1)]=k,k>D&&(D=k)}b+=3*p,t(l.itree,D),n(l.itree,D,l.imap),M=l.lmap,w=l.dmap,b=a(l.imap,(1<<D)-1,C+P,e,b,l.ttree);var E=o._copyOut(l.ttree,0,C,l.ltree);I=(1<<E)-1;var T=o._copyOut(l.ttree,C,P,l.dtree);f=(1<<T)-1,t(l.ltree,E),n(l.ltree,E,M),t(l.dtree,T),n(l.dtree,T,w)}for(;;){var h=M[c(e,b)&I];b+=15&h;var u=h>>>4;if(!(u>>>8))r[v++]=u;else{if(u==256)break;var z=v+u-254;if(u>264){var R=l.ldef[u-257];z=v+(R>>>3)+_(e,b,7&R),b+=7&R}var W=w[c(e,b)&f];b+=15&W;var G=W>>>4,$=l.ddef[G],q=($>>>4)+y(e,b,15&$);for(b+=15&$,S&&(r=s.F._check(r,v+(1<<17)));v<z;)r[v]=r[v++-q],r[v]=r[v++-q],r[v]=r[v++-q],r[v]=r[v++-q];v=z}}}else{7&b&&(b+=8-(7&b));var N=4+(b>>>3),O=e[N-4]|e[N-3]<<8;S&&(r=s.F._check(r,v+O)),r.set(new d(e.buffer,e.byteOffset+N,O),v),b=N+O<<3,v+=O}return r.length==v?r:r.slice(0,v)},s.F._check=function(e,r){var d=e.length;if(r<=d)return e;var o=new Uint8Array(Math.max(d<<1,r));return o.set(e,0),o},s.F._decodeTiny=function(e,r,d,o,y,_){for(var a=s.F._bitsE,t=s.F._get17,n=0;n<d;){var c=e[t(o,y)&r];y+=15&c;var l=c>>>4;if(l<=15)_[n]=l,n++;else{var S=0,M=0;l==16?(M=3+a(o,y,2),y+=2,S=_[n-1]):l==17?(M=3+a(o,y,3),y+=3):l==18&&(M=11+a(o,y,7),y+=7);for(var w=n+M;n<w;)_[n]=S,n++}}return y},s.F._copyOut=function(e,r,d,o){for(var y=0,_=0,a=o.length>>>1;_<d;){var t=e[_+r];o[_<<1]=0,o[1+(_<<1)]=t,t>y&&(y=t),_++}for(;_<a;)o[_<<1]=0,o[1+(_<<1)]=0,_++;return y},s.F.makeCodes=function(e,r){for(var d,o,y,_,a=s.F.U,t=e.length,n=a.bl_count,c=0;c<=r;c++)n[c]=0;for(c=1;c<t;c+=2)n[e[c]]++;var l=a.next_code;for(d=0,n[0]=0,o=1;o<=r;o++)d=d+n[o-1]<<1,l[o]=d;for(y=0;y<t;y+=2)(_=e[y+1])!=0&&(e[y]=l[_],l[_]++)},s.F.codes2map=function(e,r,d){for(var o=e.length,y=s.F.U.rev15,_=0;_<o;_+=2)if(e[_+1]!=0)for(var a=_>>1,t=e[_+1],n=a<<4|t,c=r-t,l=e[_]<<c,S=l+(1<<c);l!=S;)d[y[l]>>>15-r]=n,l++},s.F.revCodes=function(e,r){for(var d=s.F.U.rev15,o=15-r,y=0;y<e.length;y+=2){var _=e[y]<<r-e[y+1];e[y]=d[_]>>>o}},s.F._putsE=function(e,r,d){d<<=7&r;var o=r>>>3;e[o]|=d,e[o+1]|=d>>>8},s.F._putsF=function(e,r,d){d<<=7&r;var o=r>>>3;e[o]|=d,e[o+1]|=d>>>8,e[o+2]|=d>>>16},s.F._bitsE=function(e,r,d){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<d)-1},s.F._bitsF=function(e,r,d){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<d)-1},s.F._get17=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},s.F._get25=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},s.F.U=(m=Uint16Array,x=Uint32Array,{next_code:new m(16),bl_count:new m(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new m(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new x(32),flmap:new m(512),fltree:[],fdmap:new m(32),fdtree:[],lmap:new m(32768),ltree:[],ttree:[],dmap:new m(32768),dtree:[],imap:new m(512),itree:[],rev15:new m(32768),lhst:new x(286),dhst:new x(30),ihst:new x(19),lits:new x(15e3),strt:new m(65536),prev:new m(32768)}),function(){for(var e=s.F.U,r=0;r<32768;r++){var d=r;d=(4278255360&(d=(4042322160&(d=(3435973836&(d=(2863311530&d)>>>1|(1431655765&d)<<1))>>>2|(858993459&d)<<2))>>>4|(252645135&d)<<4))>>>8|(16711935&d)<<8,e.rev15[r]=(d>>>16|d<<16)>>>17}function o(y,_,a){for(;_--!=0;)y.push(0,a)}for(r=0;r<32;r++)e.ldef[r]=e.of0[r]<<3|e.exb[r],e.ddef[r]=e.df0[r]<<4|e.dxb[r];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),s.F.makeCodes(e.fltree,9),s.F.codes2map(e.fltree,9,e.flmap),s.F.revCodes(e.fltree,9),o(e.fdtree,32,5),s.F.makeCodes(e.fdtree,5),s.F.codes2map(e.fdtree,5,e.fdmap),s.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)}()})();var hi=fi({__proto__:null,default:qt},[qt]);const tt=function(){var g={nextZero(a,t){for(;a[t]!=0;)t++;return t},readUshort:(a,t)=>a[t]<<8|a[t+1],writeUshort(a,t,n){a[t]=n>>8&255,a[t+1]=255&n},readUint:(a,t)=>16777216*a[t]+(a[t+1]<<16|a[t+2]<<8|a[t+3]),writeUint(a,t,n){a[t]=n>>24&255,a[t+1]=n>>16&255,a[t+2]=n>>8&255,a[t+3]=255&n},readASCII(a,t,n){let c="";for(let l=0;l<n;l++)c+=String.fromCharCode(a[t+l]);return c},writeASCII(a,t,n){for(let c=0;c<n.length;c++)a[t+c]=n.charCodeAt(c)},readBytes(a,t,n){const c=[];for(let l=0;l<n;l++)c.push(a[t+l]);return c},pad:a=>a.length<2?`0${a}`:a,readUTF8(a,t,n){let c,l="";for(let S=0;S<n;S++)l+=`%${g.pad(a[t+S].toString(16))}`;try{c=decodeURIComponent(l)}catch{return g.readASCII(a,t,n)}return c}};function m(a,t,n,c){const l=t*n,S=r(c),M=Math.ceil(t*S/8),w=new Uint8Array(4*l),L=new Uint32Array(w.buffer),{ctype:U}=c,{depth:C}=c,P=g.readUshort;if(U==6){const R=l<<2;if(C==8)for(var p=0;p<R;p+=4)w[p]=a[p],w[p+1]=a[p+1],w[p+2]=a[p+2],w[p+3]=a[p+3];if(C==16)for(p=0;p<R;p++)w[p]=a[p<<1]}else if(U==2){const R=c.tabs.tRNS;if(R==null){if(C==8)for(p=0;p<l;p++){var I=3*p;L[p]=255<<24|a[I+2]<<16|a[I+1]<<8|a[I]}if(C==16)for(p=0;p<l;p++)I=6*p,L[p]=255<<24|a[I+4]<<16|a[I+2]<<8|a[I]}else{var f=R[0];const W=R[1],G=R[2];if(C==8)for(p=0;p<l;p++){var v=p<<2;I=3*p,L[p]=255<<24|a[I+2]<<16|a[I+1]<<8|a[I],a[I]==f&&a[I+1]==W&&a[I+2]==G&&(w[v+3]=0)}if(C==16)for(p=0;p<l;p++)v=p<<2,I=6*p,L[p]=255<<24|a[I+4]<<16|a[I+2]<<8|a[I],P(a,I)==f&&P(a,I+2)==W&&P(a,I+4)==G&&(w[v+3]=0)}}else if(U==3){const R=c.tabs.PLTE,W=c.tabs.tRNS,G=W?W.length:0;if(C==1)for(var b=0;b<n;b++){var A=b*M,D=b*t;for(p=0;p<t;p++){v=D+p<<2;var k=3*(E=a[A+(p>>3)]>>7-((7&p)<<0)&1);w[v]=R[k],w[v+1]=R[k+1],w[v+2]=R[k+2],w[v+3]=E<G?W[E]:255}}if(C==2)for(b=0;b<n;b++)for(A=b*M,D=b*t,p=0;p<t;p++)v=D+p<<2,k=3*(E=a[A+(p>>2)]>>6-((3&p)<<1)&3),w[v]=R[k],w[v+1]=R[k+1],w[v+2]=R[k+2],w[v+3]=E<G?W[E]:255;if(C==4)for(b=0;b<n;b++)for(A=b*M,D=b*t,p=0;p<t;p++)v=D+p<<2,k=3*(E=a[A+(p>>1)]>>4-((1&p)<<2)&15),w[v]=R[k],w[v+1]=R[k+1],w[v+2]=R[k+2],w[v+3]=E<G?W[E]:255;if(C==8)for(p=0;p<l;p++){var E;v=p<<2,k=3*(E=a[p]),w[v]=R[k],w[v+1]=R[k+1],w[v+2]=R[k+2],w[v+3]=E<G?W[E]:255}}else if(U==4){if(C==8)for(p=0;p<l;p++){v=p<<2;var T=a[h=p<<1];w[v]=T,w[v+1]=T,w[v+2]=T,w[v+3]=a[h+1]}if(C==16)for(p=0;p<l;p++){var h;v=p<<2,T=a[h=p<<2],w[v]=T,w[v+1]=T,w[v+2]=T,w[v+3]=a[h+2]}}else if(U==0)for(f=c.tabs.tRNS?c.tabs.tRNS:-1,b=0;b<n;b++){const R=b*M,W=b*t;if(C==1)for(var u=0;u<t;u++){var z=(T=255*(a[R+(u>>>3)]>>>7-(7&u)&1))==255*f?0:255;L[W+u]=z<<24|T<<16|T<<8|T}else if(C==2)for(u=0;u<t;u++)z=(T=85*(a[R+(u>>>2)]>>>6-((3&u)<<1)&3))==85*f?0:255,L[W+u]=z<<24|T<<16|T<<8|T;else if(C==4)for(u=0;u<t;u++)z=(T=17*(a[R+(u>>>1)]>>>4-((1&u)<<2)&15))==17*f?0:255,L[W+u]=z<<24|T<<16|T<<8|T;else if(C==8)for(u=0;u<t;u++)z=(T=a[R+u])==f?0:255,L[W+u]=z<<24|T<<16|T<<8|T;else if(C==16)for(u=0;u<t;u++)T=a[R+(u<<1)],z=P(a,R+(u<<1))==f?0:255,L[W+u]=z<<24|T<<16|T<<8|T}return w}function x(a,t,n,c){const l=r(a),S=Math.ceil(n*l/8),M=new Uint8Array((S+1+a.interlace)*c);return t=a.tabs.CgBI?e(t,M):s(t,M),a.interlace==0?t=d(t,a,0,n,c):a.interlace==1&&(t=function(L,U){const C=U.width,P=U.height,p=r(U),I=p>>3,f=Math.ceil(C*p/8),v=new Uint8Array(P*f);let b=0;const A=[0,0,4,0,2,0,1],D=[0,4,0,2,0,1,0],k=[8,8,8,4,4,2,2],E=[8,8,4,4,2,2,1];let T=0;for(;T<7;){const u=k[T],z=E[T];let R=0,W=0,G=A[T];for(;G<P;)G+=u,W++;let $=D[T];for(;$<C;)$+=z,R++;const q=Math.ceil(R*p/8);d(L,U,b,R,W);let N=0,O=A[T];for(;O<P;){let ae=D[T],ve=b+N*q<<3;for(;ae<C;){var h;if(p==1&&(h=(h=L[ve>>3])>>7-(7&ve)&1,v[O*f+(ae>>3)]|=h<<7-((7&ae)<<0)),p==2&&(h=(h=L[ve>>3])>>6-(7&ve)&3,v[O*f+(ae>>2)]|=h<<6-((3&ae)<<1)),p==4&&(h=(h=L[ve>>3])>>4-(7&ve)&15,v[O*f+(ae>>1)]|=h<<4-((1&ae)<<2)),p>=8){const fe=O*f+ae*I;for(let de=0;de<I;de++)v[fe+de]=L[(ve>>3)+de]}ve+=p,ae+=z}N++,O+=u}R*W!=0&&(b+=W*(1+q)),T+=1}return v}(t,a)),t}function s(a,t){return e(new Uint8Array(a.buffer,2,a.length-6),t)}var e=function(){const a={H:{}};return a.H.N=function(t,n){const c=Uint8Array;let l,S,M=0,w=0,L=0,U=0,C=0,P=0,p=0,I=0,f=0;if(t[0]==3&&t[1]==0)return n||new c(0);const v=a.H,b=v.b,A=v.e,D=v.R,k=v.n,E=v.A,T=v.Z,h=v.m,u=n==null;for(u&&(n=new c(t.length>>>2<<5));M==0;)if(M=b(t,f,1),w=b(t,f+1,2),f+=3,w!=0){if(u&&(n=a.H.W(n,I+(1<<17))),w==1&&(l=h.J,S=h.h,P=511,p=31),w==2){L=A(t,f,5)+257,U=A(t,f+5,5)+1,C=A(t,f+10,4)+4,f+=14;let R=1;for(var z=0;z<38;z+=2)h.Q[z]=0,h.Q[z+1]=0;for(z=0;z<C;z++){const $=A(t,f+3*z,3);h.Q[1+(h.X[z]<<1)]=$,$>R&&(R=$)}f+=3*C,k(h.Q,R),E(h.Q,R,h.u),l=h.w,S=h.d,f=D(h.u,(1<<R)-1,L+U,t,f,h.v);const W=v.V(h.v,0,L,h.C);P=(1<<W)-1;const G=v.V(h.v,L,U,h.D);p=(1<<G)-1,k(h.C,W),E(h.C,W,l),k(h.D,G),E(h.D,G,S)}for(;;){const R=l[T(t,f)&P];f+=15&R;const W=R>>>4;if(!(W>>>8))n[I++]=W;else{if(W==256)break;{let G=I+W-254;if(W>264){const ae=h.q[W-257];G=I+(ae>>>3)+A(t,f,7&ae),f+=7&ae}const $=S[T(t,f)&p];f+=15&$;const q=$>>>4,N=h.c[q],O=(N>>>4)+b(t,f,15&N);for(f+=15&N;I<G;)n[I]=n[I++-O],n[I]=n[I++-O],n[I]=n[I++-O],n[I]=n[I++-O];I=G}}}}else{7&f&&(f+=8-(7&f));const R=4+(f>>>3),W=t[R-4]|t[R-3]<<8;u&&(n=a.H.W(n,I+W)),n.set(new c(t.buffer,t.byteOffset+R,W),I),f=R+W<<3,I+=W}return n.length==I?n:n.slice(0,I)},a.H.W=function(t,n){const c=t.length;if(n<=c)return t;const l=new Uint8Array(c<<1);return l.set(t,0),l},a.H.R=function(t,n,c,l,S,M){const w=a.H.e,L=a.H.Z;let U=0;for(;U<c;){const C=t[L(l,S)&n];S+=15&C;const P=C>>>4;if(P<=15)M[U]=P,U++;else{let p=0,I=0;P==16?(I=3+w(l,S,2),S+=2,p=M[U-1]):P==17?(I=3+w(l,S,3),S+=3):P==18&&(I=11+w(l,S,7),S+=7);const f=U+I;for(;U<f;)M[U]=p,U++}}return S},a.H.V=function(t,n,c,l){let S=0,M=0;const w=l.length>>>1;for(;M<c;){const L=t[M+n];l[M<<1]=0,l[1+(M<<1)]=L,L>S&&(S=L),M++}for(;M<w;)l[M<<1]=0,l[1+(M<<1)]=0,M++;return S},a.H.n=function(t,n){const c=a.H.m,l=t.length;let S,M,w,L;const U=c.j;for(var C=0;C<=n;C++)U[C]=0;for(C=1;C<l;C+=2)U[t[C]]++;const P=c.K;for(S=0,U[0]=0,M=1;M<=n;M++)S=S+U[M-1]<<1,P[M]=S;for(w=0;w<l;w+=2)L=t[w+1],L!=0&&(t[w]=P[L],P[L]++)},a.H.A=function(t,n,c){const l=t.length,S=a.H.m.r;for(let M=0;M<l;M+=2)if(t[M+1]!=0){const w=M>>1,L=t[M+1],U=w<<4|L,C=n-L;let P=t[M]<<C;const p=P+(1<<C);for(;P!=p;)c[S[P]>>>15-n]=U,P++}},a.H.l=function(t,n){const c=a.H.m.r,l=15-n;for(let S=0;S<t.length;S+=2){const M=t[S]<<n-t[S+1];t[S]=c[M]>>>l}},a.H.M=function(t,n,c){c<<=7&n;const l=n>>>3;t[l]|=c,t[l+1]|=c>>>8},a.H.I=function(t,n,c){c<<=7&n;const l=n>>>3;t[l]|=c,t[l+1]|=c>>>8,t[l+2]|=c>>>16},a.H.e=function(t,n,c){return(t[n>>>3]|t[1+(n>>>3)]<<8)>>>(7&n)&(1<<c)-1},a.H.b=function(t,n,c){return(t[n>>>3]|t[1+(n>>>3)]<<8|t[2+(n>>>3)]<<16)>>>(7&n)&(1<<c)-1},a.H.Z=function(t,n){return(t[n>>>3]|t[1+(n>>>3)]<<8|t[2+(n>>>3)]<<16)>>>(7&n)},a.H.i=function(t,n){return(t[n>>>3]|t[1+(n>>>3)]<<8|t[2+(n>>>3)]<<16|t[3+(n>>>3)]<<24)>>>(7&n)},a.H.m=function(){const t=Uint16Array,n=Uint32Array;return{K:new t(16),j:new t(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new t(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new t(512),_:[],h:new t(32),$:[],w:new t(32768),C:[],v:[],d:new t(32768),D:[],u:new t(512),Q:[],r:new t(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new t(65536),g:new t(32768)}}(),function(){const t=a.H.m;for(var n=0;n<32768;n++){let l=n;l=(2863311530&l)>>>1|(1431655765&l)<<1,l=(3435973836&l)>>>2|(858993459&l)<<2,l=(4042322160&l)>>>4|(252645135&l)<<4,l=(4278255360&l)>>>8|(16711935&l)<<8,t.r[n]=(l>>>16|l<<16)>>>17}function c(l,S,M){for(;S--!=0;)l.push(0,M)}for(n=0;n<32;n++)t.q[n]=t.S[n]<<3|t.T[n],t.c[n]=t.p[n]<<4|t.z[n];c(t._,144,8),c(t._,112,9),c(t._,24,7),c(t._,8,8),a.H.n(t._,9),a.H.A(t._,9,t.J),a.H.l(t._,9),c(t.$,32,5),a.H.n(t.$,5),a.H.A(t.$,5,t.h),a.H.l(t.$,5),c(t.Q,19,0),c(t.C,286,0),c(t.D,30,0),c(t.v,320,0)}(),a.H.N}();function r(a){return[1,null,3,1,2,null,4][a.ctype]*a.depth}function d(a,t,n,c,l){let S=r(t);const M=Math.ceil(c*S/8);let w,L;S=Math.ceil(S/8);let U=a[n],C=0;if(U>1&&(a[n]=[0,0,1][U-2]),U==3)for(C=S;C<M;C++)a[C+1]=a[C+1]+(a[C+1-S]>>>1)&255;for(let P=0;P<l;P++)if(w=n+P*M,L=w+P+1,U=a[L-1],C=0,U==0)for(;C<M;C++)a[w+C]=a[L+C];else if(U==1){for(;C<S;C++)a[w+C]=a[L+C];for(;C<M;C++)a[w+C]=a[L+C]+a[w+C-S]}else if(U==2)for(;C<M;C++)a[w+C]=a[L+C]+a[w+C-M];else if(U==3){for(;C<S;C++)a[w+C]=a[L+C]+(a[w+C-M]>>>1);for(;C<M;C++)a[w+C]=a[L+C]+(a[w+C-M]+a[w+C-S]>>>1)}else{for(;C<S;C++)a[w+C]=a[L+C]+o(0,a[w+C-M],0);for(;C<M;C++)a[w+C]=a[L+C]+o(a[w+C-S],a[w+C-M],a[w+C-S-M])}return a}function o(a,t,n){const c=a+t-n,l=c-a,S=c-t,M=c-n;return l*l<=S*S&&l*l<=M*M?a:S*S<=M*M?t:n}function y(a,t,n){n.width=g.readUint(a,t),t+=4,n.height=g.readUint(a,t),t+=4,n.depth=a[t],t++,n.ctype=a[t],t++,n.compress=a[t],t++,n.filter=a[t],t++,n.interlace=a[t],t++}function _(a,t,n,c,l,S,M,w,L){const U=Math.min(t,l),C=Math.min(n,S);let P=0,p=0;for(let T=0;T<C;T++)for(let h=0;h<U;h++)if(M>=0&&w>=0?(P=T*t+h<<2,p=(w+T)*l+M+h<<2):(P=(-w+T)*t-M+h<<2,p=T*l+h<<2),L==0)c[p]=a[P],c[p+1]=a[P+1],c[p+2]=a[P+2],c[p+3]=a[P+3];else if(L==1){var I=a[P+3]*.00392156862745098,f=a[P]*I,v=a[P+1]*I,b=a[P+2]*I,A=c[p+3]*(1/255),D=c[p]*A,k=c[p+1]*A,E=c[p+2]*A;const u=1-I,z=I+A*u,R=z==0?0:1/z;c[p+3]=255*z,c[p+0]=(f+D*u)*R,c[p+1]=(v+k*u)*R,c[p+2]=(b+E*u)*R}else if(L==2)I=a[P+3],f=a[P],v=a[P+1],b=a[P+2],A=c[p+3],D=c[p],k=c[p+1],E=c[p+2],I==A&&f==D&&v==k&&b==E?(c[p]=0,c[p+1]=0,c[p+2]=0,c[p+3]=0):(c[p]=f,c[p+1]=v,c[p+2]=b,c[p+3]=I);else if(L==3){if(I=a[P+3],f=a[P],v=a[P+1],b=a[P+2],A=c[p+3],D=c[p],k=c[p+1],E=c[p+2],I==A&&f==D&&v==k&&b==E)continue;if(I<220&&A>20)return!1}return!0}return{decode:function(t){const n=new Uint8Array(t);let c=8;const l=g,S=l.readUshort,M=l.readUint,w={tabs:{},frames:[]},L=new Uint8Array(n.length);let U,C=0,P=0;const p=[137,80,78,71,13,10,26,10];for(var I=0;I<8;I++)if(n[I]!=p[I])throw"The input is not a PNG file!";for(;c<n.length;){const T=l.readUint(n,c);c+=4;const h=l.readASCII(n,c,4);if(c+=4,h=="IHDR")y(n,c,w);else if(h=="iCCP"){for(var f=c;n[f]!=0;)f++;l.readASCII(n,c,f-c),n[f+1];const u=n.slice(f+2,c+T);let z=null;try{z=s(u)}catch{z=e(u)}w.tabs[h]=z}else if(h=="CgBI")w.tabs[h]=n.slice(c,c+4);else if(h=="IDAT"){for(I=0;I<T;I++)L[C+I]=n[c+I];C+=T}else if(h=="acTL")w.tabs[h]={num_frames:M(n,c),num_plays:M(n,c+4)},U=new Uint8Array(n.length);else if(h=="fcTL"){P!=0&&((E=w.frames[w.frames.length-1]).data=x(w,U.slice(0,P),E.rect.width,E.rect.height),P=0);const u={x:M(n,c+12),y:M(n,c+16),width:M(n,c+4),height:M(n,c+8)};let z=S(n,c+22);z=S(n,c+20)/(z==0?100:z);const R={rect:u,delay:Math.round(1e3*z),dispose:n[c+24],blend:n[c+25]};w.frames.push(R)}else if(h=="fdAT"){for(I=0;I<T-4;I++)U[P+I]=n[c+I+4];P+=T-4}else if(h=="pHYs")w.tabs[h]=[l.readUint(n,c),l.readUint(n,c+4),n[c+8]];else if(h=="cHRM")for(w.tabs[h]=[],I=0;I<8;I++)w.tabs[h].push(l.readUint(n,c+4*I));else if(h=="tEXt"||h=="zTXt"){w.tabs[h]==null&&(w.tabs[h]={});var v=l.nextZero(n,c),b=l.readASCII(n,c,v-c),A=c+T-v-1;if(h=="tEXt")k=l.readASCII(n,v+1,A);else{var D=s(n.slice(v+2,v+2+A));k=l.readUTF8(D,0,D.length)}w.tabs[h][b]=k}else if(h=="iTXt"){w.tabs[h]==null&&(w.tabs[h]={}),v=0,f=c,v=l.nextZero(n,f),b=l.readASCII(n,f,v-f);const u=n[f=v+1];var k;n[f+1],f+=2,v=l.nextZero(n,f),l.readASCII(n,f,v-f),f=v+1,v=l.nextZero(n,f),l.readUTF8(n,f,v-f),A=T-((f=v+1)-c),u==0?k=l.readUTF8(n,f,A):(D=s(n.slice(f,f+A)),k=l.readUTF8(D,0,D.length)),w.tabs[h][b]=k}else if(h=="PLTE")w.tabs[h]=l.readBytes(n,c,T);else if(h=="hIST"){const u=w.tabs.PLTE.length/3;for(w.tabs[h]=[],I=0;I<u;I++)w.tabs[h].push(S(n,c+2*I))}else if(h=="tRNS")w.ctype==3?w.tabs[h]=l.readBytes(n,c,T):w.ctype==0?w.tabs[h]=S(n,c):w.ctype==2&&(w.tabs[h]=[S(n,c),S(n,c+2),S(n,c+4)]);else if(h=="gAMA")w.tabs[h]=l.readUint(n,c)/1e5;else if(h=="sRGB")w.tabs[h]=n[c];else if(h=="bKGD")w.ctype==0||w.ctype==4?w.tabs[h]=[S(n,c)]:w.ctype==2||w.ctype==6?w.tabs[h]=[S(n,c),S(n,c+2),S(n,c+4)]:w.ctype==3&&(w.tabs[h]=n[c]);else if(h=="IEND")break;c+=T,l.readUint(n,c),c+=4}var E;return P!=0&&((E=w.frames[w.frames.length-1]).data=x(w,U.slice(0,P),E.rect.width,E.rect.height)),w.data=x(w,L,w.width,w.height),delete w.compress,delete w.interlace,delete w.filter,w},toRGBA8:function(t){const n=t.width,c=t.height;if(t.tabs.acTL==null)return[m(t.data,n,c,t).buffer];const l=[];t.frames[0].data==null&&(t.frames[0].data=t.data);const S=n*c*4,M=new Uint8Array(S),w=new Uint8Array(S),L=new Uint8Array(S);for(let C=0;C<t.frames.length;C++){const P=t.frames[C],p=P.rect.x,I=P.rect.y,f=P.rect.width,v=P.rect.height,b=m(P.data,f,v,t);if(C!=0)for(var U=0;U<S;U++)L[U]=M[U];if(P.blend==0?_(b,f,v,M,n,c,p,I,0):P.blend==1&&_(b,f,v,M,n,c,p,I,1),l.push(M.buffer.slice(0)),P.dispose!=0){if(P.dispose==1)_(w,f,v,M,n,c,p,I,0);else if(P.dispose==2)for(U=0;U<S;U++)M[U]=L[U]}}return l},_paeth:o,_copyTile:_,_bin:g}}();(function(){const{_copyTile:g}=tt,{_bin:m}=tt,x=tt._paeth;var s={table:function(){const f=new Uint32Array(256);for(let v=0;v<256;v++){let b=v;for(let A=0;A<8;A++)1&b?b=3988292384^b>>>1:b>>>=1;f[v]=b}return f}(),update(f,v,b,A){for(let D=0;D<A;D++)f=s.table[255&(f^v[b+D])]^f>>>8;return f},crc:(f,v,b)=>4294967295^s.update(4294967295,f,v,b)};function e(f,v,b,A){v[b]+=f[0]*A>>4,v[b+1]+=f[1]*A>>4,v[b+2]+=f[2]*A>>4,v[b+3]+=f[3]*A>>4}function r(f){return Math.max(0,Math.min(255,f))}function d(f,v){const b=f[0]-v[0],A=f[1]-v[1],D=f[2]-v[2],k=f[3]-v[3];return b*b+A*A+D*D+k*k}function o(f,v,b,A,D,k,E){E==null&&(E=1);const T=A.length,h=[];for(var u=0;u<T;u++){const O=A[u];h.push([O>>>0&255,O>>>8&255,O>>>16&255,O>>>24&255])}for(u=0;u<T;u++){let O=4294967295;for(var z=0,R=0;R<T;R++){var W=d(h[u],h[R]);R!=u&&W<O&&(O=W,z=R)}}const G=new Uint32Array(D.buffer),$=new Int16Array(v*b*4),q=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(u=0;u<q.length;u++)q[u]=255*((q[u]+.5)/16-.5);for(let O=0;O<b;O++)for(let ae=0;ae<v;ae++){var N;u=4*(O*v+ae),E!=2?N=[r(f[u]+$[u]),r(f[u+1]+$[u+1]),r(f[u+2]+$[u+2]),r(f[u+3]+$[u+3])]:(W=q[4*(3&O)+(3&ae)],N=[r(f[u]+W),r(f[u+1]+W),r(f[u+2]+W),r(f[u+3]+W)]),z=0;let ve=16777215;for(R=0;R<T;R++){const we=d(N,h[R]);we<ve&&(ve=we,z=R)}const fe=h[z],de=[N[0]-fe[0],N[1]-fe[1],N[2]-fe[2],N[3]-fe[3]];E==1&&(ae!=v-1&&e(de,$,u+4,7),O!=b-1&&(ae!=0&&e(de,$,u+4*v-4,3),e(de,$,u+4*v,5),ae!=v-1&&e(de,$,u+4*v+4,1))),k[u>>2]=z,G[u>>2]=A[z]}}function y(f,v,b,A,D){D==null&&(D={});const{crc:k}=s,E=m.writeUint,T=m.writeUshort,h=m.writeASCII;let u=8;const z=f.frames.length>1;let R,W=!1,G=33+(z?20:0);if(D.sRGB!=null&&(G+=13),D.pHYs!=null&&(G+=21),D.iCCP!=null&&(R=pako.deflate(D.iCCP),G+=21+R.length+4),f.ctype==3){for(var $=f.plte.length,q=0;q<$;q++)f.plte[q]>>>24!=255&&(W=!0);G+=8+3*$+4+(W?8+1*$+4:0)}for(var N=0;N<f.frames.length;N++)z&&(G+=38),G+=(fe=f.frames[N]).cimg.length+12,N!=0&&(G+=4);G+=12;const O=new Uint8Array(G),ae=[137,80,78,71,13,10,26,10];for(q=0;q<8;q++)O[q]=ae[q];if(E(O,u,13),u+=4,h(O,u,"IHDR"),u+=4,E(O,u,v),u+=4,E(O,u,b),u+=4,O[u]=f.depth,u++,O[u]=f.ctype,u++,O[u]=0,u++,O[u]=0,u++,O[u]=0,u++,E(O,u,k(O,u-17,17)),u+=4,D.sRGB!=null&&(E(O,u,1),u+=4,h(O,u,"sRGB"),u+=4,O[u]=D.sRGB,u++,E(O,u,k(O,u-5,5)),u+=4),D.iCCP!=null){const de=13+R.length;E(O,u,de),u+=4,h(O,u,"iCCP"),u+=4,h(O,u,"ICC profile"),u+=11,u+=2,O.set(R,u),u+=R.length,E(O,u,k(O,u-(de+4),de+4)),u+=4}if(D.pHYs!=null&&(E(O,u,9),u+=4,h(O,u,"pHYs"),u+=4,E(O,u,D.pHYs[0]),u+=4,E(O,u,D.pHYs[1]),u+=4,O[u]=D.pHYs[2],u++,E(O,u,k(O,u-13,13)),u+=4),z&&(E(O,u,8),u+=4,h(O,u,"acTL"),u+=4,E(O,u,f.frames.length),u+=4,E(O,u,D.loop!=null?D.loop:0),u+=4,E(O,u,k(O,u-12,12)),u+=4),f.ctype==3){for(E(O,u,3*($=f.plte.length)),u+=4,h(O,u,"PLTE"),u+=4,q=0;q<$;q++){const de=3*q,we=f.plte[q],De=255&we,Ae=we>>>8&255,Te=we>>>16&255;O[u+de+0]=De,O[u+de+1]=Ae,O[u+de+2]=Te}if(u+=3*$,E(O,u,k(O,u-3*$-4,3*$+4)),u+=4,W){for(E(O,u,$),u+=4,h(O,u,"tRNS"),u+=4,q=0;q<$;q++)O[u+q]=f.plte[q]>>>24&255;u+=$,E(O,u,k(O,u-$-4,$+4)),u+=4}}let ve=0;for(N=0;N<f.frames.length;N++){var fe=f.frames[N];z&&(E(O,u,26),u+=4,h(O,u,"fcTL"),u+=4,E(O,u,ve++),u+=4,E(O,u,fe.rect.width),u+=4,E(O,u,fe.rect.height),u+=4,E(O,u,fe.rect.x),u+=4,E(O,u,fe.rect.y),u+=4,T(O,u,A[N]),u+=2,T(O,u,1e3),u+=2,O[u]=fe.dispose,u++,O[u]=fe.blend,u++,E(O,u,k(O,u-30,30)),u+=4);const de=fe.cimg;E(O,u,($=de.length)+(N==0?0:4)),u+=4;const we=u;h(O,u,N==0?"IDAT":"fdAT"),u+=4,N!=0&&(E(O,u,ve++),u+=4),O.set(de,u),u+=$,E(O,u,k(O,we,u-we)),u+=4}return E(O,u,0),u+=4,h(O,u,"IEND"),u+=4,E(O,u,k(O,u-4,4)),u+=4,O.buffer}function _(f,v,b){for(let A=0;A<f.frames.length;A++){const D=f.frames[A];D.rect.width;const k=D.rect.height,E=new Uint8Array(k*D.bpl+k);D.cimg=c(D.img,k,D.bpp,D.bpl,E,v,b)}}function a(f,v,b,A,D){const k=D[0],E=D[1],T=D[2],h=D[3],u=D[4],z=D[5];let R=6,W=8,G=255;for(var $=0;$<f.length;$++){const V=new Uint8Array(f[$]);for(var q=V.length,N=0;N<q;N+=4)G&=V[N+3]}const O=G!=255,ae=function(ee,ie,le,ne,X,ce){const ge=[];for(var se=0;se<ee.length;se++){const Ee=new Uint8Array(ee[se]),Re=new Uint32Array(Ee.buffer);var _e;let qe=0,He=0,Pe=ie,Me=le,We=ne?1:0;if(se!=0){const ft=ce||ne||se==1||ge[se-2].dispose!=0?1:2;let rt=0,nt=1e9;for(let at=0;at<ft;at++){var ke=new Uint8Array(ee[se-1-at]);const Vt=new Uint32Array(ee[se-1-at]);let it=ie,Ge=le,Ce=-1,bt=-1;for(let vt=0;vt<le;vt++)for(let mt=0;mt<ie;mt++)Re[be=vt*ie+mt]!=Vt[be]&&(mt<it&&(it=mt),mt>Ce&&(Ce=mt),vt<Ge&&(Ge=vt),vt>bt&&(bt=vt));Ce==-1&&(it=Ge=Ce=bt=0),X&&((1&it)==1&&it--,(1&Ge)==1&&Ge--);const Ct=(Ce-it+1)*(bt-Ge+1);Ct<nt&&(nt=Ct,rt=at,qe=it,He=Ge,Pe=Ce-it+1,Me=bt-Ge+1)}ke=new Uint8Array(ee[se-1-rt]),rt==1&&(ge[se-1].dispose=2),_e=new Uint8Array(Pe*Me*4),g(ke,ie,le,_e,Pe,Me,-qe,-He,0),We=g(Ee,ie,le,_e,Pe,Me,-qe,-He,3)?1:0,We==1?n(Ee,ie,le,_e,{x:qe,y:He,width:Pe,height:Me}):g(Ee,ie,le,_e,Pe,Me,-qe,-He,0)}else _e=Ee.slice(0);ge.push({rect:{x:qe,y:He,width:Pe,height:Me},img:_e,blend:We,dispose:0})}if(ne)for(se=0;se<ge.length;se++){if((Ye=ge[se]).blend==1)continue;const Ee=Ye.rect,Re=ge[se-1].rect,qe=Math.min(Ee.x,Re.x),He=Math.min(Ee.y,Re.y),Pe={x:qe,y:He,width:Math.max(Ee.x+Ee.width,Re.x+Re.width)-qe,height:Math.max(Ee.y+Ee.height,Re.y+Re.height)-He};ge[se-1].dispose=1,se-1!=0&&t(ee,ie,le,ge,se-1,Pe,X),t(ee,ie,le,ge,se,Pe,X)}let Be=0;if(ee.length!=1)for(var be=0;be<ge.length;be++){var Ye;Be+=(Ye=ge[be]).rect.width*Ye.rect.height}return ge}(f,v,b,k,E,T),ve={},fe=[],de=[];if(A!=0){const V=[];for(N=0;N<ae.length;N++)V.push(ae[N].img.buffer);const ee=function(X){let ce=0;for(var ge=0;ge<X.length;ge++)ce+=X[ge].byteLength;const se=new Uint8Array(ce);let _e=0;for(ge=0;ge<X.length;ge++){const ke=new Uint8Array(X[ge]),Be=ke.length;for(let be=0;be<Be;be+=4){let Ye=ke[be],Ee=ke[be+1],Re=ke[be+2];const qe=ke[be+3];qe==0&&(Ye=Ee=Re=0),se[_e+be]=Ye,se[_e+be+1]=Ee,se[_e+be+2]=Re,se[_e+be+3]=qe}_e+=Be}return se.buffer}(V),ie=S(ee,A);for(N=0;N<ie.plte.length;N++)fe.push(ie.plte[N].est.rgba);let le=0;for(N=0;N<ae.length;N++){const ne=(De=ae[N]).img.length;var we=new Uint8Array(ie.inds.buffer,le>>2,ne>>2);de.push(we);const X=new Uint8Array(ie.abuf,le,ne);z&&o(De.img,De.rect.width,De.rect.height,fe,X,we),De.img.set(X),le+=ne}}else for($=0;$<ae.length;$++){var De=ae[$];const V=new Uint32Array(De.img.buffer);var Ae=De.rect.width;for(q=V.length,we=new Uint8Array(q),de.push(we),N=0;N<q;N++){const ee=V[N];if(N!=0&&ee==V[N-1])we[N]=we[N-1];else if(N>Ae&&ee==V[N-Ae])we[N]=we[N-Ae];else{let ie=ve[ee];if(ie==null&&(ve[ee]=ie=fe.length,fe.push(ee),fe.length>=300))break;we[N]=ie}}}const Te=fe.length;for(Te<=256&&u==0&&(W=Te<=2?1:Te<=4?2:Te<=16?4:8,W=Math.max(W,h)),$=0;$<ae.length;$++){(De=ae[$]).rect.x,De.rect.y,Ae=De.rect.width;const V=De.rect.height;let ee=De.img;new Uint32Array(ee.buffer);let ie=4*Ae,le=4;if(Te<=256&&u==0){ie=Math.ceil(W*Ae/8);var Q=new Uint8Array(ie*V);const ne=de[$];for(let X=0;X<V;X++){N=X*ie;const ce=X*Ae;if(W==8)for(var Z=0;Z<Ae;Z++)Q[N+Z]=ne[ce+Z];else if(W==4)for(Z=0;Z<Ae;Z++)Q[N+(Z>>1)]|=ne[ce+Z]<<4-4*(1&Z);else if(W==2)for(Z=0;Z<Ae;Z++)Q[N+(Z>>2)]|=ne[ce+Z]<<6-2*(3&Z);else if(W==1)for(Z=0;Z<Ae;Z++)Q[N+(Z>>3)]|=ne[ce+Z]<<7-1*(7&Z)}ee=Q,R=3,le=1}else if(O==0&&ae.length==1){Q=new Uint8Array(Ae*V*3);const ne=Ae*V;for(N=0;N<ne;N++){const X=3*N,ce=4*N;Q[X]=ee[ce],Q[X+1]=ee[ce+1],Q[X+2]=ee[ce+2]}ee=Q,R=2,le=3,ie=3*Ae}De.img=ee,De.bpl=ie,De.bpp=le}return{ctype:R,depth:W,plte:fe,frames:ae}}function t(f,v,b,A,D,k,E){const T=Uint8Array,h=Uint32Array,u=new T(f[D-1]),z=new h(f[D-1]),R=D+1<f.length?new T(f[D+1]):null,W=new T(f[D]),G=new h(W.buffer);let $=v,q=b,N=-1,O=-1;for(let ve=0;ve<k.height;ve++)for(let fe=0;fe<k.width;fe++){const de=k.x+fe,we=k.y+ve,De=we*v+de,Ae=G[De];Ae==0||A[D-1].dispose==0&&z[De]==Ae&&(R==null||R[4*De+3]!=0)||(de<$&&($=de),de>N&&(N=de),we<q&&(q=we),we>O&&(O=we))}N==-1&&($=q=N=O=0),E&&((1&$)==1&&$--,(1&q)==1&&q--),k={x:$,y:q,width:N-$+1,height:O-q+1};const ae=A[D];ae.rect=k,ae.blend=1,ae.img=new Uint8Array(k.width*k.height*4),A[D-1].dispose==0?(g(u,v,b,ae.img,k.width,k.height,-k.x,-k.y,0),n(W,v,b,ae.img,k)):g(W,v,b,ae.img,k.width,k.height,-k.x,-k.y,0)}function n(f,v,b,A,D){g(f,v,b,A,D.width,D.height,-D.x,-D.y,2)}function c(f,v,b,A,D,k,E){const T=[];let h,u=[0,1,2,3,4];k!=-1?u=[k]:(v*A>5e5||b==1)&&(u=[0]),E&&(h={level:0});const z=hi;for(var R=0;R<u.length;R++){for(let $=0;$<v;$++)l(D,f,$,A,b,u[R]);T.push(z.deflate(D,h))}let W,G=1e9;for(R=0;R<T.length;R++)T[R].length<G&&(W=R,G=T[R].length);return T[W]}function l(f,v,b,A,D,k){const E=b*A;let T=E+b;if(f[T]=k,T++,k==0)if(A<500)for(var h=0;h<A;h++)f[T+h]=v[E+h];else f.set(new Uint8Array(v.buffer,E,A),T);else if(k==1){for(h=0;h<D;h++)f[T+h]=v[E+h];for(h=D;h<A;h++)f[T+h]=v[E+h]-v[E+h-D]+256&255}else if(b==0){for(h=0;h<D;h++)f[T+h]=v[E+h];if(k==2)for(h=D;h<A;h++)f[T+h]=v[E+h];if(k==3)for(h=D;h<A;h++)f[T+h]=v[E+h]-(v[E+h-D]>>1)+256&255;if(k==4)for(h=D;h<A;h++)f[T+h]=v[E+h]-x(v[E+h-D],0,0)+256&255}else{if(k==2)for(h=0;h<A;h++)f[T+h]=v[E+h]+256-v[E+h-A]&255;if(k==3){for(h=0;h<D;h++)f[T+h]=v[E+h]+256-(v[E+h-A]>>1)&255;for(h=D;h<A;h++)f[T+h]=v[E+h]+256-(v[E+h-A]+v[E+h-D]>>1)&255}if(k==4){for(h=0;h<D;h++)f[T+h]=v[E+h]+256-x(0,v[E+h-A],0)&255;for(h=D;h<A;h++)f[T+h]=v[E+h]+256-x(v[E+h-D],v[E+h-A],v[E+h-D-A])&255}}}function S(f,v){const b=new Uint8Array(f),A=b.slice(0),D=new Uint32Array(A.buffer),k=M(A,v),E=k[0],T=k[1],h=b.length,u=new Uint8Array(h>>2);let z;if(b.length<2e7)for(var R=0;R<h;R+=4)z=w(E,W=b[R]*(1/255),G=b[R+1]*(1/255),$=b[R+2]*(1/255),q=b[R+3]*(1/255)),u[R>>2]=z.ind,D[R>>2]=z.est.rgba;else for(R=0;R<h;R+=4){var W=b[R]*.00392156862745098,G=b[R+1]*(1/255),$=b[R+2]*(1/255),q=b[R+3]*(1/255);for(z=E;z.left;)z=L(z.est,W,G,$,q)<=0?z.left:z.right;u[R>>2]=z.ind,D[R>>2]=z.est.rgba}return{abuf:A.buffer,inds:u,plte:T}}function M(f,v,b){b==null&&(b=1e-4);const A=new Uint32Array(f.buffer),D={i0:0,i1:f.length,bst:null,est:null,tdst:0,left:null,right:null};D.bst=P(f,D.i0,D.i1),D.est=p(D.bst);const k=[D];for(;k.length<v;){let T=0,h=0;for(var E=0;E<k.length;E++)k[E].est.L>T&&(T=k[E].est.L,h=E);if(T<b)break;const u=k[h],z=U(f,A,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=z||u.i1<=z){u.est.L=0;continue}const R={i0:u.i0,i1:z,bst:null,est:null,tdst:0,left:null,right:null};R.bst=P(f,R.i0,R.i1),R.est=p(R.bst);const W={i0:z,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(W.bst={R:[],m:[],N:u.bst.N-R.bst.N},E=0;E<16;E++)W.bst.R[E]=u.bst.R[E]-R.bst.R[E];for(E=0;E<4;E++)W.bst.m[E]=u.bst.m[E]-R.bst.m[E];W.est=p(W.bst),u.left=R,u.right=W,k[h]=R,k.push(W)}for(k.sort((T,h)=>h.bst.N-T.bst.N),E=0;E<k.length;E++)k[E].ind=E;return[D,k]}function w(f,v,b,A,D){if(f.left==null)return f.tdst=function(R,W,G,$,q){const N=W-R[0],O=G-R[1],ae=$-R[2],ve=q-R[3];return N*N+O*O+ae*ae+ve*ve}(f.est.q,v,b,A,D),f;const k=L(f.est,v,b,A,D);let E=f.left,T=f.right;k>0&&(E=f.right,T=f.left);const h=w(E,v,b,A,D);if(h.tdst<=k*k)return h;const u=w(T,v,b,A,D);return u.tdst<h.tdst?u:h}function L(f,v,b,A,D){const{e:k}=f;return k[0]*v+k[1]*b+k[2]*A+k[3]*D-f.eMq}function U(f,v,b,A,D,k){for(A-=4;b<A;){for(;C(f,b,D)<=k;)b+=4;for(;C(f,A,D)>k;)A-=4;if(b>=A)break;const E=v[b>>2];v[b>>2]=v[A>>2],v[A>>2]=E,b+=4,A-=4}for(;C(f,b,D)>k;)b-=4;return b+4}function C(f,v,b){return f[v]*b[0]+f[v+1]*b[1]+f[v+2]*b[2]+f[v+3]*b[3]}function P(f,v,b){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D=[0,0,0,0],k=b-v>>2;for(let E=v;E<b;E+=4){const T=f[E]*.00392156862745098,h=f[E+1]*(1/255),u=f[E+2]*(1/255),z=f[E+3]*(1/255);D[0]+=T,D[1]+=h,D[2]+=u,D[3]+=z,A[0]+=T*T,A[1]+=T*h,A[2]+=T*u,A[3]+=T*z,A[5]+=h*h,A[6]+=h*u,A[7]+=h*z,A[10]+=u*u,A[11]+=u*z,A[15]+=z*z}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:D,N:k}}function p(f){const{R:v}=f,{m:b}=f,{N:A}=f,D=b[0],k=b[1],E=b[2],T=b[3],h=A==0?0:1/A,u=[v[0]-D*D*h,v[1]-D*k*h,v[2]-D*E*h,v[3]-D*T*h,v[4]-k*D*h,v[5]-k*k*h,v[6]-k*E*h,v[7]-k*T*h,v[8]-E*D*h,v[9]-E*k*h,v[10]-E*E*h,v[11]-E*T*h,v[12]-T*D*h,v[13]-T*k*h,v[14]-T*E*h,v[15]-T*T*h],z=u,R=I;let W=[Math.random(),Math.random(),Math.random(),Math.random()],G=0,$=0;if(A!=0)for(let N=0;N<16&&(W=R.multVec(z,W),$=Math.sqrt(R.dot(W,W)),W=R.sml(1/$,W),!(N!=0&&Math.abs($-G)<1e-9));N++)G=$;const q=[D*h,k*h,E*h,T*h];return{Cov:u,q,e:W,L:G,eMq255:R.dot(R.sml(255,q),W),eMq:R.dot(W,q),rgba:(Math.round(255*q[3])<<24|Math.round(255*q[2])<<16|Math.round(255*q[1])<<8|Math.round(255*q[0])<<0)>>>0}}var I={multVec:(f,v)=>[f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],f[4]*v[0]+f[5]*v[1]+f[6]*v[2]+f[7]*v[3],f[8]*v[0]+f[9]*v[1]+f[10]*v[2]+f[11]*v[3],f[12]*v[0]+f[13]*v[1]+f[14]*v[2]+f[15]*v[3]],dot:(f,v)=>f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],sml:(f,v)=>[f*v[0],f*v[1],f*v[2],f*v[3]]};tt.encode=function(v,b,A,D,k,E,T){D==null&&(D=0),T==null&&(T=!1);const h=a(v,b,A,D,[!1,!1,!1,0,T,!1]);return _(h,-1),y(h,b,A,k,E)},tt.encodeLL=function(v,b,A,D,k,E,T,h){const u={ctype:0+(D==1?0:2)+(k==0?0:4),depth:E,frames:[]},z=(D+k)*E,R=z*b;for(let W=0;W<v.length;W++)u.frames.push({rect:{x:0,y:0,width:b,height:A},img:new Uint8Array(v[W]),blend:0,dispose:1,bpp:Math.ceil(z/8),bpl:Math.ceil(R/8)});return _(u,0,!0),y(u,b,A,T,h)},tt.encode.compress=a,tt.encode.dither=o,tt.quantize=S,tt.quantize.getKDtree=M,tt.quantize.getNearest=w})();const $r={toArrayBuffer(g,m){const x=g.width,s=g.height,e=x<<2,r=g.getContext("2d").getImageData(0,0,x,s),d=new Uint32Array(r.data.buffer),o=(32*x+31)/32<<2,y=o*s,_=122+y,a=new ArrayBuffer(_),t=new DataView(a),n=1<<20;let c,l,S,M,w=n,L=0,U=0,C=0;function P(f){t.setUint16(U,f,!0),U+=2}function p(f){t.setUint32(U,f,!0),U+=4}function I(f){U+=f}P(19778),p(_),I(4),p(122),p(108),p(x),p(-s>>>0),P(1),P(32),p(3),p(y),p(2835),p(2835),I(8),p(16711680),p(65280),p(255),p(4278190080),p(1466527264),function f(){for(;L<s&&w>0;){for(M=122+L*o,c=0;c<e;)w--,l=d[C++],S=l>>>24,t.setUint32(M+c,l<<8|S),c+=4;L++}C<d.length?(w=n,setTimeout(f,$r._dly)):m(a)}()},toBlob(g,m){this.toArrayBuffer(g,x=>{m(new Blob([x],{type:"image/bmp"}))})},_dly:9};var Ze={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gi={[Ze.CHROME]:16384,[Ze.FIREFOX]:11180,[Ze.DESKTOP_SAFARI]:16384,[Ze.IE]:8192,[Ze.IOS]:4096,[Ze.ETC]:8192};const gr=typeof window<"u",Qr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Wt=gr&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),yi=(gr||Qr)&&(Wt&&Wt.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Vr=(gr||Qr)&&(Wt&&Wt.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function yr(g,m,x=Date.now()){return new Promise(s=>{const e=g.split(","),r=e[0].match(/:(.*?);/)[1],d=globalThis.atob(e[1]);let o=d.length;const y=new Uint8Array(o);for(;o--;)y[o]=d.charCodeAt(o);const _=new Blob([y],{type:r});_.name=m,_.lastModified=x,s(_)})}function Kr(g){return new Promise((m,x)=>{const s=new Vr;s.onload=()=>m(s.result),s.onerror=e=>x(e),s.readAsDataURL(g)})}function Gr(g){return new Promise((m,x)=>{const s=new Image;s.onload=()=>m(s),s.onerror=e=>x(e),s.src=g})}function xt(){if(xt.cachedResult!==void 0)return xt.cachedResult;let g=Ze.ETC;const{userAgent:m}=navigator;return/Chrom(e|ium)/i.test(m)?g=Ze.CHROME:/iP(ad|od|hone)/i.test(m)&&/WebKit/i.test(m)?g=Ze.IOS:/Safari/i.test(m)?g=Ze.DESKTOP_SAFARI:/Firefox/i.test(m)?g=Ze.FIREFOX:(/MSIE/i.test(m)||document.documentMode)&&(g=Ze.IE),xt.cachedResult=g,xt.cachedResult}function Zr(g,m){const x=xt(),s=gi[x];let e=g,r=m,d=e*r;const o=e>r?r/e:e/r;for(;d>s*s;){const y=(s+e)/2,_=(s+r)/2;y<_?(r=_,e=_*o):(r=y*o,e=y),d=e*r}return{width:e,height:r}}function Qt(g,m){let x,s;try{if(x=new OffscreenCanvas(g,m),s=x.getContext("2d"),s===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{x=document.createElement("canvas"),s=x.getContext("2d")}return x.width=g,x.height=m,[x,s]}function Xr(g,m){const{width:x,height:s}=Zr(g.width,g.height),[e,r]=Qt(x,s);return m&&/jpe?g/.test(m)&&(r.fillStyle="white",r.fillRect(0,0,e.width,e.height)),r.drawImage(g,0,0,e.width,e.height),e}function Lt(){return Lt.cachedResult!==void 0||(Lt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Lt.cachedResult}function Yt(g,m={}){return new Promise(function(x,s){let e,r;var d=function(){try{return r=Xr(e,m.fileType||g.type),x([e,r])}catch(y){return s(y)}},o=function(y){try{var _=function(a){try{throw a}catch(t){return s(t)}};try{let a;return Kr(g).then(function(t){try{return a=t,Gr(a).then(function(n){try{return e=n,function(){try{return d()}catch(c){return s(c)}}()}catch(c){return _(c)}},_)}catch(n){return _(n)}},_)}catch(a){_(a)}}catch(a){return s(a)}};try{if(Lt()||[Ze.DESKTOP_SAFARI,Ze.MOBILE_SAFARI].includes(xt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(g).then(function(y){try{return e=y,d()}catch{return o()}},o)}catch{o()}})}function jt(g,m,x,s,e=1){return new Promise(function(r,d){let o;if(m==="image/png"){let _,a,t;return _=g.getContext("2d"),{data:a}=_.getImageData(0,0,g.width,g.height),t=tt.encode([a.buffer],g.width,g.height,4096*e),o=new Blob([t],{type:m}),o.name=x,o.lastModified=s,y.call(this)}{let _=function(){return y.call(this)};if(m==="image/bmp")return new Promise(a=>$r.toBlob(g,a)).then(function(a){try{return o=a,o.name=x,o.lastModified=s,_.call(this)}catch(t){return d(t)}}.bind(this),d);{let a=function(){return _.call(this)};if(typeof OffscreenCanvas=="function"&&g instanceof OffscreenCanvas)return g.convertToBlob({type:m,quality:e}).then(function(t){try{return o=t,o.name=x,o.lastModified=s,a.call(this)}catch(n){return d(n)}}.bind(this),d);{let t;return t=g.toDataURL(m,e),yr(t,x,s).then(function(n){try{return o=n,a.call(this)}catch(c){return d(c)}}.bind(this),d)}}}function y(){return r(o)}})}function ot(g){g.width=0,g.height=0}function Dt(){return new Promise(function(g,m){let x,s,e,r;return Dt.cachedResult!==void 0?g(Dt.cachedResult):yr("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(d){try{return x=d,Yt(x).then(function(o){try{return s=o[1],jt(s,x.type,x.name,x.lastModified).then(function(y){try{return e=y,ot(s),Yt(e).then(function(_){try{return r=_[0],Dt.cachedResult=r.width===1&&r.height===2,g(Dt.cachedResult)}catch(a){return m(a)}},m)}catch(_){return m(_)}},m)}catch(y){return m(y)}},m)}catch(o){return m(o)}},m)})}function Jr(g){return new Promise((m,x)=>{const s=new Vr;s.onload=e=>{const r=new DataView(e.target.result);if(r.getUint16(0,!1)!=65496)return m(-2);const d=r.byteLength;let o=2;for(;o<d;){if(r.getUint16(o+2,!1)<=8)return m(-1);const y=r.getUint16(o,!1);if(o+=2,y==65505){if(r.getUint32(o+=2,!1)!=1165519206)return m(-1);const _=r.getUint16(o+=6,!1)==18761;o+=r.getUint32(o+4,_);const a=r.getUint16(o,_);o+=2;for(let t=0;t<a;t++)if(r.getUint16(o+12*t,_)==274)return m(r.getUint16(o+12*t+8,_))}else{if((65280&y)!=65280)break;o+=r.getUint16(o,!1)}}return m(-1)},s.onerror=e=>x(e),s.readAsArrayBuffer(g)})}function en(g,m){const{width:x}=g,{height:s}=g,{maxWidthOrHeight:e}=m;let r,d=g;return isFinite(e)&&(x>e||s>e)&&([d,r]=Qt(x,s),x>s?(d.width=e,d.height=s/x*e):(d.width=x/s*e,d.height=e),r.drawImage(g,0,0,d.width,d.height),ot(g)),d}function tn(g,m){const{width:x}=g,{height:s}=g,[e,r]=Qt(x,s);switch(m>4&&m<9?(e.width=s,e.height=x):(e.width=x,e.height=s),m){case 2:r.transform(-1,0,0,1,x,0);break;case 3:r.transform(-1,0,0,-1,x,s);break;case 4:r.transform(1,0,0,-1,0,s);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,s,0);break;case 7:r.transform(0,-1,-1,0,s,x);break;case 8:r.transform(0,-1,1,0,0,x)}return r.drawImage(g,0,0,x,s),ot(g),e}function Mr(g,m,x=0){return new Promise(function(s,e){let r,d,o,y,_,a,t,n,c,l,S,M,w,L,U,C,P,p,I,f;function v(A=5){if(m.signal&&m.signal.aborted)throw m.signal.reason;r+=A,m.onProgress(Math.min(r,100))}function b(A){if(m.signal&&m.signal.aborted)throw m.signal.reason;r=Math.min(Math.max(A,r),100),m.onProgress(r)}return r=x,d=m.maxIteration||10,o=1024*m.maxSizeMB*1024,v(),Yt(g,m).then(function(A){try{return[,y]=A,v(),_=en(y,m),v(),new Promise(function(D,k){var E;if(!(E=m.exifOrientation))return Jr(g).then(function(h){try{return E=h,T.call(this)}catch(u){return k(u)}}.bind(this),k);function T(){return D(E)}return T.call(this)}).then(function(D){try{return a=D,v(),Dt().then(function(k){try{return t=k?_:tn(_,a),v(),n=m.initialQuality||1,c=m.fileType||g.type,jt(t,c,g.name,g.lastModified,n).then(function(E){try{{let h=function(){if(d--&&(U>o||U>w)){let z,R;return z=f?.95*I.width:I.width,R=f?.95*I.height:I.height,[P,p]=Qt(z,R),p.drawImage(I,0,0,z,R),n*=c==="image/png"?.85:.95,jt(P,c,g.name,g.lastModified,n).then(function(W){try{return C=W,ot(I),I=P,U=C.size,b(Math.min(99,Math.floor((L-U)/(L-o)*100))),h}catch(G){return e(G)}},e)}return[1]},u=function(){return ot(I),ot(P),ot(_),ot(t),ot(y),b(100),s(C)};if(l=E,v(),S=l.size>o,M=l.size>g.size,!S&&!M)return b(100),s(l);var T;return w=g.size,L=l.size,U=L,I=t,f=!m.alwaysKeepResolution&&S,(T=function(z){for(;z;){if(z.then)return void z.then(T,e);try{if(z.pop){if(z.length)return z.pop()?u.call(this):z;z=h}else z=z.call(this)}catch(R){return e(R)}}}.bind(this))(h)}}catch(h){return e(h)}}.bind(this),e)}catch(E){return e(E)}}.bind(this),e)}catch(k){return e(k)}}.bind(this),e)}catch(D){return e(D)}}.bind(this),e)})}const _i=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let cr;function pi(g,m){return new Promise((x,s)=>{cr||(cr=function(d){const o=[];return o.push(d),URL.createObjectURL(new Blob(o))}(_i));const e=new Worker(cr);e.addEventListener("message",function(d){if(m.signal&&m.signal.aborted)e.terminate();else if(d.data.progress===void 0){if(d.data.error)return s(new Error(d.data.error)),void e.terminate();x(d.data.file),e.terminate()}else m.onProgress(d.data.progress)}),e.addEventListener("error",s),m.signal&&m.signal.addEventListener("abort",()=>{s(m.signal.reason),e.terminate()}),e.postMessage({file:g,imageCompressionLibUrl:m.libURL,options:{...m,onProgress:void 0,signal:void 0}})})}function je(g,m){return new Promise(function(x,s){let e,r,d,o,y,_;if(e={...m},d=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,y=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=c=>{d=c,typeof o=="function"&&o(d)},!(g instanceof Blob||g instanceof yi))return s(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(g.type))return s(new Error("The file given is not an image"));if(_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!y||typeof Worker!="function"||_)return Mr(g,e).then(function(c){try{return r=c,n.call(this)}catch(l){return s(l)}}.bind(this),s);var a=function(){try{return n.call(this)}catch(c){return s(c)}}.bind(this),t=function(c){try{return Mr(g,e).then(function(l){try{return r=l,a()}catch(S){return s(S)}},s)}catch(l){return s(l)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",pi(g,e).then(function(c){try{return r=c,a()}catch{return t()}},t)}catch{t()}function n(){try{r.name=g.name,r.lastModified=g.lastModified}catch{}try{e.preserveExif&&g.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===g.type)&&(r=jr(g,r))}catch{}return x(r)}})}je.getDataUrlFromFile=Kr,je.getFilefromDataUrl=yr,je.loadImage=Gr,je.drawImageInCanvas=Xr,je.drawFileInCanvas=Yt,je.canvasToFile=jt,je.getExifOrientation=Jr,je.handleMaxWidthOrHeight=en,je.followExifOrientation=tn,je.cleanupCanvasMemory=ot,je.isAutoOrientationInBrowser=Dt,je.approximateBelowMaximumCanvasSizeOfBrowser=Zr,je.copyExifWithoutOrientation=jr,je.getBrowserName=xt,je.version="2.0.2";const bi={maxSizeMB:.8,maxWidthOrHeight:2400,initialQuality:.9,useWebWorker:!0,compressionThresholdMB:1};async function wi(g,m,x={},s){const e={...bi,...x};try{let r=g;if(g.type.startsWith("image/")&&g.size>e.compressionThresholdMB*1024*1024){s?.("Compressing image...");try{const y=await je(g,{maxSizeMB:e.maxSizeMB,maxWidthOrHeight:e.maxWidthOrHeight,initialQuality:e.initialQuality,useWebWorker:e.useWebWorker});r=y;const _=(g.size/(1024*1024)).toFixed(2),a=(y.size/(1024*1024)).toFixed(2),t=((1-y.size/g.size)*100).toFixed(0);console.log(`Image compressed: ${_}MB → ${a}MB (${t}% smaller)`)}catch(y){console.warn("Image compression failed, uploading original:",y)}}return s?.("Uploading file..."),{success:!0,attachment:await zn(r,m)}}catch(r){return console.error("File upload failed:",r),{success:!1,error:r instanceof Error?r.message:"Upload failed"}}}async function xi(g){try{const m=Bn(g.url);return await Ln(m),!0}catch(m){return console.error("Failed to remove attachment:",m),!1}}function Ei(g,m,x){return g.map(s=>s.id===m?{...s,name:x}:s)}function Ai(g,m=5){const x=g.type.startsWith("image/"),s=m*1024*1024;if(!x&&g.size>s){const e=(g.size/1048576).toFixed(2);return{valid:!1,error:`Non-image files must be under ${m}MB (selected file is ${e}MB)`}}return{valid:!0}}function Di(g){return{uploadAttachment:(m,x,s)=>wi(m,x,g,s),removeAttachment:xi,updateAttachmentName:Ei,validateFile:Ai}}function Cr(g,m){const[x,s]=m.split(":").map(Number);let e=ia(g,x);return e=sa(e,s),e}function Fr(g){return Array.from(new Set(g)).sort((m,x)=>m-x)}function Si(g,m){if(m.includes(g))return 0;const x=m.find(s=>s>g);return x!==void 0?x-g:7-g+m[0]}function Ii(g,m,x){const s=new Date(g),e=_t(s,Ke),r=e.getDay(),d=Si(r,x);if(d===0)return{start_time:g,end_time:m};const o=Nt(e,d),y=Et(o,Ke);let _=m;if(m){const a=_t(new Date(m),Ke),t=Nt(a,d);_=Et(t,Ke).toISOString()}return{start_time:y.toISOString(),end_time:_}}function rn({eventItem:g,dateInput:m,startTimeInput:x,endTimeInput:s,attachments:e,isRecurring:r,recurrenceFrequency:d,recurrenceInterval:o,recurringDays:y,recurrenceEndDate:_,hasEndDate:a,monthlyType:t}){const n=!g.id,c={...g.meta_data??{}};g.category&&(c.category=g.category);const l=zr(),S=l?fr(l.stores.currentUser):void 0;if(n){const p=l?fr(l.stores.userOrganizations):void 0,I=S?.displayName||S?.username,f=S?.id;I&&!c.submitted_by_name&&(c.submitted_by_name=I),f&&!c.submitted_by_user_id&&(c.submitted_by_user_id=f);const v=p?Array.from(p):[];v.length&&!c.submitted_by_organizations&&(c.submitted_by_organizations=v),c.submitted_at||(c.submitted_at=new Date().toISOString())}else{const p=S?.displayName||S?.username;p&&(c.edited_by_name=p),S?.id&&(c.edited_by_user_id=S.id),c.edited_at=new Date().toISOString()}const M=Object.keys(c).length?c:void 0,w={title:g.title,description:g.description,location:g.location,is_public:g.is_public??!0,event_type:g.event_type,meta_data:M,attachments:e.length>0?e:null};if(g.event_type!=="calendar_event")return{...w,start_time:void 0,end_time:void 0,is_all_day:void 0,recurrence_rule:void 0,recurrence_end_date:void 0};const L=m?Ht(m,"yyyy-MM-dd",new Date):new Date;let U,C;if(g.is_all_day){const p=Et(L,Ke);U=p.toISOString(),C=p.toISOString()}else{const p=new Date(L.getTime()),I=new Date(L.getTime()),f=x?Cr(p,x):L,v=s?Cr(I,s):L;U=Et(f,Ke).toISOString(),C=Et(v,Ke).toISOString()}const P={...w,start_time:U,end_time:C,is_all_day:g.is_all_day};if(r&&P.start_time){if(d==="weekly"&&y.length>0){const I=Fr(y),f=Ii(P.start_time,P.end_time,I);P.start_time=f.start_time,P.end_time=f.end_time}if(d==="daily"||d==="yearly"||d==="weekly"&&y.length>0||d==="monthly"){const{recurrence_rule:I,recurrence_end_date:f}=hr({frequency:d,interval:o,recurringDays:d==="weekly"?Fr(y):[],recurrenceEndDate:_,hasEndDate:a,monthlyType:t,startTime:P.start_time});P.recurrence_rule=I,P.recurrence_end_date=f}else P.recurrence_rule=void 0,P.recurrence_end_date=void 0}else P.recurrence_rule=void 0,P.recurrence_end_date=void 0;return P}async function ki({id:g,...m}){const x=rn(m);return g?(m.eventItem.bishop_approval==="NO"&&Object.assign(x,{bishop_approval:null,bishop_approval_at:null,bishop_approval_by_user_id:null,first_counselor_approval:null,first_counselor_approval_at:null,first_counselor_approval_by_user_id:null,second_counselor_approval:null,second_counselor_approval_at:null,second_counselor_approval_by_user_id:null}),{action:"update",event:await At(g,x)}):{action:"create",event:await Br(x)}}async function Ti(g){await Pr(g)}function Ri({event:g,newDate:m}){const x=g.start_time?new Date(g.start_time):new Date,s=g.end_time?new Date(g.end_time):new Date,[e,r,d]=m.split("-").map(Number),o=new Date(x);o.setFullYear(e,r-1,d);const y=new Date(s);return y.setFullYear(e,r-1,d),{...g,id:void 0,title:`CLONED - ${g.title}`,start_time:o.toISOString(),end_time:y.toISOString(),attachments:[],recurrence_rule:void 0,recurrence_end_date:void 0}}async function Mi(g,m,x){const s=await Mt(g);if(!s)throw new Error("Event not found");const e=s.recurrence_exceptions||[];e.includes(m)||e.push(m);const r=s.recurrence_overrides||{};r[m]={title:x.title,description:x.description,location:x.location,start_time:x.start_time,end_time:x.end_time,is_all_day:x.is_all_day,meta_data:x.meta_data},await At(g,{recurrence_exceptions:e,recurrence_overrides:r})}async function Ci(g,m,x){const s=await Mt(g);if(!s||!s.recurrence_rule||!s.start_time)throw new Error("Event not found or is not recurring");const{parseRecurrenceRule:e,generateRecurrenceRule:r}=await zt(async()=>{const{parseRecurrenceRule:U,generateRecurrenceRule:C}=await Promise.resolve().then(()=>vr);return{parseRecurrenceRule:U,generateRecurrenceRule:C}},void 0,import.meta.url),d=e(s.recurrence_rule,s.recurrence_end_date);if(!d)throw new Error("Failed to parse recurrence rule");const o=Ne(new Date(s.start_time),"yyyy-MM-dd"),y=Ht(m,"yyyy-MM-dd",new Date),_=Ht(o,"yyyy-MM-dd",new Date);if(y<=_)return await At(g,x),g;const a=Nt(y,-1),t=Ne(a,"yyyy-MM-dd"),{recurrence_rule:n,recurrence_end_date:c}=r({frequency:d.frequency,interval:d.interval,recurringDays:d.recurringDays,recurrenceEndDate:t,hasEndDate:!0,monthlyType:d.monthlyType,startTime:s.start_time});await At(g,{recurrence_rule:n,recurrence_end_date:c});const l=d.hasEndDate?d.recurrenceEndDate:"",{recurrence_rule:S,recurrence_end_date:M}=r({frequency:d.frequency,interval:d.interval,recurringDays:d.recurringDays,recurrenceEndDate:l,hasEndDate:d.hasEndDate,monthlyType:d.monthlyType,startTime:x.start_time||s.start_time}),w={...x,recurrence_rule:S,recurrence_end_date:M};return(await Br(w))?.id||0}async function Fi(g,m){const x=await Mt(g);if(!x)throw new Error("Event not found");const s={title:m.title,description:m.description,location:m.location,event_type:m.event_type,meta_data:m.meta_data,attachments:m.attachments,is_all_day:m.is_all_day,start_time:x.start_time,end_time:x.end_time,recurrence_rule:x.recurrence_rule,recurrence_end_date:x.recurrence_end_date,recurrence_exceptions:[],recurrence_overrides:{}};await At(g,s)}async function Ui(g,m){const x=await Mt(g);if(!x)throw new Error("Event not found");const s=x.recurrence_exceptions||[];s.includes(m)||s.push(m);const e=x.recurrence_overrides||{};e[m]&&delete e[m],await At(g,{recurrence_exceptions:s,recurrence_overrides:e})}async function Oi(g,m){const x=await Mt(g);if(!x||!x.recurrence_rule||!x.start_time)throw new Error("Event not found or is not recurring");const s=Ht(m,"yyyy-MM-dd",new Date),e=Nt(s,-1),r=Ne(e,"yyyy-MM-dd"),{parseRecurrenceRule:d}=await zt(async()=>{const{parseRecurrenceRule:t}=await Promise.resolve().then(()=>vr);return{parseRecurrenceRule:t}},void 0,import.meta.url),o=d(x.recurrence_rule,x.recurrence_end_date);if(!o)throw new Error("Failed to parse recurrence rule");const{generateRecurrenceRule:y}=await zt(async()=>{const{generateRecurrenceRule:t}=await Promise.resolve().then(()=>vr);return{generateRecurrenceRule:t}},void 0,import.meta.url),{recurrence_rule:_,recurrence_end_date:a}=y({frequency:o.frequency,interval:o.interval,recurringDays:o.recurringDays,recurrenceEndDate:r,hasEndDate:!0,monthlyType:o.monthlyType,startTime:x.start_time});await At(g,{recurrence_rule:_,recurrence_end_date:a})}async function Pi(g){await Pr(g)}function Bi(){return{saveEvent:ki,deleteEventById:Ti,cloneEventForDate:Ri,buildEventPayload:rn,saveSingleInstance:Mi,saveFutureInstances:Ci,saveAllInstances:Fi,deleteSingleInstance:Ui,deleteFutureInstances:Oi,deleteAllInstances:Pi}}var Li=ue('<div class="alert alert-info d-flex align-items-center gap-2 mb-0" role="alert"><i class="bi bi-arrow-repeat"></i> <div><strong>Recurring Event</strong> <div class="small">Changes to this event will apply to all future occurrences.</div></div></div>'),zi=ue('<button class="btn btn-primary btn-sm"><i class="bi bi-files"></i> <span class="ms-1">Clone</span></button>'),Hi=ue("<!> <!>",1),Ni=ue('<span class="badge bg-secondary-subtle text-secondary-emphasis"> </span>'),qi=ue('<div class="card"><button type="button" class="btn btn-link text-start text-decoration-none d-flex align-items-center gap-3 p-3 w-100 submitter-chat-toggle svelte-1ujj5ue"><i class="bi bi-chat-left-dots"></i> <div class="d-flex flex-column align-items-start"><span class="fw-semibold">Discussion with Bishopric</span> <small class="text-muted">Ask questions or respond to feedback</small></div> <div class="ms-auto d-flex align-items-center gap-2"><!> <i class="bi bi-chevron-right"></i></div></button></div> <!>',1),Wi=ue('<div class="alert alert-info small mb-0 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All submissions require bishopric approval before they appear on the public calendar.</span></div> <!>',1),Yi=ue('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),ji=ue("<span>Save</span>"),$i=ue("<span>Create</span>"),Qi=ue('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),Vi=ue('<button class="btn btn-primary position-relative"><!> <!></button>'),Ki=ue('<div class="d-flex flex-column gap-4"><!> <div class="d-flex flex-column gap-3"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap"><h2 class="h5 mb-0">Event Details</h2> <!></div> <!></div> <!> <!> <!> <!> <div class="d-flex justify-content-between align-items-center gap-2 flex-row"><div class="d-flex flex-row gap-2"><!></div> <div class="d-flex flex-row gap-2"><button class="btn btn-secondary position-relative">Cancel</button> <!></div></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span></div> <!></div> <!> <!>',1);function xs(g,m){dt(m,!1);const x=()=>ar(L,"$userOrganizations",r),s=()=>ar(U,"$currentUser",r),e=()=>ar(C,"$validationErrors",r),[r,d]=On(),o=oe(),y=oe(),_=oe(),a=oe(),t=oe();let n=me(m,"name",8,""),c=me(m,"drawerId",8,""),l=me(m,"eventItem",12,Vn),S=me(m,"canDelete",8,!0),M=me(m,"canCreate",8,!0);const{actions:{reload:w}}=Hn(),{stores:{userOrganizations:L,currentUser:U}}=zr(),{validationErrors:C,validate:P,getErrorMessages:p,clearErrors:I}=ui(),{parseRecurrenceRule:f}=Yr(),{uploadAttachment:v,removeAttachment:b,updateAttachmentName:A,validateFile:D}=Di(),{saveEvent:k,deleteEventById:E,cloneEventForDate:T,buildEventPayload:h,saveSingleInstance:u,saveFutureInstances:z,saveAllInstances:R,deleteSingleInstance:W,deleteFutureInstances:G,deleteAllInstances:$}=Bi();let q=oe(!1),N=oe(!1),O=oe(!1),ae=oe("weekly"),ve=oe(1),fe=oe([]),de=oe(""),we=oe(!0),De=oe("date"),Ae=oe([]),Te=oe(!1),Q=oe(!1),Z=oe(void 0),V=oe(void 0),ee=oe(!1),ie=oe(null),le=oe(!1),ne=oe(null),X=oe(0),ce=oe({title:"",description:"",start_time:"",end_time:"",location:"",is_all_day:!1,event_type:"announcement"}),ge=oe({message:"",type:"info"}),se=oe(""),_e=oe(""),ke=oe(""),Be=oe({dateInput:"",startTimeInput:"",endTimeInput:"",isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"}),be=oe(!1);const Ye=(K,Y)=>K.length===Y.length&&K.every((ye,Se)=>ye===Y[Se]);let Ee=oe([]),Re=oe(!1),qe=oe(!1);const He=`submitter-chat-form-${na()}`;let Pe=oe(null),Me=null,We=null;Hr(async()=>{typeof window<"u"&&(We=(await zt(()=>import("./DO0djbQe.js").then(Y=>Y.o),__vite__mapDeps([0,1]),import.meta.url)).default)}),Zn(()=>{nt()});function ft(){if(!We)return;const K=document.getElementById(He);if(!K)return;We.getOrCreateInstance(K).show()}function rt(K){const Y=K??l()?.id??null;if(Me||!Y)return;const ye=typeof window<"u"?localStorage.getItem("authToken"):null;ye&&lr.realtime.setAuth(ye),Me=lr.channel(`submitter-comments-form-${Y}`).on("postgres_changes",{event:"*",schema:"public",table:"event_submitter_comments",filter:`event_id=eq.${Y}`},()=>{at(Y)}).subscribe()}function nt(){Me&&(lr.removeChannel(Me),Me=null)}async function at(K){const Y=K??l()?.id??null;if(Y){i(qe)||F(Re,!0);try{const ye=await Nn(Y);Y===(l()?.id??null)&&(F(Ee,ye),F(qe,!0))}catch(ye){console.error("Failed to load submitter comments:",ye)}finally{Y===(l()?.id??null)&&F(Re,!1)}}}async function Vt(K){if(!l()?.id||!s()?.id)return;const Y=s().displayName||s().username||"Unknown";await jn(l().id,s().id,Y,K),await at()}async function it(K){await Yn(K),await at()}const Ge=()=>{const K=`[data-bs-target="#${c()}"]`,Y=document.querySelector(K);Y&&Y.click()},Ce=(K,Y=0,ye="info")=>{nr(ge,i(ge).message=K),nr(ge,i(ge).type=ye),Y&&setTimeout(()=>{nr(ge,i(ge).message="")},Y)},bt=async K=>{const Y=K.detail;if(!Y)return;const ye=D(Y);if(!ye.valid){Ce(ye.error??"Invalid file selected",7e3,"danger");return}F(N,!0);try{const Se=await v(Y,i(o)??"temp",Xe=>Ce(Xe));if(!Se.success||!Se.attachment)throw new Error(Se.error??"Upload failed");F(Ae,[...i(Ae),Se.attachment]),F(Te,!0),Ce("File uploaded!",3e3,"success")}catch(Se){console.error("File upload failed:",Se),Ce("Failed to upload file. Please try again.",7e3,"danger")}finally{F(N,!1)}},Ct=K=>{const{attachment:Y,newName:ye}=K.detail;F(Ae,A(i(Ae),Y.id,ye)),F(Te,!0),Ce("Attachment name updated!",3e3,"success")},vt=async K=>{const Y=K.detail;if(Y){F(N,!0);try{if(!await b(Y))throw new Error("Failed to remove attachment");F(Ae,i(Ae).filter(Se=>Se.id!==Y.id)),F(Te,!0),Ce("Attachment removed!",3e3,"success")}catch(ye){console.error("Failed to remove attachment:",ye),Ce("Failed to remove attachment. Please try again.",7e3,"danger")}finally{F(N,!1)}}},mt=async()=>{if(!i(o)){Ce("ID is not defined",0,"danger");return}try{await E(i(o)),await w(),ht("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{F(q,!1),F(ce,{...l(),id:i(o)}),Ce("Event Deleted",3e3,"success"),Ge()},800)}catch(K){ht("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{F(q,!1),console.error("Delete failed:",K),Ce("Failed to delete event. Please try again.",7e3,"danger")},800)}},nn=()=>!!l().recurrence_rule,an=async()=>{const K=i(o)||l().meta_data?.recurring_parent_id;if(K&&i(Q)&&i(V)&&i(Z)){if(F(ne,null),F(le,!0),await new Promise(Y=>{const ye=setInterval(()=>{i(le)||(clearInterval(ye),Y())},50)}),!i(ne))return;F(q,!0);try{i(ne)==="single"?await W(K,i(Z)):i(ne)==="future"?await G(K,i(Z)):i(ne)==="all"&&await $(K),await w(),ht("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{F(q,!1),F(ce,{...l(),id:i(o)}),Ce("Event Deleted",3e3,"success"),Ge()},800)}catch(Y){ht("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{F(q,!1),console.error("Delete failed:",Y),Ce("Failed to delete event. Please try again.",7e3,"danger")},800)}}else F(q,!0),Xn({title:"Delete Confirmation",message:nn()?"This recurring event and every occurrence, past and future, will be removed. You won't be able to undo this. Continue?":"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:Y=>{Y?mt():F(q,!1)}})},sn=K=>{if(i(o))try{const Y=T({event:l(),newDate:K});ht("clone_calendar_event_form_loaded","interaction","Clone Calendar Event Form Loaded",1),Ce("Event cloned. Review and click Create to save.",5e3,"success"),l(Y),F(se,Y.start_time?Ne(new Date(Y.start_time),"yyyy-MM-dd"):""),F(_e,Y.start_time?Ne(new Date(Y.start_time),"HH:mm"):""),F(ke,Y.end_time?Ne(new Date(Y.end_time),"HH:mm"):""),F(Ae,[]),F(O,!1),F(fe,[]),F(de,""),F(we,!0),F(Te,!0),F(X,void 0),F(ce,{...Y}),F(Be,{dateInput:i(se),startTimeInput:i(_e),endTimeInput:i(ke),isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"})}catch(Y){console.error("Clone failed:",Y),Ce("Failed to clone event. Please try again.",7e3,"danger")}},ln=()=>{ci({title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",defaultDate:i(se),callback:(K,Y)=>{K&&Y&&sn(Y)}})},on=async()=>{if(i(o)&&!i(_)){Ce("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!await P({title:l().title,event_type:l().event_type,category:l().category??"",description:l().description,location:l().location,is_all_day:l().is_all_day,dateInput:i(se),startTimeInput:i(_e),endTimeInput:i(ke),isRecurring:i(O),recurrenceFrequency:i(ae),recurringDays:i(O)?i(fe):[],recurrenceEndDate:i(O)?i(de):void 0,hasEndDate:i(we)})){const ye=p();ye.length&&Ce(ye.join(". ")+".  Please address accordingly.",0,"danger");return}const Y=i(o)||l().meta_data?.recurring_parent_id;if(Y&&i(Q)&&i(V)&&i(Z)){if(F(ie,null),F(ee,!0),await new Promise(Se=>{const Xe=setInterval(()=>{i(ee)||(clearInterval(Xe),Se())},100)}),!i(ie)||i(q))return;Ce("Saving ..."),F(q,!0);const ye=h({eventItem:l(),dateInput:i(se),startTimeInput:i(_e),endTimeInput:i(ke),attachments:i(Ae),isRecurring:i(y)&&i(O),recurrenceFrequency:i(ae),recurrenceInterval:i(ve),recurringDays:i(O)?i(fe):[],recurrenceEndDate:i(O)?i(de):"",hasEndDate:i(we),monthlyType:i(De)});try{let Se;i(ie)==="single"?await u(Y,i(Z),ye):i(ie)==="future"?Se=await z(Y,i(Z),ye):i(ie)==="all"&&await R(Y,ye),await w(),await Cn(),ht("set_calendar_event_success","interaction",`Set Calendar Event Successful ${l().title}`,1),F(q,!1),Se&&l({...l(),id:Se}),l(l().attachments=i(Ae),!0),F(ce,{...l(),id:Se||Y}),F(Te,!1),Ce("Saved",3e3,"success"),Ge()}catch(Se){ht("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${l().title}`,1),setTimeout(()=>{F(q,!1),console.error("Save failed:",Se),Ce("Failed to save event. Please try again.",7e3,"danger")},800)}}else{if(i(q))return;Ce("Saving ..."),F(q,!0);try{const ye=await k({id:i(o),eventItem:l(),dateInput:i(se),startTimeInput:i(_e),endTimeInput:i(ke),attachments:i(Ae),isRecurring:i(y)&&i(O),recurrenceFrequency:i(ae),recurrenceInterval:i(ve),recurringDays:i(O)?i(fe):[],recurrenceEndDate:i(O)?i(de):"",hasEndDate:i(we),monthlyType:i(De)});ye.event&&l({...l(),...ye.event}),l(l().attachments=i(Ae),!0),await w(),ht("set_calendar_event_success","interaction",`Set Calendar Event Successful ${l().title}`,1),setTimeout(()=>{F(q,!1),F(ce,{...l(),id:i(o)}),F(Te,!1),Ce("Saved",3e3,"success"),Ge()},800)}catch(ye){ht("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${l().title}`,1),setTimeout(()=>{F(q,!1),console.error("Save failed:",ye),Ce("Failed to save event. Please try again.",7e3,"danger")},800)}}};ze(()=>te(l()),()=>{F(o,l().id)}),ze(()=>te(l()),()=>{F(y,l().event_type==="calendar_event")}),ze(()=>(i(y),i(O),i(fe),i(de)),()=>{!i(y)&&(i(O)||i(fe).length>0||i(de))&&(F(O,!1),F(ae,"weekly"),F(ve,1),F(fe,[]),F(de,""),F(we,!0),F(De,"date"))}),ze(()=>(te(l()),i(X),i(ce),i(Te),i(se),i(_e),i(ke),i(O),i(ae),i(ve),i(fe),i(de),i(we),i(De)),()=>{if(l()?.id!==i(X)||l()?.start_time!==i(ce).start_time||l()?.meta_data?.recurring_instance_index!==i(ce).meta_data?.recurring_instance_index){F(q,!0);const K=i(Te),Y=l();setTimeout(()=>{const ye=Y.event_type==="calendar_event";if(F(se,ye&&Y.start_time?Ne(new Date(Y.start_time),"yyyy-MM-dd"):""),F(_e,ye&&Y.start_time?Ne(new Date(Y.start_time),"HH:mm"):""),F(ke,ye&&Y.end_time?Ne(new Date(Y.end_time),"HH:mm"):""),K||F(Ae,Y.attachments?[...Y.attachments]:[]),Y.meta_data?.recurring_instance&&Y.start_time?(F(V,Y.recurrence_rule),F(Q,!0),F(Z,Ne(new Date(Y.start_time),"yyyy-MM-dd"))):(F(V,void 0),F(Q,!1),F(Z,void 0)),Y.recurrence_rule){const Se=f(Y.recurrence_rule,Y.recurrence_end_date);Se?(F(O,!0),F(ae,Se.frequency),F(ve,Se.interval),F(fe,Se.recurringDays),F(de,Se.recurrenceEndDate),F(we,Se.hasEndDate),F(De,Se.monthlyType)):(F(O,!1),F(ae,"weekly"),F(ve,1),F(fe,[]),F(de,""),F(we,!0),F(De,"date"))}else F(O,!1),F(ae,"weekly"),F(ve,1),F(fe,[]),F(de,""),F(we,!0),F(De,"date");F(X,Y.id),F(ce,{...Y}),F(q,!1),F(Te,!1),I(),F(Be,{dateInput:i(se),startTimeInput:i(_e),endTimeInput:i(ke),isRecurring:i(O),recurrenceFrequency:i(ae),recurrenceInterval:i(ve),recurringDays:[...i(fe)],recurrenceEndDate:i(de),hasEndDate:i(we),monthlyType:i(De)})},200)}}),ze(()=>(i(ce),te(l()),i(Ae),i(se),i(Be),i(_e),i(ke),i(O),i(ae),i(ve),i(fe),i(de),i(we),i(De)),()=>{F(_,i(ce).title!==l().title||i(ce).start_time!==l().start_time||i(ce).end_time!==l().end_time||i(ce).description!==l().description||i(ce).location!==l().location||i(ce).is_public!==l().is_public||i(ce).category!==l().category||i(ce).is_all_day!==l().is_all_day||JSON.stringify(i(Ae))!==JSON.stringify(l().attachments||[])||i(ce).recurrence_rule!==l().recurrence_rule||i(ce).recurrence_end_date!==l().recurrence_end_date||i(se)!==i(Be).dateInput||i(_e)!==i(Be).startTimeInput||i(ke)!==i(Be).endTimeInput||i(O)!==i(Be).isRecurring||i(ae)!==i(Be).recurrenceFrequency||i(ve)!==i(Be).recurrenceInterval||!Ye(i(fe),i(Be).recurringDays)||i(de)!==i(Be).recurrenceEndDate||i(we)!==i(Be).hasEndDate||i(De)!==i(Be).monthlyType)}),ze(()=>(x(),Fe),()=>{F(be,x().has(Fe.Bishopric))}),ze(()=>(te(l()),s()),()=>{F(a,!!l()?.id&&!!s()?.id&&l().meta_data?.submitted_by_user_id===s().id)}),ze(()=>(i(a),i(be)),()=>{F(t,i(a)&&!i(be))}),ze(()=>(i(t),te(l()),i(Pe)),()=>{const K=i(t)?l()?.id??null:null;K&&K!==i(Pe)?(F(Pe,K),F(Ee,[]),F(qe,!1),F(Re,!1),nt(),at(K),rt(K)):!K&&i(Pe)!==null&&(F(Pe,null),F(Ee,[]),F(qe,!1),F(Re,!1),nt())}),It(),gt();var _r=Ki(),Kt=Qe(_r),pr=H(Kt);{var cn=K=>{var Y=Li();re(K,Y)};he(pr,K=>{te(l()),i(o),J(()=>l().recurrence_rule&&i(o))&&K(cn)})}var Gt=j(pr,2),Zt=H(Gt),dn=j(H(Zt),2);{var un=K=>{var Y=zi();pe(()=>Y.disabled=i(q)||i(N)),Ie("click",Y,ln),re(K,Y)};he(dn,K=>{i(o)&&K(un)})}B(Zt);var fn=j(Zt,2);{let K=st(()=>i(q)||i(N));Ca(fn,{get disabled(){return i(K)},get name(){return n()},get validationErrors(){return e()},get title(){return l().title},set title(Y){l(l().title=Y,!0)},get eventType(){return l().event_type},set eventType(Y){l(l().event_type=Y,!0)},get category(){return l().category},set category(Y){l(l().category=Y,!0)},get isPublic(){return l().is_public},set isPublic(Y){l(l().is_public=Y,!0)},get description(){return l().description},set description(Y){l(l().description=Y,!0)},$$legacy:!0})}B(Gt);var br=j(Gt,2);{var vn=K=>{var Y=Hi(),ye=Qe(Y);{let Xe=st(()=>i(q)||i(N));La(ye,{get disabled(){return i(Xe)},get name(){return n()},get validationErrors(){return e()},get dateInput(){return i(se)},set dateInput(Le){F(se,Le)},get startTimeInput(){return i(_e)},set startTimeInput(Le){F(_e,Le)},get endTimeInput(){return i(ke)},set endTimeInput(Le){F(ke,Le)},get isAllDay(){return l().is_all_day},set isAllDay(Le){l(l().is_all_day=Le,!0)},$$legacy:!0})}var Se=j(ye,2);{let Xe=st(()=>i(q)||i(N));$a(Se,{get disabled(){return i(Xe)},get name(){return n()},get validationErrors(){return e()},get isRecurring(){return i(O)},set isRecurring(Le){F(O,Le)},get recurrenceFrequency(){return i(ae)},set recurrenceFrequency(Le){F(ae,Le)},get recurrenceInterval(){return i(ve)},set recurrenceInterval(Le){F(ve,Le)},get recurringDays(){return i(fe)},set recurringDays(Le){F(fe,Le)},get recurrenceEndDate(){return i(de)},set recurrenceEndDate(Le){F(de,Le)},get monthlyType(){return i(De)},set monthlyType(Le){F(De,Le)},get dateInput(){return i(se)},set dateInput(Le){F(se,Le)},$$legacy:!0})}re(K,Y)};he(br,K=>{i(y)&&K(vn)})}var wr=j(br,2);{let K=st(()=>i(q)||i(N));ri(wr,{get attachments(){return i(Ae)},get uploadingFile(){return i(N)},get disabled(){return i(K)},$$events:{upload:bt,edit:Ct,remove:vt}})}var xr=j(wr,2);{let K=st(()=>i(q)||i(N)),Y=st(()=>`${n()}-location`);Va(xr,{get disabled(){return i(K)},get name(){return i(Y)},get value(){return l().location},set value(ye){l(l().location=ye,!0)},$$legacy:!0})}var Er=j(xr,2);{var mn=K=>{var Y=Wi(),ye=j(Qe(Y),2);{var Se=Xe=>{var Le=qi(),kt=Qe(Le),$e=H(kt),yt=j(H($e),4),Sn=H(yt);{var In=Tt=>{var Rt=Ni(),Ir=H(Rt,!0);B(Rt),pe(()=>xe(Ir,(i(Ee),J(()=>i(Ee).length)))),re(Tt,Rt)};he(Sn,Tt=>{i(Ee),J(()=>i(Ee).length>0)&&Tt(In)})}Je(2),B(yt),B($e),B(kt);var kn=j(kt,2);{let Tt=st(()=>(te(l()),J(()=>l()?.title||"Event")));aa(kn,{get id(){return He},subtitle:"Discussion with Bishopric",get title(){return i(Tt)},className:"submitter-chat-drawer-stacked",bodyClass:"overflow-hidden d-flex flex-column",children:(Rt,Ir)=>{{let Tn=st(()=>(s(),J(()=>s()?.id??-1))),Rn=st(()=>i(q)||i(N));Wn(Rt,{get comments(){return i(Ee)},get currentUserId(){return i(Tn)},onSend:Vt,onDelete:it,get loading(){return i(Re)},fullHeight:!0,get disabled(){return i(Rn)}})}},$$slots:{default:!0}})}pe(()=>Oe($e,"aria-controls",He)),Ie("click",$e,ft),re(Xe,Le)};he(ye,Xe=>{i(t)&&Xe(Se)})}re(K,Y)};he(Er,K=>{i(be)||K(mn)})}var Xt=j(Er,2),Jt=H(Xt),hn=H(Jt);{var gn=K=>{var Y=Yi();pe(()=>Y.disabled=i(q)||i(N)),Ie("click",Y,an),re(K,Y)};he(hn,K=>{(i(o)||i(Q))&&S()&&K(gn)})}B(Jt);var Ar=j(Jt,2),er=H(Ar),yn=j(er,2);{var _n=K=>{var Y=Vi(),ye=H(Y);{var Se=$e=>{var yt=ji();re($e,yt)},Xe=$e=>{var yt=$i();re($e,yt)};he(ye,$e=>{i(o)||i(Q)?$e(Se):$e(Xe,!1)})}var Le=j(ye,2);{var kt=$e=>{var yt=Qi();re($e,yt)};he(Le,$e=>{i(_)&&$e(kt)})}B(Y),pe(()=>Y.disabled=i(q)||i(N)),Ie("click",Y,on),re(K,Y)};he(yn,K=>{(i(o)||i(Q)||M())&&K(_n)})}B(Ar),B(Xt);var tr=j(Xt,2),Ft=H(tr),pn=H(Ft,!0);B(Ft);var rr=j(Ft,2);let Dr;var bn=H(rr);Nr(bn,{size:"xs"}),B(rr),B(tr);var wn=j(tr,2);{var xn=K=>{{let Y=st(()=>i(q)||i(N));qn(K,{get disabled(){return i(Y)},get reloadEvents(){return w},get eventItem(){return l()},set eventItem(ye){l(ye)},$$legacy:!0})}};he(wn,K=>{i(be)&&K(xn)})}B(Kt);var Sr=j(Kt,2);{var En=K=>{ai(K,{get eventTitle(){return te(l()),J(()=>l().title)},get occurrenceDate(){return i(Z)},callback:Y=>{F(ie,Y),F(ee,!1)}})};he(Sr,K=>{i(ee)&&i(Z)&&K(En)})}var An=j(Sr,2);{var Dn=K=>{si(K,{get eventTitle(){return te(l()),J(()=>l().title)},get occurrenceDate(){return i(Z)},callback:Y=>{F(ne,Y),F(le,!1)}})};he(An,K=>{i(le)&&i(Z)&&K(Dn)})}pe(()=>{er.disabled=i(q)||i(N),et(Ft,1,`fw-lighter fst-italic text-${i(ge),J(()=>i(ge).type)??""}`,"svelte-1ujj5ue"),xe(pn,(i(ge),J(()=>i(ge).message))),Dr=et(rr,1,"",null,Dr,{"d-none":!i(q)})}),Ie("click",er,Ge),re(g,_r),ut(),d()}const Ur={SRS:[Fe.Stake],SEQ:[Fe.Stake],SYO:[Fe.Stake],SYW:[Fe.Stake],SYM:[Fe.Stake],SPR:[Fe.Stake],SSS:[Fe.Stake],SYA:[Fe.Stake],RES:[Fe.ReliefSociety],ELQ:[Fe.EldersQuorum],YOU:[Fe.YoungWomen,Fe.YoungMen],YOW:[Fe.YoungWomen],YWP:[Fe.YoungWomen],YWR:[Fe.YoungWomen],YWD:[Fe.YoungWomen],YOM:[Fe.YoungMen],YMD:[Fe.YoungMen],YMT:[Fe.YoungMen],YMP:[Fe.YoungMen],PRI:[Fe.Primary],PRN:[Fe.Primary],PRS:[Fe.Primary],PRC:[Fe.Primary],PRV:[Fe.Primary],SUS:[Fe.SundaySchool],YSA:[Fe.Stake]},Gi=g=>{const m=new Set,x=g.meta_data?.submitted_by_organizations;if(x?.length)return x.forEach(e=>m.add(e)),m;const s=g.meta_data?.category;return s&&Ur[s]&&Ur[s].forEach(e=>m.add(e)),m},Es=(g,m)=>{if(!g)return!1;const{currentUserId:x,isPrivileged:s,canEditOwnOrgEvents:e,userOrganizations:r}=m;if(s)return!0;const d=g.meta_data?.submitted_by_user_id;if(x&&typeof d=="number"&&d===x)return!0;if(!e)return!1;const o=Gi(g);if(!o.size)return!1;for(const y of o)if(r.has(y))return!0;return!1};export{xs as C,ws as E,Es as c};
