import{d as l,w as u}from"./By7HBROr.js";import{s as f,a as n}from"./DebXK80o.js";const c=u([]),o=u(!1),a=u(null);async function d(){o.set(!0),a.set(null);try{const t=localStorage.getItem("authToken"),r=await fetch(`${f}/functions/v1/admin-get-users`,{headers:{"x-auth-token":t?`Bearer ${t}`:"",Authorization:`Bearer ${n}`,apikey:n}}),e=await r.json();if(!r.ok)throw new Error(e.error||"Failed to fetch users");if(e.users)c.set(e.users);else throw new Error("No users data returned")}catch(t){const r=t instanceof Error?t.message:"Unknown error occurred";a.set(r),console.error("Fetch users error:",t)}finally{o.set(!1)}}async function h(t,r){o.set(!0),a.set(null);try{const e=localStorage.getItem("authToken"),s=await fetch(`${f}/functions/v1/admin-update-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":e?`Bearer ${e}`:"",Authorization:`Bearer ${n}`,apikey:n},body:JSON.stringify({userId:t,updates:r})}),i=await s.json();if(!s.ok)throw new Error(i.error||"Failed to update user");if(i.success)return await d(),{success:!0};throw new Error(i.error||"Update failed")}catch(e){const s=e instanceof Error?e.message:"Unknown error occurred";return a.set(s),console.error("Update user error:",e),{success:!1,error:s}}finally{o.set(!1)}}l(c,t=>t.filter(r=>r.is_active));l(c,t=>{const r={};return t.forEach(e=>{r[e.role]||(r[e.role]=[]),r[e.role].push(e)}),r});const y={stores:{users:c,loading:o,error:a},actions:{fetchUsers:d,updateUser:h}};export{y as u};
