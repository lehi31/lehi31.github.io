const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{p as rt,ai as Se,D as O,E as ce,w as G,d as n,aj as It,c as P,s as q,u as X,r as z,t as ge,a as nt,f as $e,F as Je,i as fr,ap as Un,R as dt,as as or,z as On}from"./DkHtKwEy.js";import{p as _e,i as de,e as Ie,s as ye,b as Nt,a as Or,k as zn,m as Pn,u as Bn}from"./DJ88wS1R.js";import{f as le,a as J,c as Ot,t as Ze}from"./B190dNFg.js";import{e as zt,i as zr}from"./CKczAFpg.js";import{h as Tt,j as yt,b as bt,t as wt,k as $t,g as Pr,D as Ln,f as Dt,l as Hn,m as Nn,u as qn,n as Br,o as Pt,p as kt,q as Lr,r as $n,B as Wn,s as Yn,v as jn,w as Qn}from"./BlMw_xuH.js";import{e as Hr,s as Te,b as vr,r as Ke}from"./BAllHlw7.js";import{t as Nr,e as et,j as Kn,i as Le,p as Ut,A as Ve,d as qr,G as Vn,O as qe,s as cr}from"./BWVFsUZz.js";import{s as Wt}from"./CdEA5IGF.js";import{i as it}from"./CrhaOPk_.js";import{R as Oe}from"./CFnovsA3.js";import{_ as Yt}from"./CmsKOCeN.js";import{c as Gn,o as $r,w as Zn,g as mr,a as Xn}from"./DUiJaq3B.js";import{S as Wr}from"./BIck9t-Q.js";import{b as vt,a as gr,c as dr}from"./Cf6qqcEk.js";import{b as Mt}from"./BczpZ8nK.js";import{b as xt}from"./DO_vVYAf.js";import{t as _t}from"./r7-tBYgy.js";import{c as Jn}from"./DT_AylNQ.js";import{c as ea,a as ut,e as Mr,f as ta,d as ra,V as na}from"./Bai7YTd4.js";import{p as jt}from"./CcIDsnZ_.js";import{a as Qt}from"./CWnvvnS1.js";import{v as aa,D as ia}from"./B73bWyVy.js";function sa(g,m){const w=Nr(g);return w.setHours(m),w}function la(g,m){const w=Nr(g);return w.setMinutes(m),w}var oa=le('<div style="min-width: 85px !important;"><strong> </strong> <div><small class="d-block"> </small></div></div>'),ca=le('<span class="d-block text-uppercase small fw-semibold svelte-1rksp2z">All Day</span>'),da=le('<span class="d-block small svelte-1rksp2z"> </span>'),ua=le('<span class="text-muted">•</span>'),fa=le("<span> </span> <!>",1),va=le('<span class="text-muted">•</span>'),ma=le('<span class="text-muted small svelte-1rksp2z"><i class="bi bi-arrow-repeat"></i> </span> <!>',1),ha=le('<span class="text-muted">•</span>'),ga=le('<span class="text-muted small svelte-1rksp2z"><i class="bi bi-arrow-repeat"></i> Recurring event</span> <!>',1),_a=le('<span class="text-muted">•</span>'),pa=le('<em class="small fw-lighter svelte-1rksp2z"><!></em> <!>',1),ya=le('<em class="small fw-lighter text-decoration-underline svelte-1rksp2z"><!> details</em>'),ba=le('<div class="small svelte-1rksp2z"><!></div>'),wa=le('<div class="attachment-image-container svelte-1rksp2z"><button type="button" class="attachment-image-button svelte-1rksp2z"><img class="attachment-image svelte-1rksp2z"/></button> <div class="attachment-image-label svelte-1rksp2z"><small class="text-muted"> </small></div></div>'),xa=le('<button type="button" class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-2"><i class="bi bi-file-pdf"></i> <span class="text-truncate" style="max-width: 150px;"> </span> <small class="text-muted"> </small></button>'),Ea=le('<div class="mt-1 svelte-1rksp2z"><div class="fw-semibold small mb-1 svelte-1rksp2z">Attachments:</div> <div class="d-flex flex-wrap gap-2"></div></div>'),Aa=le('<div class="small text-muted posted-meta svelte-1rksp2z">Posted <!> <!></div>'),Da=le('<div class="small text-muted posted-meta svelte-1rksp2z">Last edited <!> <!></div>'),ka=le('<div class="details-container svelte-1rksp2z"><!> <!> <!> <!></div>'),Ia=le('<div class="event-thumbnail-container svelte-1rksp2z"><img class="event-thumbnail svelte-1rksp2z"/></div>'),Sa=le('<div role="button" tabindex="0"><!> <div class="d-flex gap-1"><div class="d-flex flex-column flex-grow-1 gap-1 svelte-1rksp2z"><div class="fw-bold svelte-1rksp2z"><!></div> <!> <div class="flex d-flex align-items-center flex-wrap gap-2"><!> <!> <!> <!></div> <!></div> <!></div></div>');function Ps(g,m){rt(m,!1);const w=ce(),s=ce(),t=ce(),r=ce(),c=ce(),o=ce(),_=ce(),p=ce(),i=ce();let e=_e(m,"item",8),a=_e(m,"showDetails",12,!1),d=_e(m,"showDate",8,!0),l=_e(m,"searchQuery",8,"");const k=Q=>{if(!Q)return"";const Z=Ut(Q),V=wt(Z,Ve);return Le(V,"h:mm aa")},C=Q=>{if(!Q)return"";const Z=Ut(Q),V=wt(Z,Ve);return Le(V,"EEE")},x=Q=>{if(!Q)return"";const Z=Ut(Q),V=wt(Z,Ve);return Le(V,"MMM, dd")},N=()=>{n(s)&&a(!a())},B=Q=>{n(s)&&(Q.key==="Enter"||Q.key===" ")&&N()},R=Q=>Q<1024?Q+" B":Q<1024*1024?(Q/1024).toFixed(1)+" KB":(Q/(1024*1024)).toFixed(1)+" MB",L=Q=>Q.startsWith("image/"),y=Q=>{window.open(Q,"_blank")},I=Q=>{if(!Q)return"";try{return Le(Ut(Q),"MMM d, yyyy 'at' h:mm a")}catch{return""}},f=Q=>{try{const V=Oe.fromString(Q).origOptions,re=V.interval||1,se=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ne=["","1st","2nd","3rd","4th","5th"];if(V.freq===Oe.DAILY)return re===1?"Repeats daily":`Repeats every ${re} days`;if(V.freq===Oe.WEEKLY){if(V.byweekday){const ie=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday]).map(me=>{const be=typeof me=="number"?me:me.weekday,oe=be===6?0:be+1;return se[oe]});return re===1?ie.length===1?`Repeats every ${ie[0]}`:`Repeats on ${ie.join(", ")}`:`Repeats every ${re} weeks on ${ie.join(", ")}`}return re===1?"Repeats weekly":`Repeats every ${re} weeks`}if(V.freq===Oe.MONTHLY){if(V.byweekday){const ie=(Array.isArray(V.byweekday)?V.byweekday:[V.byweekday])[0];if(ie&&typeof ie=="object"&&"n"in ie&&"weekday"in ie){const me=ie.weekday,be=me===6?0:me+1,oe=ie.n,pe=ne[oe]||`${oe}th`;return re===1?`Repeats on the ${pe} ${se[be]} of the month`:`Repeats on the ${pe} ${se[be]} every ${re} months`}}if(V.bymonthday){const ae=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,ie=ae===1?"st":ae===2?"nd":ae===3?"rd":"th";return re===1?`Repeats on the ${ae}${ie} of the month`:`Repeats on the ${ae}${ie} every ${re} months`}return re===1?"Repeats monthly":`Repeats every ${re} months`}if(V.freq===Oe.YEARLY){if(V.bymonth&&V.bymonthday){const ae=["","January","February","March","April","May","June","July","August","September","October","November","December"],ie=Array.isArray(V.bymonth)?V.bymonth[0]:V.bymonth,me=Array.isArray(V.bymonthday)?V.bymonthday[0]:V.bymonthday,be=me===1?"st":me===2?"nd":me===3?"rd":"th";return re===1?`Repeats every ${ae[ie]} ${me}${be}`:`Repeats every ${re} years on ${ae[ie]} ${me}${be}`}return re===1?"Repeats yearly":`Repeats every ${re} years`}return"Repeats"}catch{return"Repeats"}};let v=ce("");Se(()=>G(d()),()=>{O(v,d()?"d-flex flex-sm-column flex-md-row flex-lg-row flex-xl-row gap-1":"d-flex flex-column gap-1")}),Se(()=>G(e()),()=>{O(w,e().attachments?.find(Q=>L(Q.type)))}),Se(()=>G(e()),()=>{O(s,!!(e().description||e().attachments&&e().attachments.length>0))}),Se(()=>G(e()),()=>{O(t,e().meta_data?.submitted_at??e().created_at)}),Se(()=>n(t),()=>{O(r,I(n(t)))}),Se(()=>G(e()),()=>{O(c,e().meta_data?.submitted_by_name)}),Se(()=>(n(r),n(c)),()=>{O(o,!!(n(r)||n(c)))}),Se(()=>G(e()),()=>{O(_,I(e().meta_data?.edited_at))}),Se(()=>G(e()),()=>{O(p,e().meta_data?.edited_by_name)}),Se(()=>(n(_),n(p)),()=>{O(i,!!(n(_)||n(p)))}),It(),it();var b=Sa(),A=P(b);{var D=Q=>{var Z=oa(),V=P(Z),re=P(V,!0);z(V);var se=q(V,2),ne=P(se),ae=P(ne,!0);z(ne),z(se),z(Z),ge((ie,me)=>{ye(re,ie),ye(ae,me)},[()=>(G(e()),X(()=>C(e().start_time))),()=>(G(e()),X(()=>x(e().start_time)))]),J(Q,Z)};de(A,Q=>{d()&&Q(D)})}var S=q(A,2),E=P(S),T=P(E),h=P(T);Tt(h,()=>(G(yt),G(e()),G(l()),X(()=>yt(e().title||"",l())))),z(T);var u=q(T,2);{var $=Q=>{var Z=ca();J(Q,Z)},M=Q=>{var Z=da(),V=P(Z);z(Z),ge((re,se)=>ye(V,`${re??""} to ${se??""}`),[()=>(G(e()),X(()=>k(e().start_time))),()=>(G(e()),X(()=>k(e().end_time)))]),J(Q,Z)};de(u,Q=>{G(e()),X(()=>e().is_all_day)?Q($):Q(M,!1)})}var U=q(u,2),K=P(U);{var Y=Q=>{var Z=fa(),V=$e(Z),re=P(V,!0);z(V);var se=q(V,2);{var ne=ae=>{var ie=ua();J(ae,ie)};de(se,ae=>{G(e()),X(()=>e().recurrence_rule||e()?.meta_data?.recurring_instance||e().location||e().description||e().attachments&&e().attachments.length>0)&&ae(ne)})}ge((ae,ie)=>{et(V,1,`badge rounded-pill bg-color-${ae??""}`,"svelte-1rksp2z"),ye(re,ie)},[()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.color_number)),()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.label))]),J(Q,Z)};de(K,Q=>{G(e()),X(()=>e()?.meta_data?.category)&&Q(Y)})}var W=q(K,2);{var H=Q=>{var Z=ma(),V=$e(Z),re=q(P(V));z(V);var se=q(V,2);{var ne=ae=>{var ie=va();J(ae,ie)};de(se,ae=>{G(e()),X(()=>e().location||e().description||e().attachments&&e().attachments.length>0)&&ae(ne)})}ge(ae=>ye(re,` ${ae??""}`),[()=>(G(e()),X(()=>f(e().recurrence_rule)))]),J(Q,Z)},F=Q=>{var Z=Ot(),V=$e(Z);{var re=se=>{var ne=ga(),ae=q($e(ne),2);{var ie=me=>{var be=ha();J(me,be)};de(ae,me=>{G(e()),X(()=>e().location||e().description||e().attachments&&e().attachments.length>0)&&me(ie)})}J(se,ne)};de(V,se=>{G(e()),X(()=>e()?.meta_data?.recurring_instance)&&se(re)},!0)}J(Q,Z)};de(W,Q=>{G(e()),X(()=>e().recurrence_rule)?Q(H):Q(F,!1)})}var ee=q(W,2);{var ue=Q=>{var Z=pa(),V=$e(Z),re=P(V);Tt(re,()=>(G(yt),G(e()),G(l()),X(()=>yt(e().location,l())))),z(V);var se=q(V,2);{var ne=ae=>{var ie=_a();J(ae,ie)};de(se,ae=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&ae(ne)})}J(Q,Z)};de(ee,Q=>{G(e()),X(()=>e().location)&&Q(ue)})}var he=q(ee,2);{var fe=Q=>{var Z=ya(),V=P(Z);{var re=ne=>{var ae=Ze("Hide");J(ne,ae)},se=ne=>{var ae=Ze("Show");J(ne,ae)};de(V,ne=>{a()?ne(re):ne(se,!1)})}Je(),z(Z),J(Q,Z)};de(he,Q=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&Q(fe)})}z(U);var ve=q(U,2);{var Ee=Q=>{var Z=ka(),V=P(Z);{var re=oe=>{var pe=ba(),Re=P(pe);Tt(Re,()=>(G($t),G(e()),G(l()),X(()=>$t(e().description,l())))),z(pe),J(oe,pe)};de(V,oe=>{G(e()),X(()=>e().description)&&oe(re)})}var se=q(V,2);{var ne=oe=>{var pe=Ea(),Re=q(P(pe),2);zt(Re,5,()=>(G(e()),X(()=>e().attachments)),Pe=>Pe.id,(Pe,xe)=>{var Ye=Ot(),De=$e(Ye);{var Ce=He=>{var ze=wa(),Fe=P(ze),We=P(Fe);z(Fe);var mt=q(Fe,2),st=P(mt),lt=P(st,!0);z(st),z(mt),z(ze),ge(()=>{Te(Fe,"title",`Open ${n(xe),X(()=>n(xe).name)??""}`),Te(We,"src",(n(xe),X(()=>n(xe).url))),Te(We,"alt",(n(xe),X(()=>n(xe).name))),ye(lt,(n(xe),X(()=>n(xe).name)))}),Ie("click",Fe,Wt(()=>y(n(xe).url))),J(He,ze)},Ne=He=>{var ze=xa(),Fe=q(P(ze),2),We=P(Fe,!0);z(Fe);var mt=q(Fe,2),st=P(mt);z(mt),z(ze),ge(lt=>{Te(ze,"title",`Open ${n(xe),X(()=>n(xe).name)??""}`),ye(We,(n(xe),X(()=>n(xe).name))),ye(st,`(${lt??""})`)},[()=>(n(xe),X(()=>R(n(xe).size)))]),Ie("click",ze,Wt(()=>y(n(xe).url))),J(He,ze)};de(De,He=>{n(xe),X(()=>L(n(xe).type))?He(Ce):He(Ne,!1)})}J(Pe,Ye)}),z(Re),z(pe),J(oe,pe)};de(se,oe=>{G(e()),X(()=>e().attachments&&e().attachments.length>0)&&oe(ne)})}var ae=q(se,2);{var ie=oe=>{var pe=Aa(),Re=q(P(pe));{var Pe=De=>{var Ce=Ze();ge(()=>ye(Ce,n(r))),J(De,Ce)};de(Re,De=>{n(r)&&De(Pe)})}var xe=q(Re,2);{var Ye=De=>{var Ce=Ot(),Ne=$e(Ce);{var He=Fe=>{var We=Ze();ge(()=>ye(We,`by ${n(c)??""}`)),J(Fe,We)},ze=Fe=>{var We=Ze();ge(()=>ye(We,`by ${n(c)??""}`)),J(Fe,We)};de(Ne,Fe=>{n(r)?Fe(He):Fe(ze,!1)})}J(De,Ce)};de(xe,De=>{n(c)&&De(Ye)})}z(pe),J(oe,pe)};de(ae,oe=>{n(o)&&oe(ie)})}var me=q(ae,2);{var be=oe=>{var pe=Da(),Re=q(P(pe));{var Pe=De=>{var Ce=Ze();ge(()=>ye(Ce,n(_))),J(De,Ce)};de(Re,De=>{n(_)&&De(Pe)})}var xe=q(Re,2);{var Ye=De=>{var Ce=Ze();ge(()=>ye(Ce,`by ${n(p)??""}`)),J(De,Ce)};de(xe,De=>{n(p)&&De(Ye)})}z(pe),J(oe,pe)};de(me,oe=>{n(i)&&oe(be)})}z(Z),J(Q,Z)};de(ve,Q=>{a()&&Q(Ee)})}z(E);var Ae=q(E,2);{var ke=Q=>{var Z=Ia(),V=P(Z);z(Z),ge(()=>{Te(V,"src",(n(w),X(()=>n(w).url))),Te(V,"alt",(n(w),X(()=>n(w).name)))}),J(Q,Z)};de(Ae,Q=>{n(w)&&Q(ke)})}z(S),z(b),ge(()=>{et(b,1,Kn(n(v)),"svelte-1rksp2z"),Hr(b,n(s)?"cursor: pointer;":"")}),Ie("keydown",b,B),Ie("click",b,N),J(g,b),nt()}var Ta=le('<button class="btn btn-sm btn-outline-secondary flex-shrink-0"><i></i> </button>');function Bs(g,m){rt(m,!1);const w=()=>Nt(r,"$weeksExpanded",s),[s,t]=Or(),{stores:{weeksExpanded:r}}=Pr();function c(){zn(r,!w())}it();var o=Ta(),_=P(o),p=q(_);z(o),ge(()=>{et(_,1,`bi ${w()?"bi-chevron-up":"bi-chevron-down"}`),ye(p,` ${w()?"Collapse All":"Expand All"}`)}),Ie("click",o,c),J(g,o),nt(),t()}var Ma=le('<div class="invalid-feedback d-block"> </div>'),Ra=le("<option> </option>"),Ca=le('<div class="invalid-feedback d-block"> </div>'),Fa=le(`<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Title*</div> <input type="text" placeholder="" required/> <!> <small class="fw-lighter fst-italic">Displayed publicly on the calendar and announcements page. e.g. Ward Conference, Ward BBQ
			Night</small></div> <div class="d-flex flex-column gap-2"><div>Type*</div> <select class="form-select" aria-label="Select Type"><option>Calendar Event</option><option>Announcement</option></select></div> <div class="d-flex flex-column gap-2"><div>Category*</div> <select class="form-select" aria-label="Select Category"></select> <small class="fw-lighter fst-italic">Displayed as a public badge on the event listing.</small></div> <div class="d-flex flex-column gap-2"><div>Visibility</div> <div class="form-check form-switch"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">Public (visible without login)</label></div> <small class="fw-lighter fst-italic">Turn off to restrict this event/announcement to logged-in users only.</small></div> <div class="d-flex flex-column gap-2"><div>Description</div> <textarea rows="4" placeholder="Event description (optional)"></textarea> <!> <small class="fw-lighter fst-italic">Shown publicly when viewers expand the event details. Supports basic HTML formatting.</small></div></div>`);function Ua(g,m){rt(m,!1);const w=ce(),s=ce();let t=_e(m,"title",12,""),r=_e(m,"eventType",12,"calendar_event"),c=_e(m,"category",12,""),o=_e(m,"isPublic",12,!0),_=_e(m,"description",12,""),p=_e(m,"disabled",8,!1),i=_e(m,"name",8,"event"),e=_e(m,"validationErrors",24,()=>({})),a=ce(),d=ce();function l(){n(a)?.focus()}function k(){n(d)?.focus()}Se(()=>G(e()),()=>{O(w,!!e().title)}),Se(()=>G(e()),()=>{O(s,!!e().description)}),It();var C={focusTitle:l,focusDescription:k};it();var x=Fa(),N=P(x),B=q(P(N),2);Ke(B);let R;xt(B,Y=>O(a,Y),()=>n(a));var L=q(B,2);{var y=Y=>{var W=Ma(),H=P(W,!0);z(W),ge(()=>ye(H,(G(e()),X(()=>e().title)))),J(Y,W)};de(L,Y=>{G(e()),X(()=>e().title)&&Y(y)})}Je(2),z(N);var I=q(N,2),f=q(P(I),2);ge(()=>{r(),fr(()=>{p()})});var v=P(f);v.value=v.__value="calendar_event";var b=q(v);b.value=b.__value="announcement",z(f),z(I);var A=q(I,2),D=q(P(A),2);ge(()=>{c(),fr(()=>{p()})}),zt(D,5,()=>Ln,zr,(Y,W)=>{var H=Ra(),F=P(H,!0);z(H);var ee={};ge(()=>{ye(F,(n(W),X(()=>n(W).label))),ee!==(ee=(n(W),X(()=>n(W).key)))&&(H.value=(H.__value=(n(W),X(()=>n(W).key)))??"")}),J(Y,H)}),z(D),Je(2),z(A);var S=q(A,2),E=q(P(S),2),T=P(E);Ke(T);var h=q(T,2);z(E),Je(2),z(S);var u=q(S,2),$=q(P(u),2);Un($);let M;xt($,Y=>O(d,Y),()=>n(d));var U=q($,2);{var K=Y=>{var W=Ca(),H=P(W,!0);z(W),ge(()=>ye(H,(G(e()),X(()=>e().description)))),J(Y,W)};de(U,Y=>{G(e()),X(()=>e().description)&&Y(K)})}return Je(2),z(u),z(x),ge(()=>{Te(B,"name",`${i()??""}-title`),R=et(B,1,"form-control",null,R,{"is-invalid":n(w)}),B.disabled=p(),f.disabled=p(),D.disabled=p(),Te(T,"id",`${i()??""}-is-public`),T.disabled=p(),Te(h,"for",`${i()??""}-is-public`),Te($,"name",`${i()??""}-description`),M=et($,1,"form-control",null,M,{"is-invalid":n(s)}),$.disabled=p()}),Ie("focus",B,()=>n(a).select()),vt(B,t),vr(f,r),vr(D,c),gr(T,o),Ie("focus",$,()=>n(d).select()),vt($,_),J(g,x),Mt(m,"focusTitle",l),Mt(m,"focusDescription",k),nt(C)}var Oa=le('<div class="invalid-feedback d-block"> </div>'),za=le('<div class="invalid-feedback d-block"> </div>'),Pa=le('<div class="invalid-feedback d-block"> </div>'),Ba=le('<div class="d-flex flex-column gap-4 ps-4"><div class="d-flex flex-column gap-2"><div>Start time*</div> <input type="time" required/> <!></div> <div class="d-flex flex-column gap-2"><div>End time*</div> <input type="time" required/> <!></div></div>'),La=le('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-2"><div>Date*</div> <input type="date" required/> <!></div> <div><div class="form-check d-flex align-items-center gap-2"><input class="form-check-input" type="checkbox"/> <label class="form-check-label">All Day Event</label></div></div> <!></div>');function Ha(g,m){rt(m,!1);const w=ce(),s=ce(),t=ce();let r=_e(m,"dateInput",12,""),c=_e(m,"startTimeInput",12,""),o=_e(m,"endTimeInput",12,""),_=_e(m,"isAllDay",12,!1),p=_e(m,"disabled",8,!1),i=_e(m,"name",8,"event"),e=_e(m,"validationErrors",24,()=>({})),a=ce(),d=ce(),l=ce();function k(){n(a)?.focus()}function C(){n(d)?.focus()}function x(){n(l)?.focus()}Se(()=>G(e()),()=>{O(w,!!e().dateInput)}),Se(()=>G(e()),()=>{O(s,!!e().startTimeInput)}),Se(()=>G(e()),()=>{O(t,!!e().endTimeInput)}),It();var N={focusDate:k,focusStartTime:C,focusEndTime:x};it();var B=La(),R=P(B),L=q(P(R),2);Ke(L);let y;xt(L,T=>O(a,T),()=>n(a));var I=q(L,2);{var f=T=>{var h=Oa(),u=P(h,!0);z(h),ge(()=>ye(u,(G(e()),X(()=>e().dateInput)))),J(T,h)};de(I,T=>{G(e()),X(()=>e().dateInput)&&T(f)})}z(R);var v=q(R,2),b=P(v),A=P(b);Ke(A);var D=q(A,2);z(b),z(v);var S=q(v,2);{var E=T=>{var h=Ba(),u=P(h),$=q(P(u),2);Ke($),Te($,"step",900);let M;xt($,ue=>O(d,ue),()=>n(d));var U=q($,2);{var K=ue=>{var he=za(),fe=P(he,!0);z(he),ge(()=>ye(fe,(G(e()),X(()=>e().startTimeInput)))),J(ue,he)};de(U,ue=>{G(e()),X(()=>e().startTimeInput)&&ue(K)})}z(u);var Y=q(u,2),W=q(P(Y),2);Ke(W),Te(W,"step",900);let H;xt(W,ue=>O(l,ue),()=>n(l));var F=q(W,2);{var ee=ue=>{var he=Pa(),fe=P(he,!0);z(he),ge(()=>ye(fe,(G(e()),X(()=>e().endTimeInput)))),J(ue,he)};de(F,ue=>{G(e()),X(()=>e().endTimeInput)&&ue(ee)})}z(Y),z(h),ge(()=>{Te($,"name",`${i()??""}-start-time`),M=et($,1,"form-control",null,M,{"is-invalid":n(s)}),$.disabled=p(),Te(W,"name",`${i()??""}-end-time`),H=et(W,1,"form-control",null,H,{"is-invalid":n(t)}),W.disabled=p()}),Ie("focus",$,()=>n(d).select()),vt($,c),Ie("focus",W,()=>n(l).select()),vt(W,o),J(T,h)};de(S,T=>{_()||T(E)})}return z(B),ge(()=>{Te(L,"name",`${i()??""}-date`),y=et(L,1,"form-control",null,y,{"is-invalid":n(w)}),L.disabled=p(),Te(A,"id",`${i()??""}-all-day-check`),A.disabled=p(),Te(D,"for",`${i()??""}-all-day-check`)}),Ie("focus",L,()=>n(a).select()),vt(L,r),gr(A,_),J(g,B),Mt(m,"focusDate",k),Mt(m,"focusStartTime",C),Mt(m,"focusEndTime",x),nt(N)}var Na=le('<div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label"> </label></div>'),qa=le('<div class="invalid-feedback d-block"> </div>'),$a=le('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold">Repeat on these days<span class="text-danger">*</span></div> <div class="d-flex flex-wrap gap-2"></div> <!> <small class="text-muted">Select at least one day when this event repeats</small></div>'),Wa=le('<div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Monthly recurrence">Monthly recurrence</div> <div class="d-flex flex-column gap-2"><div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div> <div class="form-check"><input class="form-check-input" type="radio"/> <label class="form-check-label"> </label></div></div></div>'),Ya=le('<div class="invalid-feedback d-block"> </div>'),ja=le('<div class="d-flex flex-column gap-3 ps-4"><div class="d-flex flex-column gap-2"><div class="form-label fw-semibold" role="group" aria-label="Repeat pattern">Repeat pattern</div> <div class="row g-2 align-items-center"><div class="col-auto"><span class="text-muted">Every</span></div> <div class="col-auto"><input type="number" class="form-control" min="1" max="99" style="width: 80px;"/></div> <div class="col-auto"><select class="form-select"><option> </option><option> </option><option> </option><option> </option></select></div></div></div> <!> <!> <div class="d-flex flex-column gap-2"><label class="form-label fw-semibold">Repeat until<span class="text-danger">*</span></label> <input type="date" required/> <!> <small class="text-muted">The last date this event will occur</small></div></div>'),Qa=le('<div class="d-flex flex-column gap-3"><div class="form-check"><input class="form-check-input" type="checkbox"/> <label class="form-check-label fw-semibold">Make this a recurring event</label></div> <!></div>');function Ka(g,m){rt(m,!1);const w=[],s=[];let t=_e(m,"isRecurring",12,!1),r=_e(m,"recurrenceFrequency",12,"weekly"),c=_e(m,"recurrenceInterval",12,1),o=_e(m,"recurringDays",28,()=>[]),_=_e(m,"recurrenceEndDate",12,""),p=_e(m,"monthlyType",12,"date"),i=_e(m,"dateInput",8,""),e=_e(m,"disabled",8,!1),a=_e(m,"name",8,"event"),d=_e(m,"validationErrors",24,()=>({}));const l=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];function k(I){if(!I)return"Same weekday of the month";try{const f=new Date(I),v=Le(f,"EEEE"),b=Math.ceil(f.getDate()/7);return`${["","1st","2nd","3rd","4th","5th"][b]} ${v} of the month`}catch{return"Same weekday of the month"}}function C(I){if(!I)return 1;try{return I.split("-").map(Number)[2]}catch{return 1}}it();var x=Qa(),N=P(x),B=P(N);Ke(B);var R=q(B,2);z(N);var L=q(N,2);{var y=I=>{var f=ja(),v=P(f),b=q(P(v),2),A=q(P(b),2),D=P(A);Ke(D),z(A);var S=q(A,2),E=P(S);ge(()=>{r(),fr(()=>{e(),c()})});var T=P(E),h=P(T,!0);z(T),T.value=T.__value="daily";var u=q(T),$=P(u,!0);z(u),u.value=u.__value="weekly";var M=q(u),U=P(M,!0);z(M),M.value=M.__value="monthly";var K=q(M),Y=P(K,!0);z(K),K.value=K.__value="yearly",z(E),z(S),z(b),z(v);var W=q(v,2);{var H=ke=>{var Q=$a(),Z=q(P(Q),2);zt(Z,5,()=>l,zr,(se,ne)=>{var ae=Na(),ie=P(ae);Ke(ie);var me,be=q(ie,2),oe=P(be,!0);z(be),z(ae),ge(()=>{Te(ie,"id",`${a()??""}-day-${n(ne),X(()=>n(ne).value)??""}`),ie.disabled=e(),me!==(me=(n(ne),X(()=>n(ne).value)))&&(ie.value=(ie.__value=(n(ne),X(()=>n(ne).value)))??""),Te(be,"for",`${a()??""}-day-${n(ne),X(()=>n(ne).value)??""}`),ye(oe,(n(ne),X(()=>n(ne).label)))}),dr(w,[],ie,()=>(n(ne),X(()=>n(ne).value),o()),o),J(se,ae)}),z(Z);var V=q(Z,2);{var re=se=>{var ne=qa(),ae=P(ne,!0);z(ne),ge(()=>ye(ae,(G(d()),X(()=>d().recurringDays)))),J(se,ne)};de(V,se=>{G(d()),X(()=>d().recurringDays)&&se(re)})}Je(2),z(Q),J(ke,Q)};de(W,ke=>{r()==="weekly"&&ke(H)})}var F=q(W,2);{var ee=ke=>{var Q=Wa(),Z=q(P(Q),2),V=P(Z),re=P(V);Ke(re),re.value=re.__value="date";var se=q(re,2),ne=P(se);z(se),z(V);var ae=q(V,2),ie=P(ae);Ke(ie),ie.value=ie.__value="weekday";var me=q(ie,2),be=P(me);z(me),z(ae),z(Z),z(Q),ge((oe,pe)=>{Te(re,"id",`${a()??""}-monthly-date`),re.disabled=e(),Te(se,"for",`${a()??""}-monthly-date`),ye(ne,`On day ${oe??""} of the month`),Te(ie,"id",`${a()??""}-monthly-weekday`),ie.disabled=e(),Te(me,"for",`${a()??""}-monthly-weekday`),ye(be,`On the ${pe??""}`)},[()=>(G(i()),X(()=>C(i()))),()=>(G(i()),X(()=>k(i())))]),dr(s,[],re,p,p),dr(s,[],ie,p,p),J(ke,Q)};de(F,ke=>{r()==="monthly"&&ke(ee)})}var ue=q(F,2),he=P(ue),fe=q(he,2);Ke(fe);let ve;var Ee=q(fe,2);{var Ae=ke=>{var Q=Ya(),Z=P(Q,!0);z(Q),ge(()=>ye(Z,(G(d()),X(()=>d().recurrenceEndDate)))),J(ke,Q)};de(Ee,ke=>{G(d()),X(()=>d().recurrenceEndDate)&&ke(Ae)})}Je(2),z(ue),z(f),ge(()=>{D.disabled=e(),E.disabled=e(),ye(h,c()===1?"day":"days"),ye($,c()===1?"week":"weeks"),ye(U,c()===1?"month":"months"),ye(Y,c()===1?"year":"years"),Te(he,"for",`${a()??""}-recurrence-end-date`),ve=et(fe,1,"form-control",null,ve,{"is-invalid":!!d().recurrenceEndDate}),Te(fe,"id",`${a()??""}-recurrence-end-date`),fe.disabled=e()}),vt(D,c),vr(E,r),vt(fe,_),J(I,f)};de(L,I=>{t()&&I(y)})}z(x),ge(()=>{Te(B,"id",`${a()??""}-is-recurring`),B.disabled=e(),Te(R,"for",`${a()??""}-is-recurring`)}),gr(B,t),J(g,x),nt()}var Va=le('<div class="d-flex flex-column gap-2"><div>Location</div> <input type="text" class="form-control" placeholder="Event location (optional)"/> <small class="fw-lighter fst-italic">Displayed publicly on the event listing. e.g. Cultural Hall, Stake Center</small></div>');function Ga(g,m){rt(m,!1);let w=_e(m,"value",12,""),s=_e(m,"disabled",8,!1),t=_e(m,"name",8,"location"),r=ce();function c(){n(r)?.focus()}var o={focus:c},_=Va(),p=q(P(_),2);return Ke(p),xt(p,i=>O(r,i),()=>n(r)),Je(2),z(_),ge(()=>{Te(p,"name",t()),p.disabled=s()}),Ie("focus",p,()=>n(r).select()),vt(p,w),J(g,_),Mt(m,"focus",c),nt(o)}var Za=le('<input type="text" class="form-control form-control-sm"/> <small class="text-muted"> </small>',1),Xa=le('<div class="fw-semibold"> </div> <small class="text-muted"> </small>',1),Ja=le('<button type="button" class="btn btn-sm btn-success" title="Save"><i class="bi bi-check-lg"></i></button> <button type="button" class="btn btn-sm btn-secondary" title="Cancel"><i class="bi bi-x-lg"></i></button>',1),ei=le('<button type="button" class="btn btn-sm btn-outline-primary" title="Edit name"><i class="bi bi-pencil"></i></button> <button type="button" class="btn btn-sm btn-outline-danger" title="Delete"><i class="bi bi-trash"></i></button>',1),ti=le('<div class="d-flex align-items-center gap-2 p-2 border rounded"><div class="flex-grow-1"><!></div> <!></div>'),ri=le('<div class="d-flex flex-column gap-2 mb-2"></div>'),ni=le('<div class="d-flex flex-column gap-2"><div>Attachments</div> <!> <div class="d-flex flex-column gap-2"><div class="d-flex gap-2 align-items-center"><input type="file" class="form-control" accept="image/*,application/pdf"/> <!></div> <small class="fw-lighter fst-italic">Publicly visible in the event details. Max 5MB per file. Supports: images, PDFs</small></div></div>');function ai(g,m){rt(m,!1);let w=_e(m,"attachments",24,()=>[]),s=_e(m,"disabled",8,!1),t=_e(m,"uploadingFile",8,!1);const r=Gn();let c=ce(),o=ce(null),_=ce("");const p=I=>{if(I===0)return"0 Bytes";const f=1024,v=["Bytes","KB","MB"],b=Math.floor(Math.log(I)/Math.log(f));return Math.round(I/Math.pow(f,b)*100)/100+" "+v[b]},i=I=>{const f=I.target;f.files&&f.files[0]&&(r("upload",f.files[0]),f.value="")},e=I=>{O(o,I.id),O(_,I.name)},a=I=>{n(_).trim()&&n(_)!==I.name&&r("edit",{attachment:I,newName:n(_).trim()}),O(o,null),O(_,"")},d=()=>{O(o,null),O(_,"")},l=I=>{r("remove",I)};it();var k=ni(),C=q(P(k),2);{var x=I=>{var f=ri();zt(f,5,w,v=>v.id,(v,b)=>{var A=ti(),D=P(A),S=P(D);{var E=M=>{var U=Za(),K=$e(U);Ke(K);var Y=q(K,2),W=P(Y,!0);z(Y),ge(H=>{K.disabled=s(),ye(W,H)},[()=>(n(b),X(()=>p(n(b).size)))]),vt(K,()=>n(_),H=>O(_,H)),Ie("keydown",K,H=>{H.key==="Enter"&&a(n(b)),H.key==="Escape"&&d()}),J(M,U)},T=M=>{var U=Xa(),K=$e(U),Y=P(K,!0);z(K);var W=q(K,2),H=P(W,!0);z(W),ge(F=>{ye(Y,(n(b),X(()=>n(b).name))),ye(H,F)},[()=>(n(b),X(()=>p(n(b).size)))]),J(M,U)};de(S,M=>{n(o),n(b),X(()=>n(o)===n(b).id)?M(E):M(T,!1)})}z(D);var h=q(D,2);{var u=M=>{var U=Ja(),K=$e(U),Y=q(K,2);ge(()=>{K.disabled=s(),Y.disabled=s()}),Ie("click",K,()=>a(n(b))),Ie("click",Y,d),J(M,U)},$=M=>{var U=ei(),K=$e(U),Y=q(K,2);ge(()=>{K.disabled=s(),Y.disabled=s()}),Ie("click",K,()=>e(n(b))),Ie("click",Y,()=>l(n(b))),J(M,U)};de(h,M=>{n(o),n(b),X(()=>n(o)===n(b).id)?M(u):M($,!1)})}z(A),J(v,A)}),z(f),J(I,f)};de(C,I=>{G(w()),X(()=>w().length>0)&&I(x)})}var N=q(C,2),B=P(N),R=P(B);xt(R,I=>O(c,I),()=>n(c));var L=q(R,2);{var y=I=>{Wr(I,{size:"sm"})};de(L,I=>{t()&&I(y)})}z(B),Je(2),z(N),z(k),ge(()=>R.disabled=s()||t()),Ie("change",R,i),J(g,k),nt()}var ii=le('<div class="modal svelte-xtxevo" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Edit Recurring Event</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">How would you like to edit it?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-primary text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">The entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function si(g,m){rt(m,!1);const w=ce();let s=_e(m,"eventTitle",8),t=_e(m,"occurrenceDate",8),r=_e(m,"callback",8);function c(A){r()(A)}function o(){r()(null)}Se(()=>(G(t()),Le),()=>{O(w,(()=>{try{const[A,D,S]=t().split("-").map(Number),E=new Date(A,D-1,S);return Le(E,"EEEE, MMMM d, yyyy")}catch{return t()}})())}),It(),it();var _=ii(),p=P(_),i=P(p),e=P(i),a=q(P(e),2);z(e);var d=q(e,2),l=P(d),k=P(l),C=P(k);z(k),Je(),z(l);var x=q(l,4),N=P(x),B=q(P(N),2),R=P(B,!0);z(B),z(N);var L=q(N,2),y=q(P(L),2),I=P(y);z(y),z(L);var f=q(L,2);z(x),z(d);var v=q(d,2),b=P(v);z(v),z(i),z(p),z(_),ge(()=>{ye(C,`"${s()??""}"`),ye(R,n(w)),ye(I,`From ${n(w)??""} onwards`)}),Ie("click",a,o),Ie("click",N,()=>c("single")),Ie("click",L,()=>c("future")),Ie("click",f,()=>c("all")),Ie("click",b,o),J(g,_),nt()}var li=le('<div class="modal svelte-gu1ski" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Recurring Event</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong> is a recurring event.</p> <p class="mb-3">What would you like to delete?</p> <div class="d-flex flex-column gap-2"><button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This occurrence only</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">This and future occurrences</div> <small class="text-muted"> </small></button> <button type="button" class="btn btn-outline-danger text-start p-3"><div class="fw-bold">All occurrences</div> <small class="text-muted">Delete the entire series</small></button></div></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button></div></div></div></div>');function oi(g,m){rt(m,!1);const w=ce();let s=_e(m,"eventTitle",8),t=_e(m,"occurrenceDate",8),r=_e(m,"callback",8);function c(A){r()(A)}function o(){r()(null)}Se(()=>(G(t()),Le),()=>{O(w,(()=>{try{const[A,D,S]=t().split("-").map(Number),E=new Date(A,D-1,S);return Le(E,"EEEE, MMMM d, yyyy")}catch{return t()}})())}),It(),it();var _=li(),p=P(_),i=P(p),e=P(i),a=q(P(e),2);z(e);var d=q(e,2),l=P(d),k=P(l),C=P(k);z(k),Je(),z(l);var x=q(l,4),N=P(x),B=q(P(N),2),R=P(B,!0);z(B),z(N);var L=q(N,2),y=q(P(L),2),I=P(y);z(y),z(L);var f=q(L,2);z(x),z(d);var v=q(d,2),b=P(v);z(v),z(i),z(p),z(_),ge(()=>{ye(C,`"${s()??""}"`),ye(R,n(w)),ye(I,`From ${n(w)??""} onwards`)}),Ie("click",a,o),Ie("click",N,()=>c("single")),Ie("click",L,()=>c("future")),Ie("click",f,()=>c("all")),Ie("click",b,o),J(g,_),nt()}var ci=le('<div class="modal fade" tabindex="-1" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div> <div class="modal-body"><p> </p> <div class="mb-3"><label for="cloneDate" class="form-label">Event Date</label> <input type="date" class="form-control" id="cloneDate"/></div></div> <div class="modal-footer"><button type="button"> </button> <button type="button"> </button></div></div></div></div>');function di(g,m){rt(m,!1);let w=_e(m,"title",8,"Clone Event"),s=_e(m,"message",8,"Select a date for the cloned event:"),t=_e(m,"confirmButtonLabel",8,"Clone"),r=_e(m,"confirmButtonCSS",8,"btn-primary"),c=_e(m,"rejectButtonLabel",8,"Cancel"),o=_e(m,"rejectButtonCSS",8,"btn-secondary"),_=_e(m,"defaultDate",8,void 0),p=_e(m,"callback",8,()=>{}),i=ce(),e=ce(_()||Le(new Date,"yyyy-MM-dd")),a=!1,d;$r(()=>{const h=window.bootstrap.Modal;new h(n(i)).show(),n(i).addEventListener("hidden.bs.modal",()=>{a?p()(!0,d):p()(!1)})});function l(){a=!0,d=n(e),window.bootstrap.Modal.getInstance(n(i)).hide()}function k(){a=!1,window.bootstrap.Modal.getInstance(n(i)).hide()}it();var C=ci(),x=P(C),N=P(x),B=P(N),R=P(B),L=P(R,!0);z(R),Je(2),z(B);var y=q(B,2),I=P(y),f=P(I,!0);z(I);var v=q(I,2),b=q(P(v),2);Ke(b),z(v),z(y);var A=q(y,2),D=P(A),S=P(D,!0);z(D);var E=q(D,2),T=P(E,!0);z(E),z(A),z(N),z(x),z(C),xt(C,h=>O(i,h),()=>n(i)),ge(()=>{ye(L,w()),ye(f,s()),et(D,1,`btn ${o()??""}`),ye(S,c()),et(E,1,`btn ${r()??""}`),ye(T,t())}),vt(b,()=>n(e),h=>O(e,h)),Ie("click",D,k),Ie("click",E,l),J(g,C),nt()}let Ht;function ui(g){if(typeof document>"u")return;const m=document.createElement("div");document.body.appendChild(m);const w={title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",rejectButtonLabel:"Cancel",rejectButtonCSS:"btn-secondary",callback:()=>{console.log("callback")}};g.title&&(w.title=g.title),g.message&&(w.message=g.message),g.confirmButtonLabel&&(w.confirmButtonLabel=g.confirmButtonLabel),g.confirmButtonCSS&&(w.confirmButtonCSS=g.confirmButtonCSS),g.rejectButtonLabel&&(w.rejectButtonLabel=g.rejectButtonLabel),g.rejectButtonCSS&&(w.rejectButtonCSS=g.rejectButtonCSS),g.defaultDate&&(w.defaultDate=g.defaultDate),w.callback=(s,t)=>{console.log("Clone confirm result:",s,t),Ht&&(Bn(Ht),Ht=void 0),m.remove(),g.callback&&typeof g.callback=="function"&&g.callback(s,t)},Ht=Pn(di,{target:m,props:w})}const fi=ea().shape({title:ut().required("Title is required").min(3,"Title must be at least 3 characters").max(255,"Title cannot exceed 255 characters"),event_type:ut().oneOf(["calendar_event","announcement"],"Invalid event type").required("Event type is required"),category:ut().required("Category is required"),description:ut().nullable().max(1e4,"Description is too long"),location:ut().nullable().max(255,"Location cannot exceed 255 characters"),dateInput:ut().when("event_type",{is:"calendar_event",then:g=>g.required("Date is required"),otherwise:g=>g.nullable()}),startTimeInput:ut().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("Start time is required"),otherwise:g=>g.nullable()}),endTimeInput:ut().when(["event_type","is_all_day"],{is:(g,m)=>g==="calendar_event"&&!m,then:g=>g.required("End time is required"),otherwise:g=>g.nullable()}),isRecurring:Mr(),recurrenceFrequency:ut().oneOf(["daily","weekly","monthly","yearly"]).nullable(),recurringDays:ta().of(ra().min(0).max(6)).when(["isRecurring","recurrenceFrequency"],{is:(g,m)=>g&&m==="weekly",then:g=>g.min(1,"Select at least one day for weekly recurring events").required(),otherwise:g=>g.nullable()}),hasEndDate:Mr(),recurrenceEndDate:ut().when(["isRecurring","hasEndDate"],{is:(g,m)=>g&&m,then:g=>g.required("End date is required").test("is-future","End date must be in the future",function(m){if(!m)return!1;const w=new Date(m),s=new Date;return s.setHours(0,0,0,0),w>=s}),otherwise:g=>g.nullable()})});function vi(){const g=Zn({});async function m(t){try{return await fi.validate(t,{abortEarly:!1}),g.set({}),!0}catch(r){if(r instanceof na){const c={};return r.inner.forEach(o=>{o.path&&(c[o.path]=o.message)}),g.set(c),!1}return!1}}function w(){g.set({})}function s(){return Object.values(mr(g)).filter(r=>r.length>0)}return{validationErrors:g,validate:m,clearErrors:w,getErrorMessages:s}}function _r(g){const{frequency:m,interval:w,recurringDays:s,recurrenceEndDate:t,hasEndDate:r,monthlyType:c,startTime:o}=g,_={0:Oe.SU,1:Oe.MO,2:Oe.TU,3:Oe.WE,4:Oe.TH,5:Oe.FR,6:Oe.SA},p={daily:Oe.DAILY,weekly:Oe.WEEKLY,monthly:Oe.MONTHLY,yearly:Oe.YEARLY},i=new Date(o),e=wt(i,Ve),a=new Date(e);a.setHours(12,0,0,0);const d=Dt(a,Ve),l={freq:p[m],interval:w,dtstart:d};if(r&&t){const C=new Date(`${t}T23:59:59.999`),x=Dt(C,Ve);l.until=x}if(m==="weekly"&&s.length>0)l.byweekday=s.map(C=>_[C]);else if(m==="monthly")if(c==="date")l.bymonthday=[a.getDate()];else{const C=Math.ceil(a.getDate()/7),x=a.getDay(),N=[Oe.SU,Oe.MO,Oe.TU,Oe.WE,Oe.TH,Oe.FR,Oe.SA];l.byweekday=[N[x].nth(C)]}else m==="yearly"&&(l.bymonth=[a.getMonth()+1],l.bymonthday=[a.getDate()]);return{recurrence_rule:new Oe(l).toString(),recurrence_end_date:r&&t?l.until.toISOString():void 0}}function Yr(g,m){try{const s=Oe.fromString(g).origOptions,t={6:0,0:1,1:2,2:3,3:4,4:5,5:6},r={[Oe.DAILY]:"daily",[Oe.WEEKLY]:"weekly",[Oe.MONTHLY]:"monthly",[Oe.YEARLY]:"yearly"},c=(s.freq!==void 0?r[s.freq]:null)||"weekly",o=s.interval||1;let _=[],p="date";s.byweekday&&c==="weekly"&&(_=(Array.isArray(s.byweekday)?s.byweekday:[s.byweekday]).map(a=>{const d=typeof a=="number"?a:a.weekday;return t[d]})),c==="monthly"&&(s.bymonthday&&Array.isArray(s.bymonthday)&&s.bymonthday.length>0?p="date":s.byweekday&&(p="weekday"));let i="",e=!1;if(m){e=!0;const a=wt(new Date(m),Ve);i=Le(a,"yyyy-MM-dd")}else if(s.until){e=!0;const a=wt(s.until,Ve);i=Le(a,"yyyy-MM-dd")}return{frequency:c,interval:o,recurringDays:_,recurrenceEndDate:i,hasEndDate:e,monthlyType:p}}catch(w){return console.error("Failed to parse recurrence rule:",w),null}}function jr(){return{recurrence_rule:void 0,recurrence_end_date:void 0}}function Qr(){return{generateRecurrenceRule:_r,parseRecurrenceRule:Yr,clearRecurrence:jr}}const hr=Object.freeze(Object.defineProperty({__proto__:null,clearRecurrence:jr,generateRecurrenceRule:_r,parseRecurrenceRule:Yr,useRecurrenceLogic:Qr},Symbol.toStringTag,{value:"Module"}));function mi(g,m){return m.forEach(function(w){w&&typeof w!="string"&&!Array.isArray(w)&&Object.keys(w).forEach(function(s){if(s!=="default"&&!(s in g)){var t=Object.getOwnPropertyDescriptor(w,s);Object.defineProperty(g,s,t.get?t:{enumerable:!0,get:function(){return w[s]}})}})}),Object.freeze(g)}function Kr(g,m){return new Promise(function(w,s){let t;return hi(g).then(function(r){try{return t=r,w(new Blob([m.slice(0,2),t,m.slice(2)],{type:"image/jpeg"}))}catch(c){return s(c)}},s)})}const hi=g=>new Promise((m,w)=>{const s=new FileReader;s.addEventListener("load",({target:{result:t}})=>{const r=new DataView(t);let c=0;if(r.getUint16(c)!==65496)return w("not a valid JPEG");for(c+=2;;){const o=r.getUint16(c);if(o===65498)break;const _=r.getUint16(c+2);if(o===65505&&r.getUint32(c+4)===1165519206){const p=c+10;let i;switch(r.getUint16(p)){case 18761:i=!0;break;case 19789:i=!1;break;default:return w("TIFF header contains invalid endian")}if(r.getUint16(p+2,i)!==42)return w("TIFF header contains invalid version");const e=r.getUint32(p+4,i),a=p+e+2+12*r.getUint16(p+e,i);for(let d=p+e+2;d<a;d+=12)if(r.getUint16(d,i)==274){if(r.getUint16(d+2,i)!==3)return w("Orientation data type is invalid");if(r.getUint32(d+4,i)!==1)return w("Orientation data count is invalid");r.setUint16(d+8,1,i);break}return m(t.slice(c,c+2+_))}c+=2+_}return m(new Blob)}),s.readAsArrayBuffer(g)});var Kt={},gi={get exports(){return Kt},set exports(g){Kt=g}};(function(g){var m,w,s={};gi.exports=s,s.parse=function(t,r){for(var c=s.bin.readUshort,o=s.bin.readUint,_=0,p={},i=new Uint8Array(t),e=i.length-4;o(i,e)!=101010256;)e--;_=e,_+=4;var a=c(i,_+=4);c(i,_+=2);var d=o(i,_+=2),l=o(i,_+=4);_+=4,_=l;for(var k=0;k<a;k++){o(i,_),_+=4,_+=4,_+=4,o(i,_+=4),d=o(i,_+=4);var C=o(i,_+=4),x=c(i,_+=4),N=c(i,_+2),B=c(i,_+4);_+=6;var R=o(i,_+=8);_+=4,_+=x+N+B,s._readLocal(i,R,p,d,C,r)}return p},s._readLocal=function(t,r,c,o,_,p){var i=s.bin.readUshort,e=s.bin.readUint;e(t,r),i(t,r+=4),i(t,r+=2);var a=i(t,r+=2);e(t,r+=2),e(t,r+=4),r+=4;var d=i(t,r+=8),l=i(t,r+=2);r+=2;var k=s.bin.readUTF8(t,r,d);if(r+=d,r+=l,p)c[k]={size:_,csize:o};else{var C=new Uint8Array(t.buffer,r);if(a==0)c[k]=new Uint8Array(C.buffer.slice(r,r+o));else{if(a!=8)throw"unknown compression method: "+a;var x=new Uint8Array(_);s.inflateRaw(C,x),c[k]=x}}},s.inflateRaw=function(t,r){return s.F.inflate(t,r)},s.inflate=function(t,r){return t[0],t[1],s.inflateRaw(new Uint8Array(t.buffer,t.byteOffset+2,t.length-6),r)},s.deflate=function(t,r){r==null&&(r={level:6});var c=0,o=new Uint8Array(50+Math.floor(1.1*t.length));o[c]=120,o[c+1]=156,c+=2,c=s.F.deflateRaw(t,o,c,r.level);var _=s.adler(t,0,t.length);return o[c+0]=_>>>24&255,o[c+1]=_>>>16&255,o[c+2]=_>>>8&255,o[c+3]=_>>>0&255,new Uint8Array(o.buffer,0,c+4)},s.deflateRaw=function(t,r){r==null&&(r={level:6});var c=new Uint8Array(50+Math.floor(1.1*t.length)),o=s.F.deflateRaw(t,c,o,r.level);return new Uint8Array(c.buffer,0,o)},s.encode=function(t,r){r==null&&(r=!1);var c=0,o=s.bin.writeUint,_=s.bin.writeUshort,p={};for(var i in t){var e=!s._noNeed(i)&&!r,a=t[i],d=s.crc.crc(a,0,a.length);p[i]={cpr:e,usize:a.length,crc:d,file:e?s.deflateRaw(a):a}}for(var i in p)c+=p[i].file.length+30+46+2*s.bin.sizeUTF8(i);c+=22;var l=new Uint8Array(c),k=0,C=[];for(var i in p){var x=p[i];C.push(k),k=s._writeHeader(l,k,i,x,0)}var N=0,B=k;for(var i in p)x=p[i],C.push(k),k=s._writeHeader(l,k,i,x,1,C[N++]);var R=k-B;return o(l,k,101010256),k+=4,_(l,k+=4,N),_(l,k+=2,N),o(l,k+=2,R),o(l,k+=4,B),k+=4,k+=2,l.buffer},s._noNeed=function(t){var r=t.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(r)!=-1},s._writeHeader=function(t,r,c,o,_,p){var i=s.bin.writeUint,e=s.bin.writeUshort,a=o.file;return i(t,r,_==0?67324752:33639248),r+=4,_==1&&(r+=2),e(t,r,20),e(t,r+=2,0),e(t,r+=2,o.cpr?8:0),i(t,r+=2,0),i(t,r+=4,o.crc),i(t,r+=4,a.length),i(t,r+=4,o.usize),e(t,r+=4,s.bin.sizeUTF8(c)),e(t,r+=2,0),r+=2,_==1&&(r+=2,r+=2,i(t,r+=6,p),r+=4),r+=s.bin.writeUTF8(t,r,c),_==0&&(t.set(a,r),r+=a.length),r},s.crc={table:function(){for(var t=new Uint32Array(256),r=0;r<256;r++){for(var c=r,o=0;o<8;o++)1&c?c=3988292384^c>>>1:c>>>=1;t[r]=c}return t}(),update:function(t,r,c,o){for(var _=0;_<o;_++)t=s.crc.table[255&(t^r[c+_])]^t>>>8;return t},crc:function(t,r,c){return 4294967295^s.crc.update(4294967295,t,r,c)}},s.adler=function(t,r,c){for(var o=1,_=0,p=r,i=r+c;p<i;){for(var e=Math.min(p+5552,i);p<e;)_+=o+=t[p++];o%=65521,_%=65521}return _<<16|o},s.bin={readUshort:function(t,r){return t[r]|t[r+1]<<8},writeUshort:function(t,r,c){t[r]=255&c,t[r+1]=c>>8&255},readUint:function(t,r){return 16777216*t[r+3]+(t[r+2]<<16|t[r+1]<<8|t[r])},writeUint:function(t,r,c){t[r]=255&c,t[r+1]=c>>8&255,t[r+2]=c>>16&255,t[r+3]=c>>24&255},readASCII:function(t,r,c){for(var o="",_=0;_<c;_++)o+=String.fromCharCode(t[r+_]);return o},writeASCII:function(t,r,c){for(var o=0;o<c.length;o++)t[r+o]=c.charCodeAt(o)},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(t,r,c){for(var o,_="",p=0;p<c;p++)_+="%"+s.bin.pad(t[r+p].toString(16));try{o=decodeURIComponent(_)}catch{return s.bin.readASCII(t,r,c)}return o},writeUTF8:function(t,r,c){for(var o=c.length,_=0,p=0;p<o;p++){var i=c.charCodeAt(p);if(!(4294967168&i))t[r+_]=i,_++;else if(!(4294965248&i))t[r+_]=192|i>>6,t[r+_+1]=128|i>>0&63,_+=2;else if(!(4294901760&i))t[r+_]=224|i>>12,t[r+_+1]=128|i>>6&63,t[r+_+2]=128|i>>0&63,_+=3;else{if(4292870144&i)throw"e";t[r+_]=240|i>>18,t[r+_+1]=128|i>>12&63,t[r+_+2]=128|i>>6&63,t[r+_+3]=128|i>>0&63,_+=4}}return _},sizeUTF8:function(t){for(var r=t.length,c=0,o=0;o<r;o++){var _=t.charCodeAt(o);if(!(4294967168&_))c++;else if(!(4294965248&_))c+=2;else if(!(4294901760&_))c+=3;else{if(4292870144&_)throw"e";c+=4}}return c}},s.F={},s.F.deflateRaw=function(t,r,c,o){var _=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],p=s.F.U,i=s.F._goodIndex;s.F._hash;var e=s.F._putsE,a=0,d=c<<3,l=0,k=t.length;if(o==0){for(;a<k;)e(r,d,a+(A=Math.min(65535,k-a))==k?1:0),d=s.F._copyExact(t,a,A,r,d+8),a+=A;return d>>>3}var C=p.lits,x=p.strt,N=p.prev,B=0,R=0,L=0,y=0,I=0,f=0;for(k>2&&(x[f=s.F._hash(t,0)]=0),a=0;a<k;a++){if(I=f,a+1<k-2){f=s.F._hash(t,a+1);var v=a+1&32767;N[v]=x[f],x[f]=v}if(l<=a){(B>14e3||R>26697)&&k-a>100&&(l<a&&(C[B]=a-l,B+=2,l=a),d=s.F._writeBlock(a==k-1||l==k?1:0,C,B,y,t,L,a-L,r,d),B=R=y=0,L=a);var b=0;a<k-2&&(b=s.F._bestMatch(t,a,N,I,Math.min(_[2],k-a),_[3]));var A=b>>>16,D=65535&b;if(b!=0){D=65535&b;var S=i(A=b>>>16,p.of0);p.lhst[257+S]++;var E=i(D,p.df0);p.dhst[E]++,y+=p.exb[S]+p.dxb[E],C[B]=A<<23|a-l,C[B+1]=D<<16|S<<8|E,B+=2,l=a+A}else p.lhst[t[a]]++;R++}}for(L==a&&t.length!=0||(l<a&&(C[B]=a-l,B+=2,l=a),d=s.F._writeBlock(1,C,B,y,t,L,a-L,r,d),B=0,R=0,B=R=y=0,L=a);7&d;)d++;return d>>>3},s.F._bestMatch=function(t,r,c,o,_,p){var i=32767&r,e=c[i],a=i-e+32768&32767;if(e==i||o!=s.F._hash(t,r-a))return 0;for(var d=0,l=0,k=Math.min(32767,r);a<=k&&--p!=0&&e!=i;){if(d==0||t[r+d]==t[r+d-a]){var C=s.F._howLong(t,r,a);if(C>d){if(l=a,(d=C)>=_)break;a+2<C&&(C=a+2);for(var x=0,N=0;N<C-2;N++){var B=r-a+N+32768&32767,R=B-c[B]+32768&32767;R>x&&(x=R,e=B)}}}a+=(i=e)-(e=c[i])+32768&32767}return d<<16|l},s.F._howLong=function(t,r,c){if(t[r]!=t[r-c]||t[r+1]!=t[r+1-c]||t[r+2]!=t[r+2-c])return 0;var o=r,_=Math.min(t.length,r+258);for(r+=3;r<_&&t[r]==t[r-c];)r++;return r-o},s.F._hash=function(t,r){return(t[r]<<8|t[r+1])+(t[r+2]<<4)&65535},s.saved=0,s.F._writeBlock=function(t,r,c,o,_,p,i,e,a){var d,l,k,C,x,N,B,R,L,y=s.F.U,I=s.F._putsF,f=s.F._putsE;y.lhst[256]++,l=(d=s.F.getTrees())[0],k=d[1],C=d[2],x=d[3],N=d[4],B=d[5],R=d[6],L=d[7];var v=32+(a+3&7?8-(a+3&7):0)+(i<<3),b=o+s.F.contSize(y.fltree,y.lhst)+s.F.contSize(y.fdtree,y.dhst),A=o+s.F.contSize(y.ltree,y.lhst)+s.F.contSize(y.dtree,y.dhst);A+=14+3*B+s.F.contSize(y.itree,y.ihst)+(2*y.ihst[16]+3*y.ihst[17]+7*y.ihst[18]);for(var D=0;D<286;D++)y.lhst[D]=0;for(D=0;D<30;D++)y.dhst[D]=0;for(D=0;D<19;D++)y.ihst[D]=0;var S=v<b&&v<A?0:b<A?1:2;if(I(e,a,t),I(e,a+1,S),a+=3,S==0){for(;7&a;)a++;a=s.F._copyExact(_,p,i,e,a)}else{var E,T;if(S==1&&(E=y.fltree,T=y.fdtree),S==2){s.F.makeCodes(y.ltree,l),s.F.revCodes(y.ltree,l),s.F.makeCodes(y.dtree,k),s.F.revCodes(y.dtree,k),s.F.makeCodes(y.itree,C),s.F.revCodes(y.itree,C),E=y.ltree,T=y.dtree,f(e,a,x-257),f(e,a+=5,N-1),f(e,a+=5,B-4),a+=4;for(var h=0;h<B;h++)f(e,a+3*h,y.itree[1+(y.ordr[h]<<1)]);a+=3*B,a=s.F._codeTiny(R,y.itree,e,a),a=s.F._codeTiny(L,y.itree,e,a)}for(var u=p,$=0;$<c;$+=2){for(var M=r[$],U=M>>>23,K=u+(8388607&M);u<K;)a=s.F._writeLit(_[u++],E,e,a);if(U!=0){var Y=r[$+1],W=Y>>16,H=Y>>8&255,F=255&Y;f(e,a=s.F._writeLit(257+H,E,e,a),U-y.of0[H]),a+=y.exb[H],I(e,a=s.F._writeLit(F,T,e,a),W-y.df0[F]),a+=y.dxb[F],u+=U}}a=s.F._writeLit(256,E,e,a)}return a},s.F._copyExact=function(t,r,c,o,_){var p=_>>>3;return o[p]=c,o[p+1]=c>>>8,o[p+2]=255-o[p],o[p+3]=255-o[p+1],p+=4,o.set(new Uint8Array(t.buffer,r,c),p),_+(c+4<<3)},s.F.getTrees=function(){for(var t=s.F.U,r=s.F._hufTree(t.lhst,t.ltree,15),c=s.F._hufTree(t.dhst,t.dtree,15),o=[],_=s.F._lenCodes(t.ltree,o),p=[],i=s.F._lenCodes(t.dtree,p),e=0;e<o.length;e+=2)t.ihst[o[e]]++;for(e=0;e<p.length;e+=2)t.ihst[p[e]]++;for(var a=s.F._hufTree(t.ihst,t.itree,7),d=19;d>4&&t.itree[1+(t.ordr[d-1]<<1)]==0;)d--;return[r,c,a,_,i,d,o,p]},s.F.getSecond=function(t){for(var r=[],c=0;c<t.length;c+=2)r.push(t[c+1]);return r},s.F.nonZero=function(t){for(var r="",c=0;c<t.length;c+=2)t[c+1]!=0&&(r+=(c>>1)+",");return r},s.F.contSize=function(t,r){for(var c=0,o=0;o<r.length;o++)c+=r[o]*t[1+(o<<1)];return c},s.F._codeTiny=function(t,r,c,o){for(var _=0;_<t.length;_+=2){var p=t[_],i=t[_+1];o=s.F._writeLit(p,r,c,o);var e=p==16?2:p==17?3:7;p>15&&(s.F._putsE(c,o,i,e),o+=e)}return o},s.F._lenCodes=function(t,r){for(var c=t.length;c!=2&&t[c-1]==0;)c-=2;for(var o=0;o<c;o+=2){var _=t[o+1],p=o+3<c?t[o+3]:-1,i=o+5<c?t[o+5]:-1,e=o==0?-1:t[o-1];if(_==0&&p==_&&i==_){for(var a=o+5;a+2<c&&t[a+2]==_;)a+=2;(d=Math.min(a+1-o>>>1,138))<11?r.push(17,d-3):r.push(18,d-11),o+=2*d-2}else if(_==e&&p==_&&i==_){for(a=o+5;a+2<c&&t[a+2]==_;)a+=2;var d=Math.min(a+1-o>>>1,6);r.push(16,d-3),o+=2*d-2}else r.push(_,0)}return c>>>1},s.F._hufTree=function(t,r,c){var o=[],_=t.length,p=r.length,i=0;for(i=0;i<p;i+=2)r[i]=0,r[i+1]=0;for(i=0;i<_;i++)t[i]!=0&&o.push({lit:i,f:t[i]});var e=o.length,a=o.slice(0);if(e==0)return 0;if(e==1){var d=o[0].lit;return a=d==0?1:0,r[1+(d<<1)]=1,r[1+(a<<1)]=1,1}o.sort(function(R,L){return R.f-L.f});var l=o[0],k=o[1],C=0,x=1,N=2;for(o[0]={lit:-1,f:l.f+k.f,l,r:k,d:0};x!=e-1;)l=C!=x&&(N==e||o[C].f<o[N].f)?o[C++]:o[N++],k=C!=x&&(N==e||o[C].f<o[N].f)?o[C++]:o[N++],o[x++]={lit:-1,f:l.f+k.f,l,r:k};var B=s.F.setDepth(o[x-1],0);for(B>c&&(s.F.restrictDepth(a,c,B),B=c),i=0;i<e;i++)r[1+(a[i].lit<<1)]=a[i].d;return B},s.F.setDepth=function(t,r){return t.lit!=-1?(t.d=r,r):Math.max(s.F.setDepth(t.l,r+1),s.F.setDepth(t.r,r+1))},s.F.restrictDepth=function(t,r,c){var o=0,_=1<<c-r,p=0;for(t.sort(function(e,a){return a.d==e.d?e.f-a.f:a.d-e.d}),o=0;o<t.length&&t[o].d>r;o++){var i=t[o].d;t[o].d=r,p+=_-(1<<c-i)}for(p>>>=c-r;p>0;)(i=t[o].d)<r?(t[o].d++,p-=1<<r-i-1):o++;for(;o>=0;o--)t[o].d==r&&p<0&&(t[o].d--,p++);p!=0&&console.log("debt left")},s.F._goodIndex=function(t,r){var c=0;return r[16|c]<=t&&(c|=16),r[8|c]<=t&&(c|=8),r[4|c]<=t&&(c|=4),r[2|c]<=t&&(c|=2),r[1|c]<=t&&(c|=1),c},s.F._writeLit=function(t,r,c,o){return s.F._putsF(c,o,r[t<<1]),o+r[1+(t<<1)]},s.F.inflate=function(t,r){var c=Uint8Array;if(t[0]==3&&t[1]==0)return r||new c(0);var o=s.F,_=o._bitsF,p=o._bitsE,i=o._decodeTiny,e=o.makeCodes,a=o.codes2map,d=o._get17,l=o.U,k=r==null;k&&(r=new c(t.length>>>2<<3));for(var C,x,N=0,B=0,R=0,L=0,y=0,I=0,f=0,v=0,b=0;N==0;)if(N=_(t,b,1),B=_(t,b+1,2),b+=3,B!=0){if(k&&(r=s.F._check(r,v+(1<<17))),B==1&&(C=l.flmap,x=l.fdmap,I=511,f=31),B==2){R=p(t,b,5)+257,L=p(t,b+5,5)+1,y=p(t,b+10,4)+4,b+=14;for(var A=0;A<38;A+=2)l.itree[A]=0,l.itree[A+1]=0;var D=1;for(A=0;A<y;A++){var S=p(t,b+3*A,3);l.itree[1+(l.ordr[A]<<1)]=S,S>D&&(D=S)}b+=3*y,e(l.itree,D),a(l.itree,D,l.imap),C=l.lmap,x=l.dmap,b=i(l.imap,(1<<D)-1,R+L,t,b,l.ttree);var E=o._copyOut(l.ttree,0,R,l.ltree);I=(1<<E)-1;var T=o._copyOut(l.ttree,R,L,l.dtree);f=(1<<T)-1,e(l.ltree,E),a(l.ltree,E,C),e(l.dtree,T),a(l.dtree,T,x)}for(;;){var h=C[d(t,b)&I];b+=15&h;var u=h>>>4;if(!(u>>>8))r[v++]=u;else{if(u==256)break;var $=v+u-254;if(u>264){var M=l.ldef[u-257];$=v+(M>>>3)+p(t,b,7&M),b+=7&M}var U=x[d(t,b)&f];b+=15&U;var K=U>>>4,Y=l.ddef[K],W=(Y>>>4)+_(t,b,15&Y);for(b+=15&Y,k&&(r=s.F._check(r,v+(1<<17)));v<$;)r[v]=r[v++-W],r[v]=r[v++-W],r[v]=r[v++-W],r[v]=r[v++-W];v=$}}}else{7&b&&(b+=8-(7&b));var H=4+(b>>>3),F=t[H-4]|t[H-3]<<8;k&&(r=s.F._check(r,v+F)),r.set(new c(t.buffer,t.byteOffset+H,F),v),b=H+F<<3,v+=F}return r.length==v?r:r.slice(0,v)},s.F._check=function(t,r){var c=t.length;if(r<=c)return t;var o=new Uint8Array(Math.max(c<<1,r));return o.set(t,0),o},s.F._decodeTiny=function(t,r,c,o,_,p){for(var i=s.F._bitsE,e=s.F._get17,a=0;a<c;){var d=t[e(o,_)&r];_+=15&d;var l=d>>>4;if(l<=15)p[a]=l,a++;else{var k=0,C=0;l==16?(C=3+i(o,_,2),_+=2,k=p[a-1]):l==17?(C=3+i(o,_,3),_+=3):l==18&&(C=11+i(o,_,7),_+=7);for(var x=a+C;a<x;)p[a]=k,a++}}return _},s.F._copyOut=function(t,r,c,o){for(var _=0,p=0,i=o.length>>>1;p<c;){var e=t[p+r];o[p<<1]=0,o[1+(p<<1)]=e,e>_&&(_=e),p++}for(;p<i;)o[p<<1]=0,o[1+(p<<1)]=0,p++;return _},s.F.makeCodes=function(t,r){for(var c,o,_,p,i=s.F.U,e=t.length,a=i.bl_count,d=0;d<=r;d++)a[d]=0;for(d=1;d<e;d+=2)a[t[d]]++;var l=i.next_code;for(c=0,a[0]=0,o=1;o<=r;o++)c=c+a[o-1]<<1,l[o]=c;for(_=0;_<e;_+=2)(p=t[_+1])!=0&&(t[_]=l[p],l[p]++)},s.F.codes2map=function(t,r,c){for(var o=t.length,_=s.F.U.rev15,p=0;p<o;p+=2)if(t[p+1]!=0)for(var i=p>>1,e=t[p+1],a=i<<4|e,d=r-e,l=t[p]<<d,k=l+(1<<d);l!=k;)c[_[l]>>>15-r]=a,l++},s.F.revCodes=function(t,r){for(var c=s.F.U.rev15,o=15-r,_=0;_<t.length;_+=2){var p=t[_]<<r-t[_+1];t[_]=c[p]>>>o}},s.F._putsE=function(t,r,c){c<<=7&r;var o=r>>>3;t[o]|=c,t[o+1]|=c>>>8},s.F._putsF=function(t,r,c){c<<=7&r;var o=r>>>3;t[o]|=c,t[o+1]|=c>>>8,t[o+2]|=c>>>16},s.F._bitsE=function(t,r,c){return(t[r>>>3]|t[1+(r>>>3)]<<8)>>>(7&r)&(1<<c)-1},s.F._bitsF=function(t,r,c){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16)>>>(7&r)&(1<<c)-1},s.F._get17=function(t,r){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16)>>>(7&r)},s.F._get25=function(t,r){return(t[r>>>3]|t[1+(r>>>3)]<<8|t[2+(r>>>3)]<<16|t[3+(r>>>3)]<<24)>>>(7&r)},s.F.U=(m=Uint16Array,w=Uint32Array,{next_code:new m(16),bl_count:new m(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new m(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new w(32),flmap:new m(512),fltree:[],fdmap:new m(32),fdtree:[],lmap:new m(32768),ltree:[],ttree:[],dmap:new m(32768),dtree:[],imap:new m(512),itree:[],rev15:new m(32768),lhst:new w(286),dhst:new w(30),ihst:new w(19),lits:new w(15e3),strt:new m(65536),prev:new m(32768)}),function(){for(var t=s.F.U,r=0;r<32768;r++){var c=r;c=(4278255360&(c=(4042322160&(c=(3435973836&(c=(2863311530&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,t.rev15[r]=(c>>>16|c<<16)>>>17}function o(_,p,i){for(;p--!=0;)_.push(0,i)}for(r=0;r<32;r++)t.ldef[r]=t.of0[r]<<3|t.exb[r],t.ddef[r]=t.df0[r]<<4|t.dxb[r];o(t.fltree,144,8),o(t.fltree,112,9),o(t.fltree,24,7),o(t.fltree,8,8),s.F.makeCodes(t.fltree,9),s.F.codes2map(t.fltree,9,t.flmap),s.F.revCodes(t.fltree,9),o(t.fdtree,32,5),s.F.makeCodes(t.fdtree,5),s.F.codes2map(t.fdtree,5,t.fdmap),s.F.revCodes(t.fdtree,5),o(t.itree,19,0),o(t.ltree,286,0),o(t.dtree,30,0),o(t.ttree,320,0)}()})();var _i=mi({__proto__:null,default:Kt},[Kt]);const at=function(){var g={nextZero(i,e){for(;i[e]!=0;)e++;return e},readUshort:(i,e)=>i[e]<<8|i[e+1],writeUshort(i,e,a){i[e]=a>>8&255,i[e+1]=255&a},readUint:(i,e)=>16777216*i[e]+(i[e+1]<<16|i[e+2]<<8|i[e+3]),writeUint(i,e,a){i[e]=a>>24&255,i[e+1]=a>>16&255,i[e+2]=a>>8&255,i[e+3]=255&a},readASCII(i,e,a){let d="";for(let l=0;l<a;l++)d+=String.fromCharCode(i[e+l]);return d},writeASCII(i,e,a){for(let d=0;d<a.length;d++)i[e+d]=a.charCodeAt(d)},readBytes(i,e,a){const d=[];for(let l=0;l<a;l++)d.push(i[e+l]);return d},pad:i=>i.length<2?`0${i}`:i,readUTF8(i,e,a){let d,l="";for(let k=0;k<a;k++)l+=`%${g.pad(i[e+k].toString(16))}`;try{d=decodeURIComponent(l)}catch{return g.readASCII(i,e,a)}return d}};function m(i,e,a,d){const l=e*a,k=r(d),C=Math.ceil(e*k/8),x=new Uint8Array(4*l),N=new Uint32Array(x.buffer),{ctype:B}=d,{depth:R}=d,L=g.readUshort;if(B==6){const M=l<<2;if(R==8)for(var y=0;y<M;y+=4)x[y]=i[y],x[y+1]=i[y+1],x[y+2]=i[y+2],x[y+3]=i[y+3];if(R==16)for(y=0;y<M;y++)x[y]=i[y<<1]}else if(B==2){const M=d.tabs.tRNS;if(M==null){if(R==8)for(y=0;y<l;y++){var I=3*y;N[y]=255<<24|i[I+2]<<16|i[I+1]<<8|i[I]}if(R==16)for(y=0;y<l;y++)I=6*y,N[y]=255<<24|i[I+4]<<16|i[I+2]<<8|i[I]}else{var f=M[0];const U=M[1],K=M[2];if(R==8)for(y=0;y<l;y++){var v=y<<2;I=3*y,N[y]=255<<24|i[I+2]<<16|i[I+1]<<8|i[I],i[I]==f&&i[I+1]==U&&i[I+2]==K&&(x[v+3]=0)}if(R==16)for(y=0;y<l;y++)v=y<<2,I=6*y,N[y]=255<<24|i[I+4]<<16|i[I+2]<<8|i[I],L(i,I)==f&&L(i,I+2)==U&&L(i,I+4)==K&&(x[v+3]=0)}}else if(B==3){const M=d.tabs.PLTE,U=d.tabs.tRNS,K=U?U.length:0;if(R==1)for(var b=0;b<a;b++){var A=b*C,D=b*e;for(y=0;y<e;y++){v=D+y<<2;var S=3*(E=i[A+(y>>3)]>>7-((7&y)<<0)&1);x[v]=M[S],x[v+1]=M[S+1],x[v+2]=M[S+2],x[v+3]=E<K?U[E]:255}}if(R==2)for(b=0;b<a;b++)for(A=b*C,D=b*e,y=0;y<e;y++)v=D+y<<2,S=3*(E=i[A+(y>>2)]>>6-((3&y)<<1)&3),x[v]=M[S],x[v+1]=M[S+1],x[v+2]=M[S+2],x[v+3]=E<K?U[E]:255;if(R==4)for(b=0;b<a;b++)for(A=b*C,D=b*e,y=0;y<e;y++)v=D+y<<2,S=3*(E=i[A+(y>>1)]>>4-((1&y)<<2)&15),x[v]=M[S],x[v+1]=M[S+1],x[v+2]=M[S+2],x[v+3]=E<K?U[E]:255;if(R==8)for(y=0;y<l;y++){var E;v=y<<2,S=3*(E=i[y]),x[v]=M[S],x[v+1]=M[S+1],x[v+2]=M[S+2],x[v+3]=E<K?U[E]:255}}else if(B==4){if(R==8)for(y=0;y<l;y++){v=y<<2;var T=i[h=y<<1];x[v]=T,x[v+1]=T,x[v+2]=T,x[v+3]=i[h+1]}if(R==16)for(y=0;y<l;y++){var h;v=y<<2,T=i[h=y<<2],x[v]=T,x[v+1]=T,x[v+2]=T,x[v+3]=i[h+2]}}else if(B==0)for(f=d.tabs.tRNS?d.tabs.tRNS:-1,b=0;b<a;b++){const M=b*C,U=b*e;if(R==1)for(var u=0;u<e;u++){var $=(T=255*(i[M+(u>>>3)]>>>7-(7&u)&1))==255*f?0:255;N[U+u]=$<<24|T<<16|T<<8|T}else if(R==2)for(u=0;u<e;u++)$=(T=85*(i[M+(u>>>2)]>>>6-((3&u)<<1)&3))==85*f?0:255,N[U+u]=$<<24|T<<16|T<<8|T;else if(R==4)for(u=0;u<e;u++)$=(T=17*(i[M+(u>>>1)]>>>4-((1&u)<<2)&15))==17*f?0:255,N[U+u]=$<<24|T<<16|T<<8|T;else if(R==8)for(u=0;u<e;u++)$=(T=i[M+u])==f?0:255,N[U+u]=$<<24|T<<16|T<<8|T;else if(R==16)for(u=0;u<e;u++)T=i[M+(u<<1)],$=L(i,M+(u<<1))==f?0:255,N[U+u]=$<<24|T<<16|T<<8|T}return x}function w(i,e,a,d){const l=r(i),k=Math.ceil(a*l/8),C=new Uint8Array((k+1+i.interlace)*d);return e=i.tabs.CgBI?t(e,C):s(e,C),i.interlace==0?e=c(e,i,0,a,d):i.interlace==1&&(e=function(N,B){const R=B.width,L=B.height,y=r(B),I=y>>3,f=Math.ceil(R*y/8),v=new Uint8Array(L*f);let b=0;const A=[0,0,4,0,2,0,1],D=[0,4,0,2,0,1,0],S=[8,8,8,4,4,2,2],E=[8,8,4,4,2,2,1];let T=0;for(;T<7;){const u=S[T],$=E[T];let M=0,U=0,K=A[T];for(;K<L;)K+=u,U++;let Y=D[T];for(;Y<R;)Y+=$,M++;const W=Math.ceil(M*y/8);c(N,B,b,M,U);let H=0,F=A[T];for(;F<L;){let ee=D[T],ue=b+H*W<<3;for(;ee<R;){var h;if(y==1&&(h=(h=N[ue>>3])>>7-(7&ue)&1,v[F*f+(ee>>3)]|=h<<7-((7&ee)<<0)),y==2&&(h=(h=N[ue>>3])>>6-(7&ue)&3,v[F*f+(ee>>2)]|=h<<6-((3&ee)<<1)),y==4&&(h=(h=N[ue>>3])>>4-(7&ue)&15,v[F*f+(ee>>1)]|=h<<4-((1&ee)<<2)),y>=8){const he=F*f+ee*I;for(let fe=0;fe<I;fe++)v[he+fe]=N[(ue>>3)+fe]}ue+=y,ee+=$}H++,F+=u}M*U!=0&&(b+=U*(1+W)),T+=1}return v}(e,i)),e}function s(i,e){return t(new Uint8Array(i.buffer,2,i.length-6),e)}var t=function(){const i={H:{}};return i.H.N=function(e,a){const d=Uint8Array;let l,k,C=0,x=0,N=0,B=0,R=0,L=0,y=0,I=0,f=0;if(e[0]==3&&e[1]==0)return a||new d(0);const v=i.H,b=v.b,A=v.e,D=v.R,S=v.n,E=v.A,T=v.Z,h=v.m,u=a==null;for(u&&(a=new d(e.length>>>2<<5));C==0;)if(C=b(e,f,1),x=b(e,f+1,2),f+=3,x!=0){if(u&&(a=i.H.W(a,I+(1<<17))),x==1&&(l=h.J,k=h.h,L=511,y=31),x==2){N=A(e,f,5)+257,B=A(e,f+5,5)+1,R=A(e,f+10,4)+4,f+=14;let M=1;for(var $=0;$<38;$+=2)h.Q[$]=0,h.Q[$+1]=0;for($=0;$<R;$++){const Y=A(e,f+3*$,3);h.Q[1+(h.X[$]<<1)]=Y,Y>M&&(M=Y)}f+=3*R,S(h.Q,M),E(h.Q,M,h.u),l=h.w,k=h.d,f=D(h.u,(1<<M)-1,N+B,e,f,h.v);const U=v.V(h.v,0,N,h.C);L=(1<<U)-1;const K=v.V(h.v,N,B,h.D);y=(1<<K)-1,S(h.C,U),E(h.C,U,l),S(h.D,K),E(h.D,K,k)}for(;;){const M=l[T(e,f)&L];f+=15&M;const U=M>>>4;if(!(U>>>8))a[I++]=U;else{if(U==256)break;{let K=I+U-254;if(U>264){const ee=h.q[U-257];K=I+(ee>>>3)+A(e,f,7&ee),f+=7&ee}const Y=k[T(e,f)&y];f+=15&Y;const W=Y>>>4,H=h.c[W],F=(H>>>4)+b(e,f,15&H);for(f+=15&H;I<K;)a[I]=a[I++-F],a[I]=a[I++-F],a[I]=a[I++-F],a[I]=a[I++-F];I=K}}}}else{7&f&&(f+=8-(7&f));const M=4+(f>>>3),U=e[M-4]|e[M-3]<<8;u&&(a=i.H.W(a,I+U)),a.set(new d(e.buffer,e.byteOffset+M,U),I),f=M+U<<3,I+=U}return a.length==I?a:a.slice(0,I)},i.H.W=function(e,a){const d=e.length;if(a<=d)return e;const l=new Uint8Array(d<<1);return l.set(e,0),l},i.H.R=function(e,a,d,l,k,C){const x=i.H.e,N=i.H.Z;let B=0;for(;B<d;){const R=e[N(l,k)&a];k+=15&R;const L=R>>>4;if(L<=15)C[B]=L,B++;else{let y=0,I=0;L==16?(I=3+x(l,k,2),k+=2,y=C[B-1]):L==17?(I=3+x(l,k,3),k+=3):L==18&&(I=11+x(l,k,7),k+=7);const f=B+I;for(;B<f;)C[B]=y,B++}}return k},i.H.V=function(e,a,d,l){let k=0,C=0;const x=l.length>>>1;for(;C<d;){const N=e[C+a];l[C<<1]=0,l[1+(C<<1)]=N,N>k&&(k=N),C++}for(;C<x;)l[C<<1]=0,l[1+(C<<1)]=0,C++;return k},i.H.n=function(e,a){const d=i.H.m,l=e.length;let k,C,x,N;const B=d.j;for(var R=0;R<=a;R++)B[R]=0;for(R=1;R<l;R+=2)B[e[R]]++;const L=d.K;for(k=0,B[0]=0,C=1;C<=a;C++)k=k+B[C-1]<<1,L[C]=k;for(x=0;x<l;x+=2)N=e[x+1],N!=0&&(e[x]=L[N],L[N]++)},i.H.A=function(e,a,d){const l=e.length,k=i.H.m.r;for(let C=0;C<l;C+=2)if(e[C+1]!=0){const x=C>>1,N=e[C+1],B=x<<4|N,R=a-N;let L=e[C]<<R;const y=L+(1<<R);for(;L!=y;)d[k[L]>>>15-a]=B,L++}},i.H.l=function(e,a){const d=i.H.m.r,l=15-a;for(let k=0;k<e.length;k+=2){const C=e[k]<<a-e[k+1];e[k]=d[C]>>>l}},i.H.M=function(e,a,d){d<<=7&a;const l=a>>>3;e[l]|=d,e[l+1]|=d>>>8},i.H.I=function(e,a,d){d<<=7&a;const l=a>>>3;e[l]|=d,e[l+1]|=d>>>8,e[l+2]|=d>>>16},i.H.e=function(e,a,d){return(e[a>>>3]|e[1+(a>>>3)]<<8)>>>(7&a)&(1<<d)-1},i.H.b=function(e,a,d){return(e[a>>>3]|e[1+(a>>>3)]<<8|e[2+(a>>>3)]<<16)>>>(7&a)&(1<<d)-1},i.H.Z=function(e,a){return(e[a>>>3]|e[1+(a>>>3)]<<8|e[2+(a>>>3)]<<16)>>>(7&a)},i.H.i=function(e,a){return(e[a>>>3]|e[1+(a>>>3)]<<8|e[2+(a>>>3)]<<16|e[3+(a>>>3)]<<24)>>>(7&a)},i.H.m=function(){const e=Uint16Array,a=Uint32Array;return{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new a(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new a(286),Y:new a(30),a:new a(19),t:new a(15e3),k:new e(65536),g:new e(32768)}}(),function(){const e=i.H.m;for(var a=0;a<32768;a++){let l=a;l=(2863311530&l)>>>1|(1431655765&l)<<1,l=(3435973836&l)>>>2|(858993459&l)<<2,l=(4042322160&l)>>>4|(252645135&l)<<4,l=(4278255360&l)>>>8|(16711935&l)<<8,e.r[a]=(l>>>16|l<<16)>>>17}function d(l,k,C){for(;k--!=0;)l.push(0,C)}for(a=0;a<32;a++)e.q[a]=e.S[a]<<3|e.T[a],e.c[a]=e.p[a]<<4|e.z[a];d(e._,144,8),d(e._,112,9),d(e._,24,7),d(e._,8,8),i.H.n(e._,9),i.H.A(e._,9,e.J),i.H.l(e._,9),d(e.$,32,5),i.H.n(e.$,5),i.H.A(e.$,5,e.h),i.H.l(e.$,5),d(e.Q,19,0),d(e.C,286,0),d(e.D,30,0),d(e.v,320,0)}(),i.H.N}();function r(i){return[1,null,3,1,2,null,4][i.ctype]*i.depth}function c(i,e,a,d,l){let k=r(e);const C=Math.ceil(d*k/8);let x,N;k=Math.ceil(k/8);let B=i[a],R=0;if(B>1&&(i[a]=[0,0,1][B-2]),B==3)for(R=k;R<C;R++)i[R+1]=i[R+1]+(i[R+1-k]>>>1)&255;for(let L=0;L<l;L++)if(x=a+L*C,N=x+L+1,B=i[N-1],R=0,B==0)for(;R<C;R++)i[x+R]=i[N+R];else if(B==1){for(;R<k;R++)i[x+R]=i[N+R];for(;R<C;R++)i[x+R]=i[N+R]+i[x+R-k]}else if(B==2)for(;R<C;R++)i[x+R]=i[N+R]+i[x+R-C];else if(B==3){for(;R<k;R++)i[x+R]=i[N+R]+(i[x+R-C]>>>1);for(;R<C;R++)i[x+R]=i[N+R]+(i[x+R-C]+i[x+R-k]>>>1)}else{for(;R<k;R++)i[x+R]=i[N+R]+o(0,i[x+R-C],0);for(;R<C;R++)i[x+R]=i[N+R]+o(i[x+R-k],i[x+R-C],i[x+R-k-C])}return i}function o(i,e,a){const d=i+e-a,l=d-i,k=d-e,C=d-a;return l*l<=k*k&&l*l<=C*C?i:k*k<=C*C?e:a}function _(i,e,a){a.width=g.readUint(i,e),e+=4,a.height=g.readUint(i,e),e+=4,a.depth=i[e],e++,a.ctype=i[e],e++,a.compress=i[e],e++,a.filter=i[e],e++,a.interlace=i[e],e++}function p(i,e,a,d,l,k,C,x,N){const B=Math.min(e,l),R=Math.min(a,k);let L=0,y=0;for(let T=0;T<R;T++)for(let h=0;h<B;h++)if(C>=0&&x>=0?(L=T*e+h<<2,y=(x+T)*l+C+h<<2):(L=(-x+T)*e-C+h<<2,y=T*l+h<<2),N==0)d[y]=i[L],d[y+1]=i[L+1],d[y+2]=i[L+2],d[y+3]=i[L+3];else if(N==1){var I=i[L+3]*.00392156862745098,f=i[L]*I,v=i[L+1]*I,b=i[L+2]*I,A=d[y+3]*(1/255),D=d[y]*A,S=d[y+1]*A,E=d[y+2]*A;const u=1-I,$=I+A*u,M=$==0?0:1/$;d[y+3]=255*$,d[y+0]=(f+D*u)*M,d[y+1]=(v+S*u)*M,d[y+2]=(b+E*u)*M}else if(N==2)I=i[L+3],f=i[L],v=i[L+1],b=i[L+2],A=d[y+3],D=d[y],S=d[y+1],E=d[y+2],I==A&&f==D&&v==S&&b==E?(d[y]=0,d[y+1]=0,d[y+2]=0,d[y+3]=0):(d[y]=f,d[y+1]=v,d[y+2]=b,d[y+3]=I);else if(N==3){if(I=i[L+3],f=i[L],v=i[L+1],b=i[L+2],A=d[y+3],D=d[y],S=d[y+1],E=d[y+2],I==A&&f==D&&v==S&&b==E)continue;if(I<220&&A>20)return!1}return!0}return{decode:function(e){const a=new Uint8Array(e);let d=8;const l=g,k=l.readUshort,C=l.readUint,x={tabs:{},frames:[]},N=new Uint8Array(a.length);let B,R=0,L=0;const y=[137,80,78,71,13,10,26,10];for(var I=0;I<8;I++)if(a[I]!=y[I])throw"The input is not a PNG file!";for(;d<a.length;){const T=l.readUint(a,d);d+=4;const h=l.readASCII(a,d,4);if(d+=4,h=="IHDR")_(a,d,x);else if(h=="iCCP"){for(var f=d;a[f]!=0;)f++;l.readASCII(a,d,f-d),a[f+1];const u=a.slice(f+2,d+T);let $=null;try{$=s(u)}catch{$=t(u)}x.tabs[h]=$}else if(h=="CgBI")x.tabs[h]=a.slice(d,d+4);else if(h=="IDAT"){for(I=0;I<T;I++)N[R+I]=a[d+I];R+=T}else if(h=="acTL")x.tabs[h]={num_frames:C(a,d),num_plays:C(a,d+4)},B=new Uint8Array(a.length);else if(h=="fcTL"){L!=0&&((E=x.frames[x.frames.length-1]).data=w(x,B.slice(0,L),E.rect.width,E.rect.height),L=0);const u={x:C(a,d+12),y:C(a,d+16),width:C(a,d+4),height:C(a,d+8)};let $=k(a,d+22);$=k(a,d+20)/($==0?100:$);const M={rect:u,delay:Math.round(1e3*$),dispose:a[d+24],blend:a[d+25]};x.frames.push(M)}else if(h=="fdAT"){for(I=0;I<T-4;I++)B[L+I]=a[d+I+4];L+=T-4}else if(h=="pHYs")x.tabs[h]=[l.readUint(a,d),l.readUint(a,d+4),a[d+8]];else if(h=="cHRM")for(x.tabs[h]=[],I=0;I<8;I++)x.tabs[h].push(l.readUint(a,d+4*I));else if(h=="tEXt"||h=="zTXt"){x.tabs[h]==null&&(x.tabs[h]={});var v=l.nextZero(a,d),b=l.readASCII(a,d,v-d),A=d+T-v-1;if(h=="tEXt")S=l.readASCII(a,v+1,A);else{var D=s(a.slice(v+2,v+2+A));S=l.readUTF8(D,0,D.length)}x.tabs[h][b]=S}else if(h=="iTXt"){x.tabs[h]==null&&(x.tabs[h]={}),v=0,f=d,v=l.nextZero(a,f),b=l.readASCII(a,f,v-f);const u=a[f=v+1];var S;a[f+1],f+=2,v=l.nextZero(a,f),l.readASCII(a,f,v-f),f=v+1,v=l.nextZero(a,f),l.readUTF8(a,f,v-f),A=T-((f=v+1)-d),u==0?S=l.readUTF8(a,f,A):(D=s(a.slice(f,f+A)),S=l.readUTF8(D,0,D.length)),x.tabs[h][b]=S}else if(h=="PLTE")x.tabs[h]=l.readBytes(a,d,T);else if(h=="hIST"){const u=x.tabs.PLTE.length/3;for(x.tabs[h]=[],I=0;I<u;I++)x.tabs[h].push(k(a,d+2*I))}else if(h=="tRNS")x.ctype==3?x.tabs[h]=l.readBytes(a,d,T):x.ctype==0?x.tabs[h]=k(a,d):x.ctype==2&&(x.tabs[h]=[k(a,d),k(a,d+2),k(a,d+4)]);else if(h=="gAMA")x.tabs[h]=l.readUint(a,d)/1e5;else if(h=="sRGB")x.tabs[h]=a[d];else if(h=="bKGD")x.ctype==0||x.ctype==4?x.tabs[h]=[k(a,d)]:x.ctype==2||x.ctype==6?x.tabs[h]=[k(a,d),k(a,d+2),k(a,d+4)]:x.ctype==3&&(x.tabs[h]=a[d]);else if(h=="IEND")break;d+=T,l.readUint(a,d),d+=4}var E;return L!=0&&((E=x.frames[x.frames.length-1]).data=w(x,B.slice(0,L),E.rect.width,E.rect.height)),x.data=w(x,N,x.width,x.height),delete x.compress,delete x.interlace,delete x.filter,x},toRGBA8:function(e){const a=e.width,d=e.height;if(e.tabs.acTL==null)return[m(e.data,a,d,e).buffer];const l=[];e.frames[0].data==null&&(e.frames[0].data=e.data);const k=a*d*4,C=new Uint8Array(k),x=new Uint8Array(k),N=new Uint8Array(k);for(let R=0;R<e.frames.length;R++){const L=e.frames[R],y=L.rect.x,I=L.rect.y,f=L.rect.width,v=L.rect.height,b=m(L.data,f,v,e);if(R!=0)for(var B=0;B<k;B++)N[B]=C[B];if(L.blend==0?p(b,f,v,C,a,d,y,I,0):L.blend==1&&p(b,f,v,C,a,d,y,I,1),l.push(C.buffer.slice(0)),L.dispose!=0){if(L.dispose==1)p(x,f,v,C,a,d,y,I,0);else if(L.dispose==2)for(B=0;B<k;B++)C[B]=N[B]}}return l},_paeth:o,_copyTile:p,_bin:g}}();(function(){const{_copyTile:g}=at,{_bin:m}=at,w=at._paeth;var s={table:function(){const f=new Uint32Array(256);for(let v=0;v<256;v++){let b=v;for(let A=0;A<8;A++)1&b?b=3988292384^b>>>1:b>>>=1;f[v]=b}return f}(),update(f,v,b,A){for(let D=0;D<A;D++)f=s.table[255&(f^v[b+D])]^f>>>8;return f},crc:(f,v,b)=>4294967295^s.update(4294967295,f,v,b)};function t(f,v,b,A){v[b]+=f[0]*A>>4,v[b+1]+=f[1]*A>>4,v[b+2]+=f[2]*A>>4,v[b+3]+=f[3]*A>>4}function r(f){return Math.max(0,Math.min(255,f))}function c(f,v){const b=f[0]-v[0],A=f[1]-v[1],D=f[2]-v[2],S=f[3]-v[3];return b*b+A*A+D*D+S*S}function o(f,v,b,A,D,S,E){E==null&&(E=1);const T=A.length,h=[];for(var u=0;u<T;u++){const F=A[u];h.push([F>>>0&255,F>>>8&255,F>>>16&255,F>>>24&255])}for(u=0;u<T;u++){let F=4294967295;for(var $=0,M=0;M<T;M++){var U=c(h[u],h[M]);M!=u&&U<F&&(F=U,$=M)}}const K=new Uint32Array(D.buffer),Y=new Int16Array(v*b*4),W=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(u=0;u<W.length;u++)W[u]=255*((W[u]+.5)/16-.5);for(let F=0;F<b;F++)for(let ee=0;ee<v;ee++){var H;u=4*(F*v+ee),E!=2?H=[r(f[u]+Y[u]),r(f[u+1]+Y[u+1]),r(f[u+2]+Y[u+2]),r(f[u+3]+Y[u+3])]:(U=W[4*(3&F)+(3&ee)],H=[r(f[u]+U),r(f[u+1]+U),r(f[u+2]+U),r(f[u+3]+U)]),$=0;let ue=16777215;for(M=0;M<T;M++){const ve=c(H,h[M]);ve<ue&&(ue=ve,$=M)}const he=h[$],fe=[H[0]-he[0],H[1]-he[1],H[2]-he[2],H[3]-he[3]];E==1&&(ee!=v-1&&t(fe,Y,u+4,7),F!=b-1&&(ee!=0&&t(fe,Y,u+4*v-4,3),t(fe,Y,u+4*v,5),ee!=v-1&&t(fe,Y,u+4*v+4,1))),S[u>>2]=$,K[u>>2]=A[$]}}function _(f,v,b,A,D){D==null&&(D={});const{crc:S}=s,E=m.writeUint,T=m.writeUshort,h=m.writeASCII;let u=8;const $=f.frames.length>1;let M,U=!1,K=33+($?20:0);if(D.sRGB!=null&&(K+=13),D.pHYs!=null&&(K+=21),D.iCCP!=null&&(M=pako.deflate(D.iCCP),K+=21+M.length+4),f.ctype==3){for(var Y=f.plte.length,W=0;W<Y;W++)f.plte[W]>>>24!=255&&(U=!0);K+=8+3*Y+4+(U?8+1*Y+4:0)}for(var H=0;H<f.frames.length;H++)$&&(K+=38),K+=(he=f.frames[H]).cimg.length+12,H!=0&&(K+=4);K+=12;const F=new Uint8Array(K),ee=[137,80,78,71,13,10,26,10];for(W=0;W<8;W++)F[W]=ee[W];if(E(F,u,13),u+=4,h(F,u,"IHDR"),u+=4,E(F,u,v),u+=4,E(F,u,b),u+=4,F[u]=f.depth,u++,F[u]=f.ctype,u++,F[u]=0,u++,F[u]=0,u++,F[u]=0,u++,E(F,u,S(F,u-17,17)),u+=4,D.sRGB!=null&&(E(F,u,1),u+=4,h(F,u,"sRGB"),u+=4,F[u]=D.sRGB,u++,E(F,u,S(F,u-5,5)),u+=4),D.iCCP!=null){const fe=13+M.length;E(F,u,fe),u+=4,h(F,u,"iCCP"),u+=4,h(F,u,"ICC profile"),u+=11,u+=2,F.set(M,u),u+=M.length,E(F,u,S(F,u-(fe+4),fe+4)),u+=4}if(D.pHYs!=null&&(E(F,u,9),u+=4,h(F,u,"pHYs"),u+=4,E(F,u,D.pHYs[0]),u+=4,E(F,u,D.pHYs[1]),u+=4,F[u]=D.pHYs[2],u++,E(F,u,S(F,u-13,13)),u+=4),$&&(E(F,u,8),u+=4,h(F,u,"acTL"),u+=4,E(F,u,f.frames.length),u+=4,E(F,u,D.loop!=null?D.loop:0),u+=4,E(F,u,S(F,u-12,12)),u+=4),f.ctype==3){for(E(F,u,3*(Y=f.plte.length)),u+=4,h(F,u,"PLTE"),u+=4,W=0;W<Y;W++){const fe=3*W,ve=f.plte[W],Ee=255&ve,Ae=ve>>>8&255,ke=ve>>>16&255;F[u+fe+0]=Ee,F[u+fe+1]=Ae,F[u+fe+2]=ke}if(u+=3*Y,E(F,u,S(F,u-3*Y-4,3*Y+4)),u+=4,U){for(E(F,u,Y),u+=4,h(F,u,"tRNS"),u+=4,W=0;W<Y;W++)F[u+W]=f.plte[W]>>>24&255;u+=Y,E(F,u,S(F,u-Y-4,Y+4)),u+=4}}let ue=0;for(H=0;H<f.frames.length;H++){var he=f.frames[H];$&&(E(F,u,26),u+=4,h(F,u,"fcTL"),u+=4,E(F,u,ue++),u+=4,E(F,u,he.rect.width),u+=4,E(F,u,he.rect.height),u+=4,E(F,u,he.rect.x),u+=4,E(F,u,he.rect.y),u+=4,T(F,u,A[H]),u+=2,T(F,u,1e3),u+=2,F[u]=he.dispose,u++,F[u]=he.blend,u++,E(F,u,S(F,u-30,30)),u+=4);const fe=he.cimg;E(F,u,(Y=fe.length)+(H==0?0:4)),u+=4;const ve=u;h(F,u,H==0?"IDAT":"fdAT"),u+=4,H!=0&&(E(F,u,ue++),u+=4),F.set(fe,u),u+=Y,E(F,u,S(F,ve,u-ve)),u+=4}return E(F,u,0),u+=4,h(F,u,"IEND"),u+=4,E(F,u,S(F,u-4,4)),u+=4,F.buffer}function p(f,v,b){for(let A=0;A<f.frames.length;A++){const D=f.frames[A];D.rect.width;const S=D.rect.height,E=new Uint8Array(S*D.bpl+S);D.cimg=d(D.img,S,D.bpp,D.bpl,E,v,b)}}function i(f,v,b,A,D){const S=D[0],E=D[1],T=D[2],h=D[3],u=D[4],$=D[5];let M=6,U=8,K=255;for(var Y=0;Y<f.length;Y++){const V=new Uint8Array(f[Y]);for(var W=V.length,H=0;H<W;H+=4)K&=V[H+3]}const F=K!=255,ee=function(re,se,ne,ae,ie,me){const be=[];for(var oe=0;oe<re.length;oe++){const De=new Uint8Array(re[oe]),Ce=new Uint32Array(De.buffer);var pe;let Ne=0,He=0,ze=se,Fe=ne,We=ae?1:0;if(oe!=0){const mt=me||ae||oe==1||be[oe-2].dispose!=0?1:2;let st=0,lt=1e9;for(let ot=0;ot<mt;ot++){var Re=new Uint8Array(re[oe-1-ot]);const Jt=new Uint32Array(re[oe-1-ot]);let ct=se,Ge=ne,Ue=-1,Et=-1;for(let ht=0;ht<ne;ht++)for(let gt=0;gt<se;gt++)Ce[xe=ht*se+gt]!=Jt[xe]&&(gt<ct&&(ct=gt),gt>Ue&&(Ue=gt),ht<Ge&&(Ge=ht),ht>Et&&(Et=ht));Ue==-1&&(ct=Ge=Ue=Et=0),ie&&((1&ct)==1&&ct--,(1&Ge)==1&&Ge--);const Bt=(Ue-ct+1)*(Et-Ge+1);Bt<lt&&(lt=Bt,st=ot,Ne=ct,He=Ge,ze=Ue-ct+1,Fe=Et-Ge+1)}Re=new Uint8Array(re[oe-1-st]),st==1&&(be[oe-1].dispose=2),pe=new Uint8Array(ze*Fe*4),g(Re,se,ne,pe,ze,Fe,-Ne,-He,0),We=g(De,se,ne,pe,ze,Fe,-Ne,-He,3)?1:0,We==1?a(De,se,ne,pe,{x:Ne,y:He,width:ze,height:Fe}):g(De,se,ne,pe,ze,Fe,-Ne,-He,0)}else pe=De.slice(0);be.push({rect:{x:Ne,y:He,width:ze,height:Fe},img:pe,blend:We,dispose:0})}if(ae)for(oe=0;oe<be.length;oe++){if((Ye=be[oe]).blend==1)continue;const De=Ye.rect,Ce=be[oe-1].rect,Ne=Math.min(De.x,Ce.x),He=Math.min(De.y,Ce.y),ze={x:Ne,y:He,width:Math.max(De.x+De.width,Ce.x+Ce.width)-Ne,height:Math.max(De.y+De.height,Ce.y+Ce.height)-He};be[oe-1].dispose=1,oe-1!=0&&e(re,se,ne,be,oe-1,ze,ie),e(re,se,ne,be,oe,ze,ie)}let Pe=0;if(re.length!=1)for(var xe=0;xe<be.length;xe++){var Ye;Pe+=(Ye=be[xe]).rect.width*Ye.rect.height}return be}(f,v,b,S,E,T),ue={},he=[],fe=[];if(A!=0){const V=[];for(H=0;H<ee.length;H++)V.push(ee[H].img.buffer);const re=function(ie){let me=0;for(var be=0;be<ie.length;be++)me+=ie[be].byteLength;const oe=new Uint8Array(me);let pe=0;for(be=0;be<ie.length;be++){const Re=new Uint8Array(ie[be]),Pe=Re.length;for(let xe=0;xe<Pe;xe+=4){let Ye=Re[xe],De=Re[xe+1],Ce=Re[xe+2];const Ne=Re[xe+3];Ne==0&&(Ye=De=Ce=0),oe[pe+xe]=Ye,oe[pe+xe+1]=De,oe[pe+xe+2]=Ce,oe[pe+xe+3]=Ne}pe+=Pe}return oe.buffer}(V),se=k(re,A);for(H=0;H<se.plte.length;H++)he.push(se.plte[H].est.rgba);let ne=0;for(H=0;H<ee.length;H++){const ae=(Ee=ee[H]).img.length;var ve=new Uint8Array(se.inds.buffer,ne>>2,ae>>2);fe.push(ve);const ie=new Uint8Array(se.abuf,ne,ae);$&&o(Ee.img,Ee.rect.width,Ee.rect.height,he,ie,ve),Ee.img.set(ie),ne+=ae}}else for(Y=0;Y<ee.length;Y++){var Ee=ee[Y];const V=new Uint32Array(Ee.img.buffer);var Ae=Ee.rect.width;for(W=V.length,ve=new Uint8Array(W),fe.push(ve),H=0;H<W;H++){const re=V[H];if(H!=0&&re==V[H-1])ve[H]=ve[H-1];else if(H>Ae&&re==V[H-Ae])ve[H]=ve[H-Ae];else{let se=ue[re];if(se==null&&(ue[re]=se=he.length,he.push(re),he.length>=300))break;ve[H]=se}}}const ke=he.length;for(ke<=256&&u==0&&(U=ke<=2?1:ke<=4?2:ke<=16?4:8,U=Math.max(U,h)),Y=0;Y<ee.length;Y++){(Ee=ee[Y]).rect.x,Ee.rect.y,Ae=Ee.rect.width;const V=Ee.rect.height;let re=Ee.img;new Uint32Array(re.buffer);let se=4*Ae,ne=4;if(ke<=256&&u==0){se=Math.ceil(U*Ae/8);var Q=new Uint8Array(se*V);const ae=fe[Y];for(let ie=0;ie<V;ie++){H=ie*se;const me=ie*Ae;if(U==8)for(var Z=0;Z<Ae;Z++)Q[H+Z]=ae[me+Z];else if(U==4)for(Z=0;Z<Ae;Z++)Q[H+(Z>>1)]|=ae[me+Z]<<4-4*(1&Z);else if(U==2)for(Z=0;Z<Ae;Z++)Q[H+(Z>>2)]|=ae[me+Z]<<6-2*(3&Z);else if(U==1)for(Z=0;Z<Ae;Z++)Q[H+(Z>>3)]|=ae[me+Z]<<7-1*(7&Z)}re=Q,M=3,ne=1}else if(F==0&&ee.length==1){Q=new Uint8Array(Ae*V*3);const ae=Ae*V;for(H=0;H<ae;H++){const ie=3*H,me=4*H;Q[ie]=re[me],Q[ie+1]=re[me+1],Q[ie+2]=re[me+2]}re=Q,M=2,ne=3,se=3*Ae}Ee.img=re,Ee.bpl=se,Ee.bpp=ne}return{ctype:M,depth:U,plte:he,frames:ee}}function e(f,v,b,A,D,S,E){const T=Uint8Array,h=Uint32Array,u=new T(f[D-1]),$=new h(f[D-1]),M=D+1<f.length?new T(f[D+1]):null,U=new T(f[D]),K=new h(U.buffer);let Y=v,W=b,H=-1,F=-1;for(let ue=0;ue<S.height;ue++)for(let he=0;he<S.width;he++){const fe=S.x+he,ve=S.y+ue,Ee=ve*v+fe,Ae=K[Ee];Ae==0||A[D-1].dispose==0&&$[Ee]==Ae&&(M==null||M[4*Ee+3]!=0)||(fe<Y&&(Y=fe),fe>H&&(H=fe),ve<W&&(W=ve),ve>F&&(F=ve))}H==-1&&(Y=W=H=F=0),E&&((1&Y)==1&&Y--,(1&W)==1&&W--),S={x:Y,y:W,width:H-Y+1,height:F-W+1};const ee=A[D];ee.rect=S,ee.blend=1,ee.img=new Uint8Array(S.width*S.height*4),A[D-1].dispose==0?(g(u,v,b,ee.img,S.width,S.height,-S.x,-S.y,0),a(U,v,b,ee.img,S)):g(U,v,b,ee.img,S.width,S.height,-S.x,-S.y,0)}function a(f,v,b,A,D){g(f,v,b,A,D.width,D.height,-D.x,-D.y,2)}function d(f,v,b,A,D,S,E){const T=[];let h,u=[0,1,2,3,4];S!=-1?u=[S]:(v*A>5e5||b==1)&&(u=[0]),E&&(h={level:0});const $=_i;for(var M=0;M<u.length;M++){for(let Y=0;Y<v;Y++)l(D,f,Y,A,b,u[M]);T.push($.deflate(D,h))}let U,K=1e9;for(M=0;M<T.length;M++)T[M].length<K&&(U=M,K=T[M].length);return T[U]}function l(f,v,b,A,D,S){const E=b*A;let T=E+b;if(f[T]=S,T++,S==0)if(A<500)for(var h=0;h<A;h++)f[T+h]=v[E+h];else f.set(new Uint8Array(v.buffer,E,A),T);else if(S==1){for(h=0;h<D;h++)f[T+h]=v[E+h];for(h=D;h<A;h++)f[T+h]=v[E+h]-v[E+h-D]+256&255}else if(b==0){for(h=0;h<D;h++)f[T+h]=v[E+h];if(S==2)for(h=D;h<A;h++)f[T+h]=v[E+h];if(S==3)for(h=D;h<A;h++)f[T+h]=v[E+h]-(v[E+h-D]>>1)+256&255;if(S==4)for(h=D;h<A;h++)f[T+h]=v[E+h]-w(v[E+h-D],0,0)+256&255}else{if(S==2)for(h=0;h<A;h++)f[T+h]=v[E+h]+256-v[E+h-A]&255;if(S==3){for(h=0;h<D;h++)f[T+h]=v[E+h]+256-(v[E+h-A]>>1)&255;for(h=D;h<A;h++)f[T+h]=v[E+h]+256-(v[E+h-A]+v[E+h-D]>>1)&255}if(S==4){for(h=0;h<D;h++)f[T+h]=v[E+h]+256-w(0,v[E+h-A],0)&255;for(h=D;h<A;h++)f[T+h]=v[E+h]+256-w(v[E+h-D],v[E+h-A],v[E+h-D-A])&255}}}function k(f,v){const b=new Uint8Array(f),A=b.slice(0),D=new Uint32Array(A.buffer),S=C(A,v),E=S[0],T=S[1],h=b.length,u=new Uint8Array(h>>2);let $;if(b.length<2e7)for(var M=0;M<h;M+=4)$=x(E,U=b[M]*(1/255),K=b[M+1]*(1/255),Y=b[M+2]*(1/255),W=b[M+3]*(1/255)),u[M>>2]=$.ind,D[M>>2]=$.est.rgba;else for(M=0;M<h;M+=4){var U=b[M]*.00392156862745098,K=b[M+1]*(1/255),Y=b[M+2]*(1/255),W=b[M+3]*(1/255);for($=E;$.left;)$=N($.est,U,K,Y,W)<=0?$.left:$.right;u[M>>2]=$.ind,D[M>>2]=$.est.rgba}return{abuf:A.buffer,inds:u,plte:T}}function C(f,v,b){b==null&&(b=1e-4);const A=new Uint32Array(f.buffer),D={i0:0,i1:f.length,bst:null,est:null,tdst:0,left:null,right:null};D.bst=L(f,D.i0,D.i1),D.est=y(D.bst);const S=[D];for(;S.length<v;){let T=0,h=0;for(var E=0;E<S.length;E++)S[E].est.L>T&&(T=S[E].est.L,h=E);if(T<b)break;const u=S[h],$=B(f,A,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=$||u.i1<=$){u.est.L=0;continue}const M={i0:u.i0,i1:$,bst:null,est:null,tdst:0,left:null,right:null};M.bst=L(f,M.i0,M.i1),M.est=y(M.bst);const U={i0:$,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(U.bst={R:[],m:[],N:u.bst.N-M.bst.N},E=0;E<16;E++)U.bst.R[E]=u.bst.R[E]-M.bst.R[E];for(E=0;E<4;E++)U.bst.m[E]=u.bst.m[E]-M.bst.m[E];U.est=y(U.bst),u.left=M,u.right=U,S[h]=M,S.push(U)}for(S.sort((T,h)=>h.bst.N-T.bst.N),E=0;E<S.length;E++)S[E].ind=E;return[D,S]}function x(f,v,b,A,D){if(f.left==null)return f.tdst=function(M,U,K,Y,W){const H=U-M[0],F=K-M[1],ee=Y-M[2],ue=W-M[3];return H*H+F*F+ee*ee+ue*ue}(f.est.q,v,b,A,D),f;const S=N(f.est,v,b,A,D);let E=f.left,T=f.right;S>0&&(E=f.right,T=f.left);const h=x(E,v,b,A,D);if(h.tdst<=S*S)return h;const u=x(T,v,b,A,D);return u.tdst<h.tdst?u:h}function N(f,v,b,A,D){const{e:S}=f;return S[0]*v+S[1]*b+S[2]*A+S[3]*D-f.eMq}function B(f,v,b,A,D,S){for(A-=4;b<A;){for(;R(f,b,D)<=S;)b+=4;for(;R(f,A,D)>S;)A-=4;if(b>=A)break;const E=v[b>>2];v[b>>2]=v[A>>2],v[A>>2]=E,b+=4,A-=4}for(;R(f,b,D)>S;)b-=4;return b+4}function R(f,v,b){return f[v]*b[0]+f[v+1]*b[1]+f[v+2]*b[2]+f[v+3]*b[3]}function L(f,v,b){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D=[0,0,0,0],S=b-v>>2;for(let E=v;E<b;E+=4){const T=f[E]*.00392156862745098,h=f[E+1]*(1/255),u=f[E+2]*(1/255),$=f[E+3]*(1/255);D[0]+=T,D[1]+=h,D[2]+=u,D[3]+=$,A[0]+=T*T,A[1]+=T*h,A[2]+=T*u,A[3]+=T*$,A[5]+=h*h,A[6]+=h*u,A[7]+=h*$,A[10]+=u*u,A[11]+=u*$,A[15]+=$*$}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:D,N:S}}function y(f){const{R:v}=f,{m:b}=f,{N:A}=f,D=b[0],S=b[1],E=b[2],T=b[3],h=A==0?0:1/A,u=[v[0]-D*D*h,v[1]-D*S*h,v[2]-D*E*h,v[3]-D*T*h,v[4]-S*D*h,v[5]-S*S*h,v[6]-S*E*h,v[7]-S*T*h,v[8]-E*D*h,v[9]-E*S*h,v[10]-E*E*h,v[11]-E*T*h,v[12]-T*D*h,v[13]-T*S*h,v[14]-T*E*h,v[15]-T*T*h],$=u,M=I;let U=[Math.random(),Math.random(),Math.random(),Math.random()],K=0,Y=0;if(A!=0)for(let H=0;H<16&&(U=M.multVec($,U),Y=Math.sqrt(M.dot(U,U)),U=M.sml(1/Y,U),!(H!=0&&Math.abs(Y-K)<1e-9));H++)K=Y;const W=[D*h,S*h,E*h,T*h];return{Cov:u,q:W,e:U,L:K,eMq255:M.dot(M.sml(255,W),U),eMq:M.dot(U,W),rgba:(Math.round(255*W[3])<<24|Math.round(255*W[2])<<16|Math.round(255*W[1])<<8|Math.round(255*W[0])<<0)>>>0}}var I={multVec:(f,v)=>[f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],f[4]*v[0]+f[5]*v[1]+f[6]*v[2]+f[7]*v[3],f[8]*v[0]+f[9]*v[1]+f[10]*v[2]+f[11]*v[3],f[12]*v[0]+f[13]*v[1]+f[14]*v[2]+f[15]*v[3]],dot:(f,v)=>f[0]*v[0]+f[1]*v[1]+f[2]*v[2]+f[3]*v[3],sml:(f,v)=>[f*v[0],f*v[1],f*v[2],f*v[3]]};at.encode=function(v,b,A,D,S,E,T){D==null&&(D=0),T==null&&(T=!1);const h=i(v,b,A,D,[!1,!1,!1,0,T,!1]);return p(h,-1),_(h,b,A,S,E)},at.encodeLL=function(v,b,A,D,S,E,T,h){const u={ctype:0+(D==1?0:2)+(S==0?0:4),depth:E,frames:[]},$=(D+S)*E,M=$*b;for(let U=0;U<v.length;U++)u.frames.push({rect:{x:0,y:0,width:b,height:A},img:new Uint8Array(v[U]),blend:0,dispose:1,bpp:Math.ceil($/8),bpl:Math.ceil(M/8)});return p(u,0,!0),_(u,b,A,T,h)},at.encode.compress=i,at.encode.dither=o,at.quantize=k,at.quantize.getKDtree=C,at.quantize.getNearest=x})();const Vr={toArrayBuffer(g,m){const w=g.width,s=g.height,t=w<<2,r=g.getContext("2d").getImageData(0,0,w,s),c=new Uint32Array(r.data.buffer),o=(32*w+31)/32<<2,_=o*s,p=122+_,i=new ArrayBuffer(p),e=new DataView(i),a=1<<20;let d,l,k,C,x=a,N=0,B=0,R=0;function L(f){e.setUint16(B,f,!0),B+=2}function y(f){e.setUint32(B,f,!0),B+=4}function I(f){B+=f}L(19778),y(p),I(4),y(122),y(108),y(w),y(-s>>>0),L(1),L(32),y(3),y(_),y(2835),y(2835),I(8),y(16711680),y(65280),y(255),y(4278190080),y(1466527264),function f(){for(;N<s&&x>0;){for(C=122+N*o,d=0;d<t;)x--,l=c[R++],k=l>>>24,e.setUint32(C+d,l<<8|k),d+=4;N++}R<c.length?(x=a,setTimeout(f,Vr._dly)):m(i)}()},toBlob(g,m){this.toArrayBuffer(g,w=>{m(new Blob([w],{type:"image/bmp"}))})},_dly:9};var Xe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},pi={[Xe.CHROME]:16384,[Xe.FIREFOX]:11180,[Xe.DESKTOP_SAFARI]:16384,[Xe.IE]:8192,[Xe.IOS]:4096,[Xe.ETC]:8192};const pr=typeof window<"u",Gr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Vt=pr&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),yi=(pr||Gr)&&(Vt&&Vt.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Zr=(pr||Gr)&&(Vt&&Vt.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function yr(g,m,w=Date.now()){return new Promise(s=>{const t=g.split(","),r=t[0].match(/:(.*?);/)[1],c=globalThis.atob(t[1]);let o=c.length;const _=new Uint8Array(o);for(;o--;)_[o]=c.charCodeAt(o);const p=new Blob([_],{type:r});p.name=m,p.lastModified=w,s(p)})}function Xr(g){return new Promise((m,w)=>{const s=new Zr;s.onload=()=>m(s.result),s.onerror=t=>w(t),s.readAsDataURL(g)})}function Jr(g){return new Promise((m,w)=>{const s=new Image;s.onload=()=>m(s),s.onerror=t=>w(t),s.src=g})}function At(){if(At.cachedResult!==void 0)return At.cachedResult;let g=Xe.ETC;const{userAgent:m}=navigator;return/Chrom(e|ium)/i.test(m)?g=Xe.CHROME:/iP(ad|od|hone)/i.test(m)&&/WebKit/i.test(m)?g=Xe.IOS:/Safari/i.test(m)?g=Xe.DESKTOP_SAFARI:/Firefox/i.test(m)?g=Xe.FIREFOX:(/MSIE/i.test(m)||document.documentMode)&&(g=Xe.IE),At.cachedResult=g,At.cachedResult}function en(g,m){const w=At(),s=pi[w];let t=g,r=m,c=t*r;const o=t>r?r/t:t/r;for(;c>s*s;){const _=(s+t)/2,p=(s+r)/2;_<p?(r=p,t=p*o):(r=_*o,t=_),c=t*r}return{width:t,height:r}}function Xt(g,m){let w,s;try{if(w=new OffscreenCanvas(g,m),s=w.getContext("2d"),s===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{w=document.createElement("canvas"),s=w.getContext("2d")}return w.width=g,w.height=m,[w,s]}function tn(g,m){const{width:w,height:s}=en(g.width,g.height),[t,r]=Xt(w,s);return m&&/jpe?g/.test(m)&&(r.fillStyle="white",r.fillRect(0,0,t.width,t.height)),r.drawImage(g,0,0,t.width,t.height),t}function qt(){return qt.cachedResult!==void 0||(qt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),qt.cachedResult}function Gt(g,m={}){return new Promise(function(w,s){let t,r;var c=function(){try{return r=tn(t,m.fileType||g.type),w([t,r])}catch(_){return s(_)}},o=function(_){try{var p=function(i){try{throw i}catch(e){return s(e)}};try{let i;return Xr(g).then(function(e){try{return i=e,Jr(i).then(function(a){try{return t=a,function(){try{return c()}catch(d){return s(d)}}()}catch(d){return p(d)}},p)}catch(a){return p(a)}},p)}catch(i){p(i)}}catch(i){return s(i)}};try{if(qt()||[Xe.DESKTOP_SAFARI,Xe.MOBILE_SAFARI].includes(At()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(g).then(function(_){try{return t=_,c()}catch{return o()}},o)}catch{o()}})}function Zt(g,m,w,s,t=1){return new Promise(function(r,c){let o;if(m==="image/png"){let p,i,e;return p=g.getContext("2d"),{data:i}=p.getImageData(0,0,g.width,g.height),e=at.encode([i.buffer],g.width,g.height,4096*t),o=new Blob([e],{type:m}),o.name=w,o.lastModified=s,_.call(this)}{let p=function(){return _.call(this)};if(m==="image/bmp")return new Promise(i=>Vr.toBlob(g,i)).then(function(i){try{return o=i,o.name=w,o.lastModified=s,p.call(this)}catch(e){return c(e)}}.bind(this),c);{let i=function(){return p.call(this)};if(typeof OffscreenCanvas=="function"&&g instanceof OffscreenCanvas)return g.convertToBlob({type:m,quality:t}).then(function(e){try{return o=e,o.name=w,o.lastModified=s,i.call(this)}catch(a){return c(a)}}.bind(this),c);{let e;return e=g.toDataURL(m,t),yr(e,w,s).then(function(a){try{return o=a,i.call(this)}catch(d){return c(d)}}.bind(this),c)}}}function _(){return r(o)}})}function ft(g){g.width=0,g.height=0}function St(){return new Promise(function(g,m){let w,s,t,r;return St.cachedResult!==void 0?g(St.cachedResult):yr("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(c){try{return w=c,Gt(w).then(function(o){try{return s=o[1],Zt(s,w.type,w.name,w.lastModified).then(function(_){try{return t=_,ft(s),Gt(t).then(function(p){try{return r=p[0],St.cachedResult=r.width===1&&r.height===2,g(St.cachedResult)}catch(i){return m(i)}},m)}catch(p){return m(p)}},m)}catch(_){return m(_)}},m)}catch(o){return m(o)}},m)})}function rn(g){return new Promise((m,w)=>{const s=new Zr;s.onload=t=>{const r=new DataView(t.target.result);if(r.getUint16(0,!1)!=65496)return m(-2);const c=r.byteLength;let o=2;for(;o<c;){if(r.getUint16(o+2,!1)<=8)return m(-1);const _=r.getUint16(o,!1);if(o+=2,_==65505){if(r.getUint32(o+=2,!1)!=1165519206)return m(-1);const p=r.getUint16(o+=6,!1)==18761;o+=r.getUint32(o+4,p);const i=r.getUint16(o,p);o+=2;for(let e=0;e<i;e++)if(r.getUint16(o+12*e,p)==274)return m(r.getUint16(o+12*e+8,p))}else{if((65280&_)!=65280)break;o+=r.getUint16(o,!1)}}return m(-1)},s.onerror=t=>w(t),s.readAsArrayBuffer(g)})}function nn(g,m){const{width:w}=g,{height:s}=g,{maxWidthOrHeight:t}=m;let r,c=g;return isFinite(t)&&(w>t||s>t)&&([c,r]=Xt(w,s),w>s?(c.width=t,c.height=s/w*t):(c.width=w/s*t,c.height=t),r.drawImage(g,0,0,c.width,c.height),ft(g)),c}function an(g,m){const{width:w}=g,{height:s}=g,[t,r]=Xt(w,s);switch(m>4&&m<9?(t.width=s,t.height=w):(t.width=w,t.height=s),m){case 2:r.transform(-1,0,0,1,w,0);break;case 3:r.transform(-1,0,0,-1,w,s);break;case 4:r.transform(1,0,0,-1,0,s);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,s,0);break;case 7:r.transform(0,-1,-1,0,s,w);break;case 8:r.transform(0,-1,1,0,0,w)}return r.drawImage(g,0,0,w,s),ft(g),t}function Rr(g,m,w=0){return new Promise(function(s,t){let r,c,o,_,p,i,e,a,d,l,k,C,x,N,B,R,L,y,I,f;function v(A=5){if(m.signal&&m.signal.aborted)throw m.signal.reason;r+=A,m.onProgress(Math.min(r,100))}function b(A){if(m.signal&&m.signal.aborted)throw m.signal.reason;r=Math.min(Math.max(A,r),100),m.onProgress(r)}return r=w,c=m.maxIteration||10,o=1024*m.maxSizeMB*1024,v(),Gt(g,m).then(function(A){try{return[,_]=A,v(),p=nn(_,m),v(),new Promise(function(D,S){var E;if(!(E=m.exifOrientation))return rn(g).then(function(h){try{return E=h,T.call(this)}catch(u){return S(u)}}.bind(this),S);function T(){return D(E)}return T.call(this)}).then(function(D){try{return i=D,v(),St().then(function(S){try{return e=S?p:an(p,i),v(),a=m.initialQuality||1,d=m.fileType||g.type,Zt(e,d,g.name,g.lastModified,a).then(function(E){try{{let h=function(){if(c--&&(B>o||B>x)){let $,M;return $=f?.95*I.width:I.width,M=f?.95*I.height:I.height,[L,y]=Xt($,M),y.drawImage(I,0,0,$,M),a*=d==="image/png"?.85:.95,Zt(L,d,g.name,g.lastModified,a).then(function(U){try{return R=U,ft(I),I=L,B=R.size,b(Math.min(99,Math.floor((N-B)/(N-o)*100))),h}catch(K){return t(K)}},t)}return[1]},u=function(){return ft(I),ft(L),ft(p),ft(e),ft(_),b(100),s(R)};if(l=E,v(),k=l.size>o,C=l.size>g.size,!k&&!C)return b(100),s(l);var T;return x=g.size,N=l.size,B=N,I=e,f=!m.alwaysKeepResolution&&k,(T=function($){for(;$;){if($.then)return void $.then(T,t);try{if($.pop){if($.length)return $.pop()?u.call(this):$;$=h}else $=$.call(this)}catch(M){return t(M)}}}.bind(this))(h)}}catch(h){return t(h)}}.bind(this),t)}catch(E){return t(E)}}.bind(this),t)}catch(S){return t(S)}}.bind(this),t)}catch(D){return t(D)}}.bind(this),t)})}const bi=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let ur;function wi(g,m){return new Promise((w,s)=>{ur||(ur=function(c){const o=[];return o.push(c),URL.createObjectURL(new Blob(o))}(bi));const t=new Worker(ur);t.addEventListener("message",function(c){if(m.signal&&m.signal.aborted)t.terminate();else if(c.data.progress===void 0){if(c.data.error)return s(new Error(c.data.error)),void t.terminate();w(c.data.file),t.terminate()}else m.onProgress(c.data.progress)}),t.addEventListener("error",s),m.signal&&m.signal.addEventListener("abort",()=>{s(m.signal.reason),t.terminate()}),t.postMessage({file:g,imageCompressionLibUrl:m.libURL,options:{...m,onProgress:void 0,signal:void 0}})})}function je(g,m){return new Promise(function(w,s){let t,r,c,o,_,p;if(t={...m},c=0,{onProgress:o}=t,t.maxSizeMB=t.maxSizeMB||Number.POSITIVE_INFINITY,_=typeof t.useWebWorker!="boolean"||t.useWebWorker,delete t.useWebWorker,t.onProgress=d=>{c=d,typeof o=="function"&&o(c)},!(g instanceof Blob||g instanceof yi))return s(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(g.type))return s(new Error("The file given is not an image"));if(p=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!_||typeof Worker!="function"||p)return Rr(g,t).then(function(d){try{return r=d,a.call(this)}catch(l){return s(l)}}.bind(this),s);var i=function(){try{return a.call(this)}catch(d){return s(d)}}.bind(this),e=function(d){try{return Rr(g,t).then(function(l){try{return r=l,i()}catch(k){return s(k)}},s)}catch(l){return s(l)}};try{return t.libURL=t.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",wi(g,t).then(function(d){try{return r=d,i()}catch{return e()}},e)}catch{e()}function a(){try{r.name=g.name,r.lastModified=g.lastModified}catch{}try{t.preserveExif&&g.type==="image/jpeg"&&(!t.fileType||t.fileType&&t.fileType===g.type)&&(r=Kr(g,r))}catch{}return w(r)}})}je.getDataUrlFromFile=Xr,je.getFilefromDataUrl=yr,je.loadImage=Jr,je.drawImageInCanvas=tn,je.drawFileInCanvas=Gt,je.canvasToFile=Zt,je.getExifOrientation=rn,je.handleMaxWidthOrHeight=nn,je.followExifOrientation=an,je.cleanupCanvasMemory=ft,je.isAutoOrientationInBrowser=St,je.approximateBelowMaximumCanvasSizeOfBrowser=en,je.copyExifWithoutOrientation=Kr,je.getBrowserName=At,je.version="2.0.2";const xi={maxSizeMB:.8,maxWidthOrHeight:2400,initialQuality:.9,useWebWorker:!0,compressionThresholdMB:1};async function Ei(g,m,w={},s){const t={...xi,...w};try{let r=g;if(g.type.startsWith("image/")&&g.size>t.compressionThresholdMB*1024*1024){s?.("Compressing image...");try{const _=await je(g,{maxSizeMB:t.maxSizeMB,maxWidthOrHeight:t.maxWidthOrHeight,initialQuality:t.initialQuality,useWebWorker:t.useWebWorker});r=_;const p=(g.size/(1024*1024)).toFixed(2),i=(_.size/(1024*1024)).toFixed(2),e=((1-_.size/g.size)*100).toFixed(0);console.log(`Image compressed: ${p}MB → ${i}MB (${e}% smaller)`)}catch(_){console.warn("Image compression failed, uploading original:",_)}}return s?.("Uploading file..."),{success:!0,attachment:await qn(r,m)}}catch(r){return console.error("File upload failed:",r),{success:!1,error:r instanceof Error?r.message:"Upload failed"}}}async function Ai(g){try{const m=Hn(g.url);return await Nn(m),!0}catch(m){return console.error("Failed to remove attachment:",m),!1}}function Di(g,m,w){return g.map(s=>s.id===m?{...s,name:w}:s)}function ki(g,m=5){const w=g.type.startsWith("image/"),s=m*1024*1024;if(!w&&g.size>s){const t=(g.size/1048576).toFixed(2);return{valid:!1,error:`Non-image files must be under ${m}MB (selected file is ${t}MB)`}}return{valid:!0}}function Ii(g){return{uploadAttachment:(m,w,s)=>Ei(m,w,g,s),removeAttachment:Ai,updateAttachmentName:Di,validateFile:ki}}function Cr(g,m){const[w,s]=m.split(":").map(Number);let t=sa(g,w);return t=la(t,s),t}function Fr(g){return Array.from(new Set(g)).sort((m,w)=>m-w)}function Si(g,m){if(m.includes(g))return 0;const w=m.find(s=>s>g);return w!==void 0?w-g:7-g+m[0]}function Ti(g,m,w){const s=new Date(g),t=wt(s,Ve),r=t.getDay(),c=Si(r,w);if(c===0)return{start_time:g,end_time:m};const o=Qt(t,c),_=Dt(o,Ve);let p=m;if(m){const i=wt(new Date(m),Ve),e=Qt(i,c);p=Dt(e,Ve).toISOString()}return{start_time:_.toISOString(),end_time:p}}function sn({eventItem:g,dateInput:m,startTimeInput:w,endTimeInput:s,attachments:t,isRecurring:r,recurrenceFrequency:c,recurrenceInterval:o,recurringDays:_,recurrenceEndDate:p,hasEndDate:i,monthlyType:e}){const a=!g.id,d={...g.meta_data??{}};g.category&&(d.category=g.category);const l=qr(),k=l?mr(l.stores.currentUser):void 0;if(a){const y=l?mr(l.stores.userOrganizations):void 0,I=k?.displayName||k?.username,f=k?.id;I&&!d.submitted_by_name&&(d.submitted_by_name=I),f&&!d.submitted_by_user_id&&(d.submitted_by_user_id=f);const v=y?Array.from(y):[];v.length&&!d.submitted_by_organizations&&(d.submitted_by_organizations=v),d.submitted_at||(d.submitted_at=new Date().toISOString())}else{const y=k?.displayName||k?.username;y&&(d.edited_by_name=y),k?.id&&(d.edited_by_user_id=k.id),d.edited_at=new Date().toISOString()}const C=Object.keys(d).length?d:void 0,x={title:g.title,description:g.description,location:g.location,is_public:g.is_public??!0,event_type:g.event_type,meta_data:C,attachments:t.length>0?t:null};if(g.event_type!=="calendar_event")return{...x,start_time:void 0,end_time:void 0,is_all_day:void 0,recurrence_rule:void 0,recurrence_end_date:void 0};const N=m?jt(m,"yyyy-MM-dd",new Date):new Date;let B,R;if(g.is_all_day){const y=Dt(N,Ve);B=y.toISOString(),R=y.toISOString()}else{const y=new Date(N.getTime()),I=new Date(N.getTime()),f=w?Cr(y,w):N,v=s?Cr(I,s):N;B=Dt(f,Ve).toISOString(),R=Dt(v,Ve).toISOString()}const L={...x,start_time:B,end_time:R,is_all_day:g.is_all_day};if(r&&L.start_time){if(c==="weekly"&&_.length>0){const I=Fr(_),f=Ti(L.start_time,L.end_time,I);L.start_time=f.start_time,L.end_time=f.end_time}if(c==="daily"||c==="yearly"||c==="weekly"&&_.length>0||c==="monthly"){const{recurrence_rule:I,recurrence_end_date:f}=_r({frequency:c,interval:o,recurringDays:c==="weekly"?Fr(_):[],recurrenceEndDate:p,hasEndDate:i,monthlyType:e,startTime:L.start_time});L.recurrence_rule=I,L.recurrence_end_date=f}else L.recurrence_rule=void 0,L.recurrence_end_date=void 0}else L.recurrence_rule=void 0,L.recurrence_end_date=void 0;return L}async function Mi({id:g,...m}){const w=sn(m);return g?(m.eventItem.bishop_approval==="NO"&&Object.assign(w,{bishop_approval:null,bishop_approval_at:null,bishop_approval_by_user_id:null,first_counselor_approval:null,first_counselor_approval_at:null,first_counselor_approval_by_user_id:null,second_counselor_approval:null,second_counselor_approval_at:null,second_counselor_approval_by_user_id:null}),{action:"update",event:await kt(g,w)}):{action:"create",event:await Lr(w)}}async function Ri(g){await Br(g)}function Ci({event:g,newDate:m}){const w=g.start_time?new Date(g.start_time):new Date,s=g.end_time?new Date(g.end_time):new Date,[t,r,c]=m.split("-").map(Number),o=new Date(w);o.setFullYear(t,r-1,c);const _=new Date(s);return _.setFullYear(t,r-1,c),{...g,id:void 0,title:`CLONED - ${g.title}`,start_time:o.toISOString(),end_time:_.toISOString(),attachments:[],recurrence_rule:void 0,recurrence_end_date:void 0}}async function Fi(g,m,w){const s=await Pt(g);if(!s)throw new Error("Event not found");const t=s.recurrence_exceptions||[];t.includes(m)||t.push(m);const r=s.recurrence_overrides||{};r[m]={title:w.title,description:w.description,location:w.location,start_time:w.start_time,end_time:w.end_time,is_all_day:w.is_all_day,meta_data:w.meta_data},await kt(g,{recurrence_exceptions:t,recurrence_overrides:r})}async function Ui(g,m,w){const s=await Pt(g);if(!s||!s.recurrence_rule||!s.start_time)throw new Error("Event not found or is not recurring");const{parseRecurrenceRule:t,generateRecurrenceRule:r}=await Yt(async()=>{const{parseRecurrenceRule:B,generateRecurrenceRule:R}=await Promise.resolve().then(()=>hr);return{parseRecurrenceRule:B,generateRecurrenceRule:R}},void 0,import.meta.url),c=t(s.recurrence_rule,s.recurrence_end_date);if(!c)throw new Error("Failed to parse recurrence rule");const o=Le(new Date(s.start_time),"yyyy-MM-dd"),_=jt(m,"yyyy-MM-dd",new Date),p=jt(o,"yyyy-MM-dd",new Date);if(_<=p)return await kt(g,w),g;const i=Qt(_,-1),e=Le(i,"yyyy-MM-dd"),{recurrence_rule:a,recurrence_end_date:d}=r({frequency:c.frequency,interval:c.interval,recurringDays:c.recurringDays,recurrenceEndDate:e,hasEndDate:!0,monthlyType:c.monthlyType,startTime:s.start_time});await kt(g,{recurrence_rule:a,recurrence_end_date:d});const l=c.hasEndDate?c.recurrenceEndDate:"",{recurrence_rule:k,recurrence_end_date:C}=r({frequency:c.frequency,interval:c.interval,recurringDays:c.recurringDays,recurrenceEndDate:l,hasEndDate:c.hasEndDate,monthlyType:c.monthlyType,startTime:w.start_time||s.start_time}),x={...w,recurrence_rule:k,recurrence_end_date:C};return(await Lr(x))?.id||0}async function Oi(g,m){const w=await Pt(g);if(!w)throw new Error("Event not found");const s={title:m.title,description:m.description,location:m.location,event_type:m.event_type,meta_data:m.meta_data,attachments:m.attachments,is_all_day:m.is_all_day,start_time:w.start_time,end_time:w.end_time,recurrence_rule:w.recurrence_rule,recurrence_end_date:w.recurrence_end_date,recurrence_exceptions:[],recurrence_overrides:{}};await kt(g,s)}async function zi(g,m){const w=await Pt(g);if(!w)throw new Error("Event not found");const s=w.recurrence_exceptions||[];s.includes(m)||s.push(m);const t=w.recurrence_overrides||{};t[m]&&delete t[m],await kt(g,{recurrence_exceptions:s,recurrence_overrides:t})}async function Pi(g,m){const w=await Pt(g);if(!w||!w.recurrence_rule||!w.start_time)throw new Error("Event not found or is not recurring");const s=jt(m,"yyyy-MM-dd",new Date),t=Qt(s,-1),r=Le(t,"yyyy-MM-dd"),{parseRecurrenceRule:c}=await Yt(async()=>{const{parseRecurrenceRule:e}=await Promise.resolve().then(()=>hr);return{parseRecurrenceRule:e}},void 0,import.meta.url),o=c(w.recurrence_rule,w.recurrence_end_date);if(!o)throw new Error("Failed to parse recurrence rule");const{generateRecurrenceRule:_}=await Yt(async()=>{const{generateRecurrenceRule:e}=await Promise.resolve().then(()=>hr);return{generateRecurrenceRule:e}},void 0,import.meta.url),{recurrence_rule:p,recurrence_end_date:i}=_({frequency:o.frequency,interval:o.interval,recurringDays:o.recurringDays,recurrenceEndDate:r,hasEndDate:!0,monthlyType:o.monthlyType,startTime:w.start_time});await kt(g,{recurrence_rule:p,recurrence_end_date:i})}async function Bi(g){await Br(g)}function Li(){return{saveEvent:Mi,deleteEventById:Ri,cloneEventForDate:Ci,buildEventPayload:sn,saveSingleInstance:Fi,saveFutureInstances:Ui,saveAllInstances:Oi,deleteSingleInstance:zi,deleteFutureInstances:Pi,deleteAllInstances:Bi}}var Hi=le('<div class="alert alert-info d-flex align-items-center gap-2 mb-0" role="alert"><i class="bi bi-arrow-repeat"></i> <div><strong>Recurring Event</strong> <div class="small">Changes to this event will apply to all future occurrences.</div></div></div>'),Ni=le('<button class="btn btn-primary btn-sm"><i class="bi bi-files"></i> <span class="ms-1">Clone</span></button>'),qi=le("<!> <!>",1),$i=le('<span class="badge bg-secondary-subtle text-secondary-emphasis"> </span>'),Wi=le('<div class="card"><button type="button" class="btn btn-link text-start text-decoration-none d-flex align-items-center gap-3 p-3 w-100 submitter-chat-toggle svelte-zsu5u8"><i class="bi bi-chat-left-dots"></i> <div class="d-flex flex-column align-items-start"><span class="fw-semibold">Discussion with Bishopric</span> <small class="text-muted">Ask questions or respond to feedback</small></div> <div class="ms-auto d-flex align-items-center gap-2"><!> <i class="bi bi-chevron-right"></i></div></button></div> <!>',1),Yi=le('<div class="alert alert-info small mb-0 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All submissions require bishopric approval before they appear on the public calendar.</span></div> <!>',1),ji=le('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),Qi=le("<span>Save</span>"),Ki=le("<span>Create</span>"),Vi=le('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),Gi=le('<button class="btn btn-primary position-relative"><!> <!></button>'),Zi=le('<div class="d-flex flex-column gap-4"><!> <div class="d-flex flex-column gap-3"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap"><h2 class="h5 mb-0">Event Details</h2> <!></div> <!></div> <!> <!> <!> <!> <div class="d-flex justify-content-between align-items-center gap-2 flex-row"><div class="d-flex flex-row gap-2"><!></div> <div class="d-flex flex-row gap-2"><button class="btn btn-secondary position-relative">Cancel</button> <!></div></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span></div> <!></div> <!> <!>',1);function Ls(g,m){rt(m,!1);const w=()=>Nt(N,"$userOrganizations",r),s=()=>Nt(B,"$currentUser",r),t=()=>Nt(R,"$validationErrors",r),[r,c]=Or(),o=ce(),_=ce(),p=ce(),i=ce(),e=ce();let a=_e(m,"name",8,""),d=_e(m,"drawerId",8,""),l=_e(m,"eventItem",12,Vn),k=_e(m,"canDelete",8,!0),C=_e(m,"canCreate",8,!0);const{actions:{reload:x}}=Pr(),{stores:{userOrganizations:N,currentUser:B}}=qr(),{validationErrors:R,validate:L,getErrorMessages:y,clearErrors:I}=vi(),{parseRecurrenceRule:f}=Qr(),{uploadAttachment:v,removeAttachment:b,updateAttachmentName:A,validateFile:D}=Ii(),{saveEvent:S,deleteEventById:E,cloneEventForDate:T,buildEventPayload:h,saveSingleInstance:u,saveFutureInstances:$,saveAllInstances:M,deleteSingleInstance:U,deleteFutureInstances:K,deleteAllInstances:Y}=Li();let W=ce(!1),H=ce(!1),F=ce(!1),ee=ce("weekly"),ue=ce(1),he=ce([]),fe=ce(""),ve=ce(!0),Ee=ce("date"),Ae=ce([]),ke=ce(!1),Q=ce(!1),Z=ce(void 0),V=ce(void 0),re=ce(!1),se=ce(null),ne=ce(!1),ae=ce(null),ie=ce(0),me=ce({title:"",description:"",start_time:"",end_time:"",location:"",is_all_day:!1,event_type:"announcement"}),be=ce({message:"",type:"info"}),oe=ce(""),pe=ce(""),Re=ce(""),Pe=ce({dateInput:"",startTimeInput:"",endTimeInput:"",isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"}),xe=ce(!1);const Ye=(te,j)=>te.length===j.length&&te.every((we,Me)=>we===j[Me]);let De=ce([]),Ce=ce(!1),Ne=ce(!1);const He=`submitter-chat-form-${aa()}`;let ze=ce(null),Fe=null,We=null;$r(async()=>{typeof window<"u"&&(We=(await Yt(()=>import("./DO0djbQe.js").then(j=>j.o),__vite__mapDeps([0,1]),import.meta.url)).default)}),Xn(()=>{lt()});function mt(){if(!We)return;const te=document.getElementById(He);if(!te)return;We.getOrCreateInstance(te).show()}function st(te){const j=te??l()?.id??null;if(Fe||!j)return;const we=typeof window<"u"?localStorage.getItem("authToken"):null;we&&cr.realtime.setAuth(we),Fe=cr.channel(`submitter-comments-form-${j}`).on("postgres_changes",{event:"*",schema:"public",table:"event_submitter_comments",filter:`event_id=eq.${j}`},()=>{ot(j)}).subscribe()}function lt(){Fe&&(cr.removeChannel(Fe),Fe=null)}async function ot(te){const j=te??l()?.id??null;if(j){n(Ne)||O(Ce,!0);try{const we=await $n(j);j===(l()?.id??null)&&(O(De,we),O(Ne,!0))}catch(we){console.error("Failed to load submitter comments:",we)}finally{j===(l()?.id??null)&&O(Ce,!1)}}}async function Jt(te){if(!l()?.id||!s()?.id)return;const j=s().displayName||s().username||"Unknown";await Qn(l().id,s().id,j,te),await ot()}async function ct(te){await jn(te),await ot()}const Ge=()=>{const te=`[data-bs-target="#${d()}"]`,j=document.querySelector(te);j&&j.click()},Ue=(te,j=0,we="info")=>{or(be,n(be).message=te),or(be,n(be).type=we),j&&setTimeout(()=>{or(be,n(be).message="")},j)},Et=async te=>{const j=te.detail;if(!j)return;const we=D(j);if(!we.valid){Ue(we.error??"Invalid file selected",7e3,"danger");return}O(H,!0);try{const Me=await v(j,n(o)??"temp",tt=>Ue(tt));if(!Me.success||!Me.attachment)throw new Error(Me.error??"Upload failed");O(Ae,[...n(Ae),Me.attachment]),O(ke,!0),Ue("File uploaded!",3e3,"success")}catch(Me){console.error("File upload failed:",Me),Ue("Failed to upload file. Please try again.",7e3,"danger")}finally{O(H,!1)}},Bt=te=>{const{attachment:j,newName:we}=te.detail;O(Ae,A(n(Ae),j.id,we)),O(ke,!0),Ue("Attachment name updated!",3e3,"success")},ht=async te=>{const j=te.detail;if(j){O(H,!0);try{if(!await b(j))throw new Error("Failed to remove attachment");O(Ae,n(Ae).filter(Me=>Me.id!==j.id)),O(ke,!0),Ue("Attachment removed!",3e3,"success")}catch(we){console.error("Failed to remove attachment:",we),Ue("Failed to remove attachment. Please try again.",7e3,"danger")}finally{O(H,!1)}}},gt=async()=>{if(!n(o)){Ue("ID is not defined",0,"danger");return}try{await E(n(o)),await x(),_t("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{O(W,!1),O(me,{...l(),id:n(o)}),Ue("Event Deleted",3e3,"success"),Ge()},800)}catch(te){_t("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{O(W,!1),console.error("Delete failed:",te),Ue("Failed to delete event. Please try again.",7e3,"danger")},800)}},ln=()=>!!l().recurrence_rule,on=async()=>{const te=n(o)||l().meta_data?.recurring_parent_id;if(te&&n(Q)&&n(V)&&n(Z)){if(O(ae,null),O(ne,!0),await new Promise(j=>{const we=setInterval(()=>{n(ne)||(clearInterval(we),j())},50)}),!n(ae))return;O(W,!0);try{n(ae)==="single"?await U(te,n(Z)):n(ae)==="future"?await K(te,n(Z)):n(ae)==="all"&&await Y(te),await x(),_t("set_calendar_event_success","interaction","Delete Calendar Event Successful",1),setTimeout(()=>{O(W,!1),O(me,{...l(),id:n(o)}),Ue("Event Deleted",3e3,"success"),Ge()},800)}catch(j){_t("set_calendar_event_failed","interaction","Delete Calendar Event Failed",1),setTimeout(()=>{O(W,!1),console.error("Delete failed:",j),Ue("Failed to delete event. Please try again.",7e3,"danger")},800)}}else O(W,!0),Jn({title:"Delete Confirmation",message:ln()?"This recurring event and every occurrence, past and future, will be removed. You won't be able to undo this. Continue?":"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:j=>{j?gt():O(W,!1)}})},cn=te=>{if(n(o))try{const j=T({event:l(),newDate:te});_t("clone_calendar_event_form_loaded","interaction","Clone Calendar Event Form Loaded",1),Ue("Event cloned. Review and click Create to save.",5e3,"success"),l(j),O(oe,j.start_time?Le(new Date(j.start_time),"yyyy-MM-dd"):""),O(pe,j.start_time?Le(new Date(j.start_time),"HH:mm"):""),O(Re,j.end_time?Le(new Date(j.end_time),"HH:mm"):""),O(Ae,[]),O(F,!1),O(he,[]),O(fe,""),O(ve,!0),O(ke,!0),O(ie,void 0),O(me,{...j}),O(Pe,{dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Re),isRecurring:!1,recurrenceFrequency:"weekly",recurrenceInterval:1,recurringDays:[],recurrenceEndDate:"",hasEndDate:!0,monthlyType:"date"})}catch(j){console.error("Clone failed:",j),Ue("Failed to clone event. Please try again.",7e3,"danger")}},dn=()=>{ui({title:"Clone Event",message:"Select a date for the cloned event:",confirmButtonLabel:"Clone",confirmButtonCSS:"btn-primary",defaultDate:n(oe),callback:(te,j)=>{te&&j&&cn(j)}})},un=async()=>{if(n(o)&&!n(p)){Ue("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!await L({title:l().title,event_type:l().event_type,category:l().category??"",description:l().description,location:l().location,is_all_day:l().is_all_day,dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Re),isRecurring:n(F),recurrenceFrequency:n(ee),recurringDays:n(F)?n(he):[],recurrenceEndDate:n(F)?n(fe):void 0,hasEndDate:n(ve)})){const we=y();we.length&&Ue(we.join(". ")+".  Please address accordingly.",0,"danger");return}const j=n(o)||l().meta_data?.recurring_parent_id;if(j&&n(Q)&&n(V)&&n(Z)){if(O(se,null),O(re,!0),await new Promise(Me=>{const tt=setInterval(()=>{n(re)||(clearInterval(tt),Me())},100)}),!n(se)||n(W))return;Ue("Saving ..."),O(W,!0);const we=h({eventItem:l(),dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Re),attachments:n(Ae),isRecurring:n(_)&&n(F),recurrenceFrequency:n(ee),recurrenceInterval:n(ue),recurringDays:n(F)?n(he):[],recurrenceEndDate:n(F)?n(fe):"",hasEndDate:n(ve),monthlyType:n(Ee)});try{let Me;n(se)==="single"?await u(j,n(Z),we):n(se)==="future"?Me=await $(j,n(Z),we):n(se)==="all"&&await M(j,we),await x(),await On(),_t("set_calendar_event_success","interaction",`Set Calendar Event Successful ${l().title}`,1),O(W,!1),Me&&l({...l(),id:Me}),l(l().attachments=n(Ae),!0),O(me,{...l(),id:Me||j}),O(ke,!1),Ue("Saved",3e3,"success"),Ge()}catch(Me){_t("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${l().title}`,1),setTimeout(()=>{O(W,!1),console.error("Save failed:",Me),Ue("Failed to save event. Please try again.",7e3,"danger")},800)}}else{if(n(W))return;Ue("Saving ..."),O(W,!0);try{const we=await S({id:n(o),eventItem:l(),dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Re),attachments:n(Ae),isRecurring:n(_)&&n(F),recurrenceFrequency:n(ee),recurrenceInterval:n(ue),recurringDays:n(F)?n(he):[],recurrenceEndDate:n(F)?n(fe):"",hasEndDate:n(ve),monthlyType:n(Ee)});we.event&&l({...l(),...we.event}),l(l().attachments=n(Ae),!0),await x(),_t("set_calendar_event_success","interaction",`Set Calendar Event Successful ${l().title}`,1),setTimeout(()=>{O(W,!1),O(me,{...l(),id:n(o)}),O(ke,!1),Ue("Saved",3e3,"success"),Ge()},800)}catch(we){_t("set_calendar_event_failed","interaction",`Set Calendar Event Failed ${l().title}`,1),setTimeout(()=>{O(W,!1),console.error("Save failed:",we),Ue("Failed to save event. Please try again.",7e3,"danger")},800)}}};Se(()=>G(l()),()=>{O(o,l().id)}),Se(()=>G(l()),()=>{O(_,l().event_type==="calendar_event")}),Se(()=>(n(_),n(F),n(he),n(fe)),()=>{!n(_)&&(n(F)||n(he).length>0||n(fe))&&(O(F,!1),O(ee,"weekly"),O(ue,1),O(he,[]),O(fe,""),O(ve,!0),O(Ee,"date"))}),Se(()=>(G(l()),n(ie),n(me),n(ke),n(oe),n(pe),n(Re),n(F),n(ee),n(ue),n(he),n(fe),n(ve),n(Ee)),()=>{if(l()?.id!==n(ie)||l()?.start_time!==n(me).start_time||l()?.meta_data?.recurring_instance_index!==n(me).meta_data?.recurring_instance_index){O(W,!0);const te=n(ke),j=l();setTimeout(()=>{const we=j.event_type==="calendar_event";if(O(oe,we&&j.start_time?Le(new Date(j.start_time),"yyyy-MM-dd"):""),O(pe,we&&j.start_time?Le(new Date(j.start_time),"HH:mm"):""),O(Re,we&&j.end_time?Le(new Date(j.end_time),"HH:mm"):""),te||O(Ae,j.attachments?[...j.attachments]:[]),j.meta_data?.recurring_instance&&j.start_time?(O(V,j.recurrence_rule),O(Q,!0),O(Z,Le(new Date(j.start_time),"yyyy-MM-dd"))):(O(V,void 0),O(Q,!1),O(Z,void 0)),j.recurrence_rule){const Me=f(j.recurrence_rule,j.recurrence_end_date);Me?(O(F,!0),O(ee,Me.frequency),O(ue,Me.interval),O(he,Me.recurringDays),O(fe,Me.recurrenceEndDate),O(ve,Me.hasEndDate),O(Ee,Me.monthlyType)):(O(F,!1),O(ee,"weekly"),O(ue,1),O(he,[]),O(fe,""),O(ve,!0),O(Ee,"date"))}else O(F,!1),O(ee,"weekly"),O(ue,1),O(he,[]),O(fe,""),O(ve,!0),O(Ee,"date");O(ie,j.id),O(me,{...j}),O(W,!1),O(ke,!1),I(),O(Pe,{dateInput:n(oe),startTimeInput:n(pe),endTimeInput:n(Re),isRecurring:n(F),recurrenceFrequency:n(ee),recurrenceInterval:n(ue),recurringDays:[...n(he)],recurrenceEndDate:n(fe),hasEndDate:n(ve),monthlyType:n(Ee)})},200)}}),Se(()=>(n(me),G(l()),n(Ae),n(oe),n(Pe),n(pe),n(Re),n(F),n(ee),n(ue),n(he),n(fe),n(ve),n(Ee)),()=>{O(p,n(me).title!==l().title||n(me).start_time!==l().start_time||n(me).end_time!==l().end_time||n(me).description!==l().description||n(me).location!==l().location||n(me).is_public!==l().is_public||n(me).category!==l().category||n(me).is_all_day!==l().is_all_day||JSON.stringify(n(Ae))!==JSON.stringify(l().attachments||[])||n(me).recurrence_rule!==l().recurrence_rule||n(me).recurrence_end_date!==l().recurrence_end_date||n(oe)!==n(Pe).dateInput||n(pe)!==n(Pe).startTimeInput||n(Re)!==n(Pe).endTimeInput||n(F)!==n(Pe).isRecurring||n(ee)!==n(Pe).recurrenceFrequency||n(ue)!==n(Pe).recurrenceInterval||!Ye(n(he),n(Pe).recurringDays)||n(fe)!==n(Pe).recurrenceEndDate||n(ve)!==n(Pe).hasEndDate||n(Ee)!==n(Pe).monthlyType)}),Se(()=>(w(),qe),()=>{O(xe,w().has(qe.Bishopric))}),Se(()=>(G(l()),s()),()=>{O(i,!!l()?.id&&!!s()?.id&&l().meta_data?.submitted_by_user_id===s().id)}),Se(()=>(n(i),n(xe)),()=>{O(e,n(i)&&!n(xe))}),Se(()=>(n(e),G(l()),n(ze)),()=>{const te=n(e)?l()?.id??null:null;te&&te!==n(ze)?(O(ze,te),O(De,[]),O(Ne,!1),O(Ce,!1),lt(),ot(te),st(te)):!te&&n(ze)!==null&&(O(ze,null),O(De,[]),O(Ne,!1),O(Ce,!1),lt())}),It(),it();var br=Zi(),er=$e(br),wr=P(er);{var fn=te=>{var j=Hi();J(te,j)};de(wr,te=>{G(l()),n(o),X(()=>l().recurrence_rule&&n(o))&&te(fn)})}var tr=q(wr,2),rr=P(tr),vn=q(P(rr),2);{var mn=te=>{var j=Ni();ge(()=>j.disabled=n(W)||n(H)),Ie("click",j,dn),J(te,j)};de(vn,te=>{n(o)&&te(mn)})}z(rr);var hn=q(rr,2);{let te=dt(()=>n(W)||n(H));Ua(hn,{get disabled(){return n(te)},get name(){return a()},get validationErrors(){return t()},get title(){return l().title},set title(j){l(l().title=j,!0)},get eventType(){return l().event_type},set eventType(j){l(l().event_type=j,!0)},get category(){return l().category},set category(j){l(l().category=j,!0)},get isPublic(){return l().is_public},set isPublic(j){l(l().is_public=j,!0)},get description(){return l().description},set description(j){l(l().description=j,!0)},$$legacy:!0})}z(tr);var xr=q(tr,2);{var gn=te=>{var j=qi(),we=$e(j);{let tt=dt(()=>n(W)||n(H));Ha(we,{get disabled(){return n(tt)},get name(){return a()},get validationErrors(){return t()},get dateInput(){return n(oe)},set dateInput(Be){O(oe,Be)},get startTimeInput(){return n(pe)},set startTimeInput(Be){O(pe,Be)},get endTimeInput(){return n(Re)},set endTimeInput(Be){O(Re,Be)},get isAllDay(){return l().is_all_day},set isAllDay(Be){l(l().is_all_day=Be,!0)},$$legacy:!0})}var Me=q(we,2);{let tt=dt(()=>n(W)||n(H));Ka(Me,{get disabled(){return n(tt)},get name(){return a()},get validationErrors(){return t()},get isRecurring(){return n(F)},set isRecurring(Be){O(F,Be)},get recurrenceFrequency(){return n(ee)},set recurrenceFrequency(Be){O(ee,Be)},get recurrenceInterval(){return n(ue)},set recurrenceInterval(Be){O(ue,Be)},get recurringDays(){return n(he)},set recurringDays(Be){O(he,Be)},get recurrenceEndDate(){return n(fe)},set recurrenceEndDate(Be){O(fe,Be)},get monthlyType(){return n(Ee)},set monthlyType(Be){O(Ee,Be)},get dateInput(){return n(oe)},set dateInput(Be){O(oe,Be)},$$legacy:!0})}J(te,j)};de(xr,te=>{n(_)&&te(gn)})}var Er=q(xr,2);{let te=dt(()=>n(W)||n(H));ai(Er,{get attachments(){return n(Ae)},get uploadingFile(){return n(H)},get disabled(){return n(te)},$$events:{upload:Et,edit:Bt,remove:ht}})}var Ar=q(Er,2);{let te=dt(()=>n(W)||n(H)),j=dt(()=>`${a()}-location`);Ga(Ar,{get disabled(){return n(te)},get name(){return n(j)},get value(){return l().location},set value(we){l(l().location=we,!0)},$$legacy:!0})}var Dr=q(Ar,2);{var _n=te=>{var j=Yi(),we=q($e(j),2);{var Me=tt=>{var Be=Wi(),Rt=$e(Be),Qe=P(Rt),pt=q(P(Qe),4),Tn=P(pt);{var Mn=Ct=>{var Ft=$i(),Tr=P(Ft,!0);z(Ft),ge(()=>ye(Tr,(n(De),X(()=>n(De).length)))),J(Ct,Ft)};de(Tn,Ct=>{n(De),X(()=>n(De).length>0)&&Ct(Mn)})}Je(2),z(pt),z(Qe),z(Rt);var Rn=q(Rt,2);{let Ct=dt(()=>(G(l()),X(()=>l()?.title||"Event")));ia(Rn,{get id(){return He},subtitle:"Discussion with Bishopric",get title(){return n(Ct)},className:"submitter-chat-drawer-stacked",bodyClass:"overflow-hidden d-flex flex-column",children:(Ft,Tr)=>{{let Cn=dt(()=>(s(),X(()=>s()?.id??-1))),Fn=dt(()=>n(W)||n(H));Yn(Ft,{get comments(){return n(De)},get currentUserId(){return n(Cn)},onSend:Jt,onDelete:ct,get loading(){return n(Ce)},fullHeight:!0,get disabled(){return n(Fn)}})}},$$slots:{default:!0}})}ge(()=>Te(Qe,"aria-controls",He)),Ie("click",Qe,mt),J(tt,Be)};de(we,tt=>{n(e)&&tt(Me)})}J(te,j)};de(Dr,te=>{n(xe)||te(_n)})}var nr=q(Dr,2),ar=P(nr),pn=P(ar);{var yn=te=>{var j=ji();ge(()=>j.disabled=n(W)||n(H)),Ie("click",j,on),J(te,j)};de(pn,te=>{(n(o)||n(Q))&&k()&&te(yn)})}z(ar);var kr=q(ar,2),ir=P(kr),bn=q(ir,2);{var wn=te=>{var j=Gi(),we=P(j);{var Me=Qe=>{var pt=Qi();J(Qe,pt)},tt=Qe=>{var pt=Ki();J(Qe,pt)};de(we,Qe=>{n(o)||n(Q)?Qe(Me):Qe(tt,!1)})}var Be=q(we,2);{var Rt=Qe=>{var pt=Vi();J(Qe,pt)};de(Be,Qe=>{n(p)&&Qe(Rt)})}z(j),ge(()=>j.disabled=n(W)||n(H)),Ie("click",j,un),J(te,j)};de(bn,te=>{(n(o)||n(Q)||C())&&te(wn)})}z(kr),z(nr);var sr=q(nr,2),Lt=P(sr),xn=P(Lt,!0);z(Lt);var lr=q(Lt,2);let Ir;var En=P(lr);Wr(En,{size:"xs"}),z(lr),z(sr);var An=q(sr,2);{var Dn=te=>{{let j=dt(()=>n(W)||n(H));Wn(te,{get disabled(){return n(j)},get reloadEvents(){return x},get eventItem(){return l()},set eventItem(we){l(we)},$$legacy:!0})}};de(An,te=>{n(xe)&&te(Dn)})}z(er);var Sr=q(er,2);{var kn=te=>{si(te,{get eventTitle(){return G(l()),X(()=>l().title)},get occurrenceDate(){return n(Z)},callback:j=>{O(se,j),O(re,!1)}})};de(Sr,te=>{n(re)&&n(Z)&&te(kn)})}var In=q(Sr,2);{var Sn=te=>{oi(te,{get eventTitle(){return G(l()),X(()=>l().title)},get occurrenceDate(){return n(Z)},callback:j=>{O(ae,j),O(ne,!1)}})};de(In,te=>{n(ne)&&n(Z)&&te(Sn)})}ge(()=>{ir.disabled=n(W)||n(H),et(Lt,1,`fw-lighter fst-italic text-${n(be),X(()=>n(be).type)??""}`,"svelte-zsu5u8"),ye(xn,(n(be),X(()=>n(be).message))),Ir=et(lr,1,"",null,Ir,{"d-none":!n(W)})}),Ie("click",ir,Ge),J(g,br),nt(),c()}const Ur={RES:[qe.ReliefSociety],ELQ:[qe.EldersQuorum],YOU:[qe.YoungWomen,qe.YoungMen],YOW:[qe.YoungWomen],YWP:[qe.YoungWomen],YWR:[qe.YoungWomen],YWD:[qe.YoungWomen],YOM:[qe.YoungMen],YMD:[qe.YoungMen],YMT:[qe.YoungMen],YMP:[qe.YoungMen],PRI:[qe.Primary],PRN:[qe.Primary],PRS:[qe.Primary],PRC:[qe.Primary],PRV:[qe.Primary],SUS:[qe.SundaySchool]},Xi=g=>{const m=new Set,w=g.meta_data?.submitted_by_organizations;if(w?.length)return w.forEach(t=>m.add(t)),m;const s=g.meta_data?.category;return s&&Ur[s]&&Ur[s].forEach(t=>m.add(t)),m},Hs=(g,m)=>{if(!g)return!1;const{currentUserId:w,isPrivileged:s,canEditOwnOrgEvents:t,userOrganizations:r}=m;if(s)return!0;const c=g.meta_data?.submitted_by_user_id;if(w&&typeof c=="number"&&c===w)return!0;if(!t)return!1;const o=Xi(g);if(!o.size)return!1;for(const _ of o)if(r.has(_))return!0;return!1};var Ji=le('<span class="text-muted">•</span>'),es=le("<span> </span> <!>",1),ts=le('<span class="text-muted">•</span>'),rs=le('<em class="small fw-lighter svelte-1bpzga2"><!></em> <!>',1),ns=le('<em class="small fw-lighter text-decoration-underline svelte-1bpzga2"><!> details</em>'),as=le('<div class="small text-muted posted-meta svelte-1bpzga2">Posted <!> <!></div>'),is=le('<div class="small text-muted posted-meta svelte-1bpzga2">Last edited <!> <!></div>'),ss=le('<div class="small svelte-1bpzga2"><!> <!> <!></div>'),ls=le('<div class="attachment-image-container svelte-1bpzga2"><button type="button" class="attachment-image-button svelte-1bpzga2"><img class="attachment-image svelte-1bpzga2"/></button> <div class="attachment-image-label svelte-1bpzga2"><small class="text-muted"> </small></div></div>'),os=le('<button type="button" class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-2"><i class="bi bi-file-pdf"></i> <span class="text-truncate" style="max-width: 150px;"> </span> <small class="text-muted"> </small></button>'),cs=le('<div class="mt-1 svelte-1bpzga2"><div class="fw-semibold small mb-1 svelte-1bpzga2">Attachments:</div> <div class="d-flex flex-wrap gap-2"></div></div>'),ds=le('<div class="details-container svelte-1bpzga2"><!> <!></div>'),us=le('<div class="announcement-thumbnail-container svelte-1bpzga2"><img class="announcement-thumbnail svelte-1bpzga2"/></div>'),fs=le('<div role="button" tabindex="0" class="d-flex flex-column gap-1 svelte-1bpzga2"><div class="d-flex gap-1"><div class="d-flex flex-column flex-grow-1 gap-1 svelte-1bpzga2"><div class="fw-bold svelte-1bpzga2"><!></div> <div class="flex d-flex align-items-center flex-wrap gap-2"><!> <!> <!></div> <!></div> <!></div></div>');function Ns(g,m){rt(m,!1);const w=ce(),s=ce(),t=ce(),r=ce(),c=ce(),o=ce(),_=ce(),p=ce(),i=ce();let e=_e(m,"item",8),a=_e(m,"showDetails",12,!1),d=_e(m,"searchQuery",8,"");const l=U=>U<1024?U+" B":U<1024*1024?(U/1024).toFixed(1)+" KB":(U/(1024*1024)).toFixed(1)+" MB",k=U=>U.startsWith("image/"),C=U=>{window.open(U,"_blank")},x=U=>{if(!U)return"";try{return Le(Ut(U),"MMM d, yyyy 'at' h:mm a")}catch{return""}},N=()=>{n(s)&&a(!a())},B=U=>{n(s)&&(U.key==="Enter"||U.key===" ")&&N()};Se(()=>G(e()),()=>{O(w,e().attachments&&e().attachments.length>0?e().attachments.find(U=>k(U.type)):void 0)}),Se(()=>G(e()),()=>{O(s,!!(e().description||e().attachments&&e().attachments.length>0))}),Se(()=>G(e()),()=>{O(t,e().meta_data?.submitted_at??e().created_at)}),Se(()=>n(t),()=>{O(r,x(n(t)))}),Se(()=>G(e()),()=>{O(c,e().meta_data?.submitted_by_name)}),Se(()=>(n(r),n(c)),()=>{O(o,!!(n(r)||n(c)))}),Se(()=>G(e()),()=>{O(_,x(e().meta_data?.edited_at))}),Se(()=>G(e()),()=>{O(p,e().meta_data?.edited_by_name)}),Se(()=>(n(_),n(p)),()=>{O(i,!!(n(_)||n(p)))}),It(),it();var R=fs(),L=P(R),y=P(L),I=P(y),f=P(I);Tt(f,()=>(G(yt),G(e()),G(d()),X(()=>yt(e().title||"",d())))),z(I);var v=q(I,2),b=P(v);{var A=U=>{var K=es(),Y=$e(K),W=P(Y,!0);z(Y);var H=q(Y,2);{var F=ee=>{var ue=Ji();J(ee,ue)};de(H,ee=>{G(e()),X(()=>e().location||e().description||e().attachments&&e().attachments.length>0)&&ee(F)})}ge((ee,ue)=>{et(Y,1,`badge rounded-pill bg-color-${ee??""}`,"svelte-1bpzga2"),ye(W,ue)},[()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.color_number)),()=>(G(bt),G(e()),X(()=>bt(e()?.meta_data?.category)?.label))]),J(U,K)};de(b,U=>{G(e()),X(()=>e()?.meta_data?.category)&&U(A)})}var D=q(b,2);{var S=U=>{var K=rs(),Y=$e(K),W=P(Y);Tt(W,()=>(G(yt),G(e()),G(d()),X(()=>yt(e().location,d())))),z(Y);var H=q(Y,2);{var F=ee=>{var ue=ts();J(ee,ue)};de(H,ee=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&ee(F)})}J(U,K)};de(D,U=>{G(e()),X(()=>e().location)&&U(S)})}var E=q(D,2);{var T=U=>{var K=ns(),Y=P(K);{var W=F=>{var ee=Ze("Hide");J(F,ee)},H=F=>{var ee=Ze("Show");J(F,ee)};de(Y,F=>{a()?F(W):F(H,!1)})}Je(),z(K),J(U,K)};de(E,U=>{G(e()),X(()=>e().description||e().attachments&&e().attachments.length>0)&&U(T)})}z(v);var h=q(v,2);{var u=U=>{var K=ds(),Y=P(K);{var W=ee=>{var ue=ss(),he=P(ue);Tt(he,()=>(G($t),G(e()),G(d()),X(()=>$t(e().description,d()))));var fe=q(he,2);{var ve=ke=>{var Q=as(),Z=q(P(Q));{var V=ne=>{var ae=Ze();ge(()=>ye(ae,n(r))),J(ne,ae)};de(Z,ne=>{n(r)&&ne(V)})}var re=q(Z,2);{var se=ne=>{var ae=Ot(),ie=$e(ae);{var me=oe=>{var pe=Ze();ge(()=>ye(pe,`by ${n(c)??""}`)),J(oe,pe)},be=oe=>{var pe=Ze();ge(()=>ye(pe,`by ${n(c)??""}`)),J(oe,pe)};de(ie,oe=>{n(r)?oe(me):oe(be,!1)})}J(ne,ae)};de(re,ne=>{n(c)&&ne(se)})}z(Q),J(ke,Q)};de(fe,ke=>{n(o)&&ke(ve)})}var Ee=q(fe,2);{var Ae=ke=>{var Q=is(),Z=q(P(Q));{var V=ne=>{var ae=Ze();ge(()=>ye(ae,n(_))),J(ne,ae)};de(Z,ne=>{n(_)&&ne(V)})}var re=q(Z,2);{var se=ne=>{var ae=Ze();ge(()=>ye(ae,`by ${n(p)??""}`)),J(ne,ae)};de(re,ne=>{n(p)&&ne(se)})}z(Q),J(ke,Q)};de(Ee,ke=>{n(i)&&ke(Ae)})}z(ue),J(ee,ue)};de(Y,ee=>{G(e()),X(()=>e().description)&&ee(W)})}var H=q(Y,2);{var F=ee=>{var ue=cs(),he=q(P(ue),2);zt(he,5,()=>(G(e()),X(()=>e().attachments)),fe=>fe.id,(fe,ve)=>{var Ee=Ot(),Ae=$e(Ee);{var ke=Z=>{var V=ls(),re=P(V),se=P(re);z(re);var ne=q(re,2),ae=P(ne),ie=P(ae,!0);z(ae),z(ne),z(V),ge(()=>{Te(re,"title",`Open ${n(ve),X(()=>n(ve).name)??""}`),Te(se,"src",(n(ve),X(()=>n(ve).url))),Te(se,"alt",(n(ve),X(()=>n(ve).name))),ye(ie,(n(ve),X(()=>n(ve).name)))}),Ie("click",re,Wt(()=>C(n(ve).url))),J(Z,V)},Q=Z=>{var V=os(),re=q(P(V),2),se=P(re,!0);z(re);var ne=q(re,2),ae=P(ne);z(ne),z(V),ge(ie=>{Te(V,"title",`Open ${n(ve),X(()=>n(ve).name)??""}`),ye(se,(n(ve),X(()=>n(ve).name))),ye(ae,`(${ie??""})`)},[()=>(n(ve),X(()=>l(n(ve).size)))]),Ie("click",V,Wt(()=>C(n(ve).url))),J(Z,V)};de(Ae,Z=>{n(ve),X(()=>k(n(ve).type))?Z(ke):Z(Q,!1)})}J(fe,Ee)}),z(he),z(ue),J(ee,ue)};de(H,ee=>{G(e()),X(()=>e().attachments&&e().attachments.length>0)&&ee(F)})}z(K),J(U,K)};de(h,U=>{a()&&U(u)})}z(y);var $=q(y,2);{var M=U=>{var K=us(),Y=P(K);z(K),ge(()=>{Te(Y,"src",(n(w),X(()=>n(w).url))),Te(Y,"alt",(n(w),X(()=>n(w).name)))}),J(U,K)};de($,U=>{n(w)&&U(M)})}z(L),z(R),ge(()=>Hr(R,n(s)?"cursor: pointer;":"")),Ie("keydown",R,B),Ie("click",R,N),J(g,R),nt()}export{Ls as A,Ps as E,Bs as a,Ns as b,Hs as c};
