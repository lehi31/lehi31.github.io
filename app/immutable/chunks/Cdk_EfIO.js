import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{p as ue,D as w,E as P,aj as H,g as e,ak as xe,c as a,r as t,s as d,t as se,a as me,f as V,F as he,w as M,u as O,am as Ce,an as Se}from"./JKZwkikK.js";import{f as T,a as m,c as te,t as tt}from"./JDsN5plM.js";import{i as gt,W as ut,a as mt,b as ft,S as pt}from"./DvcOMb_B.js";import{w as Be,g as lt,d as de,o as Ge}from"./DjNGvcU6.js";import{p as re,i as z,b as oe,e as We,a as Ee,s as A}from"./CvNikv6W.js";import{i as fe}from"./b8c_lO2i.js";import{v as at,D as rt}from"./D32NyDqB.js";import{e as ye,i as _e}from"./B2BlSr7K.js";import{s as ve,r as st,d as He}from"./B9M1IJDb.js";import{b as bt,a as ht}from"./BL6gm64P.js";import{t as yt,e as Ie,v as _t,b as Ue,f as ne,w as wt,g as xt}from"./DoOjFZYh.js";import{b as kt}from"./C_E5hxn_.js";import{e as St,p as ge}from"./B-9ZCcI7.js";import{S as Bt}from"./BcNgTtQ8.js";import{A as Et,E as $t}from"./CQDqYa4m.js";function Rt(l){return St(l,{weekStartsOn:1})}function Mt(l){return yt(l).getFullYear()}const ot=Be([]),nt=Be([]);let Ae=!1,Fe=!1;async function Ot(){if(Ae)return lt(ot);Ae=!0;try{const{data:l,error:r}=await Ie.from("bom_reading_schedule").select("*").order("day_number",{ascending:!0});if(r)throw console.error("[API] Get BOM reading schedule failed:",r),new Error(`Failed to load reading schedule: ${r.message}`);const s=l||[];return ot.set(s),setTimeout(()=>Ae=!1,800),s}catch(l){throw Ae=!1,console.error("[API] Unexpected error fetching BOM reading schedule:",l),l}}async function Ne(){if(Fe)return lt(nt);Fe=!0;try{const{data:l,error:r}=await Ie.from("bom_reading_entries").select("*").order("created_at",{ascending:!1});if(r)throw console.error("[API] Get BOM reading entries failed:",r),new Error(`Failed to load reading entries: ${r.message}`);const s=l||[];return nt.set(s),setTimeout(()=>Fe=!1,800),s}catch(l){throw Fe=!1,console.error("[API] Unexpected error fetching BOM reading entries:",l),l}}async function Ct(l){try{const{data:r,error:s}=await Ie.from("bom_reading_entries").insert([l]).select();if(s)throw console.error("[API] Create BOM reading entry failed:",s),s.message.includes("JWT")?new Error("Authentication error - please try reloading the page"):s.code==="42501"?new Error("Permission denied - please check your authentication"):s.code==="23505"?new Error("This entry already exists"):s.code==="23503"?new Error("Invalid chapter reference"):s.message.includes("fetch")||s.message.includes("Failed to fetch")?new Error("Network error - please check your connection and try again"):new Error(`Failed to save entry: ${s.message}`);return await Ne(),console.log("[API] BOM reading entry created successfully"),r?r[0]:void 0}catch(r){throw console.error("[API] Unexpected error creating BOM reading entry:",r),r}}async function Dt(l,r){try{const{data:s,error:f}=await Ie.from("bom_reading_entries").update(r).eq("id",l).select();if(f)throw console.error("[API] Update BOM reading entry failed:",f),new Error(`Failed to update entry: ${f.message}`);return await Ne(),console.log("[API] BOM reading entry updated successfully"),s?s[0]:void 0}catch(s){throw console.error("[API] Unexpected error updating BOM reading entry:",s),s}}async function It(l){try{const{error:r}=await Ie.from("bom_reading_entries").delete().eq("id",l);if(r)throw console.error("[API] Delete BOM reading entry failed:",r),new Error(`Failed to delete entry: ${r.message}`);await Ne(),console.log("[API] BOM reading entry deleted successfully")}catch(r){throw console.error("[API] Unexpected error deleting BOM reading entry:",r),r}}function jt(l){const r=new Map;return l.forEach(s=>{const f=r.get(s.chapter_ref)||0;r.set(s.chapter_ref,f+1)}),r}let De=null;const Tt=()=>{const l=Be(!1),r=Be(!1),s=Be([]),f=Be([]),y=de(f,c=>jt(c)),v=de(s,c=>{const o=new Date().toISOString().split("T")[0];return c.find(_=>_.date===o)||null}),u=de([s,y],([c,o])=>{const _=new Date().toISOString().split("T")[0];return c.map(i=>({chapter_ref:i.chapter_ref,day_number:i.day_number,date:i.date,book_name:i.book_name,chapter_number:i.chapter_number,read_count:o.get(i.chapter_ref)||0,is_today:i.date===_,is_past:i.date<_,is_future:i.date>_}))}),b=de(s,c=>c.length),S=de(y,c=>{let o=0;return c.forEach(_=>{_>0&&o++}),o}),j=de([b,S],([c,o])=>c>0?Math.round(o/c*100):0),x=de(f,c=>{const o={};c.forEach(i=>{o[i.date]||(o[i.date]=[]),o[i.date].push(i)}),Object.keys(o).forEach(i=>{o[i].sort((n,g)=>new Date(g.created_at??"").getTime()-new Date(n.created_at??"").getTime())});const _=Object.entries(o).sort(([i],[n])=>new Date(n).getTime()-new Date(i).getTime());return Object.fromEntries(_)}),p=de(f,c=>{const o={};c.forEach(i=>{const n=new Date(i.date),g=Mt(n),k=_t(n),U=`${g}-W${k.toString().padStart(2,"0")}`;o[U]||(o[U]=[]),o[U].push(i)}),Object.keys(o).forEach(i=>{o[i].sort((n,g)=>new Date(g.created_at??"").getTime()-new Date(n.created_at??"").getTime())});const _=Object.entries(o).sort(([i],[n])=>n.localeCompare(i));return Object.fromEntries(_)}),h=de(f,c=>{const o={};c.forEach(i=>{const n=i.date.substring(0,7);o[n]||(o[n]=[]),o[n].push(i)}),Object.keys(o).forEach(i=>{o[i].sort((n,g)=>new Date(g.created_at??"").getTime()-new Date(n.created_at??"").getTime())});const _=Object.entries(o).sort(([i],[n])=>n.localeCompare(i));return Object.fromEntries(_)}),B=de(x,c=>{const o={};return Object.entries(c).forEach(([_,i])=>{const n=new Set(i.map(g=>g.chapter_ref));o[_]={period:_,totalReadings:i.length,uniqueChapters:n.size,chapterRefs:n}}),o}),W=de(p,c=>{const o={};return Object.entries(c).forEach(([_,i])=>{const n=new Set(i.map(g=>g.chapter_ref));o[_]={period:_,totalReadings:i.length,uniqueChapters:n.size,chapterRefs:n}}),o}),q=de(h,c=>{const o={};return Object.entries(c).forEach(([_,i])=>{const n=new Set(i.map(g=>g.chapter_ref));o[_]={period:_,totalReadings:i.length,uniqueChapters:n.size,chapterRefs:n}}),o}),C=async()=>{r.set(!0);try{const[c,o]=await Promise.all([Ot(),Ne()]);s.set(c),f.set(o),l.set(!0)}catch(c){console.error("[State] Failed to reload BOM reading data:",c),l.set(!0)}finally{r.set(!1)}};return De={stores:{ready:l,loading:r,schedule:s,entries:f,progressByChapter:y,todaysReading:v,chapterProgress:u,totalChapters:b,chaptersReadByAnyone:S,overallProgress:j,groupedByDate:x,groupedByWeek:p,groupedByMonth:h,aggregatedByDate:B,aggregatedByWeek:W,aggregatedByMonth:q},actions:{reload:C,apiCreate:async c=>{const o=await Ct(c);return await C(),o},apiUpdate:async(c,o)=>{await Dt(c,o),await C()},apiDelete:async c=>{await It(c),await C()}}},De},je=()=>De?.stores&&Object.keys(De.stores).length>0?De:Tt(),Ke="bom_reading_submissions",ze="bom_reading_entry_ids";function Ve(){if(typeof localStorage>"u")return new Set;try{const l=localStorage.getItem(Ke);if(!l)return new Set;const r=JSON.parse(l);return new Set(Array.isArray(r)?r:[])}catch(l){return console.error("[ReadingTracker] Error reading from localStorage:",l),new Set}}function Pt(l){return Ve().has(l)}function At(l){if(typeof localStorage>"u"){console.warn("[ReadingTracker] localStorage not available");return}try{const r=Ve();r.add(l),localStorage.setItem(Ke,JSON.stringify([...r]))}catch(r){console.error("[ReadingTracker] Error writing to localStorage:",r)}}function Qe(){if(typeof localStorage>"u")return{};try{const l=localStorage.getItem(ze);if(!l)return{};const r=JSON.parse(l);return typeof r=="object"&&r!==null?r:{}}catch(l){return console.error("[ReadingTracker] Error reading entry IDs from localStorage:",l),{}}}function Ft(l){return Qe()[l]??null}function Ut(l,r){if(typeof localStorage>"u"){console.warn("[ReadingTracker] localStorage not available");return}try{const s=Qe();s[l]=r,localStorage.setItem(ze,JSON.stringify(s))}catch(s){console.error("[ReadingTracker] Error storing entry ID:",s)}}function Wt(l){if(typeof localStorage>"u"){console.warn("[ReadingTracker] localStorage not available");return}try{const r=Ve();r.delete(l),localStorage.setItem(Ke,JSON.stringify([...r]));const s=Qe();delete s[l],localStorage.setItem(ze,JSON.stringify(s))}catch(r){console.error("[ReadingTracker] Error writing to localStorage:",r)}}var Nt=T('<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>'),qt=T('<i class="bi bi-check-circle-fill me-1"></i> Undo',1),Jt=T('<i class="bi bi-check-circle me-1"></i> Read',1),Yt=T('<div class="alert alert-danger alert-sm mt-2 mb-0 svelte-18cjesl" role="alert"><i class="bi bi-exclamation-triangle-fill me-1"></i> </div>'),Lt=T('<div class="bom-reading-entry-form svelte-18cjesl"><div class="d-flex align-items-center gap-2 gap-md-3"><button type="button"><!></button></div> <!></div>');function Gt(l,r){ue(r,!1);const s=()=>oe(b,"$loading",f),[f,y]=Ee();let v=re(r,"chapterRef",8),u=re(r,"onSuccess",8,void 0);const{stores:{loading:b},actions:{apiCreate:S,apiDelete:j}}=je();let x=P(!1),p=P(""),h=P(!1),B=P(null);Ge(()=>{w(h,Pt(v()))});async function W(){if(e(h)){w(p,"You have already marked this chapter as read");return}try{w(x,!0),w(p,"");const n={date:new Date().toISOString().split("T")[0],chapter_ref:v()},g=await S(n);g&&g.id&&(At(v()),Ut(v(),g.id),w(h,!0),u()&&u()())}catch(n){w(p,n instanceof Error?n.message:"Failed to save reading"),console.error("[BomReadingEntryForm] Error:",n)}finally{w(x,!1)}}async function q(){const n=Ft(v());if(!n){w(p,"Cannot undo - entry ID not found");return}try{w(x,!0),w(p,""),await j(n),Wt(v()),w(h,!1),u()&&u()()}catch(g){w(p,g instanceof Error?g.message:"Failed to undo"),console.error("[BomReadingEntryForm] Undo error:",g)}finally{w(x,!1)}}H(()=>(e(p),e(B)),()=>{e(p)&&(e(B)&&clearTimeout(e(B)),w(B,setTimeout(()=>{w(p,""),w(B,null)},1e3)))}),xe(),fe();var C=Lt(),N=a(C),E=a(N),F=a(E);{var c=n=>{var g=Nt();m(n,g)},o=n=>{var g=te(),k=V(g);{var U=J=>{var D=qt();he(),m(J,D)},Y=J=>{var D=Jt();he(),m(J,D)};z(k,J=>{e(h)?J(U):J(Y,!1)},!0)}m(n,g)};z(F,n=>{e(x)?n(c):n(o,!1)})}t(E),t(N);var _=d(N,2);{var i=n=>{var g=Yt(),k=d(a(g));t(g),se(()=>A(k,` ${e(p)??""}`)),m(n,g)};z(_,n=>{e(p)&&n(i)})}t(C),se(()=>{Ue(E,1,`btn btn-sm ${e(h)?"btn-outline-danger":"btn-primary"}`,"svelte-18cjesl"),E.disabled=e(x)||s(),ve(E,"title",e(h)?"Undo marking this chapter as read":"Mark this chapter as read")}),We("click",E,function(...n){(e(h)?q:W)?.apply(this,n)}),m(l,C),me(),y()}var Ht=T('<span class="badge bg-info text-dark svelte-x251hv"><i class="bi bi-calendar-day"></i> Today</span>'),Kt=T('<i class="bi bi-check-circle"></i> ',1),zt=T('<i class="bi bi-circle"></i> 0',1),Vt=T('<div><div class="card-body p-2"><div class="d-flex align-items-baseline gap-2 flex-wrap mb-2"><small class="text-muted"> </small> <span> </span> <!></div> <div class="d-flex align-items-center justify-content-between gap-2"><small class="text-muted"> </small> <div class="d-flex align-items-center gap-2 flex-shrink-0"><span><!></span> <!></div></div></div></div>');function it(l,r){ue(r,!1);const s=P(),f=P(),y=P();let v=re(r,"progress",8);const u=!1;H(()=>M(v()),()=>{w(s,ne(ge(v().date,"yyyy-MM-dd",new Date),"MMM d, yyyy (EEE)"))}),H(()=>M(v()),()=>{w(f,v().is_today?"border-primary border-2":v().is_past?"past-reading":"")}),H(()=>M(v()),()=>{w(y,v().read_count>0?"bg-success":"bg-secondary")}),xe();var b={compact:u};fe();var S=Vt(),j=a(S),x=a(j),p=a(x),h=a(p);t(p);var B=d(p,2),W=a(B,!0);t(B);var q=d(B,2);{var C=k=>{var U=Ht();m(k,U)};z(q,k=>{M(v()),O(()=>v().is_today)&&k(C)})}t(x);var N=d(x,2),E=a(N),F=a(E,!0);t(E);var c=d(E,2),o=a(c),_=a(o);{var i=k=>{var U=Kt(),Y=d(V(U));se(()=>A(Y,` ${M(v()),O(()=>v().read_count)??""}`)),m(k,U)},n=k=>{var U=zt();he(),m(k,U)};z(_,k=>{M(v()),O(()=>v().read_count>0)?k(i):k(n,!1)})}t(o);var g=d(o,2);return Gt(g,{get chapterRef(){return M(v()),O(()=>v().chapter_ref)}}),t(c),t(N),t(j),t(S),se(()=>{Ue(S,1,`card bom-day-card ${e(f)??""} mb-2`,"svelte-x251hv"),A(h,`Day ${M(v()),O(()=>v().day_number)??""}`),Ue(B,1,`fw-semibold ${M(v()),O(()=>v().is_today?"text-primary":"")??""}`,"svelte-x251hv"),A(W,(M(v()),O(()=>v().chapter_ref))),A(F,e(s)),Ue(o,1,`badge ${e(y)??""}`,"svelte-x251hv")}),m(l,S),kt(r,"compact",u),me(b)}var Qt=T('<div class="alert alert-warning" role="alert"><i class="bi bi-exclamation-triangle me-2"></i> No readings found for the selected filter.</div>'),Xt=T('<div class="book-group mb-4 svelte-nbte28"><h4 class="border-bottom pb-2 mb-3 svelte-nbte28"><i class="bi bi-book me-2"></i> <span class="badge bg-secondary ms-2"> </span></h4> <!></div>'),Zt=T("<div><!></div>"),ea=T('<div class="text-center mt-4"><button class="btn btn-outline-primary"><!></button></div>'),ta=T('<div class="text-center mt-2"><p class="text-muted mb-0"><i class="bi bi-info-circle me-1"></i> </p></div>'),aa=T('<div class="bom-reading-schedule svelte-nbte28"><div class="card mb-3"><div class="card-body"><div class="d-flex flex-column gap-3"><div><label for="search" class="form-label fw-bold">Search</label> <div class="input-group"><span class="input-group-text"><i class="bi bi-search"></i></span> <input type="text" class="form-control" id="search" placeholder="Search chapters or books..."/></div></div> <div><div class="form-check"><input class="form-check-input" type="checkbox" id="groupByBook"/> <label class="form-check-label" for="groupByBook">Group by Book</label></div></div></div></div></div> <div class="reading-list svelte-nbte28"><!></div> <!> <!></div>');function ra(l,r){ue(r,!1);const s=()=>oe(S,"$chapterProgress",y),f=()=>oe(j,"$todaysReading",y),[y,v]=Ee(),u=P(),b=P(),{stores:{chapterProgress:S,todaysReading:j}}=je();let x=P(""),p=P(!1),h=P(!1);function B($,R,I){let L=$;if(I||(L=L.filter(Z=>!Z.is_future)),R){const Z=R.toLowerCase();L=L.filter(Q=>Q.chapter_ref.toLowerCase().includes(Z)||Q.book_name.toLowerCase().includes(Z))}return L}function W($){const R={};return $.forEach(I=>{R[I.book_name]||(R[I.book_name]=[]),R[I.book_name].push(I)}),R}Ge(()=>{f()&&setTimeout(()=>{const $=document.getElementById("today-reading");$&&$.scrollIntoView({behavior:"smooth",block:"center"})},500)}),H(()=>(s(),e(x),e(h)),()=>{w(u,B(s(),e(x),e(h)))}),H(()=>(e(p),e(u)),()=>{w(b,e(p)?W(e(u)):null)}),xe(),fe();var q=aa(),C=a(q),N=a(C),E=a(N),F=a(E),c=d(a(F),2),o=d(a(c),2);st(o),t(c),t(F);var _=d(F,2),i=a(_),n=a(i);st(n),he(2),t(i),t(_),t(E),t(N),t(C);var g=d(C,2),k=a(g);{var U=$=>{var R=Qt();m($,R)},Y=$=>{var R=te(),I=V(R);{var L=Q=>{var G=te(),ee=V(G);ye(ee,1,()=>(e(b),O(()=>Object.entries(e(b)))),_e,(ce,ie)=>{var le=Ce(()=>Se(e(ie),2));let pe=()=>e(le)[0],we=()=>e(le)[1];var be=Xt(),ke=a(be),$e=d(a(ke)),Re=d($e),qe=a(Re);t(Re),t(ke);var Te=d(ke,2);ye(Te,1,we,_e,(Me,Oe)=>{it(Me,{get progress(){return e(Oe)},compact:!0})}),t(be),se(()=>{A($e,` ${pe()??""} `),A(qe,`${we(),O(()=>we().length)??""} days`)}),m(ce,be)}),m(Q,G)},Z=Q=>{var G=te(),ee=V(G);ye(ee,1,()=>e(u),_e,(ce,ie)=>{var le=Zt(),pe=a(le);it(pe,{get progress(){return e(ie)}}),t(le),se(()=>ve(le,"id",(e(ie),O(()=>e(ie).is_today?"today-reading":void 0)))),m(ce,le)}),m(Q,G)};z(I,Q=>{e(b)?Q(L):Q(Z,!1)},!0)}m($,R)};z(k,$=>{e(u),O(()=>e(u).length===0)?$(U):$(Y,!1)})}t(g);var J=d(g,2);{var D=$=>{var R=ea(),I=a(R),L=a(I);{var Z=G=>{var ee=tt("Hide Future Chapters");m(G,ee)},Q=G=>{var ee=tt("Show Future Chapters");m(G,ee)};z(L,G=>{e(h)?G(Z):G(Q,!1)})}t(I),t(R),We("click",I,()=>w(h,!e(h))),m($,R)};z(J,$=>{e(x)||$(D)})}var K=d(J,2);{var X=$=>{var R=ta(),I=a(R),L=d(a(I));t(I),t(R),se(()=>A(L,` Showing ${e(u),O(()=>e(u).length)??""} reading days`)),m($,R)};z(K,$=>{e(u),O(()=>e(u).length>20)&&$(X)})}t(q),bt(o,()=>e(x),$=>w(x,$)),ht(n,()=>e(p),$=>w(p,$)),m(l,q),me(),v()}var sa=T('<span class="badge bg-primary ms-1"> </span>'),oa=T('<span class="badge bg-secondary me-1 mb-1"> <!></span>'),na=T('<li class="list-group-item"><div class="small"><strong>Chapters read:</strong> <div class="mt-1"></div></div></li>'),ia=T('<div class="mb-3"><div class="card"><div class="card-header"><small class="text-muted"> </small><br/> <strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center mb-2"><span class="text-muted">Reading Submissions:</span> <strong> </strong></div> <div class="d-flex justify-content-between align-items-center"><span class="text-muted">Unique Chapters:</span> <strong> </strong></div></li> <!></ul></div></div>');function la(l,r){ue(r,!1);const s=P(),f=P();let y=re(r,"entries",8),v=re(r,"date",8);H(()=>M(y()),()=>{w(s,y().reduce((i,n)=>(i[n.chapter_ref]=(i[n.chapter_ref]||0)+1,i),{}))}),H(()=>e(s),()=>{w(f,Object.keys(e(s)).sort())}),xe(),fe();var u=ia(),b=a(u),S=a(b),j=a(S),x=a(j,!0);t(j);var p=d(j,3),h=a(p,!0);t(p),t(S);var B=d(S,2),W=a(B),q=a(W),C=d(a(q),2),N=a(C,!0);t(C),t(q);var E=d(q,2),F=d(a(E),2),c=a(F,!0);t(F),t(E),t(W);var o=d(W,2);{var _=i=>{var n=na(),g=a(n),k=d(a(g),2);ye(k,5,()=>e(f),_e,(U,Y)=>{var J=oa(),D=a(J),K=d(D);{var X=$=>{var R=sa(),I=a(R,!0);t(R),se(()=>A(I,(e(s),e(Y),O(()=>e(s)[e(Y)])))),m($,R)};z(K,$=>{e(s),e(Y),O(()=>e(s)[e(Y)]>1)&&$(X)})}t(J),se(()=>A(D,`${e(Y)??""} `)),m(U,J)}),t(k),t(g),t(n),m(i,n)};z(o,i=>{e(f),O(()=>e(f).length>0)&&i(_)})}t(B),t(b),t(u),se((i,n)=>{A(x,i),A(h,n),A(N,(M(y()),O(()=>y().length))),A(c,(e(f),O(()=>e(f).length)))},[()=>(M(ne),M(ge),M(v()),O(()=>ne(ge(v(),"yyyy-MM-dd",new Date),"yyyy"))),()=>(M(ne),M(ge),M(v()),O(()=>ne(ge(v(),"yyyy-MM-dd",new Date),"MMM dd, EEEE")))]),m(l,u),me()}var da=T('<div class="mb-3"><div class="card"><div class="card-header"><small class="text-muted"> </small><br/> <strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Reading Submissions:</span> <strong class="fs-5"> </strong></div></li> <li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Unique Chapters:</span> <strong class="fs-5"> </strong></div></li></ul></div></div>');function ca(l,r){ue(r,!1);let s=re(r,"date",8),f=re(r,"aggregate",8);fe();var y=da(),v=a(y),u=a(v),b=a(u),S=a(b,!0);t(b);var j=d(b,3),x=a(j,!0);t(j),t(u);var p=d(u,2),h=a(p),B=a(h),W=d(a(B),2),q=a(W,!0);t(W),t(B),t(h);var C=d(h,2),N=a(C),E=d(a(N),2),F=a(E,!0);t(E),t(N),t(C),t(p),t(v),t(y),se((c,o)=>{A(S,c),A(x,o),A(q,(M(f()),O(()=>f().totalReadings))),A(F,(M(f()),O(()=>f().uniqueChapters)))},[()=>(M(ne),M(ge),M(s()),O(()=>ne(ge(s(),"yyyy-MM-dd",new Date),"yyyy"))),()=>(M(ne),M(ge),M(s()),O(()=>ne(ge(s(),"yyyy-MM-dd",new Date),"MMM dd, EEEE")))]),m(l,y),me()}var va=T('<div class="mb-3"><div class="card"><div class="card-header"><small class="text-muted"> </small><br/> <strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Reading Submissions:</span> <strong class="fs-5"> </strong></div></li> <li class="list-group-item"><div class="d-flex justify-content-between align-items-center mb-2"><span class="text-muted">Unique Chapters:</span> <strong class="fs-5"> </strong></div> <div class="progress" style="height: 8px;"><div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div> <small class="text-muted"> </small></li></ul></div></div>');function ga(l,r){ue(r,!1);const s=P(),f=P(),y=P(),v=P(),u=P(),b=P(),S=P(),j=P(),x=P(),p=P();let h=re(r,"week",8),B=re(r,"aggregate",8);H(()=>(e(s),e(f),M(h())),()=>{(R=>{var I=Se(R,2);w(s,I[0]),w(f,I[1])})(h().split("-W"))}),H(()=>e(f),()=>{w(y,parseInt(e(f),10))}),H(()=>e(s),()=>{w(v,parseInt(e(s),10))}),H(()=>e(v),()=>{w(u,new Date(e(v),0,1))}),H(()=>(e(u),e(y)),()=>{w(b,wt(new Date(e(u).getTime()+(e(y)-1)*7*24*60*60*1e3)))}),H(()=>e(b),()=>{w(S,Rt(e(b)))}),H(()=>(e(y),e(v)),()=>{w(j,`Week ${e(y)} of ${e(v)}`)}),H(()=>(e(b),e(S)),()=>{w(x,`${ne(e(b),"MMM d")} - ${ne(e(S),"MMM d, yyyy")}`)}),H(()=>M(B()),()=>{w(p,Math.round(B().uniqueChapters/244*100))}),xe(),fe();var W=va(),q=a(W),C=a(q),N=a(C),E=a(N,!0);t(N);var F=d(N,3),c=a(F,!0);t(F),t(C);var o=d(C,2),_=a(o),i=a(_),n=d(a(i),2),g=a(n,!0);t(n),t(i),t(_);var k=d(_,2),U=a(k),Y=d(a(U),2),J=a(Y,!0);t(Y),t(U);var D=d(U,2),K=a(D);t(D);var X=d(D,2),$=a(X);t(X),t(k),t(o),t(q),t(W),se(()=>{A(E,e(j)),A(c,e(x)),A(g,(M(B()),O(()=>B().totalReadings))),A(J,(M(B()),O(()=>B().uniqueChapters))),He(K,`width: ${e(p)??""}%`),ve(K,"aria-valuenow",e(p)),A($,`${e(p)??""}% of all BOM chapters`)}),m(l,W),me()}var ua=T('<div class="mb-3"><div class="card"><div class="card-header"><strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Reading Submissions:</span> <strong class="fs-5"> </strong></div></li> <li class="list-group-item"><div class="d-flex justify-content-between align-items-center mb-2"><span class="text-muted">Unique Chapters:</span> <strong class="fs-5"> </strong></div> <div class="progress" style="height: 8px;"><div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div> <small class="text-muted"> </small></li></ul></div></div>');function ma(l,r){ue(r,!1);const s=P();let f=re(r,"month",8),y=re(r,"aggregate",8);H(()=>M(y()),()=>{w(s,Math.round(y().uniqueChapters/244*100))}),xe(),fe();var v=ua(),u=a(v),b=a(u),S=a(b),j=a(S,!0);t(S),t(b);var x=d(b,2),p=a(x),h=a(p),B=d(a(h),2),W=a(B,!0);t(B),t(h),t(p);var q=d(p,2),C=a(q),N=d(a(C),2),E=a(N,!0);t(N),t(C);var F=d(C,2),c=a(F);t(F);var o=d(F,2),_=a(o);t(o),t(q),t(x),t(u),t(v),se(i=>{A(j,i),A(W,(M(y()),O(()=>y().totalReadings))),A(E,(M(y()),O(()=>y().uniqueChapters))),He(c,`width: ${e(s)??""}%`),ve(c,"aria-valuenow",e(s)),A(_,`${e(s)??""}% of all BOM chapters`)},[()=>(M(ne),M(ge),M(f()),O(()=>ne(ge(f(),"yyyy-MM",new Date),"MMMM yyyy")))]),m(l,v),me()}var fa=T('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),pa=T('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),ba=T('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),ha=T('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),ya=T('<div class="bom-submissions"><div class="mb-3"><!></div> <div class="submissions-list svelte-1qt8gnu"><!></div></div>');function _a(l,r){ue(r,!1);const s=()=>oe(S,"$groupedByDate",u),f=()=>oe(j,"$aggregatedByDate",u),y=()=>oe(x,"$aggregatedByWeek",u),v=()=>oe(p,"$aggregatedByMonth",u),[u,b]=Ee(),{stores:{groupedByDate:S,aggregatedByDate:j,aggregatedByWeek:x,aggregatedByMonth:p}}=je();let h=P("by-day");fe();var B=ya(),W=a(B),q=a(W);Bt(q,{options:[{key:"By Submission",value:"by-submission"},{key:"By Day",value:"by-day"},{key:"By Week",value:"by-week"},{key:"By Month",value:"by-month"}],label:"View",disabled:!1,get value(){return e(h)},set value(c){w(h,c)},$$legacy:!0}),t(W);var C=d(W,2),N=a(C);{var E=c=>{var o=te(),_=V(o);{var i=g=>{var k=fa();m(g,k)},n=g=>{var k=te(),U=V(k);ye(U,1,()=>Object.entries(s()),_e,(Y,J)=>{var D=Ce(()=>Se(e(J),2));let K=()=>e(D)[0],X=()=>e(D)[1];la(Y,{get date(){return K()},get entries(){return X()}})}),m(g,k)};z(_,g=>{Object.keys(s()).length===0?g(i):g(n,!1)})}m(c,o)},F=c=>{var o=te(),_=V(o);{var i=g=>{var k=te(),U=V(k);{var Y=D=>{var K=pa();m(D,K)},J=D=>{var K=te(),X=V(K);ye(X,1,()=>Object.entries(f()),_e,($,R)=>{var I=Ce(()=>Se(e(R),2));let L=()=>e(I)[0],Z=()=>e(I)[1];ca($,{get date(){return L()},get aggregate(){return Z()}})}),m(D,K)};z(U,D=>{Object.keys(f()).length===0?D(Y):D(J,!1)})}m(g,k)},n=g=>{var k=te(),U=V(k);{var Y=D=>{var K=te(),X=V(K);{var $=I=>{var L=ba();m(I,L)},R=I=>{var L=te(),Z=V(L);ye(Z,1,()=>Object.entries(y()),_e,(Q,G)=>{var ee=Ce(()=>Se(e(G),2));let ce=()=>e(ee)[0],ie=()=>e(ee)[1];ga(Q,{get week(){return ce()},get aggregate(){return ie()}})}),m(I,L)};z(X,I=>{Object.keys(y()).length===0?I($):I(R,!1)})}m(D,K)},J=D=>{var K=te(),X=V(K);{var $=R=>{var I=te(),L=V(I);{var Z=G=>{var ee=ha();m(G,ee)},Q=G=>{var ee=te(),ce=V(ee);ye(ce,1,()=>Object.entries(v()),_e,(ie,le)=>{var pe=Ce(()=>Se(e(le),2));let we=()=>e(pe)[0],be=()=>e(pe)[1];ma(ie,{get month(){return we()},get aggregate(){return be()}})}),m(G,ee)};z(L,G=>{Object.keys(v()).length===0?G(Z):G(Q,!1)})}m(R,I)};z(X,R=>{e(h)==="by-month"&&R($)},!0)}m(D,K)};z(U,D=>{e(h)==="by-week"?D(Y):D(J,!1)},!0)}m(g,k)};z(_,g=>{e(h)==="by-day"?g(i):g(n,!1)},!0)}m(c,o)};z(N,c=>{e(h)==="by-submission"?c(E):c(F,!1)})}t(C),t(B),m(l,B),me(),b()}var wa=T(`<div class="card"><div class="card-header"><div class="d-flex align-items-center gap-2"><span class="fw-600 svelte-8saayj">Book of Mormon Challenge</span></div></div> <div class="card-body"><div class="d-flex flex-column gap-3"><div><div class="d-flex justify-content-between align-items-center mb-2"><h5 class="mb-0">Overall Completion</h5> <span class="badge bg-primary fs-5"> </span></div> <div class="progress mb-2" style="height: 10px;"><div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div> <p class="text-muted mb-0"> </p></div> <div class="row g-3"><div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-calendar3 fs-1 text-primary mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">Days Remaining</p></div></div></div> <div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-book fs-1 text-primary mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">BOM Chapters</p></div></div></div> <div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-check-circle fs-1 text-success mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">Chapters Read</p></div></div></div> <div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-people fs-1 text-warning mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">Reading Submissions</p></div></div></div></div> <div class="alert alert-info mb-0" role="alert"><div class="d-flex gap-2"><i class="bi bi-info-circle"></i> <div>This progress shows how many chapters have been read by <strong>anyone</strong> in the ward.
						Each person can mark chapters as read anonymously.</div></div></div> <div class="d-flex flex-column gap-2"><div class="d-block"><button class="btn btn-sm btn-primary w-100" type="button" data-bs-toggle="offcanvas">Join the Challenge</button></div> <div class="d-block"><button class="btn btn-sm btn-outline-primary w-100" type="button" data-bs-toggle="offcanvas">Record Your Reading</button></div> <div class="d-block"><button class="btn btn-sm btn-link w-100" type="button" data-bs-toggle="offcanvas">See all submissions</button></div></div></div></div></div>`);function xa(l,r){ue(r,!1);const s=()=>oe(C,"$chapterProgress",y),f=()=>oe(N,"$entries",y),[y,v]=Ee(),u=P(),b=P(),S=P(),j=P(),x=P(),p=P();let h=re(r,"scheduleDrawerId",8),B=re(r,"submissionsDrawerId",8),W=re(r,"onJoinClick",8),q=re(r,"onRecordClick",8);const{stores:{chapterProgress:C,entries:N}}=je();function E(ae){return ae.toLocaleString("en-US")}H(()=>s(),()=>{w(u,s().filter(ae=>ae.book_name!=="Review"&&ae.chapter_number!==null))}),H(()=>e(u),()=>{w(b,e(u).length)}),H(()=>e(u),()=>{w(S,e(u).filter(ae=>ae.read_count>0).length)}),H(()=>f(),()=>{w(j,f().length)}),H(()=>(e(b),e(S)),()=>{w(x,e(b)>0?Math.round(e(S)/e(b)*100):0)}),H(()=>{},()=>{w(p,(()=>{const ae=new Date,Le=new Date(ae.getFullYear(),11,31).getTime()-ae.getTime(),Pe=Math.ceil(Le/(1e3*60*60*24));return Pe>0?Pe:0})())}),xe(),fe();var F=wa(),c=d(a(F),2),o=a(c),_=a(o),i=a(_),n=d(a(i),2),g=a(n);t(n),t(i);var k=d(i,2),U=a(k);t(k);var Y=d(k,2),J=a(Y);t(Y),t(_);var D=d(_,2),K=a(D),X=a(K),$=a(X),R=d(a($),2),I=a(R,!0);t(R),he(2),t($),t(X),t(K);var L=d(K,2),Z=a(L),Q=a(Z),G=d(a(Q),2),ee=a(G,!0);t(G),he(2),t(Q),t(Z),t(L);var ce=d(L,2),ie=a(ce),le=a(ie),pe=d(a(le),2),we=a(pe);t(pe),he(2),t(le),t(ie),t(ce);var be=d(ce,2),ke=a(be),$e=a(ke),Re=d(a($e),2),qe=a(Re,!0);t(Re),he(2),t($e),t(ke),t(be),t(D);var Te=d(D,4),Me=a(Te),Oe=a(Me);t(Me);var Je=d(Me,2),Ye=a(Je);t(Je);var Xe=d(Je,2),Ze=a(Xe);t(Xe),t(Te),t(o),t(c),t(F),se((ae,et,Le,Pe,dt,ct,vt)=>{A(g,`${e(x)??""}%`),He(U,`width: ${e(x)??""}%`),ve(U,"aria-valuenow",e(x)),A(J,`${ae??""} of ${et??""} chapters read by at
					least one person`),A(I,Le),A(ee,Pe),A(we,`${dt??""} / ${ct??""}`),A(qe,vt),ve(Oe,"data-bs-target",`#${h()??""}`),ve(Oe,"aria-controls",h()),ve(Ye,"data-bs-target",`#${h()??""}`),ve(Ye,"aria-controls",h()),ve(Ze,"data-bs-target",`#${B()??""}`),ve(Ze,"aria-controls",B())},[()=>(e(S),O(()=>E(e(S)))),()=>(e(b),O(()=>E(e(b)))),()=>(e(p),O(()=>E(e(p)))),()=>(e(b),O(()=>E(e(b)))),()=>(e(S),O(()=>E(e(S)))),()=>(e(b),O(()=>E(e(b)))),()=>(e(j),O(()=>E(e(j))))]),We("click",Oe,function(...ae){W()?.apply(this,ae)}),We("click",Ye,function(...ae){q()?.apply(this,ae)}),m(l,F),me(),v()}var ka=T('<div class="text-center py-5"><div class="spinner-border" role="status"><span class="visually-hidden">Loading reading challenge...</span></div></div>'),Sa=T(`<div class="alert alert-info mb-3" role="alert"><h5 class="alert-heading"><i class="bi bi-info-circle me-2"></i>How to Join the Challenge</h5> <p class="mb-2">Our ward is reading the Book of Mormon together! Here's how to participate:</p> <ol class="mb-2"><li>Read any chapter from the Book of Mormon</li> <li>Click the "Read" button next to the chapter you completed</li> <li>Your reading is tracked anonymously to show ward progress</li></ol> <p class="mb-0"><strong>Remember:</strong> You don't have to follow the schedule exactly! Read ahead, catch
					up, or go at your own pace. The goal is to show that our ward is moving forward in reading the
					Book of Mormon together.</p></div>`),Ba=T("<!> <!>",1),Ea=T("<!> <!> <!>",1);function $a(l,r){ue(r,!1);const s=()=>oe(S,"$loading",y),f=()=>oe(j,"$ready",y),[y,v]=Ee(),u=at(),b=at(),{stores:{loading:S,ready:j},actions:{reload:x}}=je();let p=P(!1);function h(){w(p,!0)}function B(){w(p,!1)}Ge(async()=>{await x()}),fe();var W=te(),q=V(W);{var C=E=>{var F=ka();m(E,F)},N=E=>{var F=Ea(),c=V(F);xa(c,{get scheduleDrawerId(){return u},get submissionsDrawerId(){return b},onJoinClick:h,onRecordClick:B});var o=d(c,2);rt(o,{get id(){return u},title:"2026 Book of Mormon Reading Challenge",placement:"end",children:(i,n)=>{var g=Ba(),k=V(g);{var U=J=>{var D=Sa();m(J,D)};z(k,J=>{e(p)&&J(U)})}var Y=d(k,2);ra(Y,{}),m(i,g)},$$slots:{default:!0}});var _=d(o,2);rt(_,{get id(){return b},title:"Reading Submissions",placement:"start",children:(i,n)=>{_a(i,{})},$$slots:{default:!0}}),m(E,F)};z(q,E=>{s()&&!f()?E(C):E(N,!1)})}m(l,W),me(),v()}var Ra=T('<div class="card"><ul class="list-group list-group-flush"><li class="list-group-item d-flex align-items-center justify-content-between"><div>Sacrament Program</div> <a href="/sacrament-program" class="btn btn-sm btn-primary" aria-label="View sacrament program"><i class="bi bi-link"></i></a></li></ul></div>');function Ma(l,r){ue(r,!1);const s=()=>oe(u,"$currentUserIsAdmin",y),f=()=>oe(b,"$currentUserIsRoot",y),[y,v]=Ee(),{stores:{currentUserIsAdmin:u,currentUserIsRoot:b}}=xt(),S=gt(new Date);fe();var j=te(),x=V(j);{var p=h=>{var B=Ra();m(h,B)};z(x,h=>{(S||s()||f())&&h(p)})}m(l,j),me(),v()}var Oa=T('<div class="d-flex flex-column gap-4"><!> <!> <!> <!> <!> <!> <div class="d-flex flex-column flex-lg-row justify-content-between gap-4"><!> <!></div></div>');function Ka(l){var r=Oa(),s=a(r);Ma(s,{});var f=d(s,2);ut(f,{});var y=d(f,2);mt(y,{});var v=d(y,2);$a(v,{});var u=d(v,2);Et(u,{});var b=d(u,2);$t(b,{showNextNextWeek:!1});var S=d(b,2),j=a(S);ft(j,{});var x=d(j,2);pt(x,{}),t(S),t(r),m(l,r)}export{Ka as H};
