const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BcO7X4Pb.js","./SWWSvUpQ.js","./DIeogL5L.js","./D8ekX_8E.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./WW5OsAH7.js","./CU3XCoqN.js","./YJAcq9su.js","./ecQEXOeB.js","./BkVROWuc.js","./E0Q7VAG1.js","./BUApaBEI.js","./Bgyk9asy.js","./DQwQSQOk.js","../assets/Spinner.DTjfhZ6-.css","./CgZ65Tu2.js","./mnkQx8ai.js","./CvxMDV_e.js","./Cc3l00Qu.js","./CM325Axc.js","./DqKT3Phg.js","./88TwgxMv.js","./CeUO2qMX.js","./DLkAPJLb.js","../assets/BishopricApprovalSection.DRGo_BHg.css"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{o as Je,w as fa,g as Ne}from"./WW5OsAH7.js";import{h as ba,d as ya,bb as ga,P as ha,p as _e,ah as q,ai as $e,B as A,a as pe,n as _,m as t,E as F,s,c as r,D,r as a,u as n,f as dt,R as jt,F as ue,C as Ve}from"./SWWSvUpQ.js";import{B as Ea,p as Ut,i as y,s as P,e as gt,b as Fe,a as wt,d as xa,j as wa}from"./CU3XCoqN.js";import{e as ae,i as xe}from"./YJAcq9su.js";import{f as m,a as i,c as Bt,t as ie}from"./D8ekX_8E.js";import{s as $t,e as ka,b as Ma,i as Da,d as Oa}from"./ecQEXOeB.js";import{t as we,c as Ye,i as ut,p as ht,f as ne,e as ke,O as Me,P as Rt,y as Ca,A as ye,z as Ia}from"./BkVROWuc.js";import{s as De}from"./CdEA5IGF.js";import{i as fe}from"./Bgyk9asy.js";import{C as Ge,c as Ze}from"./CDyPyCot.js";import{b as Gt,h as ze,g as Xe,C as ta,c as $a,f as ge,d as he}from"./BcO7X4Pb.js";import{S as Oe}from"./DQwQSQOk.js";import{v as Ce,D as Ie}from"./CgZ65Tu2.js";import{_ as He}from"./CmsKOCeN.js";import{R as me}from"./DqKT3Phg.js";import{P as Aa}from"./BgB8pT2-.js";import{p as Sa}from"./CabUGX0_.js";import{c as Ta,e as za}from"./CM325Axc.js";import{i as Ee}from"./CDbFGmoH.js";import{e as Fa}from"./88TwgxMv.js";import{a as Ke}from"./CeUO2qMX.js";function Ra(g,d,e){ba&&ya();var u=new Ea(g),x=!ga();ha(()=>{var B=d();x&&B!==null&&typeof B=="object"&&(B={}),u.ensure(B,e)})}function ea(g,d){const e=we(g);if(isNaN(d))return Ye(g,NaN);if(!d)return e;const u=e.getDate(),x=Ye(g,e.getTime());x.setMonth(e.getMonth()+d+1,0);const B=x.getDate();return u>=B?x:(e.setFullYear(x.getFullYear(),x.getMonth(),u),e)}function Ua(g){const d=we(g);return d.setDate(1),d.setHours(0,0,0,0),d}function We(g,d){const e=we(g),u=we(d);return e.getFullYear()===u.getFullYear()&&e.getMonth()===u.getMonth()}function qe(g){return Ee(g,Ta(g))}function Pa(g,d){return ea(g,-1)}var La=m('<div class="event-header-image svelte-lu3xbf"><img class="svelte-lu3xbf"/></div>'),Ba=m("<span> </span>"),Na=m('<button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i> Edit</button>'),Va=m('<p class="section-content svelte-lu3xbf"><span class="badge bg-secondary">All Day Event</span></p>'),Ya=m('<p class="section-content svelte-lu3xbf"> </p>'),Ha=m('<p class="section-content svelte-lu3xbf"><strong> </strong></p> <!>',1),Ka=m('<p class="section-content text-muted svelte-lu3xbf"><i class="bi bi-arrow-repeat"></i> <!></p>'),Wa=m('<p class="section-content text-muted svelte-lu3xbf"><i class="bi bi-arrow-repeat"></i> Part of recurring event series</p>'),qa=m('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-geo-alt"></i> Location</h6> <p class="section-content svelte-lu3xbf"> </p></div>'),ja=m('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-card-text"></i> Description</h6> <div class="section-content event-description svelte-lu3xbf"><!></div></div>'),Qa=m('<div class="attachment-image-container svelte-lu3xbf"><button type="button" class="attachment-image-button svelte-lu3xbf"><img class="attachment-image svelte-lu3xbf"/></button> <div class="attachment-image-label svelte-lu3xbf"><small class="text-muted"> </small></div></div>'),Ja=m('<button type="button" class="btn btn-outline-secondary attachment-file-button svelte-lu3xbf"><i class="bi bi-file-pdf"></i> <span class="text-truncate svelte-lu3xbf"> </span> <small class="text-muted"> </small></button>'),Ga=m('<div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-paperclip"></i> Attachments</h6> <div class="attachments-grid svelte-lu3xbf"></div></div>'),Za=m('<p class="metadata-item svelte-lu3xbf"><i class="bi bi-clock-history"></i> Posted <!> <!></p>'),Xa=m('<p class="metadata-item svelte-lu3xbf"><i class="bi bi-pencil-square"></i> Last edited <!> <!></p>'),tn=m('<div class="event-section event-metadata svelte-lu3xbf"><!> <!></div>'),en=m('<div class="event-details-view svelte-lu3xbf"><div class="event-header svelte-lu3xbf"><div class="event-header-content svelte-lu3xbf"><!> <div class="event-header-text svelte-lu3xbf"><h3 class="event-title svelte-lu3xbf"> </h3> <!></div></div> <!></div> <div class="event-section svelte-lu3xbf"><h6 class="section-label svelte-lu3xbf"><i class="bi bi-calendar-event"></i> Date & Time</h6> <!> <!></div> <!> <!> <!> <!></div>');function aa(g,d){_e(d,!1);const e=F(),u=F(),x=F(),B=F(),rt=F(),K=F(),G=F(),mt=F(),Z=F();let f=Ut(d,"event",8),j=Ut(d,"onEdit",8,null),X=Ut(d,"canEdit",8,!1);const V=l=>l.startsWith("image/"),xt=l=>l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB",Dt=l=>{window.open(l,"_blank")},ot=l=>{if(!l)return"";try{return ut(ht(l),"MMM d, yyyy 'at' h:mm a")}catch{return""}},Ot=l=>{try{const o=me.fromString(l).origOptions,E=o.interval||1,M=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Q=["","1st","2nd","3rd","4th","5th"];if(o.freq===me.DAILY)return E===1?"Repeats daily":`Repeats every ${E} days`;if(o.freq===me.WEEKLY){if(o.byweekday){const C=(Array.isArray(o.byweekday)?o.byweekday:[o.byweekday]).map(c=>{const p=typeof c=="number"?c:c.weekday,O=p===6?0:p+1;return M[O]});return E===1?C.length===1?`Repeats every ${C[0]}`:`Repeats on ${C.join(", ")}`:`Repeats every ${E} weeks on ${C.join(", ")}`}return E===1?"Repeats weekly":`Repeats every ${E} weeks`}if(o.freq===me.MONTHLY){if(o.byweekday){const C=(Array.isArray(o.byweekday)?o.byweekday:[o.byweekday])[0];if(C&&typeof C=="object"&&"n"in C&&"weekday"in C){const c=C.weekday,p=c===6?0:c+1,O=C.n,W=Q[O]||`${O}th`;return E===1?`Repeats on the ${W} ${M[p]} of the month`:`Repeats on the ${W} ${M[p]} every ${E} months`}}if(o.bymonthday){const R=Array.isArray(o.bymonthday)?o.bymonthday[0]:o.bymonthday,C=R===1?"st":R===2?"nd":R===3?"rd":"th";return E===1?`Repeats on the ${R}${C} of the month`:`Repeats on the ${R}${C} every ${E} months`}return E===1?"Repeats monthly":`Repeats every ${E} months`}if(o.freq===me.YEARLY){if(o.bymonth&&o.bymonthday){const R=["","January","February","March","April","May","June","July","August","September","October","November","December"],C=Array.isArray(o.bymonth)?o.bymonth[0]:o.bymonth,c=Array.isArray(o.bymonthday)?o.bymonthday[0]:o.bymonthday,p=c===1?"st":c===2?"nd":c===3?"rd":"th";return E===1?`Repeats every ${R[C]} ${c}${p}`:`Repeats every ${E} years on ${R[C]} ${c}${p}`}return E===1?"Repeats yearly":`Repeats every ${E} years`}return"Repeats"}catch{return"Repeats"}};q(()=>_(f()),()=>{D(e,Gt(f()?.meta_data?.organization??""))}),q(()=>_(f()),()=>{D(u,f().meta_data?.submitted_at??f().created_at)}),q(()=>t(u),()=>{D(x,ot(t(u)))}),q(()=>_(f()),()=>{D(B,f().meta_data?.submitted_by_name)}),q(()=>(t(x),t(B)),()=>{D(rt,!!(t(x)||t(B)))}),q(()=>_(f()),()=>{D(K,ot(f().meta_data?.edited_at))}),q(()=>_(f()),()=>{D(G,f().meta_data?.edited_by_name)}),q(()=>(t(K),t(G)),()=>{D(mt,!!(t(K)||t(G)))}),q(()=>_(f()),()=>{D(Z,f().attachments?.find(l=>V(l.type)))}),$e(),fe();var Ct=en(),Nt=r(Ct),st=r(Nt),Zt=r(st);{var Vt=l=>{var b=La(),o=r(b);a(b),A(()=>{$t(o,"src",(t(Z),n(()=>t(Z).url))),$t(o,"alt",(t(Z),n(()=>t(Z).name)))}),i(l,b)};y(Zt,l=>{t(Z)&&l(Vt)})}var Pt=s(Zt,2),kt=r(Pt),Qt=r(kt,!0);a(kt);var Kt=s(kt,2);{var St=l=>{var b=Ba(),o=r(b,!0);a(b),A(()=>{ne(b,1,`badge rounded-pill bg-color-${t(e),n(()=>t(e).color_number)??""}`,"svelte-lu3xbf"),P(o,(t(e),n(()=>t(e).label)))}),i(l,b)};y(Kt,l=>{t(e),n(()=>t(e)?.label)&&l(St)})}a(Pt),a(st);var Yt=s(st,2);{var Lt=l=>{var b=Na();gt("click",b,function(...o){j()?.apply(this,o)}),i(l,b)};y(Yt,l=>{X()&&j()&&l(Lt)})}a(Nt);var Mt=s(Nt,2),Tt=s(r(Mt),2);{var Y=l=>{var b=Ha(),o=dt(b),E=r(o),M=r(E,!0);a(E),a(o);var Q=s(o,2);{var R=c=>{var p=Va();i(c,p)},C=c=>{var p=Bt(),O=dt(p);{var W=N=>{var v=Ya(),k=r(v);a(v),A((I,tt)=>P(k,`${I??""} - ${tt??""}`),[()=>(_(ut),_(ht),_(f()),n(()=>ut(ht(f().start_time),"h:mm a"))),()=>(_(ut),_(ht),_(f()),n(()=>ut(ht(f().end_time),"h:mm a")))]),i(N,v)};y(O,N=>{_(f()),n(()=>f().start_time&&f().end_time)&&N(W)},!0)}i(c,p)};y(Q,c=>{_(f()),n(()=>f().is_all_day)?c(R):c(C,!1)})}A(c=>P(M,c),[()=>(_(ut),_(ht),_(f()),n(()=>ut(ht(f().start_time),"EEEE, MMMM d, yyyy")))]),i(l,b)};y(Tt,l=>{_(f()),n(()=>f().start_time)&&l(Y)})}var J=s(Tt,2);{var bt=l=>{var b=Ka(),o=s(r(b)),E=s(o);{var M=Q=>{var R=ie();A(C=>P(R,`until ${C??""}`),[()=>(_(ut),_(ht),_(f()),n(()=>ut(ht(f().recurrence_end_date),"MMM d, yyyy")))]),i(Q,R)};y(E,Q=>{_(f()),n(()=>f().recurrence_end_date)&&Q(M)})}a(b),A(Q=>P(o,` ${Q??""} `),[()=>(_(f()),n(()=>Ot(f().recurrence_rule)))]),i(l,b)},_t=l=>{var b=Bt(),o=dt(b);{var E=M=>{var Q=Wa();i(M,Q)};y(o,M=>{_(f()),n(()=>f()?.meta_data?.recurring_instance)&&M(E)},!0)}i(l,b)};y(J,l=>{_(f()),n(()=>f().recurrence_rule)?l(bt):l(_t,!1)})}a(Mt);var zt=s(Mt,2);{var it=l=>{var b=qa(),o=s(r(b),2),E=r(o,!0);a(o),a(b),A(()=>P(E,(_(f()),n(()=>f().location)))),i(l,b)};y(zt,l=>{_(f()),n(()=>f().location)&&l(it)})}var h=s(zt,2);{var w=l=>{var b=ja(),o=s(r(b),2),E=r(o);ze(E,()=>(_(f()),n(()=>f().description))),a(o),a(b),i(l,b)};y(h,l=>{_(f()),n(()=>f().description)&&l(w)})}var T=s(h,2);{var H=l=>{var b=Ga(),o=s(r(b),2);ae(o,5,()=>(_(f()),n(()=>f().attachments)),E=>E.id,(E,M)=>{var Q=Bt(),R=dt(Q);{var C=p=>{var O=Qa(),W=r(O),N=r(W);a(W);var v=s(W,2),k=r(v),I=r(k,!0);a(k),a(v),a(O),A(()=>{$t(W,"title",`Open ${t(M),n(()=>t(M).name)??""}`),$t(N,"src",(t(M),n(()=>t(M).url))),$t(N,"alt",(t(M),n(()=>t(M).name))),P(I,(t(M),n(()=>t(M).name)))}),gt("click",W,()=>Dt(t(M).url)),i(p,O)},c=p=>{var O=Ja(),W=s(r(O),2),N=r(W,!0);a(W);var v=s(W,2),k=r(v);a(v),a(O),A(I=>{$t(O,"title",`Open ${t(M),n(()=>t(M).name)??""}`),P(N,(t(M),n(()=>t(M).name))),P(k,`(${I??""})`)},[()=>(t(M),n(()=>xt(t(M).size)))]),gt("click",O,()=>Dt(t(M).url)),i(p,O)};y(R,p=>{t(M),n(()=>V(t(M).type))?p(C):p(c,!1)})}i(E,Q)}),a(o),a(b),i(l,b)};y(T,l=>{_(f()),n(()=>f().attachments&&f().attachments.length>0)&&l(H)})}var z=s(T,2);{var L=l=>{var b=tn(),o=r(b);{var E=R=>{var C=Za(),c=s(r(C),2);{var p=N=>{var v=ie();A(()=>P(v,t(x))),i(N,v)};y(c,N=>{t(x)&&N(p)})}var O=s(c,2);{var W=N=>{var v=ie();A(()=>P(v,`by ${t(B)??""}`)),i(N,v)};y(O,N=>{t(B)&&N(W)})}a(C),i(R,C)};y(o,R=>{t(rt)&&R(E)})}var M=s(o,2);{var Q=R=>{var C=Xa(),c=s(r(C),2);{var p=N=>{var v=ie();A(()=>P(v,t(K))),i(N,v)};y(c,N=>{t(K)&&N(p)})}var O=s(c,2);{var W=N=>{var v=ie();A(()=>P(v,`by ${t(G)??""}`)),i(N,v)};y(O,N=>{t(G)&&N(W)})}a(C),i(R,C)};y(M,R=>{t(mt)&&R(Q)})}a(b),i(l,b)};y(z,l=>{(t(rt)||t(mt))&&l(L)})}a(Ct),A(()=>P(Qt,(_(f()),n(()=>f().title)))),i(g,Ct),pe()}var an=m('<button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Add announcement"><i class="bi bi-plus"></i> <span class="d-none d-md-inline ms-1">Add Announcement</span></button>'),nn=m("<span> </span>"),rn=m('<span class="announcement-location svelte-1yokbat"><i class="bi bi-geo-alt"></i> </span>'),sn=m('<div class="announcement-thumbnail-container svelte-1yokbat"><img class="announcement-thumbnail svelte-1yokbat"/></div>'),on=m('<div class="announcement-actions svelte-1yokbat"><button type="button" class="btn btn-sm btn-primary" title="Edit announcement"><i class="bi bi-pencil"></i></button></div>'),ln=m('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="announcement-details-button svelte-1yokbat"><div class="announcement-title svelte-1yokbat"> </div> <div class="announcement-meta svelte-1yokbat"><!> <!></div></button> <!> <!></li>'),vn=m('<div class="announcements-footer svelte-1yokbat"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),cn=m('<div class="announcements-list-container svelte-1yokbat"><ul class="list-group list-group-flush"></ul></div> <!>',1),dn=m('<div class="no-announcements svelte-1yokbat"><!></div>'),un=m('<div class="announcements-container svelte-1yokbat"><div class="announcements-header svelte-1yokbat"><h2 class="announcements-title svelte-1yokbat">Announcements</h2> <div class="announcements-actions svelte-1yokbat"><!></div></div> <!></div>'),mn=m('<div class="d-flex flex-column gap-4"><!></div>'),_n=m("<!> <!> <!>",1);function Nr(g,d){_e(d,!1);const e=()=>wt(Zt,"$searchQuery",Z),u=()=>wt(st,"$announcements",Z),x=()=>wt(xt,"$currentUser",Z),B=()=>wt(Ct,"$userOrganizations",Z),rt=()=>wt(Dt,"$currentUserHasPermission",Z),K=()=>wt(Ot,"$currentUserIsRoot",Z),G=()=>wt(ot,"$currentUserIsAdmin",Z),mt=()=>wt(Nt,"$ready",Z),[Z,f]=Fe(),j=F(),X=F(),V=F(),{stores:{currentUser:xt,currentUserHasPermission:Dt,currentUserIsAdmin:ot,currentUserIsRoot:Ot,userOrganizations:Ct}}=ke(),{stores:{ready:Nt,announcements:st,searchQuery:Zt},actions:{reload:Vt}}=Xe(),Pt={title:"Announcement",description:"",location:"",event_type:"announcement",is_public:!0},kt=Ce(),Qt=Ce();let Kt=F(!1),St=F(!1),Yt=F(),Lt=F(!1),Mt=F(!1),Tt=F(!1),Y=F(new Set),J=F(""),bt=F({...Pt}),_t=F({...Pt});const zt=5,it=5;let h=F(zt);function w(){D(h,t(h)+it)}const T=c=>Ze(c,{currentUserId:t(Yt),isPrivileged:t(St),canEditOwnOrgEvents:t(Tt),userOrganizations:t(Y)}),H=c=>c.startsWith("image/");Je(async()=>{await Vt()});const z=c=>{D(J,"Announcement Form"),D(bt,{...c,organization:c?.meta_data?.organization??""})},L=c=>{D(_t,c);const p=document.getElementById(Qt);p&&new window.bootstrap.Offcanvas(p).show()},l=c=>{z(c);const p=document.getElementById(kt);p&&new window.bootstrap.Offcanvas(p).show()},b=()=>{const c=document.getElementById(Qt);if(c){const p=window.bootstrap.Offcanvas.getInstance(c);p&&p.hide()}z(t(_t)),setTimeout(()=>{const p=document.getElementById(kt);p&&new window.bootstrap.Offcanvas(p).show()},300)};q(()=>(e(),u(),t(h)),()=>{D(j,e()?u()??[]:(u()??[]).slice(0,t(h)))}),q(()=>(e(),u(),t(h)),()=>{D(X,!e()&&(u()?.length??0)>t(h))}),q(()=>x(),()=>{D(Yt,x()?.id)}),q(()=>t(Yt),()=>{D(Mt,!!t(Yt))}),q(()=>B(),()=>{D(Y,B())}),q(()=>(t(Y),Me),()=>{D(Lt,t(Y).has(Me.Bishopric))}),q(()=>(rt(),Rt),()=>{D(Tt,rt()(Rt.EditOwnOrgEvents))}),q(()=>(K(),G(),t(Lt),rt(),Rt),()=>{D(St,K()||G()||t(Lt)||rt()(Rt.EditAllEvents))}),q(()=>(t(St),rt(),t(Tt),t(Mt)),()=>{D(Kt,t(St)||rt()(Rt.CreateEvents)||t(Tt)||t(Mt))}),q(()=>(rt(),Rt),()=>{D(V,rt()(Rt.DeleteEvents))}),$e(),fe();var o=_n(),E=dt(o);Ie(E,{get title(){return t(J)},get id(){return kt},children:(c,p)=>{Ge(c,{get eventItem(){return t(bt)},get drawerId(){return kt},name:"announcement-item-form",get canDelete(){return t(V)}})},$$slots:{default:!0}});var M=s(E,2);Ie(M,{title:"Announcement Details",get id(){return Qt},children:(c,p)=>{{let O=jt(()=>(t(_t),n(()=>T(t(_t)))));aa(c,{get event(){return t(_t)},get canEdit(){return t(O)},onEdit:b})}},$$slots:{default:!0}});var Q=s(M,2);{var R=c=>{var p=un(),O=r(p),W=s(r(O),2),N=r(W);{var v=at=>{var pt=an();A(()=>{$t(pt,"data-bs-target",`#${kt??""}`),$t(pt,"aria-controls",kt)}),gt("click",pt,()=>z({...Pt,event_type:"announcement"})),i(at,pt)};y(N,at=>{t(Kt)&&at(v)})}a(W),a(O);var k=s(O,2);{var I=at=>{var pt=cn(),Jt=dt(pt),Xt=r(Jt);ae(Xt,5,()=>t(j),S=>S.id,(S,U)=>{const yt=jt(()=>(t(U),n(()=>t(U).attachments?.find(ft=>H(ft.type))))),et=jt(()=>(_(Gt),t(U),n(()=>Gt(t(U)?.meta_data?.organization??""))));var vt=ln(),Wt=r(vt),It=s(Wt,2),Ht=r(It),re=r(Ht,!0);a(Ht);var se=s(Ht,2),At=r(se);{var le=ft=>{var Et=nn(),ee=r(Et,!0);a(Et),A(()=>{ne(Et,1,`badge rounded-pill bg-color-${_(t(et)),n(()=>t(et).color_number)??""}`,"svelte-1yokbat"),P(ee,(_(t(et)),n(()=>t(et).label)))}),i(ft,Et)};y(At,ft=>{_(t(et)),n(()=>t(et)?.label)&&ft(le)})}var ve=s(At,2);{var lt=ft=>{var Et=rn(),ee=s(r(Et));a(Et),A(()=>P(ee,` ${t(U),n(()=>t(U).location)??""}`)),i(ft,Et)};y(ve,ft=>{t(U),n(()=>t(U).location)&&ft(lt)})}a(se),a(It);var ce=s(It,2);{var te=ft=>{var Et=sn(),ee=r(Et);a(Et),A(()=>{$t(ee,"src",(_(t(yt)),n(()=>t(yt).url))),$t(ee,"alt",(_(t(yt)),n(()=>t(yt).name)))}),i(ft,Et)};y(ce,ft=>{t(yt)&&ft(te)})}var de=s(ce,2);{var be=ft=>{var Et=on(),ee=r(Et);a(Et),gt("click",ee,De(()=>l(t(U)))),i(ft,Et)};y(de,ft=>{t(U),n(()=>T(t(U)))&&ft(be)})}a(vt),A(()=>{ne(Wt,1,`announcement-color-indicator bg-color-${_(t(et)),n(()=>t(et)?.color_number??0)??""}`,"svelte-1yokbat"),P(re,(t(U),n(()=>t(U).title)))}),gt("click",It,()=>L(t(U))),i(S,vt)}),a(Xt),a(Jt);var Ft=s(Jt,2);{var $=S=>{var U=vn(),yt=r(U),et=r(yt);a(yt);var vt=s(yt,2);a(U),A(()=>P(et,`Showing ${t(h)??""} of ${u(),n(()=>u()?.length??0)??""}`)),gt("click",vt,w),i(S,U)};y(Ft,S=>{t(X)&&S($)})}i(at,pt)},tt=at=>{var pt=Bt(),Jt=dt(pt);{var Xt=Ft=>{var $=dn(),S=r($);{var U=et=>{var vt=ie("No announcements match your search.");i(et,vt)},yt=et=>{var vt=ie("There are no announcements yet.");i(et,vt)};y(S,et=>{e()?et(U):et(yt,!1)})}a($),i(Ft,$)};y(Jt,Ft=>{u(),n(()=>u()?.length===0)&&Ft(Xt)},!0)}i(at,pt)};y(k,at=>{t(j),n(()=>t(j).length)?at(I):at(tt,!1)})}a(p),i(c,p)},C=c=>{var p=mn(),O=r(p);Oe(O,{}),a(p),i(c,p)};y(Q,c=>{mt()?c(R):c(C,!1)})}i(g,o),pe(),f()}const na={},ra={};for(const g of Object.values(ta))g.key&&(na[g.label.toLowerCase()]=g.key,ra[g.key]=g.label);const pn=new Set(Object.values(ta).map(g=>g.key).filter(Boolean));function fn(g){const d=g.trim();if(d)return pn.has(d.toUpperCase())?d.toUpperCase():na[d.toLowerCase()]}async function bn(g){return new Promise((d,e)=>{Aa.parse(g,{header:!0,skipEmptyLines:!0,complete:u=>{const x=u.data,B=u.meta.fields||[];d({data:x,columns:B})},error:u=>e(u)})})}function yn(g){return g.map(d=>{const e=d.toLowerCase().trim();return e==="title"||e==="event"||e==="event name"||e==="name"?{csvColumn:d,eventField:"title"}:e==="description"||e==="details"||e==="notes"?{csvColumn:d,eventField:"description"}:e==="start date"||e==="start_date"||e==="date"||e==="event date"?{csvColumn:d,eventField:"start_date"}:e==="start time"||e==="start_time"||e==="time"||e==="event time"?{csvColumn:d,eventField:"start_time"}:e==="end date"||e==="end_date"?{csvColumn:d,eventField:"end_date"}:e==="end time"||e==="end_time"?{csvColumn:d,eventField:"end_time"}:e==="location"||e==="place"||e==="venue"?{csvColumn:d,eventField:"location"}:e==="organization"||e==="group"||e==="organization"||e==="org"?{csvColumn:d,eventField:"organization"}:e==="all day"||e==="all_day"||e==="is_all_day"||e==="allday"?{csvColumn:d,eventField:"is_all_day"}:{csvColumn:d,eventField:null}})}function oe(g,d,e){const u=d.find(x=>x.eventField===e);return u?(g[u.csvColumn]||"").trim():""}function je(g){const d=["yyyy-MM-dd","MM/dd/yyyy","M/d/yyyy","MM-dd-yyyy","M-d-yyyy","MM/dd/yy","M/d/yy","yyyy/MM/dd","MMM d, yyyy","MMMM d, yyyy","MMM d yyyy","d MMM yyyy"];for(const e of d){const u=Sa(g,e,new Date);if(Ca(u))return u}return null}function Qe(g){const d=g.match(/^(\d{1,2}):(\d{2})$/);if(d){const u=parseInt(d[1],10),x=parseInt(d[2],10);if(u>=0&&u<=23&&x>=0&&x<=59)return{hours:u,minutes:x}}const e=g.match(/^(\d{1,2})(?::(\d{2}))?\s*(am|pm)$/i);if(e){let u=parseInt(e[1],10);const x=e[2]?parseInt(e[2],10):0,B=e[3].toLowerCase();if(u>=1&&u<=12&&x>=0&&x<=59)return B==="pm"&&u!==12&&(u+=12),B==="am"&&u===12&&(u=0),{hours:u,minutes:x}}return null}function gn(g){const d=g.toLowerCase().trim();return["true","yes","1","y","x"].includes(d)}function hn(g,d,e){const u=[],x=oe(g,d,"title"),B=oe(g,d,"description"),rt=oe(g,d,"start_date"),K=oe(g,d,"start_time"),G=oe(g,d,"end_date"),mt=oe(g,d,"end_time"),Z=oe(g,d,"location"),f=oe(g,d,"organization"),j=oe(g,d,"is_all_day");if(!x)return u.push({row:e,field:"title",message:"Title is required"}),{event:null,errors:u};if(x.length<3)return u.push({row:e,field:"title",message:"Title must be at least 3 characters"}),{event:null,errors:u};if(x.length>255)return u.push({row:e,field:"title",message:"Title cannot exceed 255 characters"}),{event:null,errors:u};if(!rt)return u.push({row:e,field:"start_date",message:"Start date is required"}),{event:null,errors:u};const X=je(rt);if(!X)return u.push({row:e,field:"start_date",message:`Invalid date format: "${rt}"`}),{event:null,errors:u};const V=j?gn(j):!K;let xt;if(!V&&K){const st=Qe(K);if(!st)return u.push({row:e,field:"start_time",message:`Invalid time format: "${K}"`}),{event:null,errors:u};X.setHours(st.hours,st.minutes,0,0),xt=ge(X,ye)}else X.setHours(0,0,0,0),xt=ge(X,ye);let Dt;const ot=G?je(G):new Date(X);if(ot&&!V&&mt){const st=Qe(mt);if(!st)return u.push({row:e,field:"end_time",message:`Invalid time format: "${mt}"`}),{event:null,errors:u};ot.setHours(st.hours,st.minutes,0,0),Dt=ge(ot,ye)}else if(!V&&K)Dt=new Date(xt.getTime()+60*60*1e3);else{const st=ot||new Date(X);st.setHours(23,59,59,0),Dt=ge(st,ye)}let Ot;if(f&&(Ot=fn(f),!Ot))return u.push({row:e,field:"organization",message:`Unknown organization: "${f}"`}),{event:null,errors:u};if(Z&&Z.length>255)return u.push({row:e,field:"location",message:"Location cannot exceed 255 characters"}),{event:null,errors:u};const Ct={};if(Ot){Ct.organization=Ot;const st=ra[Ot];st&&(Ct.organization_label=st)}return{event:{title:x,event_type:"calendar_event",start_time:xt.toISOString(),end_time:Dt.toISOString(),is_all_day:V,is_public:!0,is_published:!1,meta_data:Ct,...B?{description:B}:{},...Z?{location:Z}:{}},errors:[]}}async function En(g,d){const e={success:0,validationErrors:0,errors:[]},u=[];for(let K=0;K<g.length;K++){const{event:G,errors:mt}=hn(g[K],d,K+1);if(mt.length>0){e.validationErrors++,e.errors.push(...mt);continue}G&&u.push(G)}const x=ke(),B=x?Ne(x.stores.currentUser):void 0,rt=x?Ne(x.stores.userOrganizations):void 0;if(B){const K=B.displayName||B.username,G=B.id,mt=rt?Array.from(rt):[],Z=new Date().toISOString();for(const f of u){const j=f.meta_data||{};K&&(j.submitted_by_name=K),G&&(j.submitted_by_user_id=G),mt.length&&(j.submitted_by_organizations=mt),j.submitted_at=Z,f.meta_data=j}}return u.length>0&&(await $a(u),e.success=u.length),e}function xn(){const g=fa({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null});return{state:g,parseCsvFile:bn,autoDetectMappings:yn,importEvents:En,reset:()=>g.set({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null})}}var wn=m(`<p class="text-muted small mb-3">Upload a CSV file to bulk-import calendar events. Need a starting point? <a href="/sample-events.csv" download="">Download sample CSV template</a>.</p> <div class="mb-3"><label for="csvFile" class="form-label">Select CSV File</label> <input type="file" class="form-control" id="csvFile" accept=".csv"/></div> <div class="alert alert-warning small mb-3 d-flex align-items-start gap-2"><i class="bi bi-info-circle mt-1"></i> <span>All imported events require <strong>bishopric approval</strong> before they appear on the
							public calendar.</span></div> <div class="alert alert-info small mb-0"><strong>Format Guide:</strong> <ul class="mb-0 mt-1"><li><strong>Required columns:</strong> Title, Date</li> <li><strong>Optional columns:</strong> Start Time, End Time, Location, Category, Description</li> <li>Dates: YYYY-MM-DD, MM/DD/YYYY, Jan 1, 2025, etc.</li> <li>Times: 7:00 PM, 19:00, etc. (omit for all-day events)</li> <li>Categories: Ward, Relief Society, Elders Quorum, Youth, Young Women, Young Men,
								Primary, etc.</li></ul></div>`,1),kn=m('<tr><td> </td><td><select class="form-select form-select-sm"><option>-- Skip --</option><option>Title</option><option>Description</option><option>Start Date</option><option>Start Time</option><option>End Date</option><option>End Time</option><option>Location</option><option>Category</option><option>All Day</option></select></td></tr>'),Mn=m('<h6>Map CSV Columns to Event Fields</h6> <p class="text-muted"> </p> <table class="table table-sm"><thead><tr><th>CSV Column</th><th>Maps To</th></tr></thead><tbody></tbody></table>',1),Dn=m('<div class="text-center py-5"><!> <p class="mt-3">Importing events...</p></div>'),On=m("<li><strong> </strong> rows had validation errors</li>"),Cn=m(`<div class="alert alert-info small">Imported events are <strong>unpublished</strong> and will need bishopric approval before
							they appear on the public calendar.</div>`),In=m("<li> </li>"),$n=m("<li><em> </em></li>"),An=m('<div class="alert alert-warning"><h6>Validation Errors:</h6> <ul class="mb-0" style="max-height: 200px; overflow-y: auto;"><!> <!></ul></div>'),Sn=m('<div class="alert alert-success"><h6>Import Complete</h6> <ul class="mb-0"><li><strong> </strong> events imported successfully</li> <!></ul></div> <!> <!>',1),Tn=m('<button type="button" class="btn btn-secondary">Cancel</button>'),zn=m('<button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary"> </button>',1),Fn=m('<button type="button" class="btn btn-secondary" disabled>Cancel</button> <button type="button" class="btn btn-primary" disabled><!> Importing...</button>',1),Rn=m('<button type="button" class="btn btn-primary">Done</button>'),Un=m('<div class="modal-backdrop fade show"></div>'),Pn=m('<div tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Import Events from CSV</h5> <button type="button" class="btn-close" aria-label="Close import modal"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><!></div></div></div></div> <!>',1);function Ln(g,d){_e(d,!1);const e=()=>wt(G,"$state",u),[u,x]=Fe();let B=Ut(d,"isOpen",8,!1),rt=Ut(d,"onClose",8),K=Ut(d,"onComplete",8);const{state:G,parseCsvFile:mt,autoDetectMappings:Z,importEvents:f,reset:j}=xn();async function X(Y){const J=Y.target.files?.[0];if(J)try{const{data:bt,columns:_t}=await mt(J),zt=Z(_t);G.update(it=>({...it,step:"mapping",csvData:bt,csvColumns:_t,columnMappings:zt}))}catch(bt){console.error("Failed to parse CSV:",bt),alert("Failed to parse CSV file. Please check the file format.")}}async function V(){G.update(Y=>({...Y,step:"importing"}));try{const Y=await f(e().csvData,e().columnMappings);G.update(J=>({...J,step:"complete",importResult:Y})),K()()}catch(Y){console.error("Failed to import events:",Y),alert("Failed to import events. Please try again."),G.update(J=>({...J,step:"mapping"}))}}function xt(){j(),rt()()}fe();var Dt=Pn(),ot=dt(Dt);let Ot;var Ct=r(ot),Nt=r(Ct),st=r(Nt),Zt=s(r(st),2);Zt.__click=xt,a(st);var Vt=s(st,2),Pt=r(Vt);{var kt=Y=>{var J=wn(),bt=s(dt(J),2),_t=s(r(bt),2);_t.__change=X,a(bt),ue(4),i(Y,J)},Qt=Y=>{var J=Bt(),bt=dt(J);{var _t=it=>{var h=Mn(),w=s(dt(h),2),T=r(w);a(w);var H=s(w,2),z=s(r(H));ae(z,5,()=>(e(),n(()=>e().columnMappings)),xe,(L,l,b)=>{var o=kn(),E=r(o),M=r(E,!0);a(E);var Q=s(E),R=r(Q);A(()=>{t(l),Ve(()=>{})});var C=r(R);C.value=(C.__value=null)??"";var c=s(C);c.value=c.__value="title";var p=s(c);p.value=p.__value="description";var O=s(p);O.value=O.__value="start_date";var W=s(O);W.value=W.__value="start_time";var N=s(W);N.value=N.__value="end_date";var v=s(N);v.value=v.__value="end_time";var k=s(v);k.value=k.__value="location";var I=s(k);I.value=I.__value="category";var tt=s(I);tt.value=tt.__value="is_all_day",a(R),a(Q),a(o),A(()=>P(M,(t(l),n(()=>t(l).csvColumn)))),Ma(R,()=>t(l).eventField,at=>(t(l).eventField=at,Ve(()=>e()),wa(u,"$state"))),i(L,o)}),a(z),a(H),A(()=>P(T,`Found ${e(),n(()=>e().csvData.length)??""} rows in CSV`)),i(it,h)},zt=it=>{var h=Bt(),w=dt(h);{var T=z=>{var L=Dn(),l=r(L);Oe(l,{}),ue(2),a(L),i(z,L)},H=z=>{var L=Bt(),l=dt(L);{var b=o=>{var E=Sn(),M=dt(E),Q=s(r(M),2),R=r(Q),C=r(R),c=r(C,!0);a(C),ue(),a(R);var p=s(R,2);{var O=I=>{var tt=On(),at=r(tt),pt=r(at,!0);a(at),ue(),a(tt),A(()=>P(pt,(e(),n(()=>e().importResult.validationErrors)))),i(I,tt)};y(p,I=>{e(),n(()=>e().importResult?.validationErrors&&e().importResult.validationErrors>0)&&I(O)})}a(Q),a(M);var W=s(M,2);{var N=I=>{var tt=Cn();i(I,tt)};y(W,I=>{e(),n(()=>e().importResult?.success&&e().importResult.success>0)&&I(N)})}var v=s(W,2);{var k=I=>{var tt=An(),at=s(r(tt),2),pt=r(at);ae(pt,1,()=>(e(),n(()=>e().importResult.errors.slice(0,10))),xe,(Ft,$)=>{var S=In(),U=r(S);a(S),A(()=>P(U,`Row ${t($),n(()=>t($).row)??""}: ${t($),n(()=>t($).message)??""}`)),i(Ft,S)});var Jt=s(pt,2);{var Xt=Ft=>{var $=$n(),S=r($),U=r(S);a(S),a($),A(()=>P(U,`... and ${e(),n(()=>e().importResult.errors.length-10)??""} more errors`)),i(Ft,$)};y(Jt,Ft=>{e(),n(()=>e().importResult.errors.length>10)&&Ft(Xt)})}a(at),a(tt),i(I,tt)};y(v,I=>{e(),n(()=>e().importResult?.errors&&e().importResult.errors.length>0)&&I(k)})}A(()=>P(c,(e(),n(()=>e().importResult?.success||0)))),i(o,E)};y(l,o=>{e(),n(()=>e().step==="complete")&&o(b)},!0)}i(z,L)};y(w,z=>{e(),n(()=>e().step==="importing")?z(T):z(H,!1)},!0)}i(it,h)};y(bt,it=>{e(),n(()=>e().step==="mapping")?it(_t):it(zt,!1)},!0)}i(Y,J)};y(Pt,Y=>{e(),n(()=>e().step==="upload")?Y(kt):Y(Qt,!1)})}a(Vt);var Kt=s(Vt,2),St=r(Kt);{var Yt=Y=>{var J=Tn();J.__click=xt,i(Y,J)},Lt=Y=>{var J=Bt(),bt=dt(J);{var _t=it=>{var h=zn(),w=dt(h);w.__click=xt;var T=s(w,2);T.__click=V;var H=r(T);a(T),A(()=>P(H,`Import ${e(),n(()=>e().csvData.length)??""} Events`)),i(it,h)},zt=it=>{var h=Bt(),w=dt(h);{var T=z=>{var L=Fn(),l=s(dt(L),2),b=r(l);Oe(b,{size:"sm"}),ue(),a(l),i(z,L)},H=z=>{var L=Bt(),l=dt(L);{var b=o=>{var E=Rn();E.__click=xt,i(o,E)};y(l,o=>{e(),n(()=>e().step==="complete")&&o(b)},!0)}i(z,L)};y(w,z=>{e(),n(()=>e().step==="importing")?z(T):z(H,!1)},!0)}i(it,h)};y(bt,it=>{e(),n(()=>e().step==="mapping")?it(_t):it(zt,!1)},!0)}i(Y,J)};y(St,Y=>{e(),n(()=>e().step==="upload")?Y(Yt):Y(Lt,!1)})}a(Kt),a(Nt),a(Ct),a(ot);var Mt=s(ot,2);{var Tt=Y=>{var J=Un();i(Y,J)};y(Mt,Y=>{B()&&Y(Tt)})}A(()=>{Ot=ne(ot,1,"modal fade",null,Ot,{show:B()}),ka(ot,`display: ${B()?"block":"none"}`)}),i(g,Dt),pe(),x()}xa(["click","change"]);var Bn=m("<option> </option>"),Nn=m('<select class="form-select form-select-sm organization-filter svelte-14mpkul" aria-label="Filter calendar by organization"><option>All Organizations</option><!></select>'),Vn=m('<div class="calendar-day-header svelte-14mpkul"><span class="d-none d-md-inline"> </span> <span class="d-md-none"> </span></div>'),Yn=m('<button type="button"><span class="event-title svelte-14mpkul"> </span></button>'),Hn=m('<div class="more-events svelte-14mpkul"> </div>'),Kn=m('<div role="button" tabindex="0"><div class="day-number svelte-14mpkul"> </div> <div class="day-events svelte-14mpkul"><!> <!></div></div>'),Wn=m("<span> </span>"),qn=m('<span class="badge bg-secondary">All Day</span>'),jn=m('<span class="event-time svelte-14mpkul"> </span>'),Qn=m('<span class="event-location svelte-14mpkul"><i class="bi bi-geo-alt"></i> </span>'),Jn=m('<div class="event-thumbnail-container svelte-14mpkul"><img class="event-thumbnail svelte-14mpkul"/></div>'),Gn=m('<div class="event-actions svelte-14mpkul"><button type="button" class="btn btn-sm btn-primary" title="Edit event"><i class="bi bi-pencil"></i></button></div>'),Zn=m('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="event-details-button svelte-14mpkul"><div class="event-title-full svelte-14mpkul"> </div> <div class="event-meta svelte-14mpkul"><!> <!> <!></div></button> <!> <!></li>'),Xn=m('<div class="card mt-3"><div class="card-header d-flex justify-content-between align-items-center"><h6 class="mb-0 fw-semibold"> </h6> <button type="button" class="btn btn-sm btn-primary" aria-label="Close"><i class="bi bi-x-lg"></i></button></div> <ul class="list-group list-group-flush"></ul></div>'),tr=m('<div class="month-calendar svelte-14mpkul"><div class="calendar-header svelte-14mpkul"><h5 class="month-title svelte-14mpkul"> </h5> <div class="calendar-controls svelte-14mpkul"><div class="calendar-nav svelte-14mpkul"><button type="button" class="btn btn-sm btn-primary" aria-label="Previous month"><i class="bi bi-chevron-left"></i></button> <button type="button" class="btn btn-sm btn-primary" aria-label="Go to today">Today</button> <button type="button" class="btn btn-sm btn-primary" aria-label="Next month"><i class="bi bi-chevron-right"></i></button></div> <!></div></div> <div class="calendar-grid svelte-14mpkul"><!> <!></div> <!></div>');function er(g,d){_e(d,!1);const e=F(),u=F(),x=F(),B=F();let rt=Ut(d,"events",24,()=>[]),K=Ut(d,"onEventClick",8,()=>{}),G=Ut(d,"onEventEdit",8,null),mt=Ut(d,"canEditEvent",8,null),Z=Ut(d,"organizationFilter",8,""),f=Ut(d,"onOrganizationFilterChange",8,()=>{}),j=Ut(d,"availableOrganizations",24,()=>[]),X=F(new Date),V=F(null);const xt=h=>{t(V)&&Ee(t(V),h)?D(V,null):D(V,h)},Dt=()=>{D(X,new Date)},ot=()=>{D(X,Pa(t(X)))},Ot=()=>{D(X,ea(t(X),1))},Ct=h=>{const w=ut(h,"yyyy-MM-dd");return t(B)[w]||[]},Nt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],st=["S","M","T","W","T","F","S"],Zt=h=>h.startsWith("image/");q(()=>t(V),()=>{D(e,t(V)?Ct(t(V)):[])}),q(()=>(t(e),ht),()=>{D(u,t(e).slice().sort((h,w)=>{const T=h.is_all_day?0:1,H=w.is_all_day?0:1;if(T!==H)return T-H;const z=h.start_time?ht(h.start_time).getTime():0,L=w.start_time?ht(w.start_time).getTime():0;return z-L}))}),q(()=>(t(X),Ke),()=>{D(x,(()=>{const h=Ua(t(X)),w=za(t(X)),T=Ia(h,{weekStartsOn:0}),H=Fa(w,{weekStartsOn:0}),z=[];let L=T;for(;L<=H;)z.push(L),L=Ke(L,1);return z})())}),q(()=>(_(rt()),ut),()=>{D(B,rt().reduce((h,w)=>{if(!w.start_time)return h;const T=ht(w.start_time),H=ut(T,"yyyy-MM-dd");return h[H]||(h[H]=[]),h[H].push(w),h},{}))}),$e(),fe();var Vt=tr(),Pt=r(Vt),kt=r(Pt),Qt=r(kt,!0);a(kt);var Kt=s(kt,2),St=r(Kt),Yt=r(St),Lt=s(Yt,2),Mt=s(Lt,2);a(St);var Tt=s(St,2);{var Y=h=>{var w=Nn(),T=r(w);T.value=T.__value="";var H=s(T);ae(H,1,j,xe,(L,l)=>{var b=Bn(),o=r(b,!0);a(b);var E={};A(()=>{P(o,(t(l),n(()=>t(l).label))),E!==(E=(t(l),n(()=>t(l).key)))&&(b.value=(b.__value=(t(l),n(()=>t(l).key)))??"")}),i(L,b)}),a(w);var z;Da(w),A(()=>{z!==(z=Z())&&(w.value=(w.__value=Z())??"",Oa(w,Z()))}),gt("change",w,L=>f()(L.currentTarget.value)),i(h,w)};y(Tt,h=>{_(j()),n(()=>j().length>0)&&h(Y)})}a(Kt),a(Pt);var J=s(Pt,2),bt=r(J);ae(bt,1,()=>Nt,xe,(h,w,T)=>{var H=Vn(),z=r(H),L=r(z,!0);a(z);var l=s(z,2),b=r(l,!0);a(l),a(H),A(()=>{P(L,t(w)),P(b,n(()=>st[T]))}),i(h,H)});var _t=s(bt,2);ae(_t,1,()=>t(x),h=>ut(h,"yyyy-MM-dd"),(h,w)=>{const T=jt(()=>(t(w),n(()=>Ct(t(w))))),H=jt(()=>(_(We),t(w),t(X),n(()=>We(t(w),t(X))))),z=jt(()=>(_(qe),t(w),n(()=>qe(t(w))))),L=jt(()=>(t(V),_(Ee),t(w),n(()=>t(V)&&Ee(t(V),t(w)))));var l=Kn();let b;var o=r(l),E=r(o,!0);a(o);var M=s(o,2),Q=r(M);ae(Q,1,()=>(_(t(T)),n(()=>t(T).slice(0,3))),c=>c.id??c.start_time,(c,p)=>{var O=Yn(),W=r(O),N=r(W,!0);a(W),a(O),A(v=>{ne(O,1,`event-badge bg-color-${v??""}`,"svelte-14mpkul"),$t(O,"title",(t(p),n(()=>t(p).title))),P(N,(t(p),n(()=>t(p).title)))},[()=>(_(Gt),t(p),n(()=>Gt(t(p)?.meta_data?.organization??"")?.color_number??0))]),gt("click",O,De(()=>K()(t(p)))),i(c,O)});var R=s(Q,2);{var C=c=>{var p=Hn(),O=r(p);a(p),A(()=>P(O,`+${_(t(T)),n(()=>t(T).length-3)??""} more`)),i(c,p)};y(R,c=>{_(t(T)),n(()=>t(T).length>3)&&c(C)})}a(M),a(l),A(c=>{b=ne(l,1,"calendar-day svelte-14mpkul",null,b,{"other-month":!t(H),today:t(z),selected:t(L),"has-events":t(T).length>0}),P(E,c)},[()=>(_(ut),t(w),n(()=>ut(t(w),"d")))]),gt("click",l,()=>xt(t(w))),gt("keydown",l,c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),xt(t(w)))}),i(h,l)}),a(J);var zt=s(J,2);{var it=h=>{var w=Xn(),T=r(w),H=r(T),z=r(H,!0);a(H);var L=s(H,2);a(T);var l=s(T,2);ae(l,5,()=>t(u),b=>b.id??b.start_time,(b,o)=>{const E=jt(()=>(t(o),n(()=>t(o).attachments?.find($=>Zt($.type))))),M=jt(()=>(_(Gt),t(o),n(()=>Gt(t(o)?.meta_data?.organization??""))));var Q=Zn(),R=r(Q),C=s(R,2),c=r(C),p=r(c,!0);a(c);var O=s(c,2),W=r(O);{var N=$=>{var S=Wn(),U=r(S,!0);a(S),A(()=>{ne(S,1,`badge rounded-pill bg-color-${_(t(M)),n(()=>t(M).color_number)??""}`,"svelte-14mpkul"),P(U,(_(t(M)),n(()=>t(M).label)))}),i($,S)};y(W,$=>{_(t(M)),n(()=>t(M)?.label)&&$(N)})}var v=s(W,2);{var k=$=>{var S=qn();i($,S)},I=$=>{var S=Bt(),U=dt(S);{var yt=et=>{var vt=jn(),Wt=r(vt,!0);a(vt),A(It=>P(Wt,It),[()=>(_(ut),_(ht),t(o),n(()=>ut(ht(t(o).start_time),"h:mm a")))]),i(et,vt)};y(U,et=>{t(o),n(()=>t(o).start_time)&&et(yt)},!0)}i($,S)};y(v,$=>{t(o),n(()=>t(o).is_all_day)?$(k):$(I,!1)})}var tt=s(v,2);{var at=$=>{var S=Qn(),U=s(r(S));a(S),A(()=>P(U,` ${t(o),n(()=>t(o).location)??""}`)),i($,S)};y(tt,$=>{t(o),n(()=>t(o).location)&&$(at)})}a(O),a(C);var pt=s(C,2);{var Jt=$=>{var S=Jn(),U=r(S);a(S),A(()=>{$t(U,"src",(_(t(E)),n(()=>t(E).url))),$t(U,"alt",(_(t(E)),n(()=>t(E).name)))}),i($,S)};y(pt,$=>{t(E)&&$(Jt)})}var Xt=s(pt,2);{var Ft=$=>{var S=Gn(),U=r(S);a(S),gt("click",U,De(()=>G()&&G()(t(o)))),i($,S)};y(Xt,$=>{_(mt()),_(G()),t(o),n(()=>mt()&&G()&&mt()(t(o)))&&$(Ft)})}a(Q),A(()=>{ne(R,1,`event-color-indicator bg-color-${_(t(M)),n(()=>t(M)?.color_number??0)??""}`,"svelte-14mpkul"),P(p,(t(o),n(()=>t(o).title)))}),gt("click",C,()=>K()(t(o))),i(b,Q)}),a(l),a(w),A(b=>P(z,b),[()=>(_(ut),t(V),n(()=>ut(t(V),"EEEE, MMMM d, yyyy")))]),gt("click",L,()=>D(V,null)),i(h,w)};y(zt,h=>{t(V),t(e),n(()=>t(V)&&t(e).length>0)&&h(it)})}a(Vt),A(h=>P(Qt,h),[()=>(_(ut),t(X),n(()=>ut(t(X),"MMMM yyyy")))]),gt("click",Yt,ot),gt("click",Lt,Dt),gt("click",Mt,Ot),i(g,Vt),pe()}var ar=m('<div class="dropdown"><button class="btn btn-sm btn-primary dropdown-toggle" type="button" id="addEventDropdown" data-bs-toggle="dropdown" aria-label="Add event actions" aria-expanded="false"><i class="bi bi-plus"></i> <span class="d-none d-md-inline ms-1">Add Event</span></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="addEventDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-calendar-plus me-2"></i>Create Event</button></li> <li><button class="dropdown-item" type="button"><i class="bi bi-file-earmark-arrow-up me-2"></i>Import CSV</button></li></ul></div>'),nr=m("<span> </span>"),rr=m('<span class="event-date svelte-1p8xa6u"> </span>'),sr=m('<span class="badge bg-secondary">All Day</span>'),or=m('<span class="event-time svelte-1p8xa6u"> </span>'),ir=m('<span class="event-location svelte-1p8xa6u"><i class="bi bi-geo-alt"></i> <!></span>'),lr=m('<div class="event-thumbnail-container svelte-1p8xa6u"><img class="event-thumbnail svelte-1p8xa6u"/></div>'),vr=m('<div class="event-actions svelte-1p8xa6u"><button type="button" class="btn btn-sm btn-primary" title="Edit event"><i class="bi bi-pencil"></i></button></div>'),cr=m('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="event-details-button svelte-1p8xa6u"><div class="event-title-full svelte-1p8xa6u"><!></div> <div class="event-meta svelte-1p8xa6u"><!> <!> <!> <!></div></button> <!> <!></li>'),dr=m('<div class="search-results svelte-1p8xa6u"><div class="search-results-header svelte-1p8xa6u"><h6 class="search-results-title svelte-1p8xa6u"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),ur=m('<div class="search-no-results svelte-1p8xa6u"> </div>'),mr=m("<!> <!>",1),_r=m('<div class="no-events svelte-1p8xa6u"><!></div>'),pr=m('<div class="d-flex flex-column gap-2"><div class="calendar-header svelte-1p8xa6u"><h2 class="calendar-title svelte-1p8xa6u">Events</h2> <div class="calendar-actions svelte-1p8xa6u"><!></div></div> <!></div>'),fr=m('<div class="d-flex flex-column gap-4"><!></div>'),br=m("<!> <!> <!> <!>",1);function Vr(g,d){_e(d,!1);const e=()=>wt(Kt,"$dbData",j),u=()=>wt(Yt,"$authenticated",j),x=()=>wt(Qt,"$searchQuery",j),B=()=>wt(Ct,"$currentUser",j),rt=()=>wt(Vt,"$userOrganizations",j),K=()=>wt(Nt,"$currentUserHasPermission",j),G=()=>wt(Zt,"$currentUserIsRoot",j),mt=()=>wt(st,"$currentUserIsAdmin",j),Z=()=>wt(Pt,"$ready",j),f=()=>wt(kt,"$calendarEvents",j),[j,X]=Fe(),V=F(),xt=F(),Dt=F(),ot=F(),Ot=F(),{stores:{currentUser:Ct,currentUserHasPermission:Nt,currentUserIsAdmin:st,currentUserIsRoot:Zt,userOrganizations:Vt}}=ke(),{stores:{ready:Pt,calendarEvents:kt,searchQuery:Qt,dbData:Kt},actions:{reload:St}}=Xe(),{stores:{authenticated:Yt}}=ke(),Lt={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let Mt=Ut(d,"formId",24,Ce),Tt=Ut(d,"detailsId",24,Ce),Y=F(!1),J=F(!1),bt=F(),_t=F(!1),zt=F(!1),it=F(new Set),h=F(""),w=F({...Lt}),T=F({...Lt}),H=F(!1),z=F("");const L=v=>Ze(v,{currentUserId:t(bt),isPrivileged:t(J),canEditOwnOrgEvents:t(zt),userOrganizations:t(it)}),l=v=>v.startsWith("image/");function b(){St()}Je(async()=>{await St()});const o=async v=>{if(D(h,"Item Form"),v?.meta_data?.recurring_instance&&v?.meta_data?.recurring_parent_id){const{getCalendarEvent:k}=await He(async()=>{const{getCalendarEvent:tt}=await import("./BcO7X4Pb.js").then(at=>at.x);return{getCalendarEvent:tt}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),I=await k(v.meta_data.recurring_parent_id);if(I){D(w,{...I,organization:I?.meta_data?.organization,start_time:v.start_time,end_time:v.end_time,meta_data:{...I.meta_data,recurring_instance:!0,recurring_parent_id:v.meta_data.recurring_parent_id,recurring_instance_index:v.meta_data.recurring_instance_index}});return}}D(w,{...v,organization:v?.meta_data?.organization})},E=async v=>{if(v?.meta_data?.recurring_instance&&v?.meta_data?.recurring_parent_id){const{getCalendarEvent:I}=await He(async()=>{const{getCalendarEvent:at}=await import("./BcO7X4Pb.js").then(pt=>pt.x);return{getCalendarEvent:at}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),tt=await I(v.meta_data.recurring_parent_id);tt?D(T,{...tt,start_time:v.start_time,end_time:v.end_time,meta_data:{...tt.meta_data,recurring_instance:!0,recurring_parent_id:v.meta_data.recurring_parent_id,recurring_instance_index:v.meta_data.recurring_instance_index}}):D(T,v)}else D(T,v);const k=document.getElementById(Tt());k&&new window.bootstrap.Offcanvas(k).show()},M=async v=>{await o(v);const k=document.getElementById(Mt());k&&new window.bootstrap.Offcanvas(k).show()},Q=async()=>{const v=document.getElementById(Tt());if(v){const k=window.bootstrap.Offcanvas.getInstance(v);k&&k.hide()}await o(t(T)),setTimeout(()=>{const k=document.getElementById(Mt());k&&new window.bootstrap.Offcanvas(k).show()},300)};q(()=>(e(),u(),ht),()=>{D(V,(e()??[]).filter(v=>v.event_type==="calendar_event").filter(v=>!(!v.is_published||!u()&&v.is_public===!1)).filter(v=>{if(!v.start_time)return!1;const k=ht(v.start_time),I=new Date;return I.setHours(0,0,0,0),k>=I}))}),q(()=>(t(V),Gt),()=>{D(xt,(()=>{const v=new Set(t(V).filter(k=>k?.meta_data?.organization).map(k=>k.meta_data?.organization).filter(k=>k));return Array.from(v).map(k=>Gt(k||"")).filter(k=>k!==void 0).sort((k,I)=>k.sort_index-I.sort_index)})())}),q(()=>(t(z),t(V)),()=>{D(Dt,t(z)?t(V).filter(v=>v?.meta_data?.organization===t(z)):t(V))}),q(()=>(x(),t(V)),()=>{D(ot,x()?t(V).filter(v=>{const k=x().toLowerCase(),I=(v.title||"").toLowerCase(),tt=(v.description||"").replace(/<[^>]*>/g,"").toLowerCase(),at=(v.location||"").toLowerCase();return I.includes(k)||tt.includes(k)||at.includes(k)}):[])}),q(()=>B(),()=>{D(bt,B()?.id)}),q(()=>rt(),()=>{D(it,rt())}),q(()=>(t(it),Me),()=>{D(_t,t(it).has(Me.Bishopric))}),q(()=>(K(),Rt),()=>{D(zt,K()(Rt.EditOwnOrgEvents))}),q(()=>(G(),mt(),t(_t),K(),Rt),()=>{D(J,G()||mt()||t(_t)||K()(Rt.EditAllEvents))}),q(()=>(K(),Rt),()=>{D(Y,K()(Rt.CreateEvents))}),q(()=>(K(),Rt),()=>{D(Ot,K()(Rt.DeleteEvents))}),$e(),fe();var R=br(),C=dt(R);Ie(C,{get title(){return t(h)},get id(){return Mt()},children:(v,k)=>{Ge(v,{get eventItem(){return t(w)},get drawerId(){return Mt()},name:"event-item-form",get canDelete(){return t(Ot)}})},$$slots:{default:!0}});var c=s(C,2);Ie(c,{title:"Event Details",get id(){return Tt()},children:(v,k)=>{{let I=jt(()=>(t(T),n(()=>L(t(T)))));aa(v,{get event(){return t(T)},get canEdit(){return t(I)},onEdit:Q})}},$$slots:{default:!0}});var p=s(c,2);Ln(p,{get isOpen(){return t(H)},onClose:()=>D(H,!1),onComplete:b});var O=s(p,2);{var W=v=>{var k=pr(),I=r(k),tt=s(r(I),2),at=r(tt);{var pt=$=>{var S=ar(),U=s(r(S),2),yt=r(U),et=r(yt);a(yt);var vt=s(yt,2),Wt=r(vt);a(vt),a(U),a(S),A(()=>{$t(et,"data-bs-target",`#${Mt()??""}`),$t(et,"aria-controls",Mt())}),gt("click",et,()=>o({...Lt,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})),gt("click",Wt,()=>D(H,!0)),i($,S)};y(at,$=>{t(Y)&&$(pt)})}a(tt),a(I);var Jt=s(I,2);{var Xt=$=>{var S=mr(),U=dt(S);{var yt=It=>{var Ht=Bt(),re=dt(Ht);Ra(re,()=>t(z),se=>{er(se,{get events(){return t(Dt)},onEventClick:At=>E(At),onEventEdit:At=>M(At),canEditEvent:At=>L(At),get organizationFilter(){return t(z)},onOrganizationFilterChange:At=>D(z,At),get availableOrganizations(){return t(xt)}})}),i(It,Ht)};y(U,It=>{x()||It(yt)})}var et=s(U,2);{var vt=It=>{var Ht=dr(),re=r(Ht),se=r(re),At=r(se);a(se),a(re);var le=s(re,2);ae(le,5,()=>t(ot),ve=>ve.id??ve.start_time,(ve,lt)=>{const ce=jt(()=>(t(lt),n(()=>t(lt).attachments?.find(nt=>l(nt.type))))),te=jt(()=>(_(Gt),t(lt),n(()=>Gt(t(lt)?.meta_data?.organization??""))));var de=cr(),be=r(de),ft=s(be,2),Et=r(ft),ee=r(Et);ze(ee,()=>(_(he),t(lt),x(),n(()=>he(t(lt).title,x())))),a(Et);var Re=s(Et,2),Ue=r(Re);{var sa=nt=>{var ct=nr(),qt=r(ct,!0);a(ct),A(()=>{ne(ct,1,`badge rounded-pill bg-color-${_(t(te)),n(()=>t(te).color_number)??""}`,"svelte-1p8xa6u"),P(qt,(_(t(te)),n(()=>t(te).label)))}),i(nt,ct)};y(Ue,nt=>{_(t(te)),n(()=>t(te)?.label)&&nt(sa)})}var Pe=s(Ue,2);{var oa=nt=>{var ct=rr(),qt=r(ct,!0);a(ct),A(Ae=>P(qt,Ae),[()=>(_(ut),_(ht),t(lt),n(()=>ut(ht(t(lt).start_time),"MMM d, yyyy")))]),i(nt,ct)};y(Pe,nt=>{t(lt),n(()=>t(lt).start_time)&&nt(oa)})}var Le=s(Pe,2);{var ia=nt=>{var ct=sr();i(nt,ct)},la=nt=>{var ct=Bt(),qt=dt(ct);{var Ae=Se=>{var Te=or(),_a=r(Te,!0);a(Te),A(pa=>P(_a,pa),[()=>(_(ut),_(ht),t(lt),n(()=>ut(ht(t(lt).start_time),"h:mm a")))]),i(Se,Te)};y(qt,Se=>{t(lt),n(()=>t(lt).start_time)&&Se(Ae)},!0)}i(nt,ct)};y(Le,nt=>{t(lt),n(()=>t(lt).is_all_day)?nt(ia):nt(la,!1)})}var va=s(Le,2);{var ca=nt=>{var ct=ir(),qt=s(r(ct),2);ze(qt,()=>(_(he),t(lt),x(),n(()=>he(t(lt).location,x())))),a(ct),i(nt,ct)};y(va,nt=>{t(lt),n(()=>t(lt).location)&&nt(ca)})}a(Re),a(ft);var Be=s(ft,2);{var da=nt=>{var ct=lr(),qt=r(ct);a(ct),A(()=>{$t(qt,"src",(_(t(ce)),n(()=>t(ce).url))),$t(qt,"alt",(_(t(ce)),n(()=>t(ce).name)))}),i(nt,ct)};y(Be,nt=>{t(ce)&&nt(da)})}var ua=s(Be,2);{var ma=nt=>{var ct=vr(),qt=r(ct);a(ct),gt("click",qt,De(()=>M(t(lt)))),i(nt,ct)};y(ua,nt=>{t(lt),n(()=>L(t(lt)))&&nt(ma)})}a(de),A(()=>ne(be,1,`event-color-indicator bg-color-${_(t(te)),n(()=>t(te)?.color_number??0)??""}`,"svelte-1p8xa6u")),gt("click",ft,()=>E(t(lt))),i(ve,de)}),a(le),a(Ht),A(()=>P(At,`${t(ot),n(()=>t(ot).length)??""} event${t(ot),n(()=>t(ot).length===1?"":"s")??""} matching "${x()??""}"`)),i(It,Ht)},Wt=It=>{var Ht=Bt(),re=dt(Ht);{var se=At=>{var le=ur(),ve=r(le);a(le),A(()=>P(ve,`No events match your search for "${x()??""}"`)),i(At,le)};y(re,At=>{x()&&At(se)},!0)}i(It,Ht)};y(et,It=>{x(),t(ot),n(()=>x()&&t(ot).length>0)?It(vt):It(Wt,!1)})}i($,S)},Ft=$=>{var S=_r(),U=r(S);{var yt=vt=>{var Wt=ie("No events match your search.");i(vt,Wt)},et=vt=>{var Wt=ie("There are no upcoming events scheduled.");i(vt,Wt)};y(U,vt=>{x()?vt(yt):vt(et,!1)})}a(S),i($,S)};y(Jt,$=>{f(),n(()=>f()?.length)?$(Xt):$(Ft,!1)})}a(k),i(v,k)},N=v=>{var k=fr(),I=r(k);Oe(I,{}),a(k),i(v,k)};y(O,v=>{Z()?v(W):v(N,!1)})}i(g,R),pe(),X()}export{Nr as A,aa as C,Vr as E,Ua as s};
