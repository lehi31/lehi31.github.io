const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./9OwWMZAP.js","./SWWSvUpQ.js","./DIeogL5L.js","./D8ekX_8E.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./WW5OsAH7.js","./CU3XCoqN.js","./YJAcq9su.js","./h5yPuqEw.js","./CpBQByPR.js","./BZp7QGtW.js","./BUApaBEI.js","./Bgyk9asy.js","./BkhfVKlj.js","../assets/Spinner.DTjfhZ6-.css","./DqFrpDF4.js","./mnkQx8ai.js","./CvxMDV_e.js","./Cc3l00Qu.js","./DG7soIoS.js","./CrScDWWM.js","./CcoMiQA1.js","./BMIVoN_G.js","./CX8HKnIi.js","../assets/BishopricApprovalSection.DRGo_BHg.css","./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{d as ar,o as Pa,g as rr}from"./WW5OsAH7.js";import{p as bt,ah as x,D as s,E as d,ai as Gt,c as a,s as n,r as t,u as r,m as e,a as mt,B as S,C as sr,f as Re,F as pa,R as Oe,aq as nr,n as k,ar as or}from"./SWWSvUpQ.js";import{f as l,a as i,c as Bt,t as fa}from"./D8ekX_8E.js";import{a as ee,i as m,k as Kt,b as ea,e as K,s as C,p as Je}from"./CU3XCoqN.js";import{i as gt}from"./Bgyk9asy.js";import{e as dt,i as Ca}from"./YJAcq9su.js";import{r as ja,b as ir,s as Ve,i as lr,c as cr,d as dr,e as vr}from"./h5yPuqEw.js";import{b as ur}from"./CvxMDV_e.js";import{e as _r,g as ta,i as pr,h as La,d as ca,b as Xt,a as da,j as va}from"./9OwWMZAP.js";import{s as za,C as fr,E as br,A as mr,a as gr}from"./BJR3uOsy.js";import{z as Ma,v as Ba,B as yr,e as ga,p as ue,i as Ie,O as ba,P as Ce,f as vt,C as Oa}from"./CpBQByPR.js";import{C as ma,E as hr,c as qa}from"./CtPwF8qd.js";import{S as Ha}from"./BkhfVKlj.js";import{v as Jt,D as Zt}from"./DqFrpDF4.js";import{s as ua}from"./CX8HKnIi.js";import{e as _a}from"./CcoMiQA1.js";import{_ as Ta}from"./CmsKOCeN.js";import{s as Qa}from"./CdEA5IGF.js";import{B as wr}from"./rUHyiZT6.js";import{R as Yt}from"./CrScDWWM.js";function Na(pe,M,T){const h=Ma(pe,T),z=Ma(M,T),re=+h-Ba(h),I=+z-Ba(z);return Math.round((re-I)/yr)}function xr(pe,M){return _r(pe,-M)}var Er=l('<button type="button" class="btn-clear-search svelte-14zxluq" aria-label="Clear search" title="Clear search"><i class="bi bi-x-lg"></i></button>'),kr=l("<option> </option>"),$r=l('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by organization"><option>All Organizations</option><!></select></div>'),Ar=l('<div class="col-12 col-md-auto"><button type="button" class="btn btn-primary w-100" aria-label="Clear all filters"><i class="bi bi-x-circle me-1"></i> Clear All</button></div>'),Dr=l('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><div class="search-input-wrapper svelte-14zxluq"><input type="text" class="form-control form-control" placeholder="Search..."/> <!></div></div> <!> <!></div></div>');function Sr(pe,M){bt(M,!1);const T=()=>ee(V,"$searchQuery",re),h=()=>ee(J,"$organizationFilter",re),z=()=>ee(E,"$currentOrganizations",re),[re,I]=ea(),X=d(),{stores:{currentOrganizations:E,organizationFilter:J,searchQuery:V}}=ta(),$=()=>{Kt(V,""),Kt(J,"")};x(()=>(T(),h()),()=>{s(X,!!(T()||h()))}),Gt(),gt();var te=Dr(),B=a(te),j=a(B),N=a(j),oe=a(N);ja(oe);var w=n(oe,2);{var ie=P=>{var O=Er();K("click",O,()=>Kt(V,"")),i(P,O)};m(w,P=>{T()&&P(ie)})}t(N),t(j);var Y=n(j,2);{var Z=P=>{var O=$r(),q=a(O);S(()=>{h(),sr(()=>{z()})});var se=a(q);se.value=se.__value="";var G=n(se);dt(G,1,z,Ca,(xe,Ee)=>{var Ue=kr(),Me=a(Ue,!0);t(Ue);var W={};S(()=>{C(Me,(e(Ee),r(()=>e(Ee).label))),W!==(W=(e(Ee),r(()=>e(Ee).key)))&&(Ue.value=(Ue.__value=(e(Ee),r(()=>e(Ee).key)))??"")}),i(xe,Ue)}),t(q),t(O),ir(q,h,xe=>Kt(J,xe)),i(P,O)};m(Y,P=>{z(),r(()=>z().length)&&P(Z)})}var we=n(Y,2);{var ze=P=>{var O=Ar(),q=a(O);t(O),K("click",q,$),i(P,O)};m(we,P=>{e(X)&&P(ze)})}t(B),t(te),ur(oe,T,P=>Kt(V,P)),i(pe,te),mt(),I()}var Ir=l('<p class="mb-0">No past events to delete.</p>'),Or=l('<p class="mb-2"><strong> </strong></p>'),Cr=l(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Mr=l("<!> <!>",1),Tr=l('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Pr(pe,M){bt(M,!1);let T=Je(M,"deleted",8),h=Je(M,"skipped",8),z=Je(M,"callback",8);function re(){z()()}gt();var I=Tr(),X=a(I),E=a(X),J=a(E),V=n(a(J),2);t(J);var $=n(J,2),te=a($);{var B=w=>{var ie=Ir();i(w,ie)},j=w=>{var ie=Mr(),Y=Re(ie);{var Z=P=>{var O=Or(),q=a(O),se=a(q);t(q),t(O),S(()=>C(se,`✓ Deleted ${T()??""} past event${T()===1?"":"s"}.`)),i(P,O)};m(Y,P=>{T()>0&&P(Z)})}var we=n(Y,2);{var ze=P=>{var O=Cr(),q=a(O),se=a(q),G=a(se);t(se),t(q),pa(2),t(O),S(()=>C(G,`⚠ Skipped ${h()??""} recurring event${h()===1?"":"s"}`)),i(P,O)};m(we,P=>{h()>0&&P(ze)})}i(w,ie)};m(te,w=>{T()===0&&h()===0?w(B):w(j,!1)})}t($);var N=n($,2),oe=a(N);t(N),t(E),t(X),t(I),K("click",V,re),K("click",oe,re),i(pe,I),mt()}var Rr=l(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Ur(pe,M){bt(M,!1);let T=Je(M,"cutoffDate",8),h=Je(M,"callback",8);function z(){h()(!0)}function re(){h()(!1)}gt();var I=Rr(),X=a(I),E=a(X),J=a(E),V=n(a(J),2);t(J);var $=n(J,2),te=a($),B=a(te),j=a(B);t(B),t(te),pa(2),t($);var N=n($,2),oe=a(N),w=n(oe,2);t(N),t(E),t(X),t(I),S(()=>C(j,`Are you sure you want to delete all events that occurred before ${T()??""}?`)),K("click",V,re),K("click",oe,re),K("click",w,z),i(pe,I),mt()}var Fr=l('<button class="btn btn-sm btn-primary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Lr=l('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),zr=l('<div class="d-flex align-items-center justify-content-end ms-auto"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),Br=l('<div class="d-flex flex-row align-items-start gap-3 w-100"><div class="flex-grow-1"><!></div> <!></div>'),Nr=l('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Wr=l('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),jr=l('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),qr=l('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),Hr=l('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),Qr=l('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Vr=l('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Kr=l('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Yr=l('<div class="card-body text-muted small">No past events available.</div>'),Xr=l('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-primary">Hide</button></div></div></div> <!></div>'),Jr=l('<div class="d-flex flex-column gap-4"><!></div>'),Zr=l("<!> <!> <!> <!>",1);function Gr(pe,M){bt(M,!1);const T=()=>ee(Ee,"$weeksExpanded",$),h=()=>ee(xt,"$allPastEvents",$),z=()=>ee(P,"$currentUser",$),re=()=>ee(se,"$userOrganizations",$),I=()=>ee(ze,"$currentUserHasPermission",$),X=()=>ee(q,"$currentUserIsRoot",$),E=()=>ee(O,"$currentUserIsAdmin",$),J=()=>ee(G,"$ready",$),V=()=>ee(Ue,"$searchQuery",$),[$,te]=ea(),B=d(),j=d(),N=d(),oe=d(),w=d(),ie=d(),Y=d(),Z=d(),we=d(),{stores:{currentUserHasPermission:ze,currentUser:P,currentUserIsAdmin:O,currentUserIsRoot:q,userOrganizations:se}}=ga(),{stores:{ready:G,dbData:xe,weeksExpanded:Ee,searchQuery:Ue},actions:{reload:Me}}=ta(),W={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let ne=Je(M,"formId",24,Jt),at=d(!1),Ke=d(!1),_e=d(),ut=d(!1),yt=d(!1),nt=d(!1),ot=d(new Set),rt=d(!1),Tt=d(""),Pt=d({...W}),ht=d(!1),c=d(""),y=d(!1),L=d({deleted:0,skipped:0});const H=4,fe=4;let be=d(H),je=d(!1);const f=ua();let Fe=d({});function Be(u){return e(B).includes(u)}function Rt(u){const p=e(Fe)[u]??Be(u);s(Fe,{...e(Fe),[u]:!p})}const wt=u=>{s(Tt,"Event Item"),s(Pt,{...u,organization:u?.meta_data?.organization??""})},xt=ar(xe,u=>{const p=ua();return(u??[]).filter(_=>!(_.event_type!=="calendar_event"||!_.start_time||ue(_.start_time)>=p||_.recurrence_rule&&(!_.recurrence_end_date||_.recurrence_end_date&&ue(_.recurrence_end_date)>=p)))}),it=u=>qa(u,{currentUserId:e(_e),isPrivileged:e(Ke),canEditOwnOrgEvents:e(nt),userOrganizations:e(ot)});let lt=d(!1);function o(){s(be,e(be)+fe)}function v(){s(be,520),s(je,!0)}function g(){s(be,H),s(je,!1)}const A=()=>{if(!e(at)||e(rt)||!rr(q)||!e(Z))return;const u=ua();s(c,Ie(u,"MMM d, yyyy")),s(ht,!0)};async function le(u){if(s(ht,!1),!u)return;const p=ua();s(rt,!0);try{const _=await pr(p);await Me(),s(L,_),s(y,!0)}catch(_){console.error("Failed to delete past events",_),alert("Failed to delete past events. Please try again.")}finally{s(rt,!1)}}function Ze(){s(y,!1)}Pa(async()=>{await Me()}),x(()=>(h(),e(be)),()=>{s(N,(h()??[]).filter(u=>{if(!u.start_time)return!1;const p=ue(u.start_time),_=xr(f,e(be));return p>=_&&p<f}))}),x(()=>(e(N),Ie),()=>{s(w,(()=>{const u=new Map;for(const p of e(N)){if(!p.start_time)continue;const _=ue(p.start_time),U=Ma(_,{weekStartsOn:1}),ke=_a(_,{weekStartsOn:1}),ce=Ie(U,"yyyy-MM-dd"),$e=`${Ie(U,"MMM d")} – ${Ie(ke,"MMM d")}`;let Ae=u.get(ce);Ae||(Ae={key:ce,label:$e,days:new Map},u.set(ce,Ae));const me=Ie(_,"yyyy-MM-dd");let de=Ae.days.get(me);de||(de={key:me,displayDay:Ie(_,"EEE"),displayDate:Ie(_,"MMM d"),events:[]},Ae.days.set(me,de)),de.events.push(p)}return Array.from(u.values()).sort((p,_)=>p.key<_.key?1:-1).map(p=>({key:p.key,label:p.label,days:Array.from(p.days.values()).sort((_,U)=>_.key<U.key?1:-1).map(_=>({..._,events:_.events.slice().sort((U,ke)=>{const ce=U.is_all_day?0:1,$e=ke.is_all_day?0:1;if(ce!==$e)return ce-$e;const Ae=U.start_time?ue(U.start_time).getTime():Number.MAX_SAFE_INTEGER,me=ke.start_time?ue(ke.start_time).getTime():Number.MAX_SAFE_INTEGER;return Ae-me})}))}))})())}),x(()=>e(w),()=>{s(B,(()=>{if(e(w).length===0)return[];const u=[];return e(w)[0]&&u.push(e(w)[0].key),e(w)[1]&&u.push(e(w)[1].key),u})())}),x(()=>(T(),e(Fe)),()=>{s(j,u=>T()?!0:e(Fe)[u]!==void 0?e(Fe)[u]:Be(u))}),x(()=>e(N),()=>{s(oe,e(N).length)}),x(()=>(e(w),Ie),()=>{s(ie,e(w).reduce((u,p)=>{const _=ue(p.key),U=_a(_,{weekStartsOn:1}),ke=Ie(U,"yyyy-MM"),ce=Ie(U,"MMMM yyyy");return u[ke]||(u[ke]={label:ce,weeks:[]}),u[ke].weeks.push(p),u},{}))}),x(()=>z(),()=>{s(_e,z()?.id)}),x(()=>re(),()=>{s(ot,re())}),x(()=>e(_e),()=>{s(yt,!!e(_e))}),x(()=>(e(ot),ba),()=>{s(ut,e(ot).has(ba.Bishopric))}),x(()=>(I(),Ce),()=>{s(nt,I()(Ce.EditOwnOrgEvents))}),x(()=>(X(),E(),e(ut),I(),Ce),()=>{s(Ke,X()||E()||e(ut)||I()(Ce.EditAllEvents))}),x(()=>(e(Ke),I(),e(nt),e(yt)),()=>{s(at,e(Ke)||I()(Ce.CreateEvents)||e(nt)||e(yt))}),x(()=>(I(),Ce),()=>{s(Y,I()(Ce.DeleteEvents))}),x(()=>e(N),()=>{s(Z,e(N).length>0)}),x(()=>(h(),e(N)),()=>{s(we,h().length>e(N).length)}),Gt(),gt();var ye=Zr(),R=Re(ye);Zt(R,{get title(){return e(Tt)},get id(){return ne()},children:(u,p)=>{ma(u,{get eventItem(){return e(Pt)},get drawerId(){return ne()},name:"past-event-item-form",get canDelete(){return e(Y)}})},$$slots:{default:!0}});var Te=n(R,2);{var qe=u=>{var p=Bt(),_=Re(p);{var U=ce=>{var $e=Bt(),Ae=Re($e);{var me=Ge=>{var Ye=Fr(),Et=n(a(Ye));t(Ye),S(()=>C(Et,` Show Past Events (${h(),r(()=>h().length)??""})`)),K("click",Ye,()=>s(lt,!0)),i(Ge,Ye)},de=Ge=>{var Ye=Xr(),Et=a(Ye),aa=a(Et),ae=n(a(aa),2),F=a(ae);{var Pe=ge=>{var ve=Lr(),et=a(ve);{var kt=Se=>{var Le=fa("Deleting…");i(Se,Le)},Nt=Se=>{var Le=fa();S(()=>C(Le,`Delete All (${e(oe)??""})`)),i(Se,Le)};m(et,Se=>{e(rt)?Se(kt):Se(Nt,!1)})}t(ve),S(()=>ve.disabled=e(rt)),K("click",ve,A),i(ge,ve)};m(F,ge=>{X()&&e(Z)&&ge(Pe)})}var b=n(F,2);t(ae),t(aa),t(Et);var Ne=n(Et,2);{var De=ge=>{var ve=Kr(),et=Re(ve);dt(et,5,()=>(e(ie),r(()=>Object.entries(e(ie)))),([Se,Le])=>Se,(Se,Le)=>{var $t=nr(()=>or(e(Le),2));let ct=()=>e($t)[1];var At=qr(),Dt=Re(At),St=a(Dt,!0);t(Dt);var tt=n(Dt,2);dt(tt,1,()=>(ct(),r(()=>ct().weeks)),Xe=>Xe.key,(Xe,he)=>{const It=Oe(()=>(k(ue),e(he),r(()=>ue(e(he).key)))),Ft=Oe(()=>(k(_a),k(e(It)),r(()=>_a(e(It),{weekStartsOn:1})))),ra=Oe(()=>(k(za),k(e(Ft)),r(()=>za(e(Ft))))),ya=Oe(()=>(k(Na),k(e(Ft)),k(e(ra)),r(()=>Na(e(Ft),e(ra),{weekStartsOn:1})+1))),Ot=Oe(()=>(e(j),e(he),r(()=>e(j)(e(he).key)))),pt=Oe(()=>(e(he),r(()=>e(he).days.reduce((Qt,oa)=>Qt+oa.events.length,0))));var sa=jr(),Wt=Re(sa),Ct=a(Wt);let jt;var ft=a(Ct),qt=a(ft),na=n(qt,2),ha=a(na);t(na),t(ft);var Ht=n(ft,2);let D;var Q=a(Ht,!0);t(Ht),t(Ct),t(Wt);var Qe=n(Wt,2);{var Mt=Qt=>{var oa=Bt(),Va=Re(oa);{var Ka=Lt=>{var ia=Bt(),Xa=Re(ia);dt(Xa,1,()=>(e(he),r(()=>e(he).days)),wa=>wa.key,(wa,zt)=>{var xa=Nr(),Ra=a(xa),Ea=a(Ra),ka=a(Ea),Ja=a(ka,!0);t(ka);var Ua=n(ka,2),Za=a(Ua,!0);t(Ua),t(Ea);var Fa=n(Ea,2);dt(Fa,5,()=>(e(zt),r(()=>e(zt).events)),Vt=>Vt.id??`${Vt.start_time}-${Vt.meta_data?.recurring_instance_index??0}`,(Vt,la)=>{var $a=Br(),Aa=a($a),Ga=a(Aa);hr(Ga,{get item(){return e(la)},showDate:!1,get searchQuery(){return V()}}),t(Aa);var er=n(Aa,2);{var tr=Da=>{var Sa=zr(),Ia=a(Sa);t(Sa),S(()=>{Ve(Ia,"data-bs-target",`#${ne()??""}`),Ve(Ia,"aria-controls",ne())}),K("click",Ia,()=>wt(e(la))),i(Da,Sa)};m(er,Da=>{e(la),r(()=>it(e(la)))&&Da(tr)})}t($a),i(Vt,$a)}),t(Fa),t(Ra),t(xa),S(()=>{C(Ja,(e(zt),r(()=>e(zt).displayDay))),C(Za,(e(zt),r(()=>e(zt).displayDate)))}),i(wa,xa)}),i(Lt,ia)},Ya=Lt=>{var ia=Wr();i(Lt,ia)};m(Va,Lt=>{e(he),r(()=>e(he).days.length)?Lt(Ka):Lt(Ya,!1)})}i(Qt,oa)};m(Qe,Qt=>{e(Ot)&&Qt(Mt)})}S(()=>{jt=vt(Ct,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,jt,{"text-muted":e(pt)===0}),Ve(Ct,"title",e(Ot)?"Click to collapse week":"Click to expand week"),vt(qt,1,`bi ${e(Ot)?"bi-chevron-up":"bi-chevron-down"}`),C(ha,`Week ${e(ya)??""} [${e(pt)??""} Event${e(pt)===1?"":"s"}]`),D=vt(Ht,1,"",null,D,{"opacity-50":e(pt)===0}),C(Q,(e(he),r(()=>e(he).label)))}),K("click",Ct,()=>Rt(e(he).key)),i(Xe,sa)}),S(()=>C(St,(ct(),r(()=>ct().label)))),i(Se,At)}),t(et);var kt=n(et,2);{var Nt=Se=>{var Le=Vr(),$t=a(Le),ct=a($t);t($t);var At=n($t,2);{var Dt=tt=>{var Xe=Hr();K("click",Xe,g),i(tt,Xe)},St=tt=>{var Xe=Qr(),he=a(Xe),It=n(he,2);t(Xe),K("click",he,o),K("click",It,v),i(tt,Xe)};m(At,tt=>{e(je)?tt(Dt):tt(St,!1)})}t(Le),S(()=>C(ct,`Showing ${e(N),r(()=>e(N)?.length??0)??""} of ${h(),r(()=>h()?.length??0)??""}`)),i(Se,Le)};m(kt,Se=>{(e(we)||e(je))&&Se(Nt)})}i(ge,ve)},We=ge=>{var ve=Yr();i(ge,ve)};m(Ne,ge=>{e(w),r(()=>e(w).length)?ge(De):ge(We,!1)})}t(Ye),K("click",b,()=>s(lt,!1)),i(Ge,Ye)};m(Ae,Ge=>{e(lt)?Ge(de,!1):Ge(me)})}i(ce,$e)},ke=ce=>{var $e=Jr(),Ae=a($e);Ha(Ae,{}),t($e),i(ce,$e)};m(_,ce=>{J()?ce(U):ce(ke,!1)})}i(u,p)};m(Te,u=>{X()&&u(qe)})}var He=n(Te,2);{var st=u=>{Ur(u,{get cutoffDate(){return e(c)},callback:le})};m(He,u=>{e(ht)&&u(st)})}var Ut=n(He,2);{var _t=u=>{Pr(u,{get deleted(){return e(L),r(()=>e(L).deleted)},get skipped(){return e(L),r(()=>e(L).skipped)},callback:Ze})};m(Ut,u=>{e(y)&&u(_t)})}i(pe,ye),mt(),te()}var es=l("<span> </span>"),ts=l('<span class="badge bg-secondary">All Day</span>'),as=l('<span class="result-time svelte-1xkw8oa"> </span>'),rs=l('<span class="result-date svelte-1xkw8oa"> </span> <!>',1),ss=l('<span class="result-location svelte-1xkw8oa"><i class="bi bi-geo-alt"></i> <!></span>'),ns=l('<div class="result-thumbnail-container svelte-1xkw8oa"><img class="result-thumbnail svelte-1xkw8oa"/></div>'),os=l('<div class="result-actions svelte-1xkw8oa"><button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i></button></div>'),is=l('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="result-details-button svelte-1xkw8oa"><div class="result-header svelte-1xkw8oa"><div class="result-title svelte-1xkw8oa"><!></div> <span class="result-type-badge badge bg-secondary-subtle text-secondary-emphasis svelte-1xkw8oa"> </span></div> <div class="result-meta svelte-1xkw8oa"><!> <!> <!></div></button> <!> <!></li>'),ls=l('<div class="unified-search-results svelte-1xkw8oa"><div class="search-results-header svelte-1xkw8oa"><h6 class="search-results-title svelte-1xkw8oa"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),cs=l('<div class="no-search-results svelte-1xkw8oa"> </div>'),ds=l("<!> <!> <!>",1);function vs(pe,M){bt(M,!1);const T=()=>ee(j,"$currentUser",V),h=()=>ee(ie,"$userOrganizations",V),z=()=>ee(N,"$currentUserHasPermission",V),re=()=>ee(w,"$currentUserIsRoot",V),I=()=>ee(oe,"$currentUserIsAdmin",V),X=()=>ee(Y,"$calendarEvents",V),E=()=>ee(we,"$searchQuery",V),J=()=>ee(Z,"$announcements",V),[V,$]=ea(),te=d(),B=d(),{stores:{currentUser:j,currentUserHasPermission:N,currentUserIsAdmin:oe,currentUserIsRoot:w,userOrganizations:ie}}=ga(),{stores:{calendarEvents:Y,announcements:Z,searchQuery:we}}=ta(),ze=Jt(),P=Jt();let O=d(!1),q=d(),se=d(!1),G=d(!1),xe=d(new Set),Ee=d(""),Ue=d({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),Me=d({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),W=d(!1);const ne=c=>qa(c,{currentUserId:e(q),isPrivileged:e(O),canEditOwnOrgEvents:e(G),userOrganizations:e(xe)}),at=c=>c.startsWith("image/"),Ke=async c=>{const y=c.itemType==="announcement"?"announcement":"calendar_event";if(s(Ee,`${c.itemType==="announcement"?"Announcement":"Event"} Form`),c?.meta_data?.recurring_instance&&c?.meta_data?.recurring_parent_id){const{getCalendarEvent:L}=await Ta(async()=>{const{getCalendarEvent:fe}=await import("./9OwWMZAP.js").then(be=>be.y);return{getCalendarEvent:fe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),H=await L(c.meta_data.recurring_parent_id);if(H){s(Ue,{...H,organization:H?.meta_data?.organization??"",event_type:y,start_time:c.start_time,end_time:c.end_time,meta_data:{...H.meta_data,recurring_instance:!0,recurring_parent_id:c.meta_data.recurring_parent_id,recurring_instance_index:c.meta_data.recurring_instance_index}});return}}s(Ue,{...c,organization:c?.meta_data?.organization??"",event_type:y})},_e=async c=>{if(c?.meta_data?.recurring_instance&&c?.meta_data?.recurring_parent_id){const{getCalendarEvent:L}=await Ta(async()=>{const{getCalendarEvent:fe}=await import("./9OwWMZAP.js").then(be=>be.y);return{getCalendarEvent:fe}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),H=await L(c.meta_data.recurring_parent_id);H?s(Me,{...H,start_time:c.start_time,end_time:c.end_time,meta_data:{...H.meta_data,recurring_instance:!0,recurring_parent_id:c.meta_data.recurring_parent_id,recurring_instance_index:c.meta_data.recurring_instance_index}}):s(Me,c)}else s(Me,c);const y=document.getElementById(P);y&&new window.bootstrap.Offcanvas(y).show()},ut=async c=>{await Ke(c);const y=document.getElementById(ze);y&&new window.bootstrap.Offcanvas(y).show()},yt=async()=>{const c=document.getElementById(P);if(c){const y=window.bootstrap.Offcanvas.getInstance(c);y&&y.hide()}await Ke(e(Me)),setTimeout(()=>{const y=document.getElementById(ze);y&&new window.bootstrap.Offcanvas(y).show()},300)};x(()=>T(),()=>{s(q,T()?.id)}),x(()=>h(),()=>{s(xe,h())}),x(()=>(e(xe),ba),()=>{s(se,e(xe).has(ba.Bishopric))}),x(()=>(z(),Ce),()=>{s(G,z()(Ce.EditOwnOrgEvents))}),x(()=>(re(),I(),e(se),z(),Ce),()=>{s(O,re()||I()||e(se)||z()(Ce.EditAllEvents))}),x(()=>(z(),Ce),()=>{s(W,z()(Ce.DeleteEvents))}),x(()=>(X(),ue),()=>{s(te,(X()??[]).filter(c=>c.start_time?ue(c.start_time)>=new Date:!1))}),x(()=>(E(),e(te),J(),ue),()=>{s(B,E()?[...e(te).filter(c=>{const y=E().toLowerCase(),L=(c.title||"").toLowerCase(),H=(c.description||"").replace(/<[^>]*>/g,"").toLowerCase(),fe=(c.location||"").toLowerCase();return L.includes(y)||H.includes(y)||fe.includes(y)}).map(c=>({...c,itemType:"event"})),...(J()??[]).filter(c=>{const y=E().toLowerCase(),L=(c.title||"").toLowerCase(),H=(c.description||"").replace(/<[^>]*>/g,"").toLowerCase(),fe=(c.location||"").toLowerCase();return L.includes(y)||H.includes(y)||fe.includes(y)}).map(c=>({...c,itemType:"announcement"}))].sort((c,y)=>{const L=c.start_time?ue(c.start_time).getTime():0,H=y.start_time?ue(y.start_time).getTime():0;return L===0&&H!==0?-1:L!==0&&H===0?1:L-H}):[])}),Gt(),gt();var nt=ds(),ot=Re(nt);Zt(ot,{get title(){return e(Ee)},get id(){return ze},children:(c,y)=>{ma(c,{get eventItem(){return e(Ue)},get drawerId(){return ze},name:"unified-search-form",get canDelete(){return e(W)}})},$$slots:{default:!0}});var rt=n(ot,2);Zt(rt,{title:"Details",get id(){return P},children:(c,y)=>{{let L=Oe(()=>(e(Me),r(()=>ne(e(Me)))));fr(c,{get event(){return e(Me)},get canEdit(){return e(L)},onEdit:yt})}},$$slots:{default:!0}});var Tt=n(rt,2);{var Pt=c=>{var y=ls(),L=a(y),H=a(L),fe=a(H);t(H),t(L);var be=n(L,2);dt(be,5,()=>e(B),je=>je.id??je.start_time??Math.random(),(je,f)=>{const Fe=Oe(()=>(e(f),r(()=>e(f).attachments?.find(p=>at(p.type))))),Be=Oe(()=>(k(Xt),e(f),r(()=>Xt(e(f)?.meta_data?.organization??"")))),Rt=Oe(()=>(e(f),r(()=>e(f).itemType==="event")));var wt=is(),xt=a(wt),it=n(xt,2),lt=a(it),o=a(lt),v=a(o);La(v,()=>(k(ca),e(f),E(),r(()=>ca(e(f).title,E())))),t(o);var g=n(o,2),A=a(g,!0);t(g),t(lt);var le=n(lt,2),Ze=a(le);{var ye=p=>{var _=es(),U=a(_,!0);t(_),S(()=>{vt(_,1,`badge rounded-pill bg-color-${k(e(Be)),r(()=>e(Be).color_number)??""}`,"svelte-1xkw8oa"),C(U,(k(e(Be)),r(()=>e(Be).label)))}),i(p,_)};m(Ze,p=>{k(e(Be)),r(()=>e(Be)?.label)&&p(ye)})}var R=n(Ze,2);{var Te=p=>{var _=rs(),U=Re(_),ke=a(U,!0);t(U);var ce=n(U,2);{var $e=me=>{var de=ts();i(me,de)},Ae=me=>{var de=as(),Ge=a(de,!0);t(de),S(Ye=>C(Ge,Ye),[()=>(k(Ie),k(ue),e(f),r(()=>Ie(ue(e(f).start_time),"h:mm a")))]),i(me,de)};m(ce,me=>{e(f),r(()=>e(f).is_all_day)?me($e):me(Ae,!1)})}S(me=>C(ke,me),[()=>(k(Ie),k(ue),e(f),r(()=>Ie(ue(e(f).start_time),"MMM d, yyyy")))]),i(p,_)};m(R,p=>{e(f),r(()=>e(f).start_time)&&p(Te)})}var qe=n(R,2);{var He=p=>{var _=ss(),U=n(a(_),2);La(U,()=>(k(ca),e(f),E(),r(()=>ca(e(f).location,E())))),t(_),i(p,_)};m(qe,p=>{e(f),r(()=>e(f).location)&&p(He)})}t(le),t(it);var st=n(it,2);{var Ut=p=>{var _=ns(),U=a(_);t(_),S(()=>{Ve(U,"src",(k(e(Fe)),r(()=>e(Fe).url))),Ve(U,"alt",(k(e(Fe)),r(()=>e(Fe).name)))}),i(p,_)};m(st,p=>{e(Fe)&&p(Ut)})}var _t=n(st,2);{var u=p=>{var _=os(),U=a(_);t(_),S(()=>Ve(U,"title",`Edit ${e(Rt)?"event":"announcement"}`)),K("click",U,Qa(()=>ut(e(f)))),i(p,_)};m(_t,p=>{e(f),r(()=>ne(e(f)))&&p(u)})}t(wt),S(()=>{vt(xt,1,`result-color-indicator bg-color-${k(e(Be)),r(()=>e(Be)?.color_number??0)??""}`,"svelte-1xkw8oa"),C(A,e(Rt)?"Event":"Announcement")}),K("click",it,()=>_e(e(f))),i(je,wt)}),t(be),t(y),S(()=>C(fe,`${e(B),r(()=>e(B).length)??""} result${e(B),r(()=>e(B).length===1?"":"s")??""} matching "${E()??""}"`)),i(c,y)},ht=c=>{var y=Bt(),L=Re(y);{var H=fe=>{var be=cs(),je=a(be);t(be),S(()=>C(je,`No results match your search for "${E()??""}"`)),i(fe,be)};m(L,fe=>{E()&&fe(H)},!0)}i(c,y)};m(Tt,c=>{E(),e(B),r(()=>E()&&e(B).length>0)?c(Pt):c(ht,!1)})}i(pe,nt),mt(),$()}var us=l("<!> <!> <!>",1),_s=l('<div class="d-flex flex-column gap-4"><!> <!></div>');function Wa(pe,M){bt(M,!1);const T=()=>ee(re,"$searchQuery",h),[h,z]=ea(),{stores:{searchQuery:re}}=ta();let I=Je(M,"showAnnouncements",8,!0),X=Je(M,"showSearch",8,!0);gt();var E=_s(),J=a(E);{var V=j=>{Sr(j,{})};m(J,j=>{X()&&j(V)})}var $=n(J,2);{var te=j=>{vs(j,{})},B=j=>{var N=us(),oe=Re(N);{var w=Z=>{mr(Z,{})};m(oe,Z=>{I()&&Z(w)})}var ie=n(oe,2);br(ie,{});var Y=n(ie,2);Gr(Y,{}),i(j,N)};m($,j=>{X()&&T()?j(te):j(B,!1)})}t(E),i(pe,E),mt(),z()}var ps=l('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),fs=l('<i class="bi bi-arrow-clockwise"></i>'),bs=l('<i class="bi bi-arrow-clockwise me-1"></i>Refresh',1),ms=l('<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"> </span>'),gs=l('<button type="button" role="tab"> <!></button>'),ys=l("<option> </option>"),hs=l('<div class="py-5 text-center text-muted"><!></div>'),ws=l('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),xs=l("<span> </span>"),Es=l('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),ks=l('<span><i class="bi bi-geo-alt"></i> </span>'),$s=l('<span><i class="bi bi-arrow-repeat"></i> </span>'),As=l('<span><i class="bi bi-calendar3"></i> </span>'),Ds=l('<span class="text-muted small"> </span>'),Ss=l('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-primary" type="button"><i class="bi bi-pencil-square"></i></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),Is=l('<div class="d-flex flex-column gap-3"></div>'),Os=l('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="d-flex flex-column gap-3"><div class="submissions-action-bar d-flex justify-content-end gap-2"><div class="dropdown"><button class="btn btn-success btn-sm dropdown-toggle" type="button" id="createEventDropdown" data-bs-toggle="dropdown" aria-label="Create event actions" aria-expanded="false"><i class="bi bi-plus"></i> <span class="d-none d-md-inline ms-1">Create Event</span></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="createEventDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-calendar-plus me-2"></i>Create Event</button></li> <li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-megaphone me-2"></i>Create Announcement</button></li></ul></div> <button class="btn btn-outline-secondary btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#my-submissions-actions-panel" aria-expanded="false" aria-controls="my-submissions-actions-panel"><i class="bi bi-gear"></i> <span class="d-none d-md-inline ms-1">Actions</span></button></div> <div id="my-submissions-actions-panel" class="collapse"><div class="d-flex flex-column gap-2 p-3 border rounded bg-body-tertiary"><button class="btn btn-success btn-sm" type="button"><i class="bi bi-file-earmark-arrow-up me-1"></i>Import CSV</button> <button class="btn btn-primary btn-sm"><!></button></div></div> <div class="submissions-status-tabs nav nav-tabs gap-4 svelte-9fakr" role="tablist"></div></div> <div class="d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3"><div class="input-group input-group-sm my-submissions-search svelte-9fakr"><input class="form-control svelte-9fakr" type="search" placeholder="Search title, category, or location"/></div> <div class="type-filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div> <!></div></div>'),Cs=l('<div class="text-muted">Select a submission to edit.</div>'),Ms=l("<!> <!> <!> <!>",1);function Ts(pe,M){bt(M,!1);const T=()=>ee(w,"$currentUserStore",I),h=()=>ee(ie,"$currentUserHasPermission",I),z=()=>ee(N,"$dbData",I),re=()=>ee(j,"$ready",I),[I,X]=ea(),E=d(),J=d(),V=d(),$=d(),te=d(),B=d(),{stores:{ready:j,dbData:N},actions:{reload:oe}}=ta(),{stores:{currentUser:w,currentUserHasPermission:ie}}=ga();let Y=d({...Oa});const Z=`create-event-form-${Jt()}`;let we=d(!1);const ze=()=>{s(we,!1)},P=async()=>{s(we,!1),await oe()};let O=d(!1),q=d([]),se=d([]),G=d(null);const xe=Jt();let Ee=null;const Ue={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},Me={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},W={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},ne=[{value:"pending",label:W.pending},{value:"needs_review",label:W.needs_review},{value:"approved",label:W.approved},{value:"published",label:W.published}],at=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}],Ke=()=>({search:"",typeFilter:"all"});let _e=d({pending:Ke(),needs_review:Ke(),approved:Ke(),published:Ke()});Pa(async()=>{s(O,!0),await oe(),s(O,!1),typeof window<"u"&&(Ee=(await Ta(()=>import("./DO0djbQe.js").then(v=>v.o),__vite__mapDeps([27,28]),import.meta.url)).default)});const ut=o=>{const v=o.meta_data?.submitted_at??o.created_at;if(!v)return 0;try{return ue(v).getTime()}catch(g){return console.warn("Failed to parse submission timestamp",g),0}},yt=o=>{const v=o.meta_data?.submitted_at??o.created_at;if(!v)return"—";try{return Ie(ue(v),"MMM d, yyyy 'at' h:mm a")}catch(g){return console.warn("Failed to format submission timestamp",g),"—"}},nt=o=>{if(!o.start_time)return"—";try{return Ie(ue(o.start_time),"MMM d, yyyy 'at' h:mm a")}catch(v){return console.warn("Failed to format event date",v),"—"}},ot=o=>o.replace(/<[^>]*>/g,""),rt=(o,v)=>o.length<=v?o:o.substring(0,v).trimEnd()+"…",Tt=o=>o.description?rt(ot(o.description).trim(),120):"",Pt=o=>{try{const g=Yt.fromString(o).origOptions,A=g.interval||1,le=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ze=["","1st","2nd","3rd","4th","5th"];if(g.freq===Yt.DAILY)return A===1?"Repeats daily":`Repeats every ${A} days`;if(g.freq===Yt.WEEKLY){if(g.byweekday){const R=(Array.isArray(g.byweekday)?g.byweekday:[g.byweekday]).map(Te=>{const qe=typeof Te=="number"?Te:Te.weekday,He=qe===6?0:qe+1;return le[He]});return A===1?R.length===1?`Repeats every ${R[0]}`:`Repeats on ${R.join(", ")}`:`Repeats every ${A} weeks on ${R.join(", ")}`}return A===1?"Repeats weekly":`Repeats every ${A} weeks`}if(g.freq===Yt.MONTHLY){if(g.byweekday){const R=(Array.isArray(g.byweekday)?g.byweekday:[g.byweekday])[0];if(R&&typeof R=="object"&&"n"in R&&"weekday"in R){const Te=R.weekday,qe=Te===6?0:Te+1,He=R.n,st=Ze[He]||`${He}th`;return A===1?`Repeats on the ${st} ${le[qe]} of the month`:`Repeats on the ${st} ${le[qe]} every ${A} months`}}if(g.bymonthday){const ye=Array.isArray(g.bymonthday)?g.bymonthday[0]:g.bymonthday,R=ye===1?"st":ye===2?"nd":ye===3?"rd":"th";return A===1?`Repeats on the ${ye}${R} of the month`:`Repeats on the ${ye}${R} every ${A} months`}return A===1?"Repeats monthly":`Repeats every ${A} months`}return g.freq===Yt.YEARLY?A===1?"Repeats yearly":`Repeats every ${A} years`:"Repeats"}catch{return"Repeats"}},ht=(o,v)=>{const g=v.trim().toLowerCase();if(!g)return!0;const A=o.meta_data?.organization?Xt(o.meta_data.organization)?.label??"":"";return[o.title??"",o.description??"",o.location??"",A??""].join(" ").toLowerCase().includes(g)},c=(o,v)=>v==="all"?!0:v==="events"?o.event_type==="calendar_event":o.event_type==="announcement";function y(o,v){s(_e,{...e(_e),[o]:{...e(_e)[o],...v}})}const L=o=>{const v=new Set,g=[];for(const A of o){const le=A.meta_data?.recurring_parent_id;if(A.meta_data?.recurring_instance&&le!=null){if(v.has(le))continue;v.add(le)}g.push(A)}return g},H=o=>o.meta_data?.recurring_parent_id!=null?`recurring-${o.meta_data.recurring_parent_id}`:`id-${o.id}`,fe=o=>{s(G,o);const v=document.getElementById(xe);v&&Ee&&Ee.getOrCreateInstance(v).show()},be=(o,v)=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),fe(v))},je=async()=>{s(O,!0),await oe(),s(O,!1)};let f=d("pending");x(()=>T(),()=>{s(E,T())}),x(()=>(h(),Ce),()=>{s(J,h()(Ce.DeleteEvents)||h()(Ce.DeleteOwnEvents))}),x(()=>(z(),e(E)),()=>{s(q,L((z()??[]).filter(o=>{const v=o.meta_data?.submitted_by_user_id;return v&&e(E)?.id&&v===e(E).id}).sort((o,v)=>ut(v)-ut(o))))}),x(()=>e(f),()=>{s(V,`type-filter-select-submissions-${e(f)}`)}),x(()=>(e(q),da),()=>{s($,ne.reduce((o,v)=>(o[v.value]=e(q).filter(g=>da(g)===v.value),o),{}))}),x(()=>(e(_e),e($)),()=>{s(te,ne.reduce((o,v)=>{const g=e(_e)[v.value],A=(e($)[v.value]??[]).filter(le=>c(le,g.typeFilter));return o[v.value]=A.filter(le=>ht(le,g.search)),o},{}))}),x(()=>(e(te),e(f)),()=>{s(se,e(te)[e(f)]??[])}),x(()=>(e(G),e(q)),()=>{e(G)&&!e(q).some(o=>H(o)===H(e(G)))&&s(G,null)}),x(()=>e(G),()=>{s(B,e(G)?{...e(G),id:e(G).id??e(G).meta_data?.recurring_parent_id,organization:e(G).meta_data?.organization??""}:null)}),Gt(),gt();var Fe=Ms(),Be=Re(Fe);{var Rt=o=>{var v=ps(),g=a(v);Ha(g,{}),t(v),i(o,v)},wt=o=>{var v=Os(),g=a(v),A=a(g),le=a(A),Ze=n(a(le),2),ye=a(Ze),R=a(ye);t(ye);var Te=n(ye,2),qe=a(Te);t(Te),t(Ze),t(le),pa(2),t(A);var He=n(A,2),st=a(He),Ut=a(st),_t=n(Ut,2),u=a(_t);{var p=ae=>{var F=fs();i(ae,F)},_=ae=>{var F=bs();pa(),i(ae,F)};m(u,ae=>{e(O)?ae(p):ae(_,!1)})}t(_t),t(st),t(He);var U=n(He,2);dt(U,5,()=>ne,Ca,(ae,F)=>{const Pe=Oe(()=>(e($),e(F),r(()=>(e($)[e(F).value]??[]).length)));var b=gs(),Ne=a(b),De=n(Ne);{var We=ge=>{var ve=ms(),et=a(ve,!0);t(ve),S(()=>C(et,e(Pe))),i(ge,ve)};m(De,ge=>{e(Pe)>0&&ge(We)})}t(b),S(()=>{vt(b,1,(e(f),e(F),r(()=>`nav-link position-relative ${e(f)===e(F).value?"active":""}`)),"svelte-9fakr"),Ve(b,"aria-selected",(e(f),e(F),r(()=>e(f)===e(F).value))),C(Ne,`${e(F),r(()=>e(F).label)??""} `)}),K("click",b,()=>s(f,e(F).value)),i(ae,b)}),t(U),t(g);var ke=n(g,2),ce=a(ke),$e=a(ce),Ae=a($e);ja(Ae),t($e);var me=n($e,2),de=a(me);dt(de,5,()=>at,Ca,(ae,F)=>{var Pe=ys(),b=a(Pe,!0);t(Pe);var Ne={};S(()=>{C(b,(e(F),r(()=>e(F).label))),Ne!==(Ne=(e(F),r(()=>e(F).value)))&&(Pe.value=(Pe.__value=(e(F),r(()=>e(F).value)))??"")}),i(ae,Pe)}),t(de);var Ge;lr(de),t(me),t(ce);var Ye=n(ce,2);{var Et=ae=>{var F=hs(),Pe=a(F);{var b=De=>{var We=fa("You haven't submitted any events or announcements yet.");i(De,We)},Ne=De=>{var We=fa();S(ge=>C(We,`No ${ge??""} submissions match your current filters.`),[()=>(e(f),r(()=>W[e(f)].toLowerCase()))]),i(De,We)};m(Pe,De=>{e(q),r(()=>e(q).length===0)?De(b):De(Ne,!1)})}t(F),i(ae,F)},aa=ae=>{var F=Is();dt(F,5,()=>e(se),Pe=>H(Pe),(Pe,b)=>{const Ne=Oe(()=>(k(da),e(b),r(()=>da(e(b))))),De=Oe(()=>(k(e(Ne)),r(()=>Me[e(Ne)]))),We=Oe(()=>(e(b),k(Xt),r(()=>e(b).meta_data?.organization?Xt(e(b).meta_data.organization):null))),ge=Oe(()=>(e(b),r(()=>Tt(e(b)))));var ve=Ss(),et=a(ve),kt=a(et),Nt=a(kt,!0);t(kt);var Se=n(kt,2),Le=a(Se),$t=a(Le,!0);t(Le);var ct=n(Le,2);t(Se),t(et);var At=n(et,2);{var Dt=D=>{var Q=ws(),Qe=a(Q,!0);t(Q),S(()=>C(Qe,e(ge))),i(D,Q)};m(At,D=>{e(ge)&&D(Dt)})}var St=n(At,2),tt=a(St);{var Xe=D=>{var Q=xs(),Qe=a(Q,!0);t(Q),S(()=>{vt(Q,1,`badge rounded-pill bg-color-${k(e(We)),r(()=>e(We).color_number)??""}`,"svelte-9fakr"),C(Qe,(k(e(We)),r(()=>e(We).label)))}),i(D,Q)},he=D=>{var Q=Es();i(D,Q)};m(tt,D=>{e(We)?D(Xe):D(he,!1)})}var It=n(tt,2);{var Ft=D=>{var Q=ks(),Qe=n(a(Q));t(Q),S(()=>C(Qe,` ${e(b),r(()=>e(b).location)??""}`)),i(D,Q)};m(It,D=>{e(b),r(()=>e(b).location)&&D(Ft)})}var ra=n(It,2);{var ya=D=>{var Q=$s(),Qe=n(a(Q));t(Q),S(Mt=>C(Qe,` ${Mt??""}`),[()=>(e(b),r(()=>Pt(e(b).recurrence_rule)))]),i(D,Q)};m(ra,D=>{e(b),r(()=>e(b).recurrence_rule)&&D(ya)})}t(St);var Ot=n(St,2),pt=a(Ot),sa=n(a(pt));t(pt);var Wt=n(pt,2);{var Ct=D=>{var Q=As(),Qe=n(a(Q));t(Q),S(Mt=>C(Qe,` Event ${Mt??""}`),[()=>(e(b),r(()=>nt(e(b))))]),i(D,Q)};m(Wt,D=>{e(b),r(()=>e(b).event_type==="calendar_event")&&D(Ct)})}t(Ot);var jt=n(Ot,2),ft=a(jt),qt=a(ft),na=n(qt,1,!0);t(ft);var ha=n(ft,2);{var Ht=D=>{var Q=Ds(),Qe=a(Q);t(Q),S(Mt=>C(Qe,`Approvals: ${Mt??""} of 3`),[()=>(k(va),e(b),r(()=>va(e(b))))]),i(D,Q)};m(ha,D=>{k(va),e(b),r(()=>va(e(b))>0)&&D(Ht)})}t(jt),t(ve),S(D=>{vr(ve,`border-left: 4px solid ${k(e(Ne)),r(()=>Ue[e(Ne)])??""}`),C(Nt,(e(b),r(()=>e(b).title))),C($t,(e(b),r(()=>e(b).event_type==="calendar_event"?"Event":"Announcement"))),Ve(ct,"aria-label",(e(b),r(()=>`Edit ${e(b).title}`))),C(sa,` Submitted ${D??""}`),vt(ft,1,(k(e(De)),r(()=>`badge ${e(De).class}`)),"svelte-9fakr"),vt(qt,1,(k(e(De)),r(()=>`bi ${e(De).icon} me-1`)),"svelte-9fakr"),C(na,(k(e(De)),r(()=>e(De).text)))},[()=>(e(b),r(()=>yt(e(b))))]),K("click",ct,Qa(()=>fe(e(b)))),K("click",ve,()=>fe(e(b))),K("keydown",ve,D=>be(D,e(b))),i(Pe,ve)}),t(F),i(ae,F)};m(Ye,ae=>{e(se),r(()=>e(se).length===0)?ae(Et):ae(aa,!1)})}t(ke),t(v),S(()=>{Ve(R,"data-bs-target",`#${Z}`),Ve(R,"aria-controls",Z),Ve(qe,"data-bs-target",`#${Z}`),Ve(qe,"aria-controls",Z),_t.disabled=e(O),cr(Ae,(e(_e),e(f),r(()=>e(_e)[e(f)].search))),Ve(de,"id",e(V)),Ge!==(Ge=(e(_e),e(f),r(()=>e(_e)[e(f)].typeFilter)))&&(de.value=(de.__value=(e(_e),e(f),r(()=>e(_e)[e(f)].typeFilter)))??"",dr(de,(e(_e),e(f),r(()=>e(_e)[e(f)].typeFilter))))}),K("click",R,()=>{s(Y,{...Oa,event_type:"calendar_event",start_time:new Date().toISOString(),end_time:new Date().toISOString(),is_all_day:!0})}),K("click",qe,()=>{s(Y,{...Oa,event_type:"announcement"})}),K("click",Ut,()=>s(we,!0)),K("click",_t,je),K("input",Ae,ae=>y(e(f),{search:ae.currentTarget.value})),K("change",de,ae=>y(e(f),{typeFilter:ae.currentTarget.value})),i(o,v)};m(Be,o=>{re()?o(wt,!1):o(Rt)})}var xt=n(Be,2);{let o=Oe(()=>(e(G),r(()=>e(G)?`Edit: ${e(G).title}`:"Submission Details")));Zt(xt,{get id(){return xe},get title(){return e(o)},children:(v,g)=>{var A=Bt(),le=Re(A);{var Ze=R=>{ma(R,{get eventItem(){return e(B)},get drawerId(){return xe},name:"my-submission-form",get canDelete(){return e(J)},canCreate:!1})},ye=R=>{var Te=Cs();i(R,Te)};m(le,R=>{e(B)?R(Ze):R(ye,!1)})}i(v,A)},$$slots:{default:!0}})}var it=n(xt,2);{let o=Oe(()=>(e(Y),r(()=>e(Y).event_type==="announcement"?"Create Announcement":"Create Event")));Zt(it,{get id(){return Z},get title(){return e(o)},children:(v,g)=>{ma(v,{get eventItem(){return e(Y)},get drawerId(){return Z},name:"create-form",canCreate:!0})},$$slots:{default:!0}})}var lt=n(it,2);gr(lt,{onClose:ze,onComplete:P,get isOpen(){return e(we)},set isOpen(o){s(we,o)},$$legacy:!0}),i(pe,Fe),mt(),X()}var Ps=l('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),Rs=l('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),Us=l('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),Fs=l('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),Ls=l('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1),zs=l('<div class="calendar-section svelte-1oi0f59"><!></div>');function cn(pe,M){bt(M,!1);const T=d(),h=d(),z=d(),{stores:{currentUserHasPermission:re,authenticated:I}}=ga();let X=Je(M,"showApprovals",8,!0),E=Je(M,"showMySubmissions",8,!0),J=Je(M,"showAnnouncements",8,!0),V=Je(M,"showSearch",8,!0),$=d(!1),te=d(!1);Pa(()=>{const w=re.subscribe(Y=>{const Z=X()&&Y(Ce.ManageWardBusiness);s($,Z)}),ie=I.subscribe(Y=>{s(te,Y)});return()=>{w(),ie()}}),x(()=>(k(X()),e($)),()=>{s(T,X()&&e($))}),x(()=>(k(E()),e(te)),()=>{s(h,E()&&e(te))}),x(()=>(e(T),e(h)),()=>{s(z,e(T)||e(h))}),Gt(),gt();var B=zs(),j=a(B);{var N=w=>{var ie=Ls(),Y=Re(ie),Z=a(Y),we=n(a(Z),2);{var ze=W=>{var ne=Ps();i(W,ne)};m(we,W=>{e(h)&&W(ze)})}var P=n(we,2);{var O=W=>{var ne=Rs();i(W,ne)};m(P,W=>{e(T)&&W(O)})}t(Z),t(Y);var q=n(Y,2),se=a(q),G=a(se);Wa(G,{get showAnnouncements(){return J()},get showSearch(){return V()}}),t(se);var xe=n(se,2);{var Ee=W=>{var ne=Us(),at=a(ne);Ts(at,{}),t(ne),i(W,ne)};m(xe,W=>{e(h)&&W(Ee)})}var Ue=n(xe,2);{var Me=W=>{var ne=Fs(),at=a(ne);wr(at,{}),t(ne),i(W,ne)};m(Ue,W=>{e(T)&&W(Me)})}t(q),i(w,ie)},oe=w=>{Wa(w,{get showAnnouncements(){return J()},get showSearch(){return V()}})};m(j,w=>{e(z)?w(N):w(oe,!1)})}t(B),i(pe,B),mt()}export{cn as C};
