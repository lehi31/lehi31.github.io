import{r as o}from"./pfMRWl6z.js";function t(e){try{const r=localStorage.getItem("currentUser");return r?(JSON.parse(r).permissions||[]).includes(e):!1}catch(r){return console.error("Error checking permission:",r),!1}}function n(){try{const e=localStorage.getItem("currentUser");return e?(JSON.parse(e).roles||[]).includes("system-root"):!1}catch(e){return console.error("Error checking root status:",e),!1}}function i(){return n()||t("manage-users")}function c(){return n()||i()}function g(e,r){if(!t(e)){const s=encodeURIComponent(`You don't have permission to access this page${r?` (requires: ${r})`:""}.`);throw o(302,`/home?error=${s}`)}}function m(){if(!c()){const e=encodeURIComponent("This page requires administrator privileges.");throw o(302,`/home?error=${e}`)}}function f(e,r="error"){sessionStorage.setItem("redirectMessage",JSON.stringify({message:e,type:r}))}function l(){try{const e=sessionStorage.getItem("redirectMessage");if(e)return sessionStorage.removeItem("redirectMessage"),JSON.parse(e)}catch(e){console.error("Error reading redirect message:",e)}return null}export{g as a,l as g,m as r,f as s};
