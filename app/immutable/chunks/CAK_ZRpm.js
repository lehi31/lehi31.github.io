const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TJWj9Ozf.js","./SWWSvUpQ.js","./DIeogL5L.js","./D8ekX_8E.js","./CmsKOCeN.js","./NZTpNUN0.js","./69_IOA4Y.js","./WW5OsAH7.js","./CU3XCoqN.js","./YJAcq9su.js","./B_JQWfE2.js","./o_i3wQuA.js","./o2OHOMN5.js","./BUApaBEI.js","./Bgyk9asy.js","./DkmINPYC.js","../assets/Spinner.DTjfhZ6-.css","./CVUz8n-e.js","./mnkQx8ai.js","./CvxMDV_e.js","./Cc3l00Qu.js","./1WT9EMH5.js","./Pw8uDG7-.js","./BdlCETRK.js","./BabzIaXm.js","./2GYSXSLF.js","../assets/BishopricApprovalSection.DRGo_BHg.css","./DO0djbQe.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"./NZTpNUN0.js";import"./69_IOA4Y.js";import{d as tr,o as xa,g as ar}from"./WW5OsAH7.js";import{p as ct,ah as x,D as c,E as p,ai as Lt,c as a,s as l,r as t,u as s,m as e,a as dt,B as O,C as rr,f as De,F as Fa,R as Se,aq as sr,n as A,ar as nr}from"./SWWSvUpQ.js";import{f as u,a as i,c as At,t as Dt}from"./D8ekX_8E.js";import{a as ee,i as b,k as Ut,b as Bt,e as re,s as M,p as We}from"./CU3XCoqN.js";import{i as vt}from"./Bgyk9asy.js";import{e as et,i as ya}from"./YJAcq9su.js";import{r as za,b as or,s as at,i as ir,c as lr,d as cr,e as dr}from"./B_JQWfE2.js";import{b as vr}from"./CvxMDV_e.js";import{e as ur,g as Wt,i as _r,h as Ta,d as Kt,b as zt,a as Yt,j as Xt}from"./TJWj9Ozf.js";import{s as Ca,C as pr,E as fr,A as br}from"./DAul_XsN.js";import{z as ha,v as Pa,B as mr,e as aa,p as ue,i as xe,O as Gt,P as Ee,f as tt}from"./o_i3wQuA.js";import{C as Ea,E as gr,c as La}from"./BfK8H756.js";import{S as Ba}from"./DkmINPYC.js";import{v as ea,D as ta}from"./CVUz8n-e.js";import{s as Jt}from"./2GYSXSLF.js";import{e as Zt}from"./BdlCETRK.js";import{_ as wa}from"./CmsKOCeN.js";import{s as Wa}from"./CdEA5IGF.js";import{B as yr}from"./oNd2hj9i.js";import{R as Ft}from"./Pw8uDG7-.js";function Ra(pe,T,C){const h=ha(pe,C),F=ha(T,C),se=+h-Pa(h),I=+F-Pa(F);return Math.round((se-I)/mr)}function hr(pe,T){return ur(pe,-T)}var wr=u('<button type="button" class="btn-clear-search svelte-14zxluq" aria-label="Clear search" title="Clear search"><i class="bi bi-x-lg"></i></button>'),xr=u("<option> </option>"),Er=u('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by organization"><option>All Organizations</option><!></select></div>'),kr=u('<div class="col-12 col-md-auto"><button type="button" class="btn btn-primary w-100" aria-label="Clear all filters"><i class="bi bi-x-circle me-1"></i> Clear All</button></div>'),$r=u('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><div class="search-input-wrapper svelte-14zxluq"><input type="text" class="form-control form-control" placeholder="Search..."/> <!></div></div> <!> <!></div></div>');function Ar(pe,T){ct(T,!1);const C=()=>ee(H,"$searchQuery",se),h=()=>ee(Z,"$organizationFilter",se),F=()=>ee(E,"$currentOrganizations",se),[se,I]=Bt(),J=p(),{stores:{currentOrganizations:E,organizationFilter:Z,searchQuery:H}}=Wt(),D=()=>{Ut(H,""),Ut(Z,"")};x(()=>(C(),h()),()=>{c(J,!!(C()||h()))}),Lt(),vt();var te=$r(),z=a(te),j=a(z),L=a(j),de=a(L);za(de);var w=l(de,2);{var oe=S=>{var B=wr();re("click",B,()=>Ut(H,"")),i(S,B)};b(w,S=>{C()&&S(oe)})}t(L),t(j);var Q=l(j,2);{var Y=S=>{var B=Er(),ie=a(B);O(()=>{h(),rr(()=>{F()})});var _e=a(ie);_e.value=_e.__value="";var $e=l(_e);et($e,1,F,ya,(we,Oe)=>{var me=xr(),q=a(me,!0);t(me);var X={};O(()=>{M(q,(e(Oe),s(()=>e(Oe).label))),X!==(X=(e(Oe),s(()=>e(Oe).key)))&&(me.value=(me.__value=(e(Oe),s(()=>e(Oe).key)))??"")}),i(we,me)}),t(ie),t(B),or(ie,h,we=>Ut(Z,we)),i(S,B)};b(Q,S=>{F(),s(()=>F().length)&&S(Y)})}var ke=l(Q,2);{var V=S=>{var B=kr(),ie=a(B);t(B),re("click",ie,D),i(S,B)};b(ke,S=>{e(J)&&S(V)})}t(z),t(te),vr(de,C,S=>Ut(H,S)),i(pe,te),dt(),I()}var Dr=u('<p class="mb-0">No past events to delete.</p>'),Sr=u('<p class="mb-2"><strong> </strong></p>'),Or=u(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Ir=u("<!> <!>",1),Mr=u('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Tr(pe,T){ct(T,!1);let C=We(T,"deleted",8),h=We(T,"skipped",8),F=We(T,"callback",8);function se(){F()()}vt();var I=Mr(),J=a(I),E=a(J),Z=a(E),H=l(a(Z),2);t(Z);var D=l(Z,2),te=a(D);{var z=w=>{var oe=Dr();i(w,oe)},j=w=>{var oe=Ir(),Q=De(oe);{var Y=S=>{var B=Sr(),ie=a(B),_e=a(ie);t(ie),t(B),O(()=>M(_e,`✓ Deleted ${C()??""} past event${C()===1?"":"s"}.`)),i(S,B)};b(Q,S=>{C()>0&&S(Y)})}var ke=l(Q,2);{var V=S=>{var B=Or(),ie=a(B),_e=a(ie),$e=a(_e);t(_e),t(ie),Fa(2),t(B),O(()=>M($e,`⚠ Skipped ${h()??""} recurring event${h()===1?"":"s"}`)),i(S,B)};b(ke,S=>{h()>0&&S(V)})}i(w,oe)};b(te,w=>{C()===0&&h()===0?w(z):w(j,!1)})}t(D);var L=l(D,2),de=a(L);t(L),t(E),t(J),t(I),re("click",H,se),re("click",de,se),i(pe,I),dt()}var Cr=u(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Pr(pe,T){ct(T,!1);let C=We(T,"cutoffDate",8),h=We(T,"callback",8);function F(){h()(!0)}function se(){h()(!1)}vt();var I=Cr(),J=a(I),E=a(J),Z=a(E),H=l(a(Z),2);t(Z);var D=l(Z,2),te=a(D),z=a(te),j=a(z);t(z),t(te),Fa(2),t(D);var L=l(D,2),de=a(L),w=l(de,2);t(L),t(E),t(J),t(I),O(()=>M(j,`Are you sure you want to delete all events that occurred before ${C()??""}?`)),re("click",H,se),re("click",de,se),re("click",w,F),i(pe,I),dt()}var Rr=u('<button class="btn btn-sm btn-primary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Ur=u('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),Fr=u('<div class="d-flex align-items-center justify-content-end ms-auto"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),zr=u('<div class="d-flex flex-row align-items-start gap-3 w-100"><div class="flex-grow-1"><!></div> <!></div>'),Lr=u('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Br=u('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),Wr=u('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),Nr=u('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),jr=u('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),qr=u('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Hr=u('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Qr=u('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Vr=u('<div class="card-body text-muted small">No past events available.</div>'),Kr=u('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-primary">Hide</button></div></div></div> <!></div>'),Yr=u('<div class="d-flex flex-column gap-4"><!></div>'),Xr=u("<!> <!> <!> <!>",1);function Jr(pe,T){ct(T,!1);const C=()=>ee(Oe,"$weeksExpanded",D),h=()=>ee(ne,"$allPastEvents",D),F=()=>ee(S,"$currentUser",D),se=()=>ee(_e,"$userOrganizations",D),I=()=>ee(V,"$currentUserHasPermission",D),J=()=>ee(ie,"$currentUserIsRoot",D),E=()=>ee(B,"$currentUserIsAdmin",D),Z=()=>ee($e,"$ready",D),H=()=>ee(me,"$searchQuery",D),[D,te]=Bt(),z=p(),j=p(),L=p(),de=p(),w=p(),oe=p(),Q=p(),Y=p(),ke=p(),{stores:{currentUserHasPermission:V,currentUser:S,currentUserIsAdmin:B,currentUserIsRoot:ie,userOrganizations:_e}}=aa(),{stores:{ready:$e,dbData:we,weeksExpanded:Oe,searchQuery:me},actions:{reload:q}}=Wt(),X={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let ve=We(T,"formId",24,ea),He=p(!1),Ye=p(!1),rt=p(),ut=p(!1),_t=p(!1),Xe=p(!1),Je=p(new Set),Ne=p(!1),yt=p(""),st=p({...X}),Ze=p(!1),d=p(""),g=p(!1),f=p({deleted:0,skipped:0});const K=4,ge=4;let fe=p(K),Ce=p(!1);const W=Jt();let o=p({});function _(n){return e(z).includes(n)}function m(n){const v=e(o)[n]??_(n);c(o,{...e(o),[n]:!v})}const k=n=>{c(yt,"Event Item"),c(st,{...n,organization:n?.meta_data?.organization??""})},ne=tr(we,n=>{const v=Jt();return(n??[]).filter(r=>!(r.event_type!=="calendar_event"||!r.start_time||ue(r.start_time)>=v||r.recurrence_rule&&(!r.recurrence_end_date||r.recurrence_end_date&&ue(r.recurrence_end_date)>=v)))}),Ie=n=>La(n,{currentUserId:e(rt),isPrivileged:e(Ye),canEditOwnOrgEvents:e(Xe),userOrganizations:e(Je)});let be=p(!1);function N(){c(fe,e(fe)+ge)}function Me(){c(fe,520),c(Ce,!0)}function Pe(){c(fe,K),c(Ce,!1)}const je=()=>{if(!e(He)||e(Ne)||!ar(ie)||!e(Y))return;const n=Jt();c(d,xe(n,"MMM d, yyyy")),c(Ze,!0)};async function qe(n){if(c(Ze,!1),!n)return;const v=Jt();c(Ne,!0);try{const r=await _r(v);await q(),c(f,r),c(g,!0)}catch(r){console.error("Failed to delete past events",r),alert("Failed to delete past events. Please try again.")}finally{c(Ne,!1)}}function nt(){c(g,!1)}xa(async()=>{await q()}),x(()=>(h(),e(fe)),()=>{c(L,(h()??[]).filter(n=>{if(!n.start_time)return!1;const v=ue(n.start_time),r=hr(W,e(fe));return v>=r&&v<W}))}),x(()=>(e(L),xe),()=>{c(w,(()=>{const n=new Map;for(const v of e(L)){if(!v.start_time)continue;const r=ue(v.start_time),y=ha(r,{weekStartsOn:1}),R=Zt(r,{weekStartsOn:1}),U=xe(y,"yyyy-MM-dd"),le=`${xe(y,"MMM d")} – ${xe(R,"MMM d")}`;let ae=n.get(U);ae||(ae={key:U,label:le,days:new Map},n.set(U,ae));const ce=xe(r,"yyyy-MM-dd");let Ae=ae.days.get(ce);Ae||(Ae={key:ce,displayDay:xe(r,"EEE"),displayDate:xe(r,"MMM d"),events:[]},ae.days.set(ce,Ae)),Ae.events.push(v)}return Array.from(n.values()).sort((v,r)=>v.key<r.key?1:-1).map(v=>({key:v.key,label:v.label,days:Array.from(v.days.values()).sort((r,y)=>r.key<y.key?1:-1).map(r=>({...r,events:r.events.slice().sort((y,R)=>{const U=y.is_all_day?0:1,le=R.is_all_day?0:1;if(U!==le)return U-le;const ae=y.start_time?ue(y.start_time).getTime():Number.MAX_SAFE_INTEGER,ce=R.start_time?ue(R.start_time).getTime():Number.MAX_SAFE_INTEGER;return ae-ce})}))}))})())}),x(()=>e(w),()=>{c(z,(()=>{if(e(w).length===0)return[];const n=[];return e(w)[0]&&n.push(e(w)[0].key),e(w)[1]&&n.push(e(w)[1].key),n})())}),x(()=>(C(),e(o)),()=>{c(j,n=>C()?!0:e(o)[n]!==void 0?e(o)[n]:_(n))}),x(()=>e(L),()=>{c(de,e(L).length)}),x(()=>(e(w),xe),()=>{c(oe,e(w).reduce((n,v)=>{const r=ue(v.key),y=Zt(r,{weekStartsOn:1}),R=xe(y,"yyyy-MM"),U=xe(y,"MMMM yyyy");return n[R]||(n[R]={label:U,weeks:[]}),n[R].weeks.push(v),n},{}))}),x(()=>F(),()=>{c(rt,F()?.id)}),x(()=>se(),()=>{c(Je,se())}),x(()=>e(rt),()=>{c(_t,!!e(rt))}),x(()=>(e(Je),Gt),()=>{c(ut,e(Je).has(Gt.Bishopric))}),x(()=>(I(),Ee),()=>{c(Xe,I()(Ee.EditOwnOrgEvents))}),x(()=>(J(),E(),e(ut),I(),Ee),()=>{c(Ye,J()||E()||e(ut)||I()(Ee.EditAllEvents))}),x(()=>(e(Ye),I(),e(Xe),e(_t)),()=>{c(He,e(Ye)||I()(Ee.CreateEvents)||e(Xe)||e(_t))}),x(()=>(I(),Ee),()=>{c(Q,I()(Ee.DeleteEvents))}),x(()=>e(L),()=>{c(Y,e(L).length>0)}),x(()=>(h(),e(L)),()=>{c(ke,h().length>e(L).length)}),Lt(),vt();var ot=Xr(),it=De(ot);ta(it,{get title(){return e(yt)},get id(){return ve()},children:(n,v)=>{Ea(n,{get eventItem(){return e(st)},get drawerId(){return ve()},name:"past-event-item-form",get canDelete(){return e(Q)}})},$$slots:{default:!0}});var Re=l(it,2);{var ht=n=>{var v=At(),r=De(v);{var y=U=>{var le=At(),ae=De(le);{var ce=Qe=>{var Ue=Rr(),Ge=l(a(Ue));t(Ue),O(()=>M(Ge,` Show Past Events (${h(),s(()=>h().length)??""})`)),re("click",Ue,()=>c(be,!0)),i(Qe,Ue)},Ae=Qe=>{var Ue=Kr(),Ge=a(Ue),Nt=a(Ge),Ot=l(a(Nt),2),It=a(Ot);{var ra=Fe=>{var Le=Ur(),pt=a(Le);{var Tt=ye=>{var ze=Dt("Deleting…");i(ye,ze)},ft=ye=>{var ze=Dt();O(()=>M(ze,`Delete All (${e(de)??""})`)),i(ye,ze)};b(pt,ye=>{e(Ne)?ye(Tt):ye(ft,!1)})}t(Le),O(()=>Le.disabled=e(Ne)),re("click",Le,je),i(Fe,Le)};b(It,Fe=>{J()&&e(Y)&&Fe(ra)})}var Mt=l(It,2);t(Ot),t(Nt),t(Ge);var jt=l(Ge,2);{var sa=Fe=>{var Le=Qr(),pt=De(Le);et(pt,5,()=>(e(oe),s(()=>Object.entries(e(oe)))),([ye,ze])=>ye,(ye,ze)=>{var bt=sr(()=>nr(e(ze),2));let lt=()=>e(bt)[1];var mt=Nr(),Ve=De(mt),Et=a(Ve,!0);t(Ve);var Ke=l(Ve,2);et(Ke,1,()=>(lt(),s(()=>lt().weeks)),Be=>Be.key,(Be,he)=>{const $=Se(()=>(A(ue),e(he),s(()=>ue(e(he).key)))),P=Se(()=>(A(Zt),A(e($)),s(()=>Zt(e($),{weekStartsOn:1})))),Te=Se(()=>(A(Ca),A(e(P)),s(()=>Ca(e(P))))),gt=Se(()=>(A(Ra),A(e(P)),A(e(Te)),s(()=>Ra(e(P),e(Te),{weekStartsOn:1})+1))),oa=Se(()=>(e(j),e(he),s(()=>e(j)(e(he).key)))),qt=Se(()=>(e(he),s(()=>e(he).days.reduce((Pt,Ht)=>Pt+Ht.events.length,0))));var ka=Wr(),ia=De(ka),Ct=a(ia);let $a;var la=a(Ct),Aa=a(la),Da=l(Aa,2),Na=a(Da);t(Da),t(la);var ca=l(la,2);let Sa;var ja=a(ca,!0);t(ca),t(Ct),t(ia);var qa=l(ia,2);{var Ha=Pt=>{var Ht=At(),Qa=De(Ht);{var Va=kt=>{var Qt=At(),Ya=De(Qt);et(Ya,1,()=>(e(he),s(()=>e(he).days)),da=>da.key,(da,$t)=>{var va=Lr(),Oa=a(va),ua=a(Oa),_a=a(ua),Xa=a(_a,!0);t(_a);var Ia=l(_a,2),Ja=a(Ia,!0);t(Ia),t(ua);var Ma=l(ua,2);et(Ma,5,()=>(e($t),s(()=>e($t).events)),Rt=>Rt.id??`${Rt.start_time}-${Rt.meta_data?.recurring_instance_index??0}`,(Rt,Vt)=>{var pa=zr(),fa=a(pa),Za=a(fa);gr(Za,{get item(){return e(Vt)},showDate:!1,get searchQuery(){return H()}}),t(fa);var Ga=l(fa,2);{var er=ba=>{var ma=Fr(),ga=a(ma);t(ma),O(()=>{at(ga,"data-bs-target",`#${ve()??""}`),at(ga,"aria-controls",ve())}),re("click",ga,()=>k(e(Vt))),i(ba,ma)};b(Ga,ba=>{e(Vt),s(()=>Ie(e(Vt)))&&ba(er)})}t(pa),i(Rt,pa)}),t(Ma),t(Oa),t(va),O(()=>{M(Xa,(e($t),s(()=>e($t).displayDay))),M(Ja,(e($t),s(()=>e($t).displayDate)))}),i(da,va)}),i(kt,Qt)},Ka=kt=>{var Qt=Br();i(kt,Qt)};b(Qa,kt=>{e(he),s(()=>e(he).days.length)?kt(Va):kt(Ka,!1)})}i(Pt,Ht)};b(qa,Pt=>{e(oa)&&Pt(Ha)})}O(()=>{$a=tt(Ct,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,$a,{"text-muted":e(qt)===0}),at(Ct,"title",e(oa)?"Click to collapse week":"Click to expand week"),tt(Aa,1,`bi ${e(oa)?"bi-chevron-up":"bi-chevron-down"}`),M(Na,`Week ${e(gt)??""} [${e(qt)??""} Event${e(qt)===1?"":"s"}]`),Sa=tt(ca,1,"",null,Sa,{"opacity-50":e(qt)===0}),M(ja,(e(he),s(()=>e(he).label)))}),re("click",Ct,()=>m(e(he).key)),i(Be,ka)}),O(()=>M(Et,(lt(),s(()=>lt().label)))),i(ye,mt)}),t(pt);var Tt=l(pt,2);{var ft=ye=>{var ze=Hr(),bt=a(ze),lt=a(bt);t(bt);var mt=l(bt,2);{var Ve=Ke=>{var Be=jr();re("click",Be,Pe),i(Ke,Be)},Et=Ke=>{var Be=qr(),he=a(Be),$=l(he,2);t(Be),re("click",he,N),re("click",$,Me),i(Ke,Be)};b(mt,Ke=>{e(Ce)?Ke(Ve):Ke(Et,!1)})}t(ze),O(()=>M(lt,`Showing ${e(L),s(()=>e(L)?.length??0)??""} of ${h(),s(()=>h()?.length??0)??""}`)),i(ye,ze)};b(Tt,ye=>{(e(ke)||e(Ce))&&ye(ft)})}i(Fe,Le)},na=Fe=>{var Le=Vr();i(Fe,Le)};b(jt,Fe=>{e(w),s(()=>e(w).length)?Fe(sa):Fe(na,!1)})}t(Ue),re("click",Mt,()=>c(be,!1)),i(Qe,Ue)};b(ae,Qe=>{e(be)?Qe(Ae,!1):Qe(ce)})}i(U,le)},R=U=>{var le=Yr(),ae=a(le);Ba(ae,{}),t(le),i(U,le)};b(r,U=>{Z()?U(y):U(R,!1)})}i(n,v)};b(Re,n=>{J()&&n(ht)})}var wt=l(Re,2);{var xt=n=>{Pr(n,{get cutoffDate(){return e(d)},callback:qe})};b(wt,n=>{e(Ze)&&n(xt)})}var St=l(wt,2);{var G=n=>{Tr(n,{get deleted(){return e(f),s(()=>e(f).deleted)},get skipped(){return e(f),s(()=>e(f).skipped)},callback:nt})};b(St,n=>{e(g)&&n(G)})}i(pe,ot),dt(),te()}var Zr=u("<span> </span>"),Gr=u('<span class="badge bg-secondary">All Day</span>'),es=u('<span class="result-time svelte-1xkw8oa"> </span>'),ts=u('<span class="result-date svelte-1xkw8oa"> </span> <!>',1),as=u('<span class="result-location svelte-1xkw8oa"><i class="bi bi-geo-alt"></i> <!></span>'),rs=u('<div class="result-thumbnail-container svelte-1xkw8oa"><img class="result-thumbnail svelte-1xkw8oa"/></div>'),ss=u('<div class="result-actions svelte-1xkw8oa"><button type="button" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i></button></div>'),ns=u('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="result-details-button svelte-1xkw8oa"><div class="result-header svelte-1xkw8oa"><div class="result-title svelte-1xkw8oa"><!></div> <span class="result-type-badge badge bg-secondary-subtle text-secondary-emphasis svelte-1xkw8oa"> </span></div> <div class="result-meta svelte-1xkw8oa"><!> <!> <!></div></button> <!> <!></li>'),os=u('<div class="unified-search-results svelte-1xkw8oa"><div class="search-results-header svelte-1xkw8oa"><h6 class="search-results-title svelte-1xkw8oa"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),is=u('<div class="no-search-results svelte-1xkw8oa"> </div>'),ls=u("<!> <!> <!>",1);function cs(pe,T){ct(T,!1);const C=()=>ee(j,"$currentUser",H),h=()=>ee(oe,"$userOrganizations",H),F=()=>ee(L,"$currentUserHasPermission",H),se=()=>ee(w,"$currentUserIsRoot",H),I=()=>ee(de,"$currentUserIsAdmin",H),J=()=>ee(Q,"$calendarEvents",H),E=()=>ee(ke,"$searchQuery",H),Z=()=>ee(Y,"$announcements",H),[H,D]=Bt(),te=p(),z=p(),{stores:{currentUser:j,currentUserHasPermission:L,currentUserIsAdmin:de,currentUserIsRoot:w,userOrganizations:oe}}=aa(),{stores:{calendarEvents:Q,announcements:Y,searchQuery:ke}}=Wt(),V=ea(),S=ea();let B=p(!1),ie=p(),_e=p(!1),$e=p(!1),we=p(new Set),Oe=p(""),me=p({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),q=p({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),X=p(!1);const ve=d=>La(d,{currentUserId:e(ie),isPrivileged:e(B),canEditOwnOrgEvents:e($e),userOrganizations:e(we)}),He=d=>d.startsWith("image/"),Ye=async d=>{const g=d.itemType==="announcement"?"announcement":"calendar_event";if(c(Oe,`${d.itemType==="announcement"?"Announcement":"Event"} Form`),d?.meta_data?.recurring_instance&&d?.meta_data?.recurring_parent_id){const{getCalendarEvent:f}=await wa(async()=>{const{getCalendarEvent:ge}=await import("./TJWj9Ozf.js").then(fe=>fe.y);return{getCalendarEvent:ge}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),K=await f(d.meta_data.recurring_parent_id);if(K){c(me,{...K,organization:K?.meta_data?.organization??"",event_type:g,start_time:d.start_time,end_time:d.end_time,meta_data:{...K.meta_data,recurring_instance:!0,recurring_parent_id:d.meta_data.recurring_parent_id,recurring_instance_index:d.meta_data.recurring_instance_index}});return}}c(me,{...d,organization:d?.meta_data?.organization??"",event_type:g})},rt=async d=>{if(d?.meta_data?.recurring_instance&&d?.meta_data?.recurring_parent_id){const{getCalendarEvent:f}=await wa(async()=>{const{getCalendarEvent:ge}=await import("./TJWj9Ozf.js").then(fe=>fe.y);return{getCalendarEvent:ge}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),K=await f(d.meta_data.recurring_parent_id);K?c(q,{...K,start_time:d.start_time,end_time:d.end_time,meta_data:{...K.meta_data,recurring_instance:!0,recurring_parent_id:d.meta_data.recurring_parent_id,recurring_instance_index:d.meta_data.recurring_instance_index}}):c(q,d)}else c(q,d);const g=document.getElementById(S);g&&new window.bootstrap.Offcanvas(g).show()},ut=async d=>{await Ye(d);const g=document.getElementById(V);g&&new window.bootstrap.Offcanvas(g).show()},_t=async()=>{const d=document.getElementById(S);if(d){const g=window.bootstrap.Offcanvas.getInstance(d);g&&g.hide()}await Ye(e(q)),setTimeout(()=>{const g=document.getElementById(V);g&&new window.bootstrap.Offcanvas(g).show()},300)};x(()=>C(),()=>{c(ie,C()?.id)}),x(()=>h(),()=>{c(we,h())}),x(()=>(e(we),Gt),()=>{c(_e,e(we).has(Gt.Bishopric))}),x(()=>(F(),Ee),()=>{c($e,F()(Ee.EditOwnOrgEvents))}),x(()=>(se(),I(),e(_e),F(),Ee),()=>{c(B,se()||I()||e(_e)||F()(Ee.EditAllEvents))}),x(()=>(F(),Ee),()=>{c(X,F()(Ee.DeleteEvents))}),x(()=>(J(),ue),()=>{c(te,(J()??[]).filter(d=>d.start_time?ue(d.start_time)>=new Date:!1))}),x(()=>(E(),e(te),Z(),ue),()=>{c(z,E()?[...e(te).filter(d=>{const g=E().toLowerCase(),f=(d.title||"").toLowerCase(),K=(d.description||"").replace(/<[^>]*>/g,"").toLowerCase(),ge=(d.location||"").toLowerCase();return f.includes(g)||K.includes(g)||ge.includes(g)}).map(d=>({...d,itemType:"event"})),...(Z()??[]).filter(d=>{const g=E().toLowerCase(),f=(d.title||"").toLowerCase(),K=(d.description||"").replace(/<[^>]*>/g,"").toLowerCase(),ge=(d.location||"").toLowerCase();return f.includes(g)||K.includes(g)||ge.includes(g)}).map(d=>({...d,itemType:"announcement"}))].sort((d,g)=>{const f=d.start_time?ue(d.start_time).getTime():0,K=g.start_time?ue(g.start_time).getTime():0;return f===0&&K!==0?-1:f!==0&&K===0?1:f-K}):[])}),Lt(),vt();var Xe=ls(),Je=De(Xe);ta(Je,{get title(){return e(Oe)},get id(){return V},children:(d,g)=>{Ea(d,{get eventItem(){return e(me)},get drawerId(){return V},name:"unified-search-form",get canDelete(){return e(X)}})},$$slots:{default:!0}});var Ne=l(Je,2);ta(Ne,{title:"Details",get id(){return S},children:(d,g)=>{{let f=Se(()=>(e(q),s(()=>ve(e(q)))));pr(d,{get event(){return e(q)},get canEdit(){return e(f)},onEdit:_t})}},$$slots:{default:!0}});var yt=l(Ne,2);{var st=d=>{var g=os(),f=a(g),K=a(f),ge=a(K);t(K),t(f);var fe=l(f,2);et(fe,5,()=>e(z),Ce=>Ce.id??Ce.start_time??Math.random(),(Ce,W)=>{const o=Se(()=>(e(W),s(()=>e(W).attachments?.find(v=>He(v.type))))),_=Se(()=>(A(zt),e(W),s(()=>zt(e(W)?.meta_data?.organization??"")))),m=Se(()=>(e(W),s(()=>e(W).itemType==="event")));var k=ns(),ne=a(k),Ie=l(ne,2),be=a(Ie),N=a(be),Me=a(N);Ta(Me,()=>(A(Kt),e(W),E(),s(()=>Kt(e(W).title,E())))),t(N);var Pe=l(N,2),je=a(Pe,!0);t(Pe),t(be);var qe=l(be,2),nt=a(qe);{var ot=v=>{var r=Zr(),y=a(r,!0);t(r),O(()=>{tt(r,1,`badge rounded-pill bg-color-${A(e(_)),s(()=>e(_).color_number)??""}`,"svelte-1xkw8oa"),M(y,(A(e(_)),s(()=>e(_).label)))}),i(v,r)};b(nt,v=>{A(e(_)),s(()=>e(_)?.label)&&v(ot)})}var it=l(nt,2);{var Re=v=>{var r=ts(),y=De(r),R=a(y,!0);t(y);var U=l(y,2);{var le=ce=>{var Ae=Gr();i(ce,Ae)},ae=ce=>{var Ae=es(),Qe=a(Ae,!0);t(Ae),O(Ue=>M(Qe,Ue),[()=>(A(xe),A(ue),e(W),s(()=>xe(ue(e(W).start_time),"h:mm a")))]),i(ce,Ae)};b(U,ce=>{e(W),s(()=>e(W).is_all_day)?ce(le):ce(ae,!1)})}O(ce=>M(R,ce),[()=>(A(xe),A(ue),e(W),s(()=>xe(ue(e(W).start_time),"MMM d, yyyy")))]),i(v,r)};b(it,v=>{e(W),s(()=>e(W).start_time)&&v(Re)})}var ht=l(it,2);{var wt=v=>{var r=as(),y=l(a(r),2);Ta(y,()=>(A(Kt),e(W),E(),s(()=>Kt(e(W).location,E())))),t(r),i(v,r)};b(ht,v=>{e(W),s(()=>e(W).location)&&v(wt)})}t(qe),t(Ie);var xt=l(Ie,2);{var St=v=>{var r=rs(),y=a(r);t(r),O(()=>{at(y,"src",(A(e(o)),s(()=>e(o).url))),at(y,"alt",(A(e(o)),s(()=>e(o).name)))}),i(v,r)};b(xt,v=>{e(o)&&v(St)})}var G=l(xt,2);{var n=v=>{var r=ss(),y=a(r);t(r),O(()=>at(y,"title",`Edit ${e(m)?"event":"announcement"}`)),re("click",y,Wa(()=>ut(e(W)))),i(v,r)};b(G,v=>{e(W),s(()=>ve(e(W)))&&v(n)})}t(k),O(()=>{tt(ne,1,`result-color-indicator bg-color-${A(e(_)),s(()=>e(_)?.color_number??0)??""}`,"svelte-1xkw8oa"),M(je,e(m)?"Event":"Announcement")}),re("click",Ie,()=>rt(e(W))),i(Ce,k)}),t(fe),t(g),O(()=>M(ge,`${e(z),s(()=>e(z).length)??""} result${e(z),s(()=>e(z).length===1?"":"s")??""} matching "${E()??""}"`)),i(d,g)},Ze=d=>{var g=At(),f=De(g);{var K=ge=>{var fe=is(),Ce=a(fe);t(fe),O(()=>M(Ce,`No results match your search for "${E()??""}"`)),i(ge,fe)};b(f,ge=>{E()&&ge(K)},!0)}i(d,g)};b(yt,d=>{E(),e(z),s(()=>E()&&e(z).length>0)?d(st):d(Ze,!1)})}i(pe,Xe),dt(),D()}var ds=u("<!> <!> <!>",1),vs=u('<div class="d-flex flex-column gap-4"><!> <!></div>');function Ua(pe,T){ct(T,!1);const C=()=>ee(se,"$searchQuery",h),[h,F]=Bt(),{stores:{searchQuery:se}}=Wt();let I=We(T,"showAnnouncements",8,!0),J=We(T,"showSearch",8,!0);vt();var E=vs(),Z=a(E);{var H=j=>{Ar(j,{})};b(Z,j=>{J()&&j(H)})}var D=l(Z,2);{var te=j=>{cs(j,{})},z=j=>{var L=ds(),de=De(L);{var w=Y=>{br(Y,{})};b(de,Y=>{I()&&Y(w)})}var oe=l(de,2);fr(oe,{});var Q=l(oe,2);Jr(Q,{}),i(j,L)};b(D,j=>{J()&&C()?j(te):j(z,!1)})}t(E),i(pe,E),dt(),F()}var us=u('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),_s=u('<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"> </span>'),ps=u('<button type="button" role="tab"> <!></button>'),fs=u("<option> </option>"),bs=u('<div class="py-5 text-center text-muted"><!></div>'),ms=u('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),gs=u("<span> </span>"),ys=u('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),hs=u('<span><i class="bi bi-geo-alt"></i> </span>'),ws=u('<span><i class="bi bi-arrow-repeat"></i> </span>'),xs=u('<span><i class="bi bi-calendar3"></i> </span>'),Es=u('<span class="text-muted small"> </span>'),ks=u('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-primary" type="button"><i class="bi bi-pencil-square"></i></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),$s=u('<div class="d-flex flex-column gap-3"></div>'),As=u('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="card"><div class="card-header d-flex flex-column gap-3"><div class="d-flex flex-md-row align-items-center justify-content-between gap-2"><div class="mb-0">My Submissions</div> <button class="btn btn-primary btn-sm"><!></button></div> <div class="submissions-status-tabs nav nav-pills gap-4" role="tablist"></div></div> <div class="card-body d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3"><div class="input-group input-group-sm my-submissions-search svelte-9fakr"><input class="form-control svelte-9fakr" type="search" placeholder="Search title, category, or location"/></div> <div class="type-filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div> <!></div></div></div>'),Ds=u('<div class="text-muted">Select a submission to edit.</div>'),Ss=u("<!> <!>",1);function Os(pe,T){ct(T,!1);const C=()=>ee(w,"$currentUserStore",I),h=()=>ee(oe,"$currentUserHasPermission",I),F=()=>ee(L,"$dbData",I),se=()=>ee(j,"$ready",I),[I,J]=Bt(),E=p(),Z=p(),H=p(),D=p(),te=p(),z=p(),{stores:{ready:j,dbData:L},actions:{reload:de}}=Wt(),{stores:{currentUser:w,currentUserHasPermission:oe}}=aa();let Q=p(!1),Y=p([]),ke=p([]),V=p(null);const S=ea();let B=null;const ie={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},_e={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},$e={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},we=[{value:"pending",label:$e.pending},{value:"needs_review",label:$e.needs_review},{value:"approved",label:$e.approved},{value:"published",label:$e.published}],Oe=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}],me=()=>({search:"",typeFilter:"all"});let q=p({pending:me(),needs_review:me(),approved:me(),published:me()});xa(async()=>{c(Q,!0),await de(),c(Q,!1),typeof window<"u"&&(B=(await wa(()=>import("./DO0djbQe.js").then(_=>_.o),__vite__mapDeps([27,28]),import.meta.url)).default)});const X=o=>{const _=o.meta_data?.submitted_at??o.created_at;if(!_)return 0;try{return ue(_).getTime()}catch(m){return console.warn("Failed to parse submission timestamp",m),0}},ve=o=>{const _=o.meta_data?.submitted_at??o.created_at;if(!_)return"—";try{return xe(ue(_),"MMM d, yyyy 'at' h:mm a")}catch(m){return console.warn("Failed to format submission timestamp",m),"—"}},He=o=>{if(!o.start_time)return"—";try{return xe(ue(o.start_time),"MMM d, yyyy 'at' h:mm a")}catch(_){return console.warn("Failed to format event date",_),"—"}},Ye=o=>o.replace(/<[^>]*>/g,""),rt=(o,_)=>o.length<=_?o:o.substring(0,_).trimEnd()+"…",ut=o=>o.description?rt(Ye(o.description).trim(),120):"",_t=o=>{try{const m=Ft.fromString(o).origOptions,k=m.interval||1,ne=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ie=["","1st","2nd","3rd","4th","5th"];if(m.freq===Ft.DAILY)return k===1?"Repeats daily":`Repeats every ${k} days`;if(m.freq===Ft.WEEKLY){if(m.byweekday){const N=(Array.isArray(m.byweekday)?m.byweekday:[m.byweekday]).map(Me=>{const Pe=typeof Me=="number"?Me:Me.weekday,je=Pe===6?0:Pe+1;return ne[je]});return k===1?N.length===1?`Repeats every ${N[0]}`:`Repeats on ${N.join(", ")}`:`Repeats every ${k} weeks on ${N.join(", ")}`}return k===1?"Repeats weekly":`Repeats every ${k} weeks`}if(m.freq===Ft.MONTHLY){if(m.byweekday){const N=(Array.isArray(m.byweekday)?m.byweekday:[m.byweekday])[0];if(N&&typeof N=="object"&&"n"in N&&"weekday"in N){const Me=N.weekday,Pe=Me===6?0:Me+1,je=N.n,qe=Ie[je]||`${je}th`;return k===1?`Repeats on the ${qe} ${ne[Pe]} of the month`:`Repeats on the ${qe} ${ne[Pe]} every ${k} months`}}if(m.bymonthday){const be=Array.isArray(m.bymonthday)?m.bymonthday[0]:m.bymonthday,N=be===1?"st":be===2?"nd":be===3?"rd":"th";return k===1?`Repeats on the ${be}${N} of the month`:`Repeats on the ${be}${N} every ${k} months`}return k===1?"Repeats monthly":`Repeats every ${k} months`}return m.freq===Ft.YEARLY?k===1?"Repeats yearly":`Repeats every ${k} years`:"Repeats"}catch{return"Repeats"}},Xe=(o,_)=>{const m=_.trim().toLowerCase();if(!m)return!0;const k=o.meta_data?.organization?zt(o.meta_data.organization)?.label??"":"";return[o.title??"",o.description??"",o.location??"",k??""].join(" ").toLowerCase().includes(m)},Je=(o,_)=>_==="all"?!0:_==="events"?o.event_type==="calendar_event":o.event_type==="announcement";function Ne(o,_){c(q,{...e(q),[o]:{...e(q)[o],..._}})}const yt=o=>{const _=new Set,m=[];for(const k of o){const ne=k.meta_data?.recurring_parent_id;if(k.meta_data?.recurring_instance&&ne!=null){if(_.has(ne))continue;_.add(ne)}m.push(k)}return m},st=o=>o.meta_data?.recurring_parent_id!=null?`recurring-${o.meta_data.recurring_parent_id}`:`id-${o.id}`,Ze=o=>{c(V,o);const _=document.getElementById(S);_&&B&&B.getOrCreateInstance(_).show()},d=(o,_)=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),Ze(_))},g=async()=>{c(Q,!0),await de(),c(Q,!1)};let f=p("pending");x(()=>C(),()=>{c(E,C())}),x(()=>(h(),Ee),()=>{c(Z,h()(Ee.DeleteEvents)||h()(Ee.DeleteOwnEvents))}),x(()=>(F(),e(E)),()=>{c(Y,yt((F()??[]).filter(o=>{const _=o.meta_data?.submitted_by_user_id;return _&&e(E)?.id&&_===e(E).id}).sort((o,_)=>X(o)-X(_))))}),x(()=>e(f),()=>{c(H,`type-filter-select-submissions-${e(f)}`)}),x(()=>(e(Y),Yt),()=>{c(D,we.reduce((o,_)=>(o[_.value]=e(Y).filter(m=>Yt(m)===_.value),o),{}))}),x(()=>(e(q),e(D)),()=>{c(te,we.reduce((o,_)=>{const m=e(q)[_.value],k=(e(D)[_.value]??[]).filter(ne=>Je(ne,m.typeFilter));return o[_.value]=k.filter(ne=>Xe(ne,m.search)),o},{}))}),x(()=>(e(te),e(f)),()=>{c(ke,e(te)[e(f)]??[])}),x(()=>(e(V),e(Y)),()=>{e(V)&&!e(Y).some(o=>st(o)===st(e(V)))&&c(V,null)}),x(()=>e(V),()=>{c(z,e(V)?{...e(V),id:e(V).id??e(V).meta_data?.recurring_parent_id,organization:e(V).meta_data?.organization??""}:null)}),Lt(),vt();var K=Ss(),ge=De(K);{var fe=o=>{var _=us(),m=a(_);Ba(m,{}),t(_),i(o,_)},Ce=o=>{var _=As(),m=a(_),k=a(m),ne=a(k),Ie=l(a(ne),2),be=a(Ie);{var N=G=>{var n=Dt("Refreshing…");i(G,n)},Me=G=>{var n=Dt("Refresh");i(G,n)};b(be,G=>{e(Q)?G(N):G(Me,!1)})}t(Ie),t(ne);var Pe=l(ne,2);et(Pe,5,()=>we,ya,(G,n)=>{const v=Se(()=>(e(D),e(n),s(()=>(e(D)[e(n).value]??[]).length)));var r=ps(),y=a(r),R=l(y);{var U=le=>{var ae=_s(),ce=a(ae,!0);t(ae),O(()=>M(ce,e(v))),i(le,ae)};b(R,le=>{e(v)>0&&le(U)})}t(r),O(()=>{tt(r,1,(e(f),e(n),s(()=>`nav-link position-relative ${e(f)===e(n).value?"active":"border border-secondary"}`)),"svelte-9fakr"),at(r,"aria-selected",(e(f),e(n),s(()=>e(f)===e(n).value))),M(y,`${e(n),s(()=>e(n).label)??""} `)}),re("click",r,()=>c(f,e(n).value)),i(G,r)}),t(Pe),t(k);var je=l(k,2),qe=a(je),nt=a(qe),ot=a(nt);za(ot),t(nt);var it=l(nt,2),Re=a(it);et(Re,5,()=>Oe,ya,(G,n)=>{var v=fs(),r=a(v,!0);t(v);var y={};O(()=>{M(r,(e(n),s(()=>e(n).label))),y!==(y=(e(n),s(()=>e(n).value)))&&(v.value=(v.__value=(e(n),s(()=>e(n).value)))??"")}),i(G,v)}),t(Re);var ht;ir(Re),t(it),t(qe);var wt=l(qe,2);{var xt=G=>{var n=bs(),v=a(n);{var r=R=>{var U=Dt("You haven't submitted any events or announcements yet.");i(R,U)},y=R=>{var U=Dt();O(le=>M(U,`No ${le??""} submissions match your current filters.`),[()=>(e(f),s(()=>$e[e(f)].toLowerCase()))]),i(R,U)};b(v,R=>{e(Y),s(()=>e(Y).length===0)?R(r):R(y,!1)})}t(n),i(G,n)},St=G=>{var n=$s();et(n,5,()=>e(ke),v=>st(v),(v,r)=>{const y=Se(()=>(A(Yt),e(r),s(()=>Yt(e(r))))),R=Se(()=>(A(e(y)),s(()=>_e[e(y)]))),U=Se(()=>(e(r),A(zt),s(()=>e(r).meta_data?.organization?zt(e(r).meta_data.organization):null))),le=Se(()=>(e(r),s(()=>ut(e(r)))));var ae=ks(),ce=a(ae),Ae=a(ce),Qe=a(Ae,!0);t(Ae);var Ue=l(Ae,2),Ge=a(Ue),Nt=a(Ge,!0);t(Ge);var Ot=l(Ge,2);t(Ue),t(ce);var It=l(ce,2);{var ra=$=>{var P=ms(),Te=a(P,!0);t(P),O(()=>M(Te,e(le))),i($,P)};b(It,$=>{e(le)&&$(ra)})}var Mt=l(It,2),jt=a(Mt);{var sa=$=>{var P=gs(),Te=a(P,!0);t(P),O(()=>{tt(P,1,`badge rounded-pill bg-color-${A(e(U)),s(()=>e(U).color_number)??""}`,"svelte-9fakr"),M(Te,(A(e(U)),s(()=>e(U).label)))}),i($,P)},na=$=>{var P=ys();i($,P)};b(jt,$=>{e(U)?$(sa):$(na,!1)})}var Fe=l(jt,2);{var Le=$=>{var P=hs(),Te=l(a(P));t(P),O(()=>M(Te,` ${e(r),s(()=>e(r).location)??""}`)),i($,P)};b(Fe,$=>{e(r),s(()=>e(r).location)&&$(Le)})}var pt=l(Fe,2);{var Tt=$=>{var P=ws(),Te=l(a(P));t(P),O(gt=>M(Te,` ${gt??""}`),[()=>(e(r),s(()=>_t(e(r).recurrence_rule)))]),i($,P)};b(pt,$=>{e(r),s(()=>e(r).recurrence_rule)&&$(Tt)})}t(Mt);var ft=l(Mt,2),ye=a(ft),ze=l(a(ye));t(ye);var bt=l(ye,2);{var lt=$=>{var P=xs(),Te=l(a(P));t(P),O(gt=>M(Te,` Event ${gt??""}`),[()=>(e(r),s(()=>He(e(r))))]),i($,P)};b(bt,$=>{e(r),s(()=>e(r).event_type==="calendar_event")&&$(lt)})}t(ft);var mt=l(ft,2),Ve=a(mt),Et=a(Ve),Ke=l(Et,1,!0);t(Ve);var Be=l(Ve,2);{var he=$=>{var P=Es(),Te=a(P);t(P),O(gt=>M(Te,`Approvals: ${gt??""} of 3`),[()=>(A(Xt),e(r),s(()=>Xt(e(r))))]),i($,P)};b(Be,$=>{A(Xt),e(r),s(()=>Xt(e(r))>0)&&$(he)})}t(mt),t(ae),O($=>{dr(ae,`border-left: 4px solid ${A(e(y)),s(()=>ie[e(y)])??""}`),M(Qe,(e(r),s(()=>e(r).title))),M(Nt,(e(r),s(()=>e(r).event_type==="calendar_event"?"Event":"Announcement"))),at(Ot,"aria-label",(e(r),s(()=>`Edit ${e(r).title}`))),M(ze,` Submitted ${$??""}`),tt(Ve,1,(A(e(R)),s(()=>`badge ${e(R).class}`)),"svelte-9fakr"),tt(Et,1,(A(e(R)),s(()=>`bi ${e(R).icon} me-1`)),"svelte-9fakr"),M(Ke,(A(e(R)),s(()=>e(R).text)))},[()=>(e(r),s(()=>ve(e(r))))]),re("click",Ot,Wa(()=>Ze(e(r)))),re("click",ae,()=>Ze(e(r))),re("keydown",ae,$=>d($,e(r))),i(v,ae)}),t(n),i(G,n)};b(wt,G=>{e(ke),s(()=>e(ke).length===0)?G(xt):G(St,!1)})}t(je),t(m),t(_),O(()=>{Ie.disabled=e(Q),lr(ot,(e(q),e(f),s(()=>e(q)[e(f)].search))),at(Re,"id",e(H)),ht!==(ht=(e(q),e(f),s(()=>e(q)[e(f)].typeFilter)))&&(Re.value=(Re.__value=(e(q),e(f),s(()=>e(q)[e(f)].typeFilter)))??"",cr(Re,(e(q),e(f),s(()=>e(q)[e(f)].typeFilter))))}),re("click",Ie,g),re("input",ot,G=>Ne(e(f),{search:G.currentTarget.value})),re("change",Re,G=>Ne(e(f),{typeFilter:G.currentTarget.value})),i(o,_)};b(ge,o=>{se()?o(Ce,!1):o(fe)})}var W=l(ge,2);{let o=Se(()=>(e(V),s(()=>e(V)?`Edit: ${e(V).title}`:"Submission Details")));ta(W,{get id(){return S},get title(){return e(o)},children:(_,m)=>{var k=At(),ne=De(k);{var Ie=N=>{Ea(N,{get eventItem(){return e(z)},get drawerId(){return S},name:"my-submission-form",get canDelete(){return e(Z)},canCreate:!1})},be=N=>{var Me=Ds();i(N,Me)};b(ne,N=>{e(z)?N(Ie):N(be,!1)})}i(_,k)},$$slots:{default:!0}})}i(pe,K),dt(),J()}var Is=u('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),Ms=u('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),Ts=u('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),Cs=u('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),Ps=u('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1),Rs=u('<div class="calendar-section svelte-1oi0f59"><!></div>');function sn(pe,T){ct(T,!1);const C=p(),h=p(),F=p(),{stores:{currentUserHasPermission:se,authenticated:I}}=aa();let J=We(T,"showApprovals",8,!0),E=We(T,"showMySubmissions",8,!0),Z=We(T,"showAnnouncements",8,!0),H=We(T,"showSearch",8,!0),D=p(!1),te=p(!1);xa(()=>{const w=se.subscribe(Q=>{const Y=J()&&Q(Ee.ManageWardBusiness);c(D,Y)}),oe=I.subscribe(Q=>{c(te,Q)});return()=>{w(),oe()}}),x(()=>(A(J()),e(D)),()=>{c(C,J()&&e(D))}),x(()=>(A(E()),e(te)),()=>{c(h,E()&&e(te))}),x(()=>(e(C),e(h)),()=>{c(F,e(C)||e(h))}),Lt(),vt();var z=Rs(),j=a(z);{var L=w=>{var oe=Ps(),Q=De(oe),Y=a(Q),ke=l(a(Y),2);{var V=X=>{var ve=Is();i(X,ve)};b(ke,X=>{e(C)&&X(V)})}var S=l(ke,2);{var B=X=>{var ve=Ms();i(X,ve)};b(S,X=>{e(h)&&X(B)})}t(Y),t(Q);var ie=l(Q,2),_e=a(ie),$e=a(_e);Ua($e,{get showAnnouncements(){return Z()},get showSearch(){return H()}}),t(_e);var we=l(_e,2);{var Oe=X=>{var ve=Ts(),He=a(ve);yr(He,{}),t(ve),i(X,ve)};b(we,X=>{e(C)&&X(Oe)})}var me=l(we,2);{var q=X=>{var ve=Cs(),He=a(ve);Os(He,{}),t(ve),i(X,ve)};b(me,X=>{e(h)&&X(q)})}t(ie),i(w,oe)},de=w=>{Ua(w,{get showAnnouncements(){return Z()},get showSearch(){return H()}})};b(j,w=>{e(F)?w(L):w(de,!1)})}t(z),i(pe,z),dt()}export{sn as C};
