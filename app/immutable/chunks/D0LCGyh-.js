import{d as h,w as i}from"./DjNGvcU6.js";import{s as f,a as u}from"./C9XViFXT.js";const l=i([]),c=i(!1),t=i(null);async function d(){c.set(!0),t.set(null);try{const s=localStorage.getItem("authToken"),r=await fetch(`${f}/functions/v1/admin-get-users`,{headers:{"x-auth-token":s?`Bearer ${s}`:"",Authorization:`Bearer ${u}`,apikey:u}}),e=await r.json();if(!r.ok){t.set(e.error||"Failed to fetch users"),console.error("Fetch users error:",e.error);return}e.users?l.set(e.users):(t.set("No users data returned"),console.error("Fetch users error: No users data returned"))}catch(s){const r=s instanceof Error?s.message:"Unknown error occurred";t.set(r),console.error("Fetch users error:",s)}finally{c.set(!1)}}async function p(s,r){c.set(!0),t.set(null);try{const e=localStorage.getItem("authToken"),a=await fetch(`${f}/functions/v1/admin-update-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":e?`Bearer ${e}`:"",Authorization:`Bearer ${u}`,apikey:u},body:JSON.stringify({userId:s,updates:r})}),o=await a.json();if(!a.ok){const n=o.error||"Failed to update user";return t.set(n),console.error("Update user error:",n),{success:!1,error:n}}if(o.success)return await d(),{success:!0};{const n=o.error||"Update failed";return t.set(n),console.error("Update user error:",n),{success:!1,error:n}}}catch(e){const a=e instanceof Error?e.message:"Unknown error occurred";return t.set(a),console.error("Update user error:",e),{success:!1,error:a}}finally{c.set(!1)}}async function g(s){c.set(!0),t.set(null);try{const r=localStorage.getItem("authToken"),e=await fetch(`${f}/functions/v1/admin-delete-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":r?`Bearer ${r}`:"",Authorization:`Bearer ${u}`,apikey:u},body:JSON.stringify({userId:s})}),a=await e.json();if(!e.ok){const o=a.error||"Failed to delete user";return t.set(o),console.error("Delete user error:",o),{success:!1,error:o}}if(a.success)return await d(),{success:!0};{const o=a.error||"Delete failed";return t.set(o),console.error("Delete user error:",o),{success:!1,error:o}}}catch(r){const e=r instanceof Error?r.message:"Unknown error occurred";return t.set(e),console.error("Delete user error:",r),{success:!1,error:e}}finally{c.set(!1)}}h(l,s=>s.filter(r=>r.is_active));h(l,s=>s.length);const m={stores:{users:l,loading:c,error:t},actions:{fetchUsers:d,updateUser:p,deleteUser:g}};export{m as u};
