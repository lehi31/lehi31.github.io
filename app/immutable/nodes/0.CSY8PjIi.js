import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{o as ve}from"../chunks/DB0qkhVq.js";import{K as ke,aF as xe,bb as Ee,O as Fe,e as Te,u as ue,bc as Se,aX as be,bd as Ae,q as Ne,al as V,p as B,c as E,s as p,r as F,t as me,a as H,f as D,g as o,ah as Ce,ai as Oe,D as v,E as I,ap as $e,F as ne,aj as Ie,$ as Pe}from"../chunks/D2Wl5k_M.js";import{o as Le,p as re,i as O,s as je,e as q,b as pe,a as _e}from"../chunks/Dp64CMOB.js";import{f as A,a as _,c as W}from"../chunks/DfqsuKYE.js";import{s as qe}from"../chunks/BicphDRr.js";import{e as Ue,h as De}from"../chunks/DrikPB-j.js";import{i as K}from"../chunks/CPbJ_PqI.js";import{e as Me,b as Re,f as ze,d as Ve}from"../chunks/HmHUL7PJ.js";import{t as We,d as Ye}from"../chunks/CncIguPn.js";import{r as le}from"../chunks/Df79sd2X.js";import{b as se}from"../chunks/CMEL2kP5.js";import{p as Be}from"../chunks/CdEA5IGF.js";const He=()=>performance.now(),P={tick:a=>requestAnimationFrame(a),now:()=>He(),tasks:new Set};function ge(){const a=P.now();P.tasks.forEach(e=>{e.c(a)||(P.tasks.delete(e),e.f())}),P.tasks.size!==0&&P.tick(ge)}function Ke(a){let e;return P.tasks.size===0&&P.tick(ge),{promise:new Promise(t=>{P.tasks.add(e={c:a,f:t})}),abort(){P.tasks.delete(e)}}}function Y(a,e){be(()=>{a.dispatchEvent(new CustomEvent(e))})}function Ge(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function ce(a){const e={},t=a.split(";");for(const r of t){const[f,l]=r.split(":");if(!f||l===void 0)break;const s=Ge(f.trim());e[s]=l.trim()}return e}const Je=a=>a;function fe(a,e,t,r){var f=(a&Se)!==0,l="both",s,u=e.inert,y=e.style.overflow,g,h;function N(){return be(()=>s??=t()(e,r?.()??{},{direction:l}))}var b={is_global:f,in(){e.inert=u,Y(e,"introstart"),g=oe(e,N(),h,1,()=>{Y(e,"introend"),g?.abort(),g=s=void 0,e.style.overflow=y})},out(w){e.inert=!0,Y(e,"outrostart"),h=oe(e,N(),g,0,()=>{Y(e,"outroend"),w?.()})},stop:()=>{g?.abort(),h?.abort()}},T=ke;if((T.nodes.t??=[]).push(b),Le){var d=f;if(!d){for(var i=T.parent;i&&i.f&xe;)for(;(i=i.parent)&&!(i.f&Ee););d=!i||(i.f&Fe)!==0}d&&Te(()=>{ue(()=>b.in())})}}function oe(a,e,t,r,f){var l=r===1;if(Ae(e)){var s,u=!1;return Ne(()=>{if(!u){var w=e({direction:l?"in":"out"});s=oe(a,w,t,r,f)}}),{abort:()=>{u=!0,s?.abort()},deactivate:()=>s.deactivate(),reset:()=>s.reset(),t:()=>s.t()}}if(t?.deactivate(),!e?.duration)return f(),{abort:V,deactivate:V,reset:V,t:()=>r};const{delay:y=0,css:g,tick:h,easing:N=Je}=e;var b=[];if(l&&t===void 0&&(h&&h(0,1),g)){var T=ce(g(0,1));b.push(T,T)}var d=()=>1-r,i=a.animate(b,{duration:y,fill:"forwards"});return i.onfinish=()=>{i.cancel();var w=t?.t()??1-r;t?.abort();var x=r-w,C=e.duration*Math.abs(x),n=[];if(C>0){var c=!1;if(g)for(var k=Math.ceil(C/16.666666666666668),m=0;m<=k;m+=1){var $=w+x*N(m/k),U=ce(g($,1-$));n.push(U),c||=U.overflow==="hidden"}c&&(a.style.overflow="hidden"),d=()=>{var L=i.currentTime;return w+x*N(L/C)},h&&Ke(()=>{if(i.playState!=="running")return!1;var L=d();return h(L,1-L),!0})}i=a.animate(n,{duration:C,fill:"forwards"}),i.onfinish=()=>{d=()=>r,h?.(r,1-r),f()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=V)},deactivate:()=>{f=V},reset:()=>{r===0&&h?.(1,0)},t:()=>d()}}const Xe=!0,Ca=Object.freeze(Object.defineProperty({__proto__:null,prerender:Xe},Symbol.toStringTag,{value:"Module"}));var Qe=A('<i class="bi bi-info-circle"></i>'),Ze=A('<i class="bi bi-exclamation-triangle"></i>'),ea=A('<i class="bi bi-x-circle"></i>'),aa=A('<i class="bi bi-check-circle"></i>'),ta=A('<div role="alert"><!> <div class="flex-grow-1"> </div> <button type="button" class="btn-close" aria-label="Close"></button></div>');function ra(a,e){B(e,!1);let t=re(e,"message",8),r=re(e,"type",8,"info"),f=re(e,"onClose",8);setTimeout(()=>f()(),5e3),K();var l=ta(),s=E(l);{var u=b=>{var T=Qe();_(b,T)},y=b=>{var T=W(),d=D(T);{var i=x=>{var C=Ze();_(x,C)},w=x=>{var C=W(),n=D(C);{var c=m=>{var $=ea();_(m,$)},k=m=>{var $=W(),U=D($);{var L=R=>{var G=aa();_(R,G)};O(U,R=>{r()==="success"&&R(L)},!0)}_(m,$)};O(n,m=>{r()==="danger"?m(c):m(k,!1)},!0)}_(x,C)};O(d,x=>{r()==="warning"?x(i):x(w,!1)},!0)}_(b,T)};O(s,b=>{r()==="info"?b(u):b(y,!1)})}var g=p(s,2),h=E(g,!0);F(g);var N=p(g,2);F(l),me(()=>{Me(l,1,`alert alert-${r()??""} alert-dismissible d-flex align-items-center gap-2`,"svelte-1jlqy1l"),je(h,t())}),q("click",N,function(...b){f()?.apply(this,b)}),_(a,l),H()}function sa(a,e){B(e,!1);const t=()=>_e(We,"$toasts",r),[r,f]=pe();K();var l=W(),s=D(l);Ue(s,1,t,u=>u.id,(u,y)=>{ra(u,{get message(){return o(y).message},get type(){return o(y).type},onClose:()=>Ye(o(y).id)})}),_(a,l),H(),f()}const oa=a=>a;function de(a,{delay:e=0,duration:t=400,easing:r=oa}={}){const f=+getComputedStyle(a).opacity;return{delay:e,duration:t,easing:r,css:l=>`opacity: ${l*f}`}}var ia=A('<div class="text-center py-4"><i class="bi bi-check-circle text-success" style="font-size: 3rem;"></i> <p class="mt-3 mb-3">Thank you for your feedback!<br/> The bishopric will review and get back to you.</p> <button type="button" class="btn btn-sm btn-outline-secondary">Close</button></div>'),na=A('<span class="spinner-border spinner-border-sm me-1" role="status"></span> Sending...',1),la=A('<i class="bi bi-send me-1"></i> Send Feedback',1),ca=A(`<form><div class="mb-3"><label for="feedback-name" class="form-label small">Name (optional)</label> <input type="text" class="form-control form-control-sm" id="feedback-name" placeholder="Your name"/></div> <div class="mb-3"><label for="feedback-email" class="form-label small">Email (optional)</label> <input type="email" class="form-control form-control-sm" id="feedback-email" placeholder="your@email.com"/></div> <div class="mb-3"><label for="feedback-message" class="form-label small">Message <span class="text-danger">*</span></label> <textarea class="form-control form-control-sm" id="feedback-message" placeholder="Tell us what's on your mind..." rows="4" required></textarea></div> <div class="d-grid"><button type="submit" class="btn btn-primary btn-sm"><!></button></div></form>`),fa=A('<div class="feedback-panel shadow-lg svelte-1csgcly"><div class="card h-100 feedback-card svelte-1csgcly"><div class="card-header d-flex justify-content-between align-items-center bg-body-tertiary"><h5 class="mb-0">Send Feedback</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="card-body overflow-auto"><!></div></div></div>'),da=A('<button class="btn btn-primary rounded-circle feedback-button shadow svelte-1csgcly" aria-label="Send feedback" title="Send feedback"><i class="bi bi-chat-dots"></i></button> <!>',1);function va(a,e){B(e,!1);let t=I(!1),r=I(""),f=I(""),l=I(""),s=I(!1),u=I(!1),y=I(!1);async function g(){if(o(l).trim()){v(s,!0);try{(await fetch(`${Re}/functions/v1/website-feedback`,{method:"POST",headers:ze(!0,{useAuthToken:!1}),body:JSON.stringify({name:o(r).trim()||void 0,email:o(f).trim()||void 0,message:o(l).trim(),page_url:window.location.href,user_agent:navigator.userAgent})})).ok?(v(u,!0),setTimeout(()=>{v(t,!1),v(u,!1),v(r,""),v(f,""),v(l,"")},8e3)):alert("Failed to submit feedback. Please try again.")}catch(d){console.error("Error submitting feedback:",d),alert("Failed to submit feedback. Please try again.")}finally{v(s,!1)}}}function h(){v(t,!o(t)),o(t)||v(u,!1)}ve(()=>{function d(){v(y,!0)}function i(){v(y,!1)}return document.addEventListener("show.bs.offcanvas",d),document.addEventListener("hidden.bs.offcanvas",i),()=>{document.removeEventListener("show.bs.offcanvas",d),document.removeEventListener("hidden.bs.offcanvas",i)}}),Ce(()=>(o(y),o(t)),()=>{o(y)&&o(t)&&v(t,!1)}),Oe(),K();var N=W(),b=D(N);{var T=d=>{var i=da(),w=D(i),x=p(w,2);{var C=n=>{var c=fa(),k=E(c),m=E(k),$=p(E(m),2);F(m);var U=p(m,2),L=E(U);{var R=M=>{var j=ia(),z=p(E(j),4);F(j),q("click",z,h),_(M,j)},G=M=>{var j=ca(),z=E(j),J=p(E(z),2);le(J),F(z);var X=p(z,2),Q=p(E(X),2);le(Q),F(X);var Z=p(X,2),ee=p(E(Z),2);$e(ee),F(Z);var ie=p(Z,2),ae=E(ie),he=E(ae);{var ye=S=>{var te=na();ne(),_(S,te)},we=S=>{var te=la();ne(),_(S,te)};O(he,S=>{o(s)?S(ye):S(we,!1)})}F(ae),F(ie),F(j),me(S=>{J.disabled=o(s),Q.disabled=o(s),ee.disabled=o(s),ae.disabled=S},[()=>(o(s),o(l),ue(()=>o(s)||!o(l).trim()))]),se(J,()=>o(r),S=>v(r,S)),se(Q,()=>o(f),S=>v(f,S)),se(ee,()=>o(l),S=>v(l,S)),q("submit",j,Be(g)),_(M,j)};O(L,M=>{o(u)?M(R):M(G,!1)})}F(U),F(k),F(c),q("click",$,h),fe(3,c,()=>de,()=>({duration:200})),_(n,c)};O(x,n=>{o(t)&&n(C)})}fe(3,w,()=>de,()=>({duration:200})),q("click",w,h),_(d,i)};O(b,d=>{o(y)||d(T)})}_(a,N),H()}var ua=A('<div class="alert alert-info alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-arrow-clockwise"></i> <div class="flex-grow-1"><strong>Update Available</strong><br/> A new version of the app is available. Please reload to get the latest features and bug fixes.</div> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-arrow-clockwise"></i> Reload Now</button> <button type="button" class="btn-close" aria-label="Close"></button></div>'),ba=A('<div class="alert alert-warning alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-clock-history"></i> <div><strong>Session Expired</strong><br/> Your authentication token has expired. Please log in again to continue.</div> <button type="button" class="btn-close" aria-label="Close"></button></div>'),ma=A("<!> <!> <!> <!> <!>",1);function Oa(a,e){B(e,!1);const t=()=>_e(l,"$pageName",r),[r,f]=pe(),{stores:{pageName:l}}=Ve();let s=I(!1),u=I(!1);const y=async()=>{try{const n=await fetch("/api/version"),{version:c}=await n.json(),k=parseInt(c),m=parseInt("1771742959418");return!isNaN(k)&&!isNaN(m)&&k>m?(console.warn("[App] New version available:",c,"current:","1771742959418","(server is newer)"),!0):(c!=="1771742959418"&&console.log("[App] Version mismatch but client is newer or equal:","server:",c,"client:","1771742959418"),!1)}catch(n){return console.error("[App] Failed to check for updates:",n),!1}};ve(()=>{{sessionStorage.getItem("authExpired")==="true"&&(v(s,!0),setTimeout(()=>{v(s,!1),sessionStorage.removeItem("authExpired")},1e4));{const n=async()=>{await y()&&v(u,!0)};n();const c=setInterval(n,5*60*1e3);return()=>clearInterval(c)}}});const g=()=>{v(s,!1),sessionStorage.removeItem("authExpired")},h=async()=>{try{if("caches"in window){const n=await caches.keys();await Promise.all(n.map(c=>caches.delete(c))),console.log("[App] Cleared service worker caches")}}catch(n){console.error("[App] Failed to clear caches:",n)}finally{window.location.href=window.location.href}};K();var N=ma();De("12qhfyh",n=>{Ie(()=>{Pe.title=`Lehi31 | ${t()??""}`})});var b=D(N);{var T=n=>{var c=ua(),k=p(E(c),4),m=p(k,2);F(c),q("click",k,h),q("click",m,()=>v(u,!1)),_(n,c)};O(b,n=>{o(u)&&n(T)})}var d=p(b,2);{var i=n=>{var c=ba(),k=p(E(c),4);F(c),q("click",k,g),_(n,c)};O(d,n=>{o(s)&&n(i)})}var w=p(d,2);sa(w,{});var x=p(w,2);qe(x,e,"default",{});var C=p(x,2);va(C,{}),_(a,N),H(),f()}export{Oa as component,Ca as universal};
