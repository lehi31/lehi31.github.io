import{a as Yt}from"../chunks/B5LTcAhG.js";import{P as Zt,f as j,j as te}from"../chunks/B_EOEitS.js";import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{P as ee}from"../chunks/BS1DSlEj.js";import{o as ae}from"../chunks/WW5OsAH7.js";import{p as se,ah as le,m as t,ai as re,f as st,s as l,B as q,a as oe,E as B,c as s,D as y,r as a,F as E,ap as ne,as as lt,u as n}from"../chunks/SWWSvUpQ.js";import{a as rt,i as M,e as x,b as ie,s as u}from"../chunks/CU3XCoqN.js";import{e as ce}from"../chunks/YJAcq9su.js";import{f as b,c as de,a as v,t as ve}from"../chunks/D8ekX_8E.js";import{r as ot,s as Dt}from"../chunks/BwCC9vqv.js";import{b as nt,a as me}from"../chunks/CvxMDV_e.js";import{p as ue}from"../chunks/CdEA5IGF.js";import{i as be}from"../chunks/Bgyk9asy.js";import{D as pe}from"../chunks/BB-WLD4v.js";import{u as _e}from"../chunks/BnDaARTS.js";const fe=!1,ge=async()=>(Yt(Zt.ManageUsers,"Manage Users"),{}),He=Object.freeze(Object.defineProperty({__proto__:null,load:ge,ssr:fe},Symbol.toStringTag,{value:"Module"}));function he(P){switch(P){case"root":return"danger";case"admin":return"primary";case"primary":case"relief-society":case"elders-quorum":case"teachers-quorum":case"young-women":case"sunday-school":return"info";case"authenticated":return"success";case"un-authenticated":return"secondary";default:return"secondary"}}var ye=b('<div class="alert alert-danger alert-dismissible fade show" role="alert"> <button type="button" class="btn-close" aria-label="Close"></button></div>'),xe=b('<div class="text-center py-5"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>'),we=b('<span class="text-muted">Never</span>'),$e=b('<tr><td><div class="fw-semibold"> </div> <small class="d-md-none text-muted d-block"> </small></td><td class="d-none d-md-table-cell"> </td><td><span></span> <div class="d-lg-none mt-1"><span> </span></div></td><td class="d-none d-lg-table-cell"><span> </span></td><td class="d-none d-lg-table-cell"><span> </span></td><td class="d-none d-lg-table-cell"><small> </small></td><td class="d-none d-xl-table-cell"><small><!></small></td><td class="text-end"><div class="btn-group gap-2" role="group"><button class="btn btn-sm btn-outline-primary" type="button" data-bs-toggle="offcanvas"><i class="bi bi-pencil"></i> <span class="d-none d-sm-inline">Edit</span></button> <button class="btn btn-sm btn-outline-danger" type="button"><i class="bi bi-trash"></i> <span class="d-none d-sm-inline">Delete</span></button></div></td></tr>'),De=b('<div class="text-center py-5 text-muted"><p>No users found matching your filters.</p></div>'),ke=b('<div class="table-responsive"><table class="table table-hover align-middle"><thead><tr><th scope="col">Name</th><th scope="col" class="d-none d-md-table-cell">Email</th><th scope="col" class="d-none d-lg-table-cell">Status</th><th scope="col" class="d-none d-lg-table-cell">Active</th><th scope="col" class="d-none d-lg-table-cell">Email Verified</th><th scope="col" class="d-none d-lg-table-cell">Created</th><th scope="col" class="d-none d-xl-table-cell">Last Login</th><th scope="col" class="text-end">Actions</th></tr></thead><tbody></tbody></table> <!></div>'),Ue=b('<form class="d-flex flex-column gap-3"><div><label class="form-label" for="displayName">Display Name</label> <input type="text" class="form-control" id="displayName" placeholder="Display name (optional)"/></div> <div><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="isActive"/> <label class="form-check-label" for="isActive">Active Account</label></div> <div class="form-text">Disabled accounts cannot login</div></div> <div><label class="form-label" for="adminNotes">Admin Notes</label> <textarea class="form-control" id="adminNotes" rows="3" placeholder="Internal notes about this user..."></textarea></div> <div class="d-flex justify-content-end gap-2"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary">Save Changes</button></div></form>'),Ce=b('<p class="text-muted mb-0">Select a user to edit.</p>'),Ae=b('<div class="modal show d-block" tabindex="-1" role="dialog"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Confirm Delete</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="modal-body"><p>Are you sure you want to delete the user <strong> </strong>?</p> <p class="text-danger mb-0">This action cannot be undone.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete User</button></div></div></div></div> <div class="modal-backdrop show"></div>',1),Le=b('<div class="user-management"><div class="d-flex justify-content-between align-items-center mb-4"><h2>User Management</h2> <button class="btn btn-primary"><i class="bi bi-arrow-clockwise"></i> Refresh</button></div> <!> <div class="row mb-3"><div class="col-md-9"><input type="text" class="form-control" placeholder="Search by email or name..."/></div> <div class="col-md-3"><div class="text-muted mt-2"> </div></div></div> <!></div> <!> <!>',1);function Se(P,z){se(z,!1);const F=()=>rt(At,"$users",Q),it=()=>rt(ct,"$error",Q),kt=()=>rt(Lt,"$loading",Q),[Q,Ut]=ie(),w=B(),{stores:Ct,actions:I}=_e,{users:At,loading:Lt,error:ct}=Ct;let o=B(null),p=B(null),A=B("");const O="edit-user-drawer";let dt=B("Edit User");ae(()=>{I.fetchUsers()});function St(r){y(o,{...r}),y(dt,`Edit User: ${r.email}`)}function vt(){document.querySelector(`[data-bs-target="#${O}"]`)?.click()}function Nt(){y(o,null),vt()}async function Et(){if(!t(o))return;(await I.updateUser(t(o).id,{is_active:t(o).is_active,notes:t(o).notes,display_name:t(o).display_name})).success&&(vt(),y(o,null))}function Mt(r){y(p,r)}function mt(){y(p,null)}async function Pt(){if(!t(p))return;(await I.deleteUser(t(p).id)).success&&y(p,null)}le(()=>(F(),t(A)),()=>{y(w,F().filter(r=>t(A)===""||r.email.toLowerCase().includes(t(A).toLowerCase())||r.display_name?.toLowerCase().includes(t(A).toLowerCase())))}),re(),be();var ut=Le(),G=st(ut),H=s(G),Tt=l(s(H),2);a(H);var bt=l(H,2);{var jt=r=>{var c=ye(),d=s(c),_=l(d);a(c),q(()=>u(d,`${it()??""} `)),x("click",_,()=>ct.set(null)),v(r,c)};M(bt,r=>{it()&&r(jt)})}var J=l(bt,2),K=s(J),pt=s(K);ot(pt),a(K);var _t=l(K,2),ft=s(_t),qt=s(ft);a(ft),a(_t),a(J);var Bt=l(J,2);{var It=r=>{var c=xe();v(r,c)},Ot=r=>{var c=ke(),d=s(c),_=l(s(d));ce(_,5,()=>t(w),i=>i.id,(i,e)=>{var m=$e(),f=s(m),g=s(f),U=s(g,!0);a(g);var $=l(g,2),C=s($,!0);a($),a(f);var S=l(f),R=s(S,!0);a(S);var T=l(S),h=s(T);h.textContent="user";var ht=l(h,2),W=s(ht),zt=s(W,!0);a(W),a(ht),a(T);var X=l(T),Y=s(X),Ft=s(Y,!0);a(Y),a(X);var Z=l(X),tt=s(Z),Qt=s(tt,!0);a(tt),a(Z);var et=l(Z),yt=s(et),Gt=s(yt,!0);a(yt),a(et);var at=l(et),xt=s(at),Ht=s(xt);{var Jt=D=>{var N=ve();q(Xt=>u(N,Xt),[()=>(t(e),n(()=>new Date(t(e).last_login).toLocaleDateString()))]),v(D,N)},Kt=D=>{var N=we();v(D,N)};M(Ht,D=>{t(e),n(()=>t(e).last_login)?D(Jt):D(Kt,!1)})}a(xt),a(at);var wt=l(at),$t=s(wt),V=s($t);Dt(V,"data-bs-target",`#${O}`),Dt(V,"aria-controls",O);var Wt=l(V,2);a($t),a(wt),a(m),q((D,N)=>{j(m,1,te((t(e),n(()=>t(e).is_active?"":"opacity-75")))),u(U,(t(e),n(()=>t(e).display_name??t(e).email))),u(C,(t(e),n(()=>t(e).email))),u(R,(t(e),n(()=>t(e).email))),j(h,1,D),j(W,1,(t(e),n(()=>`badge ${t(e).is_active?"bg-success":"bg-danger"}`))),u(zt,(t(e),n(()=>t(e).is_active?"Active":"Disabled"))),j(Y,1,(t(e),n(()=>`badge ${t(e).is_active?"bg-success":"bg-danger"}`))),u(Ft,(t(e),n(()=>t(e).is_active?"Active":"Disabled"))),j(tt,1,(t(e),n(()=>`badge ${t(e).email_confirmed?"bg-success":"bg-warning"}`))),u(Qt,(t(e),n(()=>t(e).email_confirmed?"Verified":"Unverified"))),u(Gt,N)},[()=>n(()=>`badge bg-${he("user")} text-uppercase`),()=>(t(e),n(()=>new Date(t(e).created_at).toLocaleDateString()))]),x("click",V,()=>St(t(e))),x("click",Wt,()=>Mt(t(e))),v(i,m)}),a(_),a(d);var L=l(d,2);{var k=i=>{var e=De();v(i,e)};M(L,i=>{t(w),n(()=>t(w).length===0)&&i(k)})}a(c),v(r,c)};M(Bt,r=>{kt()?r(It):r(Ot,!1)})}a(G);var gt=l(G,2);pe(gt,{get title(){return t(dt)},id:O,children:(r,c)=>{var d=de(),_=st(d);{var L=i=>{var e=Ue(),m=s(e),f=l(s(m),2);ot(f),a(m);var g=l(m,2),U=s(g),$=s(U);ot($),E(2),a(U),E(2),a(g);var C=l(g,2),S=l(s(C),2);ne(S),a(C);var R=l(C,2),T=s(R);E(2),a(R),a(e),nt(f,()=>t(o).display_name,h=>lt(o,t(o).display_name=h)),me($,()=>t(o).is_active,h=>lt(o,t(o).is_active=h)),nt(S,()=>t(o).notes,h=>lt(o,t(o).notes=h)),x("click",T,Nt),x("submit",e,ue(Et)),v(i,e)},k=i=>{var e=Ce();v(i,e)};M(_,i=>{t(o)?i(L):i(k,!1)})}v(r,d)},$$slots:{default:!0}});var Rt=l(gt,2);{var Vt=r=>{var c=Ae(),d=st(c),_=s(d),L=s(_),k=s(L),i=l(s(k),2);a(k);var e=l(k,2),m=s(e),f=l(s(m)),g=s(f,!0);a(f),E(),a(m),E(2),a(e);var U=l(e,2),$=s(U),C=l($,2);a(U),a(L),a(_),a(d),E(2),q(()=>u(g,(t(p),n(()=>t(p).display_name??t(p).email)))),x("click",i,mt),x("click",$,mt),x("click",C,Pt),v(r,c)};M(Rt,r=>{t(p)&&r(Vt)})}q(()=>u(qt,`Total: ${t(w),n(()=>t(w).length)??""} user${t(w),n(()=>t(w).length!==1?"s":"")??""}`)),x("click",Tt,()=>I.fetchUsers()),nt(pt,()=>t(A),r=>y(A,r)),v(P,ut),oe(),Ut()}function Je(P){ee(P,{pageTitle:"Manage Users",children:(z,F)=>{Se(z,{})},$$slots:{default:!0}})}export{Je as component,He as universal};
