import{S as Ee,i as ye,s as $e,d as m,e as G,t as S,a as M,H as le,G as se,m as q,h as w,n as K,l as L,W as X,q as z,p as V,A as ie,B as Se,a0 as Ne,v,f as b,j as E,k as $,x as ce,o as y,C as x,O as ue,r as ee,y as F,z as R}from"../chunks/C5twpB8P.js";import"../chunks/IHki7fMi.js";import{P as Te}from"../chunks/DFI0woS6.js";import{A as Pe,E as Ae}from"../chunks/Bs0mIc7a.js";import{e as Ce,g as Le,s as fe,f as Ve,A as Oe,b as Fe,E as Re,d as We}from"../chunks/DQVecoP_.js";import{e as oe,u as we,o as Ie}from"../chunks/BVU-SBqd.js";import{g as Ue,F as je}from"../chunks/I3k67RAl.js";import{d as _e}from"../chunks/DzDB5CMn.js";import{S as Be}from"../chunks/CDcZWSVK.js";import{D as Ge,v as qe}from"../chunks/CgPuVtgq.js";import{p as U,U as Ke,s as ze,f as B}from"../chunks/BNNq8oat.js";function Xe(i,e){return Ce(i,-e)}const He=!0,kt=Object.freeze(Object.defineProperty({__proto__:null,prerender:He},Symbol.toStringTag,{value:"Module"})),{Map:De}=Fe;function de(i,e,t){const l=i.slice();return l[27]=e[t],l}function me(i,e,t){const l=i.slice();return l[30]=e[t],l}function Je(i){let e,t;return e=new Oe({props:{eventItem:i[6],drawerId:i[0],name:"past-event-item-form"}}),{c(){z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){q(e,l,s),t=!0},p(l,s){const a={};s[0]&64&&(a.eventItem=l[6]),s[0]&1&&(a.drawerId=l[0]),e.$set(a)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){S(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function pe(i){let e,t,l,s;const a=[Ye,Qe],n=[];function c(r,o){return r[12]?0:1}return e=c(i),t=n[e]=a[e](i),{c(){t.c(),l=X()},l(r){t.l(r),l=X()},m(r,o){n[e].m(r,o),w(r,l,o),s=!0},p(r,o){let f=e;e=c(r),e===f?n[e].p(r,o):(le(),S(n[f],1,1,()=>{n[f]=null}),se(),t=n[e],t?t.p(r,o):(t=n[e]=a[e](r),t.c()),M(t,1),t.m(l.parentNode,l))},i(r){s||(M(t),s=!0)},o(r){S(t),s=!1},d(r){r&&m(l),n[e].d(r)}}}function Qe(i){let e,t,l;return t=new Be({}),{c(){e=y("div"),z(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var a=$(e);K(t.$$.fragment,a),a.forEach(m),this.h()},h(){b(e,"class","d-flex flex-column gap-4")},m(s,a){w(s,e,a),q(t,e,null),l=!0},p:x,i(s){l||(M(t.$$.fragment,s),l=!0)},o(s){S(t.$$.fragment,s),l=!1},d(s){s&&m(e),G(t)}}}function Ye(i){let e,t,l,s,a="Past Events",n,c,r,o,f,u=i[11]&&i[7]&&he(i);const _=[tt,et],d=[];function h(p,g){return p[9].length?0:1}return r=h(i),o=d[r]=_[r](i),{c(){e=y("div"),t=y("div"),l=y("div"),s=y("span"),s.textContent=a,n=V(),u&&u.c(),c=V(),o.c(),this.h()},l(p){e=E(p,"DIV",{class:!0});var g=$(e);t=E(g,"DIV",{class:!0});var A=$(t);l=E(A,"DIV",{class:!0});var C=$(l);s=E(C,"SPAN",{"data-svelte-h":!0}),ce(s)!=="svelte-15uqv9t"&&(s.textContent=a),n=L(C),u&&u.l(C),C.forEach(m),A.forEach(m),c=L(g),o.l(g),g.forEach(m),this.h()},h(){b(l,"class","d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter d-flex justify-content-end"),b(t,"class","card-header"),b(e,"class","card")},m(p,g){w(p,e,g),v(e,t),v(t,l),v(l,s),v(l,n),u&&u.m(l,null),v(e,c),d[r].m(e,null),f=!0},p(p,g){p[11]&&p[7]?u?u.p(p,g):(u=he(p),u.c(),u.m(l,null)):u&&(u.d(1),u=null);let A=r;r=h(p),r===A?d[r].p(p,g):(le(),S(d[A],1,1,()=>{d[A]=null}),se(),o=d[r],o?o.p(p,g):(o=d[r]=_[r](p),o.c()),M(o,1),o.m(e,null))},i(p){f||(M(o),f=!0)},o(p){S(o),f=!1},d(p){p&&m(e),u&&u.d(),d[r].d()}}}function he(i){let e,t,l;function s(c,r){return c[4]?xe:Ze}let a=s(i),n=a(i);return{c(){e=y("button"),n.c(),this.h()},l(c){e=E(c,"BUTTON",{class:!0,type:!0});var r=$(e);n.l(r),r.forEach(m),this.h()},h(){b(e,"class","btn btn-sm btn-outline-danger"),b(e,"type","button"),e.disabled=i[4]},m(c,r){w(c,e,r),n.m(e,null),t||(l=ue(e,"click",i[18]),t=!0)},p(c,r){a===(a=s(c))&&n?n.p(c,r):(n.d(1),n=a(c),n&&(n.c(),n.m(e,null))),r[0]&16&&(e.disabled=c[4])},d(c){c&&m(e),n.d(),t=!1,l()}}}function Ze(i){let e,t,l;return{c(){e=R("Delete Past Events ("),t=R(i[10]),l=R(")")},l(s){e=F(s,"Delete Past Events ("),t=F(s,i[10]),l=F(s,")")},m(s,a){w(s,e,a),w(s,t,a),w(s,l,a)},p(s,a){a[0]&1024&&ee(t,s[10])},d(s){s&&(m(e),m(t),m(l))}}}function xe(i){let e;return{c(){e=R("Deleting…")},l(t){e=F(t,"Deleting…")},m(t,l){w(t,e,l)},p:x,d(t){t&&m(e)}}}function et(i){let e,t="No past events available.";return{c(){e=y("div"),e.textContent=t,this.h()},l(l){e=E(l,"DIV",{class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-aczpuf"&&(e.textContent=t),this.h()},h(){b(e,"class","card-body text-muted small")},m(l,s){w(l,e,s)},p:x,i:x,o:x,d(l){l&&m(e)}}}function tt(i){let e,t=[],l=new De,s,a,n,c=oe(i[9]);const r=f=>f[27].key;for(let f=0;f<c.length;f+=1){let u=de(i,c,f),_=r(u);l.set(_,t[f]=be(_,u))}let o=i[8]&&ke(i);return{c(){e=y("ul");for(let f=0;f<t.length;f+=1)t[f].c();s=V(),o&&o.c(),a=X(),this.h()},l(f){e=E(f,"UL",{class:!0});var u=$(e);for(let _=0;_<t.length;_+=1)t[_].l(u);u.forEach(m),s=L(f),o&&o.l(f),a=X(),this.h()},h(){b(e,"class","list-group list-group-flush border-top-0")},m(f,u){w(f,e,u);for(let _=0;_<t.length;_+=1)t[_]&&t[_].m(e,null);w(f,s,u),o&&o.m(f,u),w(f,a,u),n=!0},p(f,u){u[0]&16905&&(c=oe(f[9]),le(),t=we(t,u,r,1,f,c,l,e,Ie,be,null,de),se()),f[8]?o?o.p(f,u):(o=ke(f),o.c(),o.m(a.parentNode,a)):o&&(o.d(1),o=null)},i(f){if(!n){for(let u=0;u<c.length;u+=1)M(t[u]);n=!0}},o(f){for(let u=0;u<t.length;u+=1)S(t[u]);n=!1},d(f){f&&(m(e),m(s),m(a));for(let u=0;u<t.length;u+=1)t[u].d();o&&o.d(f)}}}function ve(i){let e,t,l,s,a,n;function c(){return i[20](i[30])}return{c(){e=y("div"),t=y("button"),l=y("i"),this.h()},l(r){e=E(r,"DIV",{class:!0});var o=$(e);t=E(o,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var f=$(t);l=E(f,"I",{class:!0}),$(l).forEach(m),f.forEach(m),o.forEach(m),this.h()},h(){b(l,"class","bi bi-pencil-square"),b(t,"class","btn btn-sm btn-primary"),b(t,"type","button"),b(t,"data-bs-toggle","offcanvas"),b(t,"data-bs-target",s="#"+i[0]),b(t,"aria-controls",i[0]),b(e,"class","event-actions svelte-kxknx")},m(r,o){w(r,e,o),v(e,t),v(t,l),a||(n=ue(t,"click",c),a=!0)},p(r,o){i=r,o[0]&1&&s!==(s="#"+i[0])&&b(t,"data-bs-target",s),o[0]&1&&b(t,"aria-controls",i[0])},d(r){r&&m(e),a=!1,n()}}}function ge(i,e){let t,l,s,a,n=B(U(e[30].start_time??""),"EEE")+"",c,r,o,f=B(U(e[30].start_time??""),"MMM d")+"",u,_,d,h,p,g,A,C,O;g=new Re({props:{item:e[30],showDate:!1}});let I=e[3]&&ve(e);return{key:i,first:null,c(){t=y("li"),l=y("div"),s=y("div"),a=y("strong"),c=R(n),r=V(),o=y("small"),u=R(f),_=V(),d=y("div"),h=y("div"),p=y("div"),z(g.$$.fragment),A=V(),I&&I.c(),C=V(),this.h()},l(T){t=E(T,"LI",{class:!0});var P=$(t);l=E(P,"DIV",{class:!0});var W=$(l);s=E(W,"DIV",{class:!0});var H=$(s);a=E(H,"STRONG",{});var te=$(a);c=F(te,n),te.forEach(m),r=L(H),o=E(H,"SMALL",{class:!0});var J=$(o);u=F(J,f),J.forEach(m),H.forEach(m),_=L(W),d=E(W,"DIV",{class:!0});var ne=$(d);h=E(ne,"DIV",{class:!0});var Q=$(h);p=E(Q,"DIV",{class:!0});var re=$(p);K(g.$$.fragment,re),re.forEach(m),A=L(Q),I&&I.l(Q),Q.forEach(m),ne.forEach(m),W.forEach(m),C=L(P),P.forEach(m),this.h()},h(){b(o,"class","text-muted"),b(s,"class","event-date-column d-flex flex-column align-items-start text-nowrap svelte-kxknx"),b(p,"class","event-content svelte-kxknx"),b(h,"class","daily-event-row svelte-kxknx"),b(d,"class","d-flex flex-column gap-3 flex-grow-1"),b(l,"class","d-flex flex-column flex-md-row gap-3"),b(t,"class","list-group-item py-3"),this.first=t},m(T,P){w(T,t,P),v(t,l),v(l,s),v(s,a),v(a,c),v(s,r),v(s,o),v(o,u),v(l,_),v(l,d),v(d,h),v(h,p),q(g,p,null),v(h,A),I&&I.m(h,null),v(t,C),O=!0},p(T,P){e=T,(!O||P[0]&512)&&n!==(n=B(U(e[30].start_time??""),"EEE")+"")&&ee(c,n),(!O||P[0]&512)&&f!==(f=B(U(e[30].start_time??""),"MMM d")+"")&&ee(u,f);const W={};P[0]&512&&(W.item=e[30]),g.$set(W),e[3]?I?I.p(e,P):(I=ve(e),I.c(),I.m(h,null)):I&&(I.d(1),I=null)},i(T){O||(M(g.$$.fragment,T),O=!0)},o(T){S(g.$$.fragment,T),O=!1},d(T){T&&m(t),G(g),I&&I.d()}}}function be(i,e){let t,l=e[27].label+"",s,a,n=[],c=new De,r,o,f=oe(e[27].events);const u=_=>_[30].id??_[30].start_time;for(let _=0;_<f.length;_+=1){let d=me(e,f,_),h=u(d);c.set(h,n[_]=ge(h,d))}return{key:i,first:null,c(){t=y("li"),s=R(l),a=V();for(let _=0;_<n.length;_+=1)n[_].c();r=X(),this.h()},l(_){t=E(_,"LI",{class:!0});var d=$(t);s=F(d,l),d.forEach(m),a=L(_);for(let h=0;h<n.length;h+=1)n[h].l(_);r=X(),this.h()},h(){b(t,"class","list-group-item list-group-item-light text-uppercase small fw-semibold"),this.first=t},m(_,d){w(_,t,d),v(t,s),w(_,a,d);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(_,d);w(_,r,d),o=!0},p(_,d){e=_,(!o||d[0]&512)&&l!==(l=e[27].label+"")&&ee(s,l),d[0]&16905&&(f=oe(e[27].events),le(),n=we(n,d,u,1,e,f,c,r.parentNode,Ie,ge,r,me),se())},i(_){if(!o){for(let d=0;d<f.length;d+=1)M(n[d]);o=!0}},o(_){for(let d=0;d<n.length;d+=1)S(n[d]);o=!1},d(_){_&&(m(t),m(a),m(r));for(let d=0;d<n.length;d+=1)n[d].d(_)}}}function ke(i){let e,t,l,s=(i[1]?.length??0)+"",a,n,c=(i[2]?.length??0)+"",r,o,f,u="More",_,d;return{c(){e=y("div"),t=y("small"),l=R("Showing "),a=R(s),n=R(" of "),r=R(c),o=V(),f=y("button"),f.textContent=u,this.h()},l(h){e=E(h,"DIV",{class:!0});var p=$(e);t=E(p,"SMALL",{});var g=$(t);l=F(g,"Showing "),a=F(g,s),n=F(g," of "),r=F(g,c),g.forEach(m),o=L(p),f=E(p,"BUTTON",{class:!0,"data-svelte-h":!0}),ce(f)!=="svelte-1ox9u2o"&&(f.textContent=u),p.forEach(m),this.h()},h(){b(f,"class","btn btn-primary btn-sm"),b(e,"class","card-footer d-flex align-items-center justify-content-between")},m(h,p){w(h,e,p),v(e,t),v(t,l),v(t,a),v(t,n),v(t,r),v(e,o),v(e,f),_||(d=ue(f,"click",i[17]),_=!0)},p(h,p){p[0]&2&&s!==(s=(h[1]?.length??0)+"")&&ee(a,s),p[0]&4&&c!==(c=(h[2]?.length??0)+"")&&ee(r,c)},d(h){h&&m(e),_=!1,d()}}}function lt(i){let e,t,l,s;e=new Ge({props:{title:i[5],id:i[0],$$slots:{default:[Je]},$$scope:{ctx:i}}});let a=i[11]&&pe(i);return{c(){z(e.$$.fragment),t=V(),a&&a.c(),l=X()},l(n){K(e.$$.fragment,n),t=L(n),a&&a.l(n),l=X()},m(n,c){q(e,n,c),w(n,t,c),a&&a.m(n,c),w(n,l,c),s=!0},p(n,c){const r={};c[0]&32&&(r.title=n[5]),c[0]&1&&(r.id=n[0]),c[0]&65|c[1]&4&&(r.$$scope={dirty:c,ctx:n}),e.$set(r),n[11]?a?(a.p(n,c),c[0]&2048&&M(a,1)):(a=pe(n),a.c(),M(a,1),a.m(l.parentNode,l)):a&&(le(),S(a,1,1,()=>{a=null}),se())},i(n){s||(M(e.$$.fragment,n),M(a),s=!0)},o(n){S(e.$$.fragment,n),S(a),s=!1},d(n){n&&(m(t),m(l)),G(e,n),a&&a.d(n)}}}const st=4,nt=4;function rt(i,e,t){let l,s,a,n,c,r,o,f;const{actions:{featureIsEnabled:u},stores:{currentUser:_}}=Ue(),{stores:{ready:d,dbData:h},actions:{reload:p}}=Le();ie(i,d,k=>t(12,f=k));const g={title:"Event",description:"",location:"",event_type:"calendar_event"};let{formId:A=qe()}=e,C=!1,O=!1,I="",T={...g},P=st;const W=fe(),H=k=>{t(5,I="Event Item"),t(6,T={...k,category:k?.meta_data?.category})},te=_e(h,k=>{const N=fe();return(k??[]).filter(D=>D.event_type!=="calendar_event"||!D.start_time?!1:U(D.start_time)<N)});ie(i,te,k=>t(2,r=k));const J=_e(_,k=>k.role===Ke.Root);ie(i,J,k=>t(11,o=k));function ne(){t(19,P+=nt)}const Q=async()=>{if(!C||O||!Ne(J)||!n)return;const k=fe(),N=B(k,"MMM d, yyyy");if(confirm(`Delete all events that occurred before ${N}?`)){t(4,O=!0);try{const D=await We(k);await p(),D>0?alert(`Deleted ${D} past event${D===1?"":"s"}.`):alert("No past events to delete.")}catch(D){console.error("Failed to delete past events",D),alert("Failed to delete past events. Please try again.")}finally{t(4,O=!1)}}};Se(async()=>{t(3,C=u(je.EditDBCalendarEvent)),await p()});const re=k=>H(k);return i.$$set=k=>{"formId"in k&&t(0,A=k.formId)},i.$$.update=()=>{i.$$.dirty[0]&524292&&t(1,l=(r??[]).filter(k=>{if(!k.start_time)return!1;const N=U(k.start_time),D=Xe(W,P);return N>=D&&N<W})),i.$$.dirty[0]&2&&t(10,s=l.length),i.$$.dirty[0]&2&&t(9,a=(()=>{const k=new Map;for(const N of l){if(!N.start_time)continue;const D=U(N.start_time),j=ze(D,{weekStartsOn:1}),Y=B(j,"yyyy-MM-dd"),ae=`${B(j,"EEE MMM d")} – ${B(Ve(j,{weekStartsOn:1}),"EEE MMM d, yyyy")}`;let Z=k.get(Y);Z||(Z={key:Y,label:ae,events:[]},k.set(Y,Z)),Z.events.push(N)}return Array.from(k.values()).sort((N,D)=>N.key<D.key?1:-1).map(N=>({...N,events:N.events.slice().sort((D,j)=>{const Y=D.is_all_day?0:1,ae=j.is_all_day?0:1;if(Y!==ae)return Y-ae;const Z=D.start_time?U(D.start_time).getTime():Number.MAX_SAFE_INTEGER,Me=j.start_time?U(j.start_time).getTime():Number.MAX_SAFE_INTEGER;return Z-Me})}))})()),i.$$.dirty[0]&2&&t(7,n=l.length>0),i.$$.dirty[0]&6&&t(8,c=r.length>l.length)},[A,l,r,C,O,I,T,n,c,a,s,o,f,d,H,te,J,ne,Q,P,re]}class at extends Ee{constructor(e){super(),ye(this,e,rt,lt,$e,{formId:0},null,[-1,-1])}}function ot(i){let e,t,l,s,a,n,c;return t=new Pe({}),s=new Ae({}),n=new at({}),{c(){e=y("div"),z(t.$$.fragment),l=V(),z(s.$$.fragment),a=V(),z(n.$$.fragment),this.h()},l(r){e=E(r,"DIV",{class:!0});var o=$(e);K(t.$$.fragment,o),l=L(o),K(s.$$.fragment,o),a=L(o),K(n.$$.fragment,o),o.forEach(m),this.h()},h(){b(e,"class","d-flex flex-column gap-4")},m(r,o){w(r,e,o),q(t,e,null),v(e,l),q(s,e,null),v(e,a),q(n,e,null),c=!0},p:x,i(r){c||(M(t.$$.fragment,r),M(s.$$.fragment,r),M(n.$$.fragment,r),c=!0)},o(r){S(t.$$.fragment,r),S(s.$$.fragment,r),S(n.$$.fragment,r),c=!1},d(r){r&&m(e),G(t),G(s),G(n)}}}function it(i){let e,t;return e=new Te({props:{pageTitle:"Announcements & Events",$$slots:{default:[ot]},$$scope:{ctx:i}}}),{c(){z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){q(e,l,s),t=!0},p(l,[s]){const a={};s&1&&(a.$$scope={dirty:s,ctx:l}),e.$set(a)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){S(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}class Et extends Ee{constructor(e){super(),ye(this,e,null,it,$e,{})}}export{Et as component,kt as universal};
