import{s as rt,n as Ie,d as i,y as Ne,I as Ye,B as Fe,D as _e,a as ne,i as Q,b as n,C as ce,p as a,E as dt,c as f,e as b,w as re,g as N,f as G,h as d,j as A,t as q,k as Ve,r as vt,H as ht,L as lt,J as nt}from"../chunks/BQ7GsIJB.js";import{S as ot,i as at,d as Ge,t as Pe,a as Ue,m as qe,c as Ke,b as Qe,g as xt,e as $t}from"../chunks/BJAXi6Wx.js";import{e as be}from"../chunks/C4J4wrHe.js";import{P as el}from"../chunks/CT4Pur72.js";import{O as Tt,h as tl,i as ll,j as sl,r as nl,k as rl,g as ol,P as al}from"../chunks/CCzF6k4p.js";import{u as il}from"../chunks/Cqd7ZG1L.js";import{g as cl}from"../chunks/DrMf7_PW.js";import{D as Zt}from"../chunks/4kTNVrYs.js";import{f as ul,g as fl,h as dl,e as hl,p as _l,i as ml,j as vl,r as pl,k as bl,m as gl,n as El}from"../chunks/BJaCESNi.js";function Ct(s,e,t){const l=s.slice();return l[24]=e[t],l}function Dt(s,e,t){const l=s.slice();return l[27]=e[t],l}function wt(s,e,t){const l=s.slice();return l[27]=e[t],l}function yt(s,e,t){const l=s.slice();return l[32]=e[t],l}function It(s,e,t){const l=s.slice();return l[35]=e[t],l}function Ot(s){let e,t,l,r,o,h;return{c(){e=d("div"),t=q(s[4]),l=A(),r=d("button"),this.h()},l(u){e=f(u,"DIV",{class:!0,role:!0});var c=b(e);t=G(c,s[4]),l=N(c),r=f(c,"BUTTON",{type:!0,class:!0,"aria-label":!0}),b(r).forEach(i),c.forEach(i),this.h()},h(){a(r,"type","button"),a(r,"class","btn-close"),a(r,"aria-label","Close"),a(e,"class","alert alert-danger alert-dismissible fade show"),a(e,"role","alert")},m(u,c){Q(u,e,c),n(e,t),n(e,l),n(e,r),o||(h=ce(r,"click",s[16]),o=!0)},p(u,c){c[0]&16&&ne(t,u[4])},d(u){u&&i(e),o=!1,h()}}}function Lt(s){let e,t=(s[35].display_name||s[35].email)+"",l,r,o=s[35].email+"",h,u,c;return{c(){e=d("option"),l=q(t),r=q(" ("),h=q(o),u=q(`)
							`),this.h()},l(_){e=f(_,"OPTION",{});var p=b(e);l=G(p,t),r=G(p," ("),h=G(p,o),u=G(p,`)
							`),p.forEach(i),this.h()},h(){e.__value=c=s[35].id,_e(e,e.__value)},m(_,p){Q(_,e,p),n(e,l),n(e,r),n(e,h),n(e,u)},p(_,p){p[0]&1024&&t!==(t=(_[35].display_name||_[35].email)+"")&&ne(l,t),p[0]&1024&&o!==(o=_[35].email+"")&&ne(h,o),p[0]&1024&&c!==(c=_[35].id)&&(e.__value=c,_e(e,e.__value))},d(_){_&&i(e)}}}function Nt(s){let e,t=s[32].name+"",l,r;return{c(){e=d("option"),l=q(t),this.h()},l(o){e=f(o,"OPTION",{});var h=b(e);l=G(h,t),h.forEach(i),this.h()},h(){e.__value=r=s[32].id,_e(e,e.__value)},m(o,h){Q(o,e,h),n(e,l)},p(o,h){h[0]&260&&t!==(t=o[32].name+"")&&ne(l,t),h[0]&260&&r!==(r=o[32].id)&&(e.__value=r,_e(e,e.__value))},d(o){o&&i(e)}}}function At(s){let e,t,l=be(s[2][s[27]]),r=[];for(let o=0;o<l.length;o+=1)r[o]=Nt(yt(s,l,o));return{c(){e=d("optgroup");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=f(o,"OPTGROUP",{label:!0});var h=b(e);for(let u=0;u<r.length;u+=1)r[u].l(h);h.forEach(i),this.h()},h(){a(e,"label",t=mt(s[27]))},m(o,h){Q(o,e,h);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null)},p(o,h){if(h[0]&260){l=be(o[2][o[27]]);let u;for(u=0;u<l.length;u+=1){const c=yt(o,l,u);r[u]?r[u].p(c,h):(r[u]=Nt(c),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=l.length}h[0]&256&&t!==(t=mt(o[27]))&&a(e,"label",t)},d(o){o&&i(e),Ne(r,o)}}}function Rt(s){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0,role:!0}),b(e).forEach(i),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,l){Q(t,e,l)},d(t){t&&i(e)}}}function St(s){let e,t=mt(s[27])+"",l;return{c(){e=d("option"),l=q(t),this.h()},l(r){e=f(r,"OPTION",{});var o=b(e);l=G(o,t),o.forEach(i),this.h()},h(){e.__value=s[27],_e(e,e.__value)},m(r,o){Q(r,e,o),n(e,l)},p:Ie,d(r){r&&i(e)}}}function kl(s){let e,t,l,r='<tr><th scope="col" class="svelte-1h4f1is">Name</th> <th scope="col" class="d-none d-md-table-cell svelte-1h4f1is">Email</th> <th scope="col" class="svelte-1h4f1is">Role</th> <th scope="col" class="d-none d-lg-table-cell svelte-1h4f1is">Organization</th> <th scope="col" class="d-none d-lg-table-cell svelte-1h4f1is">Assigned Date</th> <th scope="col" class="d-none d-xl-table-cell svelte-1h4f1is">Notes</th> <th scope="col" class="text-end svelte-1h4f1is">Actions</th></tr>',o,h,u=be(s[9]),c=[];for(let _=0;_<u.length;_+=1)c[_]=Vt(Ct(s,u,_));return{c(){e=d("div"),t=d("table"),l=d("thead"),l.innerHTML=r,o=A(),h=d("tbody");for(let _=0;_<c.length;_+=1)c[_].c();this.h()},l(_){e=f(_,"DIV",{class:!0});var p=b(e);t=f(p,"TABLE",{class:!0});var m=b(t);l=f(m,"THEAD",{"data-svelte-h":!0}),re(l)!=="svelte-1wg3omm"&&(l.innerHTML=r),o=N(m),h=f(m,"TBODY",{class:!0});var E=b(h);for(let L=0;L<c.length;L+=1)c[L].l(E);E.forEach(i),m.forEach(i),p.forEach(i),this.h()},h(){a(h,"class","table-group-divider"),a(t,"class","table table-hover align-middle svelte-1h4f1is"),a(e,"class","table-responsive")},m(_,p){Q(_,e,p),n(e,t),n(t,l),n(t,o),n(t,h);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(h,null)},p(_,p){if(p[0]&16904){u=be(_[9]);let m;for(m=0;m<u.length;m+=1){const E=Ct(_,u,m);c[m]?c[m].p(E,p):(c[m]=Vt(E),c[m].c(),c[m].m(h,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=u.length}},d(_){_&&i(e),Ne(c,_)}}}function Tl(s){let e,t,l=s[1]!=="all"&&Pt();return{c(){e=d("div"),t=q(`No active role assignments found.
			`),l&&l.c(),this.h()},l(r){e=f(r,"DIV",{class:!0});var o=b(e);t=G(o,`No active role assignments found.
			`),l&&l.l(o),o.forEach(i),this.h()},h(){a(e,"class","alert alert-info")},m(r,o){Q(r,e,o),n(e,t),l&&l.m(e,null)},p(r,o){r[1]!=="all"?l||(l=Pt(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(r){r&&i(e),l&&l.d()}}}function Cl(s){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-mlx3u2"&&(e.innerHTML=t),this.h()},h(){a(e,"class","text-center py-5")},m(l,r){Q(l,e,r)},p:Ie,d(l){l&&i(e)}}}function Vt(s){let e,t,l,r=(s[24].user?.display_name||"Unknown")+"",o,h,u,c=(s[24].user?.email||"N/A")+"",_,p,m,E,L=(s[24].user?.email||"N/A")+"",w,z,v,g,S=s[24].roleName+"",I,k,C,O,T=st(s[24].roleOrganization)+"",P,M,D,V,H=st(s[24].roleOrganization)+"",U,le,Z,se,oe=new Date(s[24].assigned_date).toLocaleDateString()+"",ie,fe,x,F,y=(s[24].notes||"—")+"",W,K,ae,J,$,ee,Y,j;function ue(){return s[21](s[24])}return{c(){e=d("tr"),t=d("td"),l=d("div"),o=q(r),h=A(),u=d("small"),_=q(c),p=A(),m=d("td"),E=d("small"),w=q(L),z=A(),v=d("td"),g=d("strong"),I=q(S),k=A(),C=d("div"),O=d("span"),P=q(T),M=A(),D=d("td"),V=d("span"),U=q(H),le=A(),Z=d("td"),se=d("small"),ie=q(oe),fe=A(),x=d("td"),F=d("small"),W=q(y),K=A(),ae=d("td"),J=d("button"),$=d("i"),ee=A(),this.h()},l(me){e=f(me,"TR",{});var X=b(e);t=f(X,"TD",{});var ke=b(t);l=f(ke,"DIV",{class:!0});var ge=b(l);o=G(ge,r),ge.forEach(i),h=N(ke),u=f(ke,"SMALL",{class:!0});var Te=b(u);_=G(Te,c),Te.forEach(i),ke.forEach(i),p=N(X),m=f(X,"TD",{class:!0});var De=b(m);E=f(De,"SMALL",{class:!0});var Be=b(E);w=G(Be,L),Be.forEach(i),De.forEach(i),z=N(X),v=f(X,"TD",{});var Ae=b(v);g=f(Ae,"STRONG",{});var Re=b(g);I=G(Re,S),Re.forEach(i),k=N(Ae),C=f(Ae,"DIV",{class:!0});var ze=b(C);O=f(ze,"SPAN",{class:!0});var Me=b(O);P=G(Me,T),Me.forEach(i),ze.forEach(i),Ae.forEach(i),M=N(X),D=f(X,"TD",{class:!0});var He=b(D);V=f(He,"SPAN",{class:!0});var Je=b(V);U=G(Je,H),Je.forEach(i),He.forEach(i),le=N(X),Z=f(X,"TD",{class:!0});var ve=b(Z);se=f(ve,"SMALL",{});var Oe=b(se);ie=G(Oe,oe),Oe.forEach(i),ve.forEach(i),fe=N(X),x=f(X,"TD",{class:!0});var de=b(x);F=f(de,"SMALL",{class:!0});var Le=b(F);W=G(Le,y),Le.forEach(i),de.forEach(i),K=N(X),ae=f(X,"TD",{class:!0});var he=b(ae);J=f(he,"BUTTON",{class:!0});var pe=b(J);$=f(pe,"I",{class:!0}),b($).forEach(i),pe.forEach(i),he.forEach(i),ee=N(X),X.forEach(i),this.h()},h(){a(l,"class","fw-semibold"),a(u,"class","d-md-none text-muted d-block"),a(E,"class","text-muted"),a(m,"class","d-none d-md-table-cell"),a(O,"class","badge bg-info"),a(C,"class","d-lg-none mt-1"),a(V,"class","badge bg-info"),a(D,"class","d-none d-lg-table-cell"),a(Z,"class","d-none d-lg-table-cell"),a(F,"class","text-muted"),a(x,"class","d-none d-xl-table-cell"),a($,"class","bi bi-x-circle"),a(J,"class","btn btn-sm btn-outline-danger"),J.disabled=s[3],a(ae,"class","text-end")},m(me,X){Q(me,e,X),n(e,t),n(t,l),n(l,o),n(t,h),n(t,u),n(u,_),n(e,p),n(e,m),n(m,E),n(E,w),n(e,z),n(e,v),n(v,g),n(g,I),n(v,k),n(v,C),n(C,O),n(O,P),n(e,M),n(e,D),n(D,V),n(V,U),n(e,le),n(e,Z),n(Z,se),n(se,ie),n(e,fe),n(e,x),n(x,F),n(F,W),n(e,K),n(e,ae),n(ae,J),n(J,$),n(e,ee),Y||(j=ce(J,"click",ue),Y=!0)},p(me,X){s=me,X[0]&512&&r!==(r=(s[24].user?.display_name||"Unknown")+"")&&ne(o,r),X[0]&512&&c!==(c=(s[24].user?.email||"N/A")+"")&&ne(_,c),X[0]&512&&L!==(L=(s[24].user?.email||"N/A")+"")&&ne(w,L),X[0]&512&&S!==(S=s[24].roleName+"")&&ne(I,S),X[0]&512&&T!==(T=st(s[24].roleOrganization)+"")&&ne(P,T),X[0]&512&&H!==(H=st(s[24].roleOrganization)+"")&&ne(U,H),X[0]&512&&oe!==(oe=new Date(s[24].assigned_date).toLocaleDateString()+"")&&ne(ie,oe),X[0]&512&&y!==(y=(s[24].notes||"—")+"")&&ne(W,y),X[0]&8&&(J.disabled=s[3])},d(me){me&&i(e),Y=!1,j()}}}function Pt(s){let e;return{c(){e=q("Try selecting a different organization.")},l(t){e=G(t,"Try selecting a different organization.")},m(t,l){Q(t,e,l)},d(t){t&&i(e)}}}function Dl(s){let e,t,l,r="Role Assignments",o,h,u,c,_,p,m,E,L='<h5 class="mb-0">Assign New Role</h5>',w,z,v,g,S,I="Select User",k,C,O,T="Choose a user...",P,M,D,V="Select Role",H,U,le,Z="Choose a role...",se,oe,ie,fe="Notes (Optional)",x,F,y,W,K,ae,J,$,ee,Y,j,ue,me="All Organizations",X,ke,ge,Te,De=s[9].length+"",Be,Ae,Re=s[9].length!==1?"s":"",ze,Me,He,Je,ve=s[4]&&Ot(s),Oe=be(s[10]),de=[];for(let R=0;R<Oe.length;R+=1)de[R]=Lt(It(s,Oe,R));let Le=be(s[8]),he=[];for(let R=0;R<Le.length;R+=1)he[R]=At(wt(s,Le,R));let pe=s[3]&&Rt(),je=be(Object.values(Tt)),Ee=[];for(let R=0;R<je.length;R+=1)Ee[R]=St(Dt(s,je,R));function pt(R,te){return R[3]&&R[0].length===0?Cl:R[9].length===0?Tl:kl}let We=pt(s),we=We(s);return{c(){e=d("div"),t=d("div"),l=d("h2"),l.textContent=r,o=A(),h=d("button"),u=d("i"),c=q(" Refresh"),_=A(),ve&&ve.c(),p=A(),m=d("div"),E=d("div"),E.innerHTML=L,w=A(),z=d("div"),v=d("div"),g=d("div"),S=d("label"),S.textContent=I,k=A(),C=d("select"),O=d("option"),O.textContent=T;for(let R=0;R<de.length;R+=1)de[R].c();P=A(),M=d("div"),D=d("label"),D.textContent=V,H=A(),U=d("select"),le=d("option"),le.textContent=Z;for(let R=0;R<he.length;R+=1)he[R].c();se=A(),oe=d("div"),ie=d("label"),ie.textContent=fe,x=A(),F=d("input"),y=A(),W=d("div"),K=d("button"),pe&&pe.c(),ae=q(`
						Assign Role`),$=A(),ee=d("div"),Y=d("div"),j=d("select"),ue=d("option"),ue.textContent=me;for(let R=0;R<Ee.length;R+=1)Ee[R].c();X=A(),ke=d("div"),ge=d("div"),Te=q("Showing "),Be=q(De),Ae=q(" active role"),ze=q(Re),Me=A(),we.c(),this.h()},l(R){e=f(R,"DIV",{class:!0});var te=b(e);t=f(te,"DIV",{class:!0});var B=b(t);l=f(B,"H2",{"data-svelte-h":!0}),re(l)!=="svelte-1xkrq8g"&&(l.textContent=r),o=N(B),h=f(B,"BUTTON",{class:!0});var Ce=b(h);u=f(Ce,"I",{class:!0}),b(u).forEach(i),c=G(Ce," Refresh"),Ce.forEach(i),B.forEach(i),_=N(te),ve&&ve.l(te),p=N(te),m=f(te,"DIV",{class:!0});var Ze=b(m);E=f(Ze,"DIV",{class:!0,"data-svelte-h":!0}),re(E)!=="svelte-1dkbtll"&&(E.innerHTML=L),w=N(Ze),z=f(Ze,"DIV",{class:!0});var bt=b(z);v=f(bt,"DIV",{class:!0});var Se=b(v);g=f(Se,"DIV",{class:!0});var xe=b(g);S=f(xe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(S)!=="svelte-1s8xk4p"&&(S.textContent=I),k=N(xe),C=f(xe,"SELECT",{id:!0,class:!0});var it=b(C);O=f(it,"OPTION",{"data-svelte-h":!0}),re(O)!=="svelte-kua526"&&(O.textContent=T);for(let ye=0;ye<de.length;ye+=1)de[ye].l(it);it.forEach(i),xe.forEach(i),P=N(Se),M=f(Se,"DIV",{class:!0});var $e=b(M);D=f($e,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(D)!=="svelte-rwhvvv"&&(D.textContent=V),H=N($e),U=f($e,"SELECT",{id:!0,class:!0});var ct=b(U);le=f(ct,"OPTION",{"data-svelte-h":!0}),re(le)!=="svelte-1fatopy"&&(le.textContent=Z);for(let ye=0;ye<he.length;ye+=1)he[ye].l(ct);ct.forEach(i),$e.forEach(i),se=N(Se),oe=f(Se,"DIV",{class:!0});var et=b(oe);ie=f(et,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(ie)!=="svelte-vpme2u"&&(ie.textContent=fe),x=N(et),F=f(et,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),et.forEach(i),y=N(Se),W=f(Se,"DIV",{class:!0});var gt=b(W);K=f(gt,"BUTTON",{class:!0});var ut=b(K);pe&&pe.l(ut),ae=G(ut,`
						Assign Role`),ut.forEach(i),gt.forEach(i),Se.forEach(i),bt.forEach(i),Ze.forEach(i),$=N(te),ee=f(te,"DIV",{class:!0});var tt=b(ee);Y=f(tt,"DIV",{class:!0});var Et=b(Y);j=f(Et,"SELECT",{class:!0});var ft=b(j);ue=f(ft,"OPTION",{"data-svelte-h":!0}),re(ue)!=="svelte-1vw7buo"&&(ue.textContent=me);for(let ye=0;ye<Ee.length;ye+=1)Ee[ye].l(ft);ft.forEach(i),Et.forEach(i),X=N(tt),ke=f(tt,"DIV",{class:!0});var kt=b(ke);ge=f(kt,"DIV",{class:!0});var Xe=b(ge);Te=G(Xe,"Showing "),Be=G(Xe,De),Ae=G(Xe," active role"),ze=G(Xe,Re),Xe.forEach(i),kt.forEach(i),tt.forEach(i),Me=N(te),we.l(te),te.forEach(i),this.h()},h(){a(u,"class","bi bi-arrow-clockwise"),a(h,"class","btn btn-primary"),h.disabled=s[3],a(t,"class","d-flex justify-content-between align-items-center mb-4"),a(E,"class","card-header svelte-1h4f1is"),a(S,"for","user-select"),a(S,"class","form-label"),O.__value=null,_e(O,O.__value),a(C,"id","user-select"),a(C,"class","form-select"),C.disabled=s[3],s[5]===void 0&&dt(()=>s[17].call(C)),a(g,"class","col-md-4"),a(D,"for","role-select"),a(D,"class","form-label"),le.__value="",_e(le,le.__value),a(U,"id","role-select"),a(U,"class","form-select"),U.disabled=s[3],s[6]===void 0&&dt(()=>s[18].call(U)),a(M,"class","col-md-4"),a(ie,"for","notes-input"),a(ie,"class","form-label"),a(F,"id","notes-input"),a(F,"type","text"),a(F,"class","form-control"),a(F,"placeholder","Assignment notes..."),F.disabled=s[3],a(oe,"class","col-md-4"),a(K,"class","btn btn-success"),K.disabled=J=s[3]||!s[5]||!s[6],a(W,"class","col-12"),a(v,"class","row g-3"),a(z,"class","card-body"),a(m,"class","card mb-4"),ue.__value="all",_e(ue,ue.__value),a(j,"class","form-select"),s[1]===void 0&&dt(()=>s[20].call(j)),a(Y,"class","col-md-4"),a(ge,"class","text-muted mt-2"),a(ke,"class","col-md-8"),a(ee,"class","row mb-3"),a(e,"class","role-assignment svelte-1h4f1is")},m(R,te){Q(R,e,te),n(e,t),n(t,l),n(t,o),n(t,h),n(h,u),n(h,c),n(e,_),ve&&ve.m(e,null),n(e,p),n(e,m),n(m,E),n(m,w),n(m,z),n(z,v),n(v,g),n(g,S),n(g,k),n(g,C),n(C,O);for(let B=0;B<de.length;B+=1)de[B]&&de[B].m(C,null);Fe(C,s[5],!0),n(v,P),n(v,M),n(M,D),n(M,H),n(M,U),n(U,le);for(let B=0;B<he.length;B+=1)he[B]&&he[B].m(U,null);Fe(U,s[6],!0),n(v,se),n(v,oe),n(oe,ie),n(oe,x),n(oe,F),_e(F,s[7]),n(v,y),n(v,W),n(W,K),pe&&pe.m(K,null),n(K,ae),n(e,$),n(e,ee),n(ee,Y),n(Y,j),n(j,ue);for(let B=0;B<Ee.length;B+=1)Ee[B]&&Ee[B].m(j,null);Fe(j,s[1],!0),n(ee,X),n(ee,ke),n(ke,ge),n(ge,Te),n(ge,Be),n(ge,Ae),n(ge,ze),n(e,Me),we.m(e,null),He||(Je=[ce(h,"click",s[12]),ce(C,"change",s[17]),ce(U,"change",s[18]),ce(F,"input",s[19]),ce(K,"click",s[13]),ce(j,"change",s[20])],He=!0)},p(R,te){if(te[0]&8&&(h.disabled=R[3]),R[4]?ve?ve.p(R,te):(ve=Ot(R),ve.c(),ve.m(e,p)):ve&&(ve.d(1),ve=null),te[0]&1024){Oe=be(R[10]);let B;for(B=0;B<Oe.length;B+=1){const Ce=It(R,Oe,B);de[B]?de[B].p(Ce,te):(de[B]=Lt(Ce),de[B].c(),de[B].m(C,null))}for(;B<de.length;B+=1)de[B].d(1);de.length=Oe.length}if(te[0]&8&&(C.disabled=R[3]),te[0]&1056&&Fe(C,R[5]),te[0]&260){Le=be(R[8]);let B;for(B=0;B<Le.length;B+=1){const Ce=wt(R,Le,B);he[B]?he[B].p(Ce,te):(he[B]=At(Ce),he[B].c(),he[B].m(U,null))}for(;B<he.length;B+=1)he[B].d(1);he.length=Le.length}if(te[0]&8&&(U.disabled=R[3]),te[0]&324&&Fe(U,R[6]),te[0]&8&&(F.disabled=R[3]),te[0]&128&&F.value!==R[7]&&_e(F,R[7]),R[3]?pe||(pe=Rt(),pe.c(),pe.m(K,ae)):pe&&(pe.d(1),pe=null),te[0]&1388&&J!==(J=R[3]||!R[5]||!R[6])&&(K.disabled=J),te&0){je=be(Object.values(Tt));let B;for(B=0;B<je.length;B+=1){const Ce=Dt(R,je,B);Ee[B]?Ee[B].p(Ce,te):(Ee[B]=St(Ce),Ee[B].c(),Ee[B].m(j,null))}for(;B<Ee.length;B+=1)Ee[B].d(1);Ee.length=je.length}te[0]&2&&Fe(j,R[1]),te[0]&512&&De!==(De=R[9].length+"")&&ne(Be,De),te[0]&512&&Re!==(Re=R[9].length!==1?"s":"")&&ne(ze,Re),We===(We=pt(R))&&we?we.p(R,te):(we.d(1),we=We(R),we&&(we.c(),we.m(e,null)))},i:Ie,o:Ie,d(R){R&&i(e),ve&&ve.d(),Ne(de,R),Ne(he,R),pe&&pe.d(),Ne(Ee,R),we.d(),He=!1,Ye(Je)}}}function mt(s){return s.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function st(s){return s?s.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Unknown"}function wl(s,e,t){let l,r,o,h,u;const{stores:c,actions:_}=il,{users:p}=c;Ve(s,p,V=>t(10,u=V));let m=[],E=!1,L=null,w=null,z="",v="",g="all";vt(async()=>{await _.fetchUsers(),await S()});async function S(){t(3,E=!0),t(4,L=null);try{const V=await tl();t(0,m=V.map(H=>{const U=u.find(Z=>Z.id===H.user_id),le=H.roles;return{...H,user:U,roleName:le?.name||String(H.role_id),roleOrganization:le?.organization}}))}catch(V){t(4,L=V instanceof Error?V.message:"Failed to load roles")}finally{t(3,E=!1)}}async function I(){if(!w||!z){t(4,L="Please select both a user and a role");return}t(3,E=!0),t(4,L=null);try{const V=await rl(w,z,1,v||void 0);V.success?(t(5,w=null),t(6,z=""),t(7,v=""),await S()):t(4,L=V.error||"Failed to assign role")}catch(V){t(4,L=V instanceof Error?V.message:"Failed to assign role")}finally{t(3,E=!1)}}async function k(V){if(confirm("Are you sure you want to release this role?")){t(3,E=!0),t(4,L=null);try{const H=await nl(V);H.success?await S():t(4,L=H.error||"Failed to release role")}catch(H){t(4,L=H instanceof Error?H.message:"Failed to release role")}finally{t(3,E=!1)}}}const C=()=>t(4,L=null);function O(){w=ht(this),t(5,w)}function T(){z=ht(this),t(6,z),t(2,o),t(15,r),t(8,h),t(2,o),t(15,r)}function P(){v=this.value,t(7,v)}function M(){g=ht(this),t(1,g)}const D=V=>k(V.id);return s.$$.update=()=>{s.$$.dirty[0]&3&&t(9,l=m.filter(V=>g==="all"?!0:V.roleOrganization===g)),s.$$.dirty[0]&32768&&t(2,o=r.reduce((V,H)=>{const U=ll(H);if(U){const le=U.organization;V[le]||(V[le]=[]),V[le].push(U)}return V},{})),s.$$.dirty[0]&4&&t(8,h=Object.keys(o))},t(15,r=sl()),[m,g,o,E,L,w,z,v,h,l,u,p,S,I,k,r,C,O,T,P,M,D]}class yl extends ot{constructor(e){super(),at(this,e,wl,Dl,rt,{},null,[-1,-1])}}function Ut(s){let e,t;return{c(){e=d("div"),t=q(s[6]),this.h()},l(l){e=f(l,"DIV",{class:!0,role:!0});var r=b(e);t=G(r,s[6]),r.forEach(i),this.h()},h(){a(e,"class","alert alert-danger"),a(e,"role","alert")},m(l,r){Q(l,e,r),n(e,t)},p(l,r){r&64&&ne(t,l[6])},d(l){l&&i(e)}}}function Bt(s){let e,t="Key cannot be changed after creation";return{c(){e=d("div"),e.textContent=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1k89ihx"&&(e.textContent=t),this.h()},h(){a(e,"class","form-text")},m(l,r){Q(l,e,r)},d(l){l&&i(e)}}}function zt(s){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0,role:!0}),b(e).forEach(i),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,l){Q(t,e,l)},d(t){t&&i(e)}}}function Il(s){let e,t,l,r,o='Key <span class="text-danger">*</span>',h,u,c,_,p,m,E='Name <span class="text-danger">*</span>',L,w,z,v,g,S="Organization",I,k,C,O,T="Used for grouping roles",P,M,D,V="Description",H,U,le,Z,se,oe,ie=s[7]?"Update":"Create",fe,x,F,y,W,K,ae,J=s[6]&&Ut(s),$=s[7]&&Bt(),ee=s[5]&&zt();return{c(){e=d("form"),J&&J.c(),t=A(),l=d("div"),r=d("label"),r.innerHTML=o,h=A(),u=d("input"),c=A(),$&&$.c(),_=A(),p=d("div"),m=d("label"),m.innerHTML=E,L=A(),w=d("input"),z=A(),v=d("div"),g=d("label"),g.textContent=S,I=A(),k=d("input"),C=A(),O=d("div"),O.textContent=T,P=A(),M=d("div"),D=d("label"),D.textContent=V,H=A(),U=d("textarea"),le=A(),Z=d("div"),se=d("button"),ee&&ee.c(),oe=A(),fe=q(ie),x=q(" Role"),F=A(),y=d("button"),W=q("Cancel"),this.h()},l(Y){e=f(Y,"FORM",{});var j=b(e);J&&J.l(j),t=N(j),l=f(j,"DIV",{class:!0});var ue=b(l);r=f(ue,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(r)!=="svelte-136wa73"&&(r.innerHTML=o),h=N(ue),u=f(ue,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),c=N(ue),$&&$.l(ue),ue.forEach(i),_=N(j),p=f(j,"DIV",{class:!0});var me=b(p);m=f(me,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(m)!=="svelte-kgvawd"&&(m.innerHTML=E),L=N(me),w=f(me,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),me.forEach(i),z=N(j),v=f(j,"DIV",{class:!0});var X=b(v);g=f(X,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(g)!=="svelte-hzptp9"&&(g.textContent=S),I=N(X),k=f(X,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),C=N(X),O=f(X,"DIV",{class:!0,"data-svelte-h":!0}),re(O)!=="svelte-a7bjz3"&&(O.textContent=T),X.forEach(i),P=N(j),M=f(j,"DIV",{class:!0});var ke=b(M);D=f(ke,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(D)!=="svelte-1wym8yn"&&(D.textContent=V),H=N(ke),U=f(ke,"TEXTAREA",{class:!0,id:!0,rows:!0,placeholder:!0}),b(U).forEach(i),ke.forEach(i),le=N(j),Z=f(j,"DIV",{class:!0});var ge=b(Z);se=f(ge,"BUTTON",{type:!0,class:!0});var Te=b(se);ee&&ee.l(Te),oe=N(Te),fe=G(Te,ie),x=G(Te," Role"),Te.forEach(i),F=N(ge),y=f(ge,"BUTTON",{type:!0,class:!0,"data-bs-dismiss":!0});var De=b(y);W=G(De,"Cancel"),De.forEach(i),ge.forEach(i),j.forEach(i),this.h()},h(){a(r,"for","role-key"),a(r,"class","form-label"),a(u,"type","text"),a(u,"class","form-control"),a(u,"id","role-key"),u.required=!0,u.disabled=s[7],a(u,"placeholder","e.g., primary-president"),a(l,"class","mb-3"),a(m,"for","role-name"),a(m,"class","form-label"),a(w,"type","text"),a(w,"class","form-control"),a(w,"id","role-name"),w.required=!0,a(w,"placeholder","e.g., Primary President"),a(p,"class","mb-3"),a(g,"for","role-organization"),a(g,"class","form-label"),a(k,"type","text"),a(k,"class","form-control"),a(k,"id","role-organization"),a(k,"placeholder","e.g., primary, bishopric, relief-society"),a(O,"class","form-text"),a(v,"class","mb-3"),a(D,"for","role-description"),a(D,"class","form-label"),a(U,"class","form-control"),a(U,"id","role-description"),a(U,"rows","3"),a(U,"placeholder","Describe this role..."),a(M,"class","mb-3"),a(se,"type","submit"),a(se,"class","btn btn-primary"),se.disabled=s[5],a(y,"type","button"),a(y,"class","btn btn-secondary"),a(y,"data-bs-dismiss","offcanvas"),y.disabled=s[5],a(Z,"class","d-flex gap-2")},m(Y,j){Q(Y,e,j),J&&J.m(e,null),n(e,t),n(e,l),n(l,r),n(l,h),n(l,u),_e(u,s[1]),n(l,c),$&&$.m(l,null),n(e,_),n(e,p),n(p,m),n(p,L),n(p,w),_e(w,s[2]),n(e,z),n(e,v),n(v,g),n(v,I),n(v,k),_e(k,s[3]),n(v,C),n(v,O),n(e,P),n(e,M),n(M,D),n(M,H),n(M,U),_e(U,s[4]),n(e,le),n(e,Z),n(Z,se),ee&&ee.m(se,null),n(se,oe),n(se,fe),n(se,x),n(Z,F),n(Z,y),n(y,W),K||(ae=[ce(u,"input",s[11]),ce(w,"input",s[12]),ce(k,"input",s[13]),ce(U,"input",s[14]),ce(e,"submit",s[8])],K=!0)},p(Y,j){Y[6]?J?J.p(Y,j):(J=Ut(Y),J.c(),J.m(e,t)):J&&(J.d(1),J=null),j&128&&(u.disabled=Y[7]),j&2&&u.value!==Y[1]&&_e(u,Y[1]),Y[7]?$||($=Bt(),$.c(),$.m(l,null)):$&&($.d(1),$=null),j&4&&w.value!==Y[2]&&_e(w,Y[2]),j&8&&k.value!==Y[3]&&_e(k,Y[3]),j&16&&_e(U,Y[4]),Y[5]?ee||(ee=zt(),ee.c(),ee.m(se,oe)):ee&&(ee.d(1),ee=null),j&128&&ie!==(ie=Y[7]?"Update":"Create")&&ne(fe,ie),j&32&&(se.disabled=Y[5]),j&32&&(y.disabled=Y[5])},d(Y){Y&&i(e),J&&J.d(),$&&$.d(),ee&&ee.d(),K=!1,Ye(ae)}}}function Ol(s){let e,t;return e=new Zt({props:{title:s[7]?"Edit Role":"Create Role",id:s[0],$$slots:{default:[Il]},$$scope:{ctx:s}}}),{c(){Qe(e.$$.fragment)},l(l){Ke(e.$$.fragment,l)},m(l,r){qe(e,l,r),t=!0},p(l,[r]){const o={};r&128&&(o.title=l[7]?"Edit Role":"Create Role"),r&1&&(o.id=l[0]),r&131326&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function Ll(s,e,t){let l,{id:r="role-form-drawer"}=e,{role:o=null}=e,{onSave:h=null}=e,u="",c="",_="",p="",m=!1,E="";async function L(k){k.preventDefault(),t(5,m=!0),t(6,E="");try{l&&o?await ul(o.id,{name:c,organization:_||null,description:p||null}):await fl({key:u,name:c,organization:_||null,description:p||null});const C=document.getElementById(r);if(C){const T=window.bootstrap?.Offcanvas?.getInstance(C);T&&T.hide()}w(),h&&h()}catch(C){t(6,E=C instanceof Error?C.message:"Failed to save role")}finally{t(5,m=!1)}}function w(){t(1,u=""),t(2,c=""),t(3,_=""),t(4,p=""),t(6,E="")}function z(){w()}vt(()=>{const k=document.getElementById(r);if(k)return k.addEventListener("hidden.bs.offcanvas",z),()=>{k.removeEventListener("hidden.bs.offcanvas",z)}});function v(){u=this.value,t(1,u),t(9,o)}function g(){c=this.value,t(2,c),t(9,o)}function S(){_=this.value,t(3,_),t(9,o)}function I(){p=this.value,t(4,p),t(9,o)}return s.$$set=k=>{"id"in k&&t(0,r=k.id),"role"in k&&t(9,o=k.role),"onSave"in k&&t(10,h=k.onSave)},s.$$.update=()=>{s.$$.dirty&512&&t(7,l=o!==null),s.$$.dirty&512&&o&&(t(1,u=o.key),t(2,c=o.name),t(3,_=o.organization||""),t(4,p=o.description||""))},[r,u,c,_,p,m,E,l,L,o,h,v,g,S,I]}class Nl extends ot{constructor(e){super(),at(this,e,Ll,Ol,rt,{id:0,role:9,onSave:10})}}function Mt(s,e,t){const l=s.slice();return l[13]=e[t][0],l[14]=e[t][1],l}function Ht(s,e,t){const l=s.slice();return l[17]=e[t],l}function jt(s){let e,t;return{c(){e=d("div"),t=q(s[4]),this.h()},l(l){e=f(l,"DIV",{class:!0,role:!0});var r=b(e);t=G(r,s[4]),r.forEach(i),this.h()},h(){a(e,"class","alert alert-danger"),a(e,"role","alert")},m(l,r){Q(l,e,r),n(e,t)},p(l,r){r&16&&ne(t,l[4])},d(l){l&&i(e)}}}function Al(s){let e,t="Please select a role to manage permissions.";return{c(){e=d("div"),e.textContent=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-d823lb"&&(e.textContent=t),this.h()},h(){a(e,"class","alert alert-info")},m(l,r){Q(l,e,r)},p:Ie,d(l){l&&i(e)}}}function Rl(s){let e,t,l,r,o="Role:",h,u=s[1].name+"",c,_,p,m,E="Select All",L,w,z="Deselect All",v,g,S=s[2].size+"",I,k,C=s[5].length+"",O,T,P,M,D,V,H,U,le,Z,se,oe,ie,fe=be(Object.entries(s[6])),x=[];for(let y=0;y<fe.length;y+=1)x[y]=qt(Mt(s,fe,y));let F=s[3]&&Kt();return{c(){e=d("div"),t=d("div"),l=d("div"),r=d("strong"),r.textContent=o,h=A(),c=q(u),_=A(),p=d("div"),m=d("button"),m.textContent=E,L=A(),w=d("button"),w.textContent=z,v=A(),g=d("div"),I=q(S),k=q(" of "),O=q(C),T=q(" permissions selected"),P=A(),M=d("div");for(let y=0;y<x.length;y+=1)x[y].c();D=A(),V=d("div"),H=d("button"),F&&F.c(),U=q(`
					Save Permissions`),le=A(),Z=d("button"),se=q("Cancel"),this.h()},l(y){e=f(y,"DIV",{class:!0});var W=b(e);t=f(W,"DIV",{class:!0});var K=b(t);l=f(K,"DIV",{});var ae=b(l);r=f(ae,"STRONG",{"data-svelte-h":!0}),re(r)!=="svelte-4i7x80"&&(r.textContent=o),h=N(ae),c=G(ae,u),ae.forEach(i),_=N(K),p=f(K,"DIV",{});var J=b(p);m=f(J,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),re(m)!=="svelte-grzpeo"&&(m.textContent=E),L=N(J),w=f(J,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),re(w)!=="svelte-18kd0i8"&&(w.textContent=z),J.forEach(i),K.forEach(i),v=N(W),g=f(W,"DIV",{class:!0});var $=b(g);I=G($,S),k=G($," of "),O=G($,C),T=G($," permissions selected"),$.forEach(i),W.forEach(i),P=N(y),M=f(y,"DIV",{class:!0});var ee=b(M);for(let me=0;me<x.length;me+=1)x[me].l(ee);ee.forEach(i),D=N(y),V=f(y,"DIV",{class:!0});var Y=b(V);H=f(Y,"BUTTON",{type:!0,class:!0});var j=b(H);F&&F.l(j),U=G(j,`
					Save Permissions`),j.forEach(i),le=N(Y),Z=f(Y,"BUTTON",{type:!0,class:!0,"data-bs-dismiss":!0});var ue=b(Z);se=G(ue,"Cancel"),ue.forEach(i),Y.forEach(i),this.h()},h(){a(m,"type","button"),a(m,"class","btn btn-sm btn-outline-primary me-1"),a(w,"type","button"),a(w,"class","btn btn-sm btn-outline-secondary"),a(t,"class","d-flex justify-content-between align-items-center mb-2"),a(g,"class","text-muted small"),a(e,"class","mb-3"),a(M,"class","mb-3"),a(H,"type","submit"),a(H,"class","btn btn-primary"),H.disabled=s[3],a(Z,"type","button"),a(Z,"class","btn btn-secondary"),a(Z,"data-bs-dismiss","offcanvas"),Z.disabled=s[3],a(V,"class","d-flex gap-2 sticky-bottom bg-body pt-3 border-top svelte-nth4dh")},m(y,W){Q(y,e,W),n(e,t),n(t,l),n(l,r),n(l,h),n(l,c),n(t,_),n(t,p),n(p,m),n(p,L),n(p,w),n(e,v),n(e,g),n(g,I),n(g,k),n(g,O),n(g,T),Q(y,P,W),Q(y,M,W);for(let K=0;K<x.length;K+=1)x[K]&&x[K].m(M,null);Q(y,D,W),Q(y,V,W),n(V,H),F&&F.m(H,null),n(H,U),n(V,le),n(V,Z),n(Z,se),oe||(ie=[ce(m,"click",s[8]),ce(w,"click",s[9])],oe=!0)},p(y,W){if(W&2&&u!==(u=y[1].name+"")&&ne(c,u),W&4&&S!==(S=y[2].size+"")&&ne(I,S),W&32&&C!==(C=y[5].length+"")&&ne(O,C),W&196){fe=be(Object.entries(y[6]));let K;for(K=0;K<fe.length;K+=1){const ae=Mt(y,fe,K);x[K]?x[K].p(ae,W):(x[K]=qt(ae),x[K].c(),x[K].m(M,null))}for(;K<x.length;K+=1)x[K].d(1);x.length=fe.length}y[3]?F||(F=Kt(),F.c(),F.m(H,U)):F&&(F.d(1),F=null),W&8&&(H.disabled=y[3]),W&8&&(Z.disabled=y[3])},d(y){y&&(i(e),i(P),i(M),i(D),i(V)),Ne(x,y),F&&F.d(),oe=!1,Ye(ie)}}}function Ft(s){let e,t=s[17].description+"",l;return{c(){e=d("div"),l=q(t),this.h()},l(r){e=f(r,"DIV",{class:!0});var o=b(e);l=G(o,t),o.forEach(i),this.h()},h(){a(e,"class","text-muted small")},m(r,o){Q(r,e,o),n(e,l)},p(r,o){o&64&&t!==(t=r[17].description+"")&&ne(l,t)},d(r){r&&i(e)}}}function Gt(s){let e,t,l,r,o,h,u,c,_=s[17].name+"",p,m,E,L,w=s[17].key+"",z,v,g,S,I,k;function C(){return s[12](s[17])}let O=s[17].description&&Ft(s);return{c(){e=d("div"),t=d("input"),o=A(),h=d("label"),u=d("div"),c=d("strong"),p=q(_),m=A(),E=d("span"),L=q("("),z=q(w),v=q(")"),g=A(),O&&O.c(),this.h()},l(T){e=f(T,"DIV",{class:!0});var P=b(e);t=f(P,"INPUT",{class:!0,type:!0,id:!0}),o=N(P),h=f(P,"LABEL",{class:!0,for:!0});var M=b(h);u=f(M,"DIV",{});var D=b(u);c=f(D,"STRONG",{});var V=b(c);p=G(V,_),V.forEach(i),m=N(D),E=f(D,"SPAN",{class:!0});var H=b(E);L=G(H,"("),z=G(H,w),v=G(H,")"),H.forEach(i),D.forEach(i),g=N(M),O&&O.l(M),M.forEach(i),P.forEach(i),this.h()},h(){a(t,"class","form-check-input"),a(t,"type","checkbox"),a(t,"id",l="permission-"+s[17].id),t.checked=r=s[2].has(s[17].id),a(E,"class","text-muted small"),a(h,"class","form-check-label"),a(h,"for",S="permission-"+s[17].id),a(e,"class","form-check mb-2")},m(T,P){Q(T,e,P),n(e,t),n(e,o),n(e,h),n(h,u),n(u,c),n(c,p),n(u,m),n(u,E),n(E,L),n(E,z),n(E,v),n(h,g),O&&O.m(h,null),I||(k=ce(t,"change",C),I=!0)},p(T,P){s=T,P&64&&l!==(l="permission-"+s[17].id)&&a(t,"id",l),P&68&&r!==(r=s[2].has(s[17].id))&&(t.checked=r),P&64&&_!==(_=s[17].name+"")&&ne(p,_),P&64&&w!==(w=s[17].key+"")&&ne(z,w),s[17].description?O?O.p(s,P):(O=Ft(s),O.c(),O.m(h,null)):O&&(O.d(1),O=null),P&64&&S!==(S="permission-"+s[17].id)&&a(h,"for",S)},d(T){T&&i(e),O&&O.d(),I=!1,k()}}}function qt(s){let e,t,l=s[13]+"",r,o,h,u=be(s[14]),c=[];for(let _=0;_<u.length;_+=1)c[_]=Gt(Ht(s,u,_));return{c(){e=d("div"),t=d("h6"),r=q(l),o=A();for(let _=0;_<c.length;_+=1)c[_].c();h=A(),this.h()},l(_){e=f(_,"DIV",{class:!0});var p=b(e);t=f(p,"H6",{class:!0});var m=b(t);r=G(m,l),m.forEach(i),o=N(p);for(let E=0;E<c.length;E+=1)c[E].l(p);h=N(p),p.forEach(i),this.h()},h(){a(t,"class","text-uppercase text-muted small mb-2"),a(e,"class","mb-3")},m(_,p){Q(_,e,p),n(e,t),n(t,r),n(e,o);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(e,null);n(e,h)},p(_,p){if(p&64&&l!==(l=_[13]+"")&&ne(r,l),p&196){u=be(_[14]);let m;for(m=0;m<u.length;m+=1){const E=Ht(_,u,m);c[m]?c[m].p(E,p):(c[m]=Gt(E),c[m].c(),c[m].m(e,h))}for(;m<c.length;m+=1)c[m].d(1);c.length=u.length}},d(_){_&&i(e),Ne(c,_)}}}function Kt(s){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0,role:!0}),b(e).forEach(i),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,l){Q(t,e,l)},d(t){t&&i(e)}}}function Sl(s){let e,t,l,r,o=s[4]&&jt(s);function h(_,p){return _[1]?Rl:Al}let u=h(s),c=u(s);return{c(){e=d("form"),o&&o.c(),t=A(),c.c()},l(_){e=f(_,"FORM",{});var p=b(e);o&&o.l(p),t=N(p),c.l(p),p.forEach(i)},m(_,p){Q(_,e,p),o&&o.m(e,null),n(e,t),c.m(e,null),l||(r=ce(e,"submit",s[10]),l=!0)},p(_,p){_[4]?o?o.p(_,p):(o=jt(_),o.c(),o.m(e,t)):o&&(o.d(1),o=null),u===(u=h(_))&&c?c.p(_,p):(c.d(1),c=u(_),c&&(c.c(),c.m(e,null)))},d(_){_&&i(e),o&&o.d(),c.d(),l=!1,r()}}}function Vl(s){let e,t;return e=new Zt({props:{title:s[1]?`Manage Permissions: ${s[1].name}`:"Manage Permissions",id:s[0],$$slots:{default:[Sl]},$$scope:{ctx:s}}}),{c(){Qe(e.$$.fragment)},l(l){Ke(e.$$.fragment,l)},m(l,r){qe(e,l,r),t=!0},p(l,[r]){const o={};r&2&&(o.title=l[1]?`Manage Permissions: ${l[1].name}`:"Manage Permissions"),r&1&&(o.id=l[0]),r&1048702&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function Pl(s,e,t){let l,r;Ve(s,hl,v=>t(5,l=v)),Ve(s,_l,v=>t(6,r=v));let{id:o="role-permissions-drawer"}=e,{role:h=null}=e,{onSave:u=null}=e,c=new Set,_=!1,p="";function m(v){c.has(v)?c.delete(v):c.add(v),t(2,c),t(1,h)}function E(){t(2,c=new Set(l.map(v=>v.id)))}function L(){t(2,c=new Set)}async function w(v){if(v.preventDefault(),!!h){t(3,_=!0),t(4,p="");try{await dl(h.id,Array.from(c));const g=document.getElementById(o);if(g){const I=window.bootstrap?.Offcanvas?.getInstance(g);I&&I.hide()}u&&u()}catch(g){t(4,p=g instanceof Error?g.message:"Failed to assign permissions")}finally{t(3,_=!1)}}}const z=v=>m(v.id);return s.$$set=v=>{"id"in v&&t(0,o=v.id),"role"in v&&t(1,h=v.role),"onSave"in v&&t(11,u=v.onSave)},s.$$.update=()=>{s.$$.dirty&2&&h&&t(2,c=new Set(h.permissions.map(v=>v.id)))},[o,h,c,_,p,l,r,m,E,L,w,u,z]}class Ul extends ot{constructor(e){super(),at(this,e,Pl,Vl,rt,{id:0,role:1,onSave:11})}}function Qt(s,e,t){const l=s.slice();return l[23]=e[t][0],l[24]=e[t][1],l}function Yt(s,e,t){const l=s.slice();return l[27]=e[t],l}function Bl(s){let e,t,l="Role Definitions",r,o,h=`<i class="bi bi-plus-lg me-1"></i>
					Create Role`,u,c,_,p,m,E,L,w,z,v=s[5]&&Jt(s);function g(k,C){return k[6]?jl:k[7].length===0?Hl:Ml}let S=g(s),I=S(s);return{c(){e=d("div"),t=d("h2"),t.textContent=l,r=A(),o=d("button"),o.innerHTML=h,u=A(),v&&v.c(),c=A(),_=d("div"),p=d("div"),m=d("input"),E=A(),I.c(),L=nt(),this.h()},l(k){e=f(k,"DIV",{class:!0});var C=b(e);t=f(C,"H2",{"data-svelte-h":!0}),re(t)!=="svelte-104zljo"&&(t.textContent=l),r=N(C),o=f(C,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),re(o)!=="svelte-gydj2j"&&(o.innerHTML=h),C.forEach(i),u=N(k),v&&v.l(k),c=N(k),_=f(k,"DIV",{class:!0});var O=b(_);p=f(O,"DIV",{class:!0});var T=b(p);m=f(T,"INPUT",{type:!0,class:!0,placeholder:!0}),T.forEach(i),O.forEach(i),E=N(k),I.l(k),L=nt(),this.h()},h(){a(o,"type","button"),a(o,"class","btn btn-primary"),a(e,"class","d-flex justify-content-between align-items-center mb-4"),a(m,"type","text"),a(m,"class","form-control"),a(m,"placeholder","Search roles..."),a(p,"class","card-body"),a(_,"class","card mb-4")},m(k,C){Q(k,e,C),n(e,t),n(e,r),n(e,o),Q(k,u,C),v&&v.m(k,C),Q(k,c,C),Q(k,_,C),n(_,p),n(p,m),_e(m,s[0]),Q(k,E,C),I.m(k,C),Q(k,L,C),w||(z=[ce(o,"click",s[9]),ce(m,"input",s[16])],w=!0)},p(k,C){k[5]?v?v.p(k,C):(v=Jt(k),v.c(),v.m(c.parentNode,c)):v&&(v.d(1),v=null),C&1&&m.value!==k[0]&&_e(m,k[0]),S===(S=g(k))&&I?I.p(k,C):(I.d(1),I=S(k),I&&(I.c(),I.m(L.parentNode,L)))},i:Ie,o:Ie,d(k){k&&(i(e),i(u),i(c),i(_),i(E),i(L)),v&&v.d(k),I.d(k),w=!1,Ye(z)}}}function zl(s){let e,t;return e=new yl({}),{c(){Qe(e.$$.fragment)},l(l){Ke(e.$$.fragment,l)},m(l,r){qe(e,l,r),t=!0},p:Ie,i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function Jt(s){let e,t,l,r;return{c(){e=d("div"),t=d("i"),l=A(),r=q(s[5]),this.h()},l(o){e=f(o,"DIV",{class:!0,role:!0});var h=b(e);t=f(h,"I",{class:!0}),b(t).forEach(i),l=N(h),r=G(h,s[5]),h.forEach(i),this.h()},h(){a(t,"class","bi bi-exclamation-triangle me-2"),a(e,"class","alert alert-danger"),a(e,"role","alert")},m(o,h){Q(o,e,h),n(e,t),n(e,l),n(e,r)},p(o,h){h&32&&ne(r,o[5])},d(o){o&&i(e)}}}function Ml(s){let e,t=be(s[4]),l=[];for(let r=0;r<t.length;r+=1)l[r]=Wt(Qt(s,t,r));return{c(){for(let r=0;r<l.length;r+=1)l[r].c();e=nt()},l(r){for(let o=0;o<l.length;o+=1)l[o].l(r);e=nt()},m(r,o){for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(r,o);Q(r,e,o)},p(r,o){if(o&7184){t=be(r[4]);let h;for(h=0;h<t.length;h+=1){const u=Qt(r,t,h);l[h]?l[h].p(u,o):(l[h]=Wt(u),l[h].c(),l[h].m(e.parentNode,e))}for(;h<l.length;h+=1)l[h].d(1);l.length=t.length}},d(r){r&&i(e),Ne(l,r)}}}function Hl(s){let e,t="No roles found. Create your first role to get started.";return{c(){e=d("div"),e.textContent=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1hcv02t"&&(e.textContent=t),this.h()},h(){a(e,"class","alert alert-info")},m(l,r){Q(l,e,r)},p:Ie,d(l){l&&i(e)}}}function jl(s){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1xj70p"&&(e.innerHTML=t),this.h()},h(){a(e,"class","d-flex justify-content-center align-items-center py-5")},m(l,r){Q(l,e,r)},p:Ie,d(l){l&&i(e)}}}function Xt(s){let e,t,l,r=s[27].name+"",o,h,u,c,_=s[27].key+"",p,m,E,L=(s[27].description||"-")+"",w,z,v,g,S=s[27].permissions.length+"",I,k,C,O,T,P='<i class="bi bi-key"></i>',M,D,V='<i class="bi bi-pencil"></i>',H,U,le='<i class="bi bi-trash"></i>',Z,se,oe;function ie(){return s[17](s[27])}function fe(){return s[18](s[27])}function x(){return s[19](s[27])}return{c(){e=d("tr"),t=d("td"),l=d("strong"),o=q(r),h=A(),u=d("td"),c=d("code"),p=q(_),m=A(),E=d("td"),w=q(L),z=A(),v=d("td"),g=d("span"),I=q(S),k=q(" permissions"),C=A(),O=d("td"),T=d("button"),T.innerHTML=P,M=A(),D=d("button"),D.innerHTML=V,H=A(),U=d("button"),U.innerHTML=le,Z=A(),this.h()},l(F){e=f(F,"TR",{});var y=b(e);t=f(y,"TD",{});var W=b(t);l=f(W,"STRONG",{});var K=b(l);o=G(K,r),K.forEach(i),W.forEach(i),h=N(y),u=f(y,"TD",{});var ae=b(u);c=f(ae,"CODE",{});var J=b(c);p=G(J,_),J.forEach(i),ae.forEach(i),m=N(y),E=f(y,"TD",{});var $=b(E);w=G($,L),$.forEach(i),z=N(y),v=f(y,"TD",{});var ee=b(v);g=f(ee,"SPAN",{class:!0});var Y=b(g);I=G(Y,S),k=G(Y," permissions"),Y.forEach(i),ee.forEach(i),C=N(y),O=f(y,"TD",{});var j=b(O);T=f(j,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),re(T)!=="svelte-1jg2ize"&&(T.innerHTML=P),M=N(j),D=f(j,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),re(D)!=="svelte-rmv7u4"&&(D.innerHTML=V),H=N(j),U=f(j,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),re(U)!=="svelte-bhg5w1"&&(U.innerHTML=le),j.forEach(i),Z=N(y),y.forEach(i),this.h()},h(){a(g,"class","badge bg-secondary"),a(T,"type","button"),a(T,"class","btn btn-sm btn-outline-success me-1"),a(T,"title","Manage Permissions"),a(D,"type","button"),a(D,"class","btn btn-sm btn-outline-primary me-1"),a(D,"title","Edit"),a(U,"type","button"),a(U,"class","btn btn-sm btn-outline-danger"),a(U,"title","Delete")},m(F,y){Q(F,e,y),n(e,t),n(t,l),n(l,o),n(e,h),n(e,u),n(u,c),n(c,p),n(e,m),n(e,E),n(E,w),n(e,z),n(e,v),n(v,g),n(g,I),n(g,k),n(e,C),n(e,O),n(O,T),n(O,M),n(O,D),n(O,H),n(O,U),n(e,Z),se||(oe=[ce(T,"click",ie),ce(D,"click",fe),ce(U,"click",x)],se=!0)},p(F,y){s=F,y&16&&r!==(r=s[27].name+"")&&ne(o,r),y&16&&_!==(_=s[27].key+"")&&ne(p,_),y&16&&L!==(L=(s[27].description||"-")+"")&&ne(w,L),y&16&&S!==(S=s[27].permissions.length+"")&&ne(I,S)},d(F){F&&i(e),se=!1,Ye(oe)}}}function Wt(s){let e,t,l,r=s[23]+"",o,h,u,c,_,p,m='<tr><th>Name</th> <th>Key</th> <th>Description</th> <th>Permissions</th> <th style="width: 200px;">Actions</th></tr>',E,L,w,z=be(s[24]),v=[];for(let g=0;g<z.length;g+=1)v[g]=Xt(Yt(s,z,g));return{c(){e=d("div"),t=d("div"),l=d("h5"),o=q(r),h=A(),u=d("div"),c=d("div"),_=d("table"),p=d("thead"),p.innerHTML=m,E=A(),L=d("tbody");for(let g=0;g<v.length;g+=1)v[g].c();w=A(),this.h()},l(g){e=f(g,"DIV",{class:!0});var S=b(e);t=f(S,"DIV",{class:!0});var I=b(t);l=f(I,"H5",{class:!0});var k=b(l);o=G(k,r),k.forEach(i),I.forEach(i),h=N(S),u=f(S,"DIV",{class:!0});var C=b(u);c=f(C,"DIV",{class:!0});var O=b(c);_=f(O,"TABLE",{class:!0});var T=b(_);p=f(T,"THEAD",{"data-svelte-h":!0}),re(p)!=="svelte-106iwxu"&&(p.innerHTML=m),E=N(T),L=f(T,"TBODY",{});var P=b(L);for(let M=0;M<v.length;M+=1)v[M].l(P);P.forEach(i),T.forEach(i),O.forEach(i),C.forEach(i),w=N(S),S.forEach(i),this.h()},h(){a(l,"class","mb-0 text-uppercase"),a(t,"class","card-header"),a(_,"class","table table-hover mb-0"),a(c,"class","table-responsive"),a(u,"class","card-body"),a(e,"class","card mb-3")},m(g,S){Q(g,e,S),n(e,t),n(t,l),n(l,o),n(e,h),n(e,u),n(u,c),n(c,_),n(_,p),n(_,E),n(_,L);for(let I=0;I<v.length;I+=1)v[I]&&v[I].m(L,null);n(e,w)},p(g,S){if(S&16&&r!==(r=g[23]+"")&&ne(o,r),S&7184){z=be(g[24]);let I;for(I=0;I<z.length;I+=1){const k=Yt(g,z,I);v[I]?v[I].p(k,S):(v[I]=Xt(k),v[I].c(),v[I].m(L,null))}for(;I<v.length;I+=1)v[I].d(1);v.length=z.length}},d(g){g&&i(e),Ne(v,g)}}}function Fl(s){let e,t,l,r,o="User Role Assignments",h,u,c,_="Role Definitions",p,m,E,L,w,z,v,g,S,I;const k=[zl,Bl],C=[];function O(T,P){return T[3]==="assignments"?0:1}return m=O(s),E=C[m]=k[m](s),w=new Nl({props:{id:"role-form-drawer",role:s[1],onSave:s[20]}}),v=new Ul({props:{id:"role-permissions-drawer",role:s[2],onSave:s[21]}}),{c(){e=d("div"),t=d("ul"),l=d("li"),r=d("button"),r.textContent=o,h=A(),u=d("li"),c=d("button"),c.textContent=_,p=A(),E.c(),L=A(),Qe(w.$$.fragment),z=A(),Qe(v.$$.fragment),this.h()},l(T){e=f(T,"DIV",{class:!0});var P=b(e);t=f(P,"UL",{class:!0});var M=b(t);l=f(M,"LI",{class:!0});var D=b(l);r=f(D,"BUTTON",{class:!0,"data-svelte-h":!0}),re(r)!=="svelte-1ja0zxy"&&(r.textContent=o),D.forEach(i),h=N(M),u=f(M,"LI",{class:!0});var V=b(u);c=f(V,"BUTTON",{class:!0,"data-svelte-h":!0}),re(c)!=="svelte-1rl4saz"&&(c.textContent=_),V.forEach(i),M.forEach(i),p=N(P),E.l(P),P.forEach(i),L=N(T),Ke(w.$$.fragment,T),z=N(T),Ke(v.$$.fragment,T),this.h()},h(){a(r,"class","nav-link"),lt(r,"active",s[3]==="assignments"),a(l,"class","nav-item"),a(c,"class","nav-link"),lt(c,"active",s[3]==="definitions"),a(u,"class","nav-item"),a(t,"class","nav nav-tabs mb-4"),a(e,"class","container-fluid py-4")},m(T,P){Q(T,e,P),n(e,t),n(t,l),n(l,r),n(t,h),n(t,u),n(u,c),n(e,p),C[m].m(e,null),Q(T,L,P),qe(w,T,P),Q(T,z,P),qe(v,T,P),g=!0,S||(I=[ce(r,"click",s[14]),ce(c,"click",s[15])],S=!0)},p(T,P){(!g||P&8)&&lt(r,"active",T[3]==="assignments"),(!g||P&8)&&lt(c,"active",T[3]==="definitions");let M=m;m=O(T),m===M?C[m].p(T,P):(xt(),Pe(C[M],1,1,()=>{C[M]=null}),$t(),E=C[m],E?E.p(T,P):(E=C[m]=k[m](T),E.c()),Ue(E,1),E.m(e,null));const D={};P&2&&(D.role=T[1]),P&2&&(D.onSave=T[20]),w.$set(D);const V={};P&4&&(V.role=T[2]),P&4&&(V.onSave=T[21]),v.$set(V)},i(T){g||(Ue(E),Ue(w.$$.fragment,T),Ue(v.$$.fragment,T),g=!0)},o(T){Pe(E),Pe(w.$$.fragment,T),Pe(v.$$.fragment,T),g=!1},d(T){T&&(i(e),i(L),i(z)),C[m].d(),Ge(w,T),Ge(v,T),S=!1,Ye(I)}}}function Gl(s){let e,t;return e=new el({props:{pageTitle:"Manage Roles",$$slots:{default:[Fl]},$$scope:{ctx:s}}}),{c(){Qe(e.$$.fragment)},l(l){Ke(e.$$.fragment,l)},m(l,r){qe(e,l,r),t=!0},p(l,[r]){const o={};r&1073742079&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function _t(s){const e=document.getElementById(s);if(e){const t=window.bootstrap;t?.Offcanvas&&new t.Offcanvas(e).show()}}function ql(s,e,t){let l,r,o,h,u,c;Ve(s,pl,D=>t(13,r=D)),Ve(s,bl,D=>t(5,h=D)),Ve(s,gl,D=>t(6,u=D)),Ve(s,El,D=>t(7,c=D));const{stores:{currentUserHasPermission:_}}=ol();Ve(s,_,D=>t(22,o=D));let p=null,m=null,E="",L="assignments";vt(async()=>{if(!o(al.AssignCallings)){cl("/home");return}await ml()});function w(){t(1,p=null),_t("role-form-drawer")}function z(D){t(1,p=D),_t("role-form-drawer")}function v(D){t(2,m=D),_t("role-permissions-drawer")}async function g(D){if(confirm(`Are you sure you want to delete the role "${D.name}"? This will remove it from all users.`))try{await vl(D.id)}catch(V){alert(`Failed to delete role: ${V instanceof Error?V.message:"Unknown error"}`)}}const S=()=>t(3,L="assignments"),I=()=>t(3,L="definitions");function k(){E=this.value,t(0,E)}const C=D=>v(D),O=D=>z(D),T=D=>g(D),P=()=>{t(1,p=null)},M=()=>{t(2,m=null)};return s.$$.update=()=>{s.$$.dirty&8193&&t(4,l=Object.entries(r).filter(([D,V])=>{if(!E)return!0;const H=E.toLowerCase();return D.toLowerCase().includes(H)||V.some(U=>U.name.toLowerCase().includes(H)||U.key.toLowerCase().includes(H)||U.description?.toLowerCase().includes(H))}))},[E,p,m,L,l,h,u,c,_,w,z,v,g,r,S,I,k,C,O,T,P,M]}class es extends ot{constructor(e){super(),at(this,e,ql,Gl,rt,{})}}export{es as component};
