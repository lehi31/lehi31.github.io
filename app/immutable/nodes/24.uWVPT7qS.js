import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{P as ut}from"../chunks/C9TIr6ei.js";import{w as Be,g as dt,d as le,o as ze}from"../chunks/DB0qkhVq.js";import{p as ge,D as b,E as j,ah as L,g as e,ai as xe,c as a,r as t,s as c,t as se,a as ue,f as V,F as he,o as $,u as C,aq as Ce,ar as Se}from"../chunks/D2Wl5k_M.js";import{f as q,a as u,c as ae,t as at}from"../chunks/DfqsuKYE.js";import{p as re,i as H,a as ce,e as Ue,b as De,s as T}from"../chunks/Dp64CMOB.js";import{i as fe}from"../chunks/CPbJ_PqI.js";import{v as rt,D as st}from"../chunks/DLI0UxPJ.js";import{e as ye,i as _e}from"../chunks/DrikPB-j.js";import{s as de,r as ot,e as He}from"../chunks/Df79sd2X.js";import{b as ft,a as mt}from"../chunks/CMEL2kP5.js";import{t as pt,a as Ie,D as bt,e as Ne,h as ne,E as ht}from"../chunks/HmHUL7PJ.js";import{b as yt}from"../chunks/D4FdWAE2.js";import{p as ve}from"../chunks/DpxOcZ60.js";import{S as _t}from"../chunks/DHnZRJ_1.js";import{e as wt}from"../chunks/DfaCml7G.js";function xt(l){return wt(l,{weekStartsOn:1})}function kt(l){return pt(l).getFullYear()}const nt=Be([]),it=Be([]);let Fe=!1,qe=!1;async function Bt(){if(Fe)return dt(nt);Fe=!0;try{const{data:l,error:r}=await Ie.from("bom_reading_schedule").select("*").order("day_number",{ascending:!0});if(r)throw console.error("[API] Get BOM reading schedule failed:",r),new Error(`Failed to load reading schedule: ${r.message}`);const s=l||[];return nt.set(s),setTimeout(()=>Fe=!1,800),s}catch(l){throw Fe=!1,console.error("[API] Unexpected error fetching BOM reading schedule:",l),l}}async function We(){if(qe)return dt(it);qe=!0;try{const{data:l,error:r}=await Ie.from("bom_reading_entries").select("*").order("created_at",{ascending:!1});if(r)throw console.error("[API] Get BOM reading entries failed:",r),new Error(`Failed to load reading entries: ${r.message}`);const s=l||[];return it.set(s),setTimeout(()=>qe=!1,800),s}catch(l){throw qe=!1,console.error("[API] Unexpected error fetching BOM reading entries:",l),l}}async function St(l){try{const{data:r,error:s}=await Ie.from("bom_reading_entries").insert([l]).select();if(s)throw console.error("[API] Create BOM reading entry failed:",s),s.message.includes("JWT")?new Error("Authentication error - please try reloading the page"):s.code==="42501"?new Error("Permission denied - please check your authentication"):s.code==="23505"?new Error("This entry already exists"):s.code==="23503"?new Error("Invalid chapter reference"):s.message.includes("fetch")||s.message.includes("Failed to fetch")?new Error("Network error - please check your connection and try again"):new Error(`Failed to save entry: ${s.message}`);return await We(),console.log("[API] BOM reading entry created successfully"),r?r[0]:void 0}catch(r){throw console.error("[API] Unexpected error creating BOM reading entry:",r),r}}async function Et(l,r){try{const{data:s,error:p}=await Ie.from("bom_reading_entries").update(r).eq("id",l).select();if(p)throw console.error("[API] Update BOM reading entry failed:",p),new Error(`Failed to update entry: ${p.message}`);return await We(),console.log("[API] BOM reading entry updated successfully"),s?s[0]:void 0}catch(s){throw console.error("[API] Unexpected error updating BOM reading entry:",s),s}}async function Mt(l){try{const{error:r}=await Ie.from("bom_reading_entries").delete().eq("id",l);if(r)throw console.error("[API] Delete BOM reading entry failed:",r),new Error(`Failed to delete entry: ${r.message}`);await We(),console.log("[API] BOM reading entry deleted successfully")}catch(r){throw console.error("[API] Unexpected error deleting BOM reading entry:",r),r}}function Rt(l){const r=new Map;return l.forEach(s=>{const p=r.get(s.chapter_ref)||0;r.set(s.chapter_ref,p+1)}),r}let Oe=null;const $t=()=>{const l=Be(!1),r=Be(!1),s=Be([]),p=Be([]),_=le(p,d=>Rt(d)),g=le(s,d=>{const n=new Date().toISOString().split("T")[0];return d.find(h=>h.date===n)||null}),f=le([s,_],([d,n])=>{const h=new Date().toISOString().split("T")[0];return d.map(i=>({chapter_ref:i.chapter_ref,day_number:i.day_number,date:i.date,book_name:i.book_name,chapter_number:i.chapter_number,read_count:n.get(i.chapter_ref)||0,is_today:i.date===h,is_past:i.date<h,is_future:i.date>h}))}),B=le(s,d=>d.length),S=le(_,d=>{let n=0;return d.forEach(h=>{h>0&&n++}),n}),A=le([B,S],([d,n])=>d>0?Math.round(n/d*100):0),E=le(p,d=>{const n={};d.forEach(i=>{n[i.date]||(n[i.date]=[]),n[i.date].push(i)}),Object.keys(n).forEach(i=>{n[i].sort((o,v)=>new Date(v.created_at??"").getTime()-new Date(o.created_at??"").getTime())});const h=Object.entries(n).sort(([i],[o])=>new Date(o).getTime()-new Date(i).getTime());return Object.fromEntries(h)}),m=le(p,d=>{const n={};d.forEach(i=>{const o=new Date(i.date),v=kt(o),x=bt(o),F=`${v}-W${x.toString().padStart(2,"0")}`;n[F]||(n[F]=[]),n[F].push(i)}),Object.keys(n).forEach(i=>{n[i].sort((o,v)=>new Date(v.created_at??"").getTime()-new Date(o.created_at??"").getTime())});const h=Object.entries(n).sort(([i],[o])=>o.localeCompare(i));return Object.fromEntries(h)}),y=le(p,d=>{const n={};d.forEach(i=>{const o=i.date.substring(0,7);n[o]||(n[o]=[]),n[o].push(i)}),Object.keys(n).forEach(i=>{n[i].sort((o,v)=>new Date(v.created_at??"").getTime()-new Date(o.created_at??"").getTime())});const h=Object.entries(n).sort(([i],[o])=>o.localeCompare(i));return Object.fromEntries(h)}),w=le(E,d=>{const n={};return Object.entries(d).forEach(([h,i])=>{const o=new Set(i.map(v=>v.chapter_ref));n[h]={period:h,totalReadings:i.length,uniqueChapters:o.size,chapterRefs:o}}),n}),N=le(m,d=>{const n={};return Object.entries(d).forEach(([h,i])=>{const o=new Set(i.map(v=>v.chapter_ref));n[h]={period:h,totalReadings:i.length,uniqueChapters:o.size,chapterRefs:o}}),n}),J=le(y,d=>{const n={};return Object.entries(d).forEach(([h,i])=>{const o=new Set(i.map(v=>v.chapter_ref));n[h]={period:h,totalReadings:i.length,uniqueChapters:o.size,chapterRefs:o}}),n}),O=async()=>{r.set(!0);try{const[d,n]=await Promise.all([Bt(),We()]);s.set(d),p.set(n),l.set(!0)}catch(d){console.error("[State] Failed to reload BOM reading data:",d),l.set(!0)}finally{r.set(!1)}};return Oe={stores:{ready:l,loading:r,schedule:s,entries:p,progressByChapter:_,todaysReading:g,chapterProgress:f,totalChapters:B,chaptersReadByAnyone:S,overallProgress:A,groupedByDate:E,groupedByWeek:m,groupedByMonth:y,aggregatedByDate:w,aggregatedByWeek:N,aggregatedByMonth:J},actions:{reload:O,apiCreate:async d=>{const n=await St(d);return await O(),n},apiUpdate:async(d,n)=>{await Et(d,n),await O()},apiDelete:async d=>{await Mt(d),await O()}}},Oe},je=()=>Oe?.stores&&Object.keys(Oe.stores).length>0?Oe:$t(),Ve="bom_reading_submissions",Qe="bom_reading_entry_ids";function Xe(){if(typeof localStorage>"u")return new Set;try{const l=localStorage.getItem(Ve);if(!l)return new Set;const r=JSON.parse(l);return new Set(Array.isArray(r)?r:[])}catch(l){return console.error("[ReadingTracker] Error reading from localStorage:",l),new Set}}function Ct(l){return Xe().has(l)}function Ot(l){if(!(typeof localStorage>"u"))try{const r=Xe();r.add(l),localStorage.setItem(Ve,JSON.stringify([...r]))}catch(r){console.error("[ReadingTracker] Error writing to localStorage:",r)}}function Ze(){if(typeof localStorage>"u")return{};try{const l=localStorage.getItem(Qe);if(!l)return{};const r=JSON.parse(l);return typeof r=="object"&&r!==null?r:{}}catch(l){return console.error("[ReadingTracker] Error reading entry IDs from localStorage:",l),{}}}function Dt(l){return Ze()[l]??null}function It(l,r){if(!(typeof localStorage>"u"))try{const s=Ze();s[l]=r,localStorage.setItem(Qe,JSON.stringify(s))}catch(s){console.error("[ReadingTracker] Error storing entry ID:",s)}}function jt(l){if(!(typeof localStorage>"u"))try{const r=Xe();r.delete(l),localStorage.setItem(Ve,JSON.stringify([...r]));const s=Ze();delete s[l],localStorage.setItem(Qe,JSON.stringify(s))}catch(r){console.error("[ReadingTracker] Error writing to localStorage:",r)}}var Pt=q('<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>'),Tt=q('<i class="bi bi-check-circle-fill me-1"></i> Undo',1),At=q('<i class="bi bi-check-circle me-1"></i> Read',1),Ft=q('<div class="alert alert-danger alert-sm mt-2 mb-0 svelte-18cjesl" role="alert"><i class="bi bi-exclamation-triangle-fill me-1"></i> </div>'),qt=q('<div class="bom-reading-entry-form svelte-18cjesl"><div class="d-flex align-items-center gap-2 gap-md-3"><button type="button"><!></button></div> <!></div>');function Nt(l,r){ge(r,!1);const s=()=>ce(B,"$loading",p),[p,_]=De();let g=re(r,"chapterRef",8),f=re(r,"onSuccess",8,void 0);const{stores:{loading:B},actions:{apiCreate:S,apiDelete:A}}=je();let E=j(!1),m=j(""),y=j(!1),w=j(null);ze(()=>{b(y,Ct(g()))});async function N(){if(e(y)){b(m,"You have already marked this chapter as read");return}try{b(E,!0),b(m,"");const o={date:new Date().toISOString().split("T")[0],chapter_ref:g()},v=await S(o);v&&v.id&&(Ot(g()),It(g(),v.id),b(y,!0),f()&&f()())}catch(o){b(m,o instanceof Error?o.message:"Failed to save reading"),console.error("[BomReadingEntryForm] Error:",o)}finally{b(E,!1)}}async function J(){const o=Dt(g());if(!o){b(m,"Cannot undo - entry ID not found");return}try{b(E,!0),b(m,""),await A(o),jt(g()),b(y,!1),f()&&f()()}catch(v){b(m,v instanceof Error?v.message:"Failed to undo"),console.error("[BomReadingEntryForm] Undo error:",v)}finally{b(E,!1)}}L(()=>(e(m),e(w)),()=>{e(m)&&(e(w)&&clearTimeout(e(w)),b(w,setTimeout(()=>{b(m,""),b(w,null)},1e3)))}),xe(),fe();var O=qt(),U=a(O),D=a(U),I=a(D);{var d=o=>{var v=Pt();u(o,v)},n=o=>{var v=ae(),x=V(v);{var F=W=>{var P=Tt();he(),u(W,P)},Y=W=>{var P=At();he(),u(W,P)};H(x,W=>{e(y)?W(F):W(Y,!1)},!0)}u(o,v)};H(I,o=>{e(E)?o(d):o(n,!1)})}t(D),t(U);var h=c(U,2);{var i=o=>{var v=Ft(),x=c(a(v));t(v),se(()=>T(x,` ${e(m)??""}`)),u(o,v)};H(h,o=>{e(m)&&o(i)})}t(O),se(()=>{Ne(D,1,`btn btn-sm ${e(y)?"btn-outline-danger":"btn-primary"}`,"svelte-18cjesl"),D.disabled=e(E)||s(),de(D,"title",e(y)?"Undo marking this chapter as read":"Mark this chapter as read")}),Ue("click",D,function(...o){(e(y)?J:N)?.apply(this,o)}),u(l,O),ue(),_()}var Ut=q('<span class="badge bg-info text-dark svelte-x251hv"><i class="bi bi-calendar-day"></i> Today</span>'),Wt=q('<i class="bi bi-check-circle"></i> ',1),Jt=q('<i class="bi bi-circle"></i> 0',1),Yt=q('<div><div class="card-body p-2"><div class="d-flex align-items-baseline gap-2 flex-wrap mb-2"><small class="text-muted"> </small> <span> </span> <!></div> <div class="d-flex align-items-center justify-content-between gap-2"><small class="text-muted"> </small> <div class="d-flex align-items-center gap-2 flex-shrink-0"><span><!></span> <!></div></div></div></div>');function lt(l,r){ge(r,!1);const s=j(),p=j(),_=j();let g=re(r,"progress",8);const f=!1;L(()=>$(g()),()=>{b(s,ne(ve(g().date,"yyyy-MM-dd",new Date),"MMM d, yyyy (EEE)"))}),L(()=>$(g()),()=>{b(p,g().is_today?"border-primary border-2":g().is_past?"past-reading":"")}),L(()=>$(g()),()=>{b(_,g().read_count>0?"bg-success":"bg-secondary")}),xe();var B={compact:f};fe();var S=Yt(),A=a(S),E=a(A),m=a(E),y=a(m);t(m);var w=c(m,2),N=a(w,!0);t(w);var J=c(w,2);{var O=x=>{var F=Ut();u(x,F)};H(J,x=>{$(g()),C(()=>g().is_today)&&x(O)})}t(E);var U=c(E,2),D=a(U),I=a(D,!0);t(D);var d=c(D,2),n=a(d),h=a(n);{var i=x=>{var F=Wt(),Y=c(V(F));se(()=>T(Y,` ${$(g()),C(()=>g().read_count)??""}`)),u(x,F)},o=x=>{var F=Jt();he(),u(x,F)};H(h,x=>{$(g()),C(()=>g().read_count>0)?x(i):x(o,!1)})}t(n);var v=c(n,2);return Nt(v,{get chapterRef(){return $(g()),C(()=>g().chapter_ref)}}),t(d),t(U),t(A),t(S),se(()=>{Ne(S,1,`card bom-day-card ${e(p)??""} mb-2`,"svelte-x251hv"),T(y,`Day ${$(g()),C(()=>g().day_number)??""}`),Ne(w,1,`fw-semibold ${$(g()),C(()=>g().is_today?"text-primary":"")??""}`,"svelte-x251hv"),T(N,($(g()),C(()=>g().chapter_ref))),T(I,e(s)),Ne(n,1,`badge ${e(_)??""}`,"svelte-x251hv")}),u(l,S),yt(r,"compact",f),ue(B)}var Lt=q('<div class="alert alert-warning" role="alert"><i class="bi bi-exclamation-triangle me-2"></i> No readings found for the selected filter.</div>'),Gt=q('<div class="book-group mb-4 svelte-nbte28"><h4 class="border-bottom pb-2 mb-3 svelte-nbte28"><i class="bi bi-book me-2"></i> <span class="badge bg-secondary ms-2"> </span></h4> <!></div>'),Kt=q("<div><!></div>"),zt=q('<div class="text-center mt-4"><button class="btn btn-outline-primary"><!></button></div>'),Ht=q('<div class="text-center mt-2"><p class="text-muted mb-0"><i class="bi bi-info-circle me-1"></i> </p></div>'),Vt=q('<div class="bom-reading-schedule svelte-nbte28"><div class="card mb-3"><div class="card-body"><div class="d-flex flex-column gap-3"><div><label for="search" class="form-label fw-bold">Search</label> <div class="input-group"><span class="input-group-text"><i class="bi bi-search"></i></span> <input type="text" class="form-control" id="search" placeholder="Search chapters or books..."/></div></div> <div><div class="form-check"><input class="form-check-input" type="checkbox" id="groupByBook"/> <label class="form-check-label" for="groupByBook">Group by Book</label></div></div></div></div></div> <div class="reading-list svelte-nbte28"><!></div> <!> <!></div>');function Qt(l,r){ge(r,!1);const s=()=>ce(S,"$chapterProgress",_),p=()=>ce(A,"$todaysReading",_),[_,g]=De(),f=j(),B=j(),{stores:{chapterProgress:S,todaysReading:A}}=je();let E=j(""),m=j(!1),y=j(!1);function w(k,M,R){let z=k;if(R||(z=z.filter(X=>!X.is_future)),M){const X=M.toLowerCase();z=z.filter(Z=>Z.chapter_ref.toLowerCase().includes(X)||Z.book_name.toLowerCase().includes(X))}return z}function N(k){const M={};return k.forEach(R=>{M[R.book_name]||(M[R.book_name]=[]),M[R.book_name].push(R)}),M}ze(()=>{p()&&setTimeout(()=>{const k=document.getElementById("today-reading");k&&k.scrollIntoView({behavior:"smooth",block:"center"})},500)}),L(()=>(s(),e(E),e(y)),()=>{b(f,w(s(),e(E),e(y)))}),L(()=>(e(m),e(f)),()=>{b(B,e(m)?N(e(f)):null)}),xe(),fe();var J=Vt(),O=a(J),U=a(O),D=a(U),I=a(D),d=c(a(I),2),n=c(a(d),2);ot(n),t(d),t(I);var h=c(I,2),i=a(h),o=a(i);ot(o),he(2),t(i),t(h),t(D),t(U),t(O);var v=c(O,2),x=a(v);{var F=k=>{var M=Lt();u(k,M)},Y=k=>{var M=ae(),R=V(M);{var z=Z=>{var G=ae(),ee=V(G);ye(ee,1,()=>(e(B),C(()=>Object.entries(e(B)))),_e,(me,oe)=>{var ie=Ce(()=>Se(e(oe),2));let pe=()=>e(ie)[0],be=()=>e(ie)[1];var we=Gt(),ke=a(we),Ee=c(a(ke)),Me=c(Ee),Pe=a(Me);t(Me),t(ke);var Je=c(ke,2);ye(Je,1,be,_e,(Te,Re)=>{lt(Te,{get progress(){return e(Re)},compact:!0})}),t(we),se(()=>{T(Ee,` ${pe()??""} `),T(Pe,`${be(),C(()=>be().length)??""} days`)}),u(me,we)}),u(Z,G)},X=Z=>{var G=ae(),ee=V(G);ye(ee,1,()=>e(f),_e,(me,oe)=>{var ie=Kt(),pe=a(ie);lt(pe,{get progress(){return e(oe)}}),t(ie),se(()=>de(ie,"id",(e(oe),C(()=>e(oe).is_today?"today-reading":void 0)))),u(me,ie)}),u(Z,G)};H(R,Z=>{e(B)?Z(z):Z(X,!1)},!0)}u(k,M)};H(x,k=>{e(f),C(()=>e(f).length===0)?k(F):k(Y,!1)})}t(v);var W=c(v,2);{var P=k=>{var M=zt(),R=a(M),z=a(R);{var X=G=>{var ee=at("Hide Future Chapters");u(G,ee)},Z=G=>{var ee=at("Show Future Chapters");u(G,ee)};H(z,G=>{e(y)?G(X):G(Z,!1)})}t(R),t(M),Ue("click",R,()=>b(y,!e(y))),u(k,M)};H(W,k=>{e(E)||k(P)})}var K=c(W,2);{var Q=k=>{var M=Ht(),R=a(M),z=c(a(R));t(R),t(M),se(()=>T(z,` Showing ${e(f),C(()=>e(f).length)??""} reading days`)),u(k,M)};H(K,k=>{e(f),C(()=>e(f).length>20)&&k(Q)})}t(J),ft(n,()=>e(E),k=>b(E,k)),mt(o,()=>e(m),k=>b(m,k)),u(l,J),ue(),g()}var Xt=q('<span class="badge bg-primary ms-1"> </span>'),Zt=q('<span class="badge bg-secondary me-1 mb-1"> <!></span>'),ea=q('<li class="list-group-item"><div class="small"><strong>Chapters read:</strong> <div class="mt-1"></div></div></li>'),ta=q('<div class="mb-3"><div class="card"><div class="card-header"><small class="text-muted"> </small><br/> <strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center mb-2"><span class="text-muted">Reading Submissions:</span> <strong> </strong></div> <div class="d-flex justify-content-between align-items-center"><span class="text-muted">Unique Chapters:</span> <strong> </strong></div></li> <!></ul></div></div>');function aa(l,r){ge(r,!1);const s=j(),p=j();let _=re(r,"entries",8),g=re(r,"date",8);L(()=>$(_()),()=>{b(s,_().reduce((i,o)=>(i[o.chapter_ref]=(i[o.chapter_ref]||0)+1,i),{}))}),L(()=>e(s),()=>{b(p,Object.keys(e(s)).sort())}),xe(),fe();var f=ta(),B=a(f),S=a(B),A=a(S),E=a(A,!0);t(A);var m=c(A,3),y=a(m,!0);t(m),t(S);var w=c(S,2),N=a(w),J=a(N),O=c(a(J),2),U=a(O,!0);t(O),t(J);var D=c(J,2),I=c(a(D),2),d=a(I,!0);t(I),t(D),t(N);var n=c(N,2);{var h=i=>{var o=ea(),v=a(o),x=c(a(v),2);ye(x,5,()=>e(p),_e,(F,Y)=>{var W=Zt(),P=a(W),K=c(P);{var Q=k=>{var M=Xt(),R=a(M,!0);t(M),se(()=>T(R,(e(s),e(Y),C(()=>e(s)[e(Y)])))),u(k,M)};H(K,k=>{e(s),e(Y),C(()=>e(s)[e(Y)]>1)&&k(Q)})}t(W),se(()=>T(P,`${e(Y)??""} `)),u(F,W)}),t(x),t(v),t(o),u(i,o)};H(n,i=>{e(p),C(()=>e(p).length>0)&&i(h)})}t(w),t(B),t(f),se((i,o)=>{T(E,i),T(y,o),T(U,($(_()),C(()=>_().length))),T(d,(e(p),C(()=>e(p).length)))},[()=>($(ne),$(ve),$(g()),C(()=>ne(ve(g(),"yyyy-MM-dd",new Date),"yyyy"))),()=>($(ne),$(ve),$(g()),C(()=>ne(ve(g(),"yyyy-MM-dd",new Date),"MMM dd, EEEE")))]),u(l,f),ue()}var ra=q('<div class="mb-3"><div class="card"><div class="card-header"><small class="text-muted"> </small><br/> <strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Reading Submissions:</span> <strong class="fs-5"> </strong></div></li> <li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Unique Chapters:</span> <strong class="fs-5"> </strong></div></li></ul></div></div>');function sa(l,r){ge(r,!1);let s=re(r,"date",8),p=re(r,"aggregate",8);fe();var _=ra(),g=a(_),f=a(g),B=a(f),S=a(B,!0);t(B);var A=c(B,3),E=a(A,!0);t(A),t(f);var m=c(f,2),y=a(m),w=a(y),N=c(a(w),2),J=a(N,!0);t(N),t(w),t(y);var O=c(y,2),U=a(O),D=c(a(U),2),I=a(D,!0);t(D),t(U),t(O),t(m),t(g),t(_),se((d,n)=>{T(S,d),T(E,n),T(J,($(p()),C(()=>p().totalReadings))),T(I,($(p()),C(()=>p().uniqueChapters)))},[()=>($(ne),$(ve),$(s()),C(()=>ne(ve(s(),"yyyy-MM-dd",new Date),"yyyy"))),()=>($(ne),$(ve),$(s()),C(()=>ne(ve(s(),"yyyy-MM-dd",new Date),"MMM dd, EEEE")))]),u(l,_),ue()}var oa=q('<div class="mb-3"><div class="card"><div class="card-header"><small class="text-muted"> </small><br/> <strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Reading Submissions:</span> <strong class="fs-5"> </strong></div></li> <li class="list-group-item"><div class="d-flex justify-content-between align-items-center mb-2"><span class="text-muted">Unique Chapters:</span> <strong class="fs-5"> </strong></div> <div class="progress" style="height: 8px;"><div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div> <small class="text-muted"> </small></li></ul></div></div>');function na(l,r){ge(r,!1);const s=j(),p=j(),_=j(),g=j(),f=j(),B=j(),S=j(),A=j(),E=j(),m=j();let y=re(r,"week",8),w=re(r,"aggregate",8);L(()=>(e(s),e(p),$(y())),()=>{(M=>{var R=Se(M,2);b(s,R[0]),b(p,R[1])})(y().split("-W"))}),L(()=>e(p),()=>{b(_,parseInt(e(p),10))}),L(()=>e(s),()=>{b(g,parseInt(e(s),10))}),L(()=>e(g),()=>{b(f,new Date(e(g),0,1))}),L(()=>(e(f),e(_)),()=>{b(B,ht(new Date(e(f).getTime()+(e(_)-1)*7*24*60*60*1e3)))}),L(()=>e(B),()=>{b(S,xt(e(B)))}),L(()=>(e(_),e(g)),()=>{b(A,`Week ${e(_)} of ${e(g)}`)}),L(()=>(e(B),e(S)),()=>{b(E,`${ne(e(B),"MMM d")} - ${ne(e(S),"MMM d, yyyy")}`)}),L(()=>$(w()),()=>{b(m,Math.round(w().uniqueChapters/244*100))}),xe(),fe();var N=oa(),J=a(N),O=a(J),U=a(O),D=a(U,!0);t(U);var I=c(U,3),d=a(I,!0);t(I),t(O);var n=c(O,2),h=a(n),i=a(h),o=c(a(i),2),v=a(o,!0);t(o),t(i),t(h);var x=c(h,2),F=a(x),Y=c(a(F),2),W=a(Y,!0);t(Y),t(F);var P=c(F,2),K=a(P);t(P);var Q=c(P,2),k=a(Q);t(Q),t(x),t(n),t(J),t(N),se(()=>{T(D,e(A)),T(d,e(E)),T(v,($(w()),C(()=>w().totalReadings))),T(W,($(w()),C(()=>w().uniqueChapters))),He(K,`width: ${e(m)??""}%`),de(K,"aria-valuenow",e(m)),T(k,`${e(m)??""}% of all BOM chapters`)}),u(l,N),ue()}var ia=q('<div class="mb-3"><div class="card"><div class="card-header"><strong> </strong></div> <ul class="list-group list-group-flush"><li class="list-group-item"><div class="d-flex justify-content-between align-items-center"><span class="text-muted">Reading Submissions:</span> <strong class="fs-5"> </strong></div></li> <li class="list-group-item"><div class="d-flex justify-content-between align-items-center mb-2"><span class="text-muted">Unique Chapters:</span> <strong class="fs-5"> </strong></div> <div class="progress" style="height: 8px;"><div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div> <small class="text-muted"> </small></li></ul></div></div>');function la(l,r){ge(r,!1);const s=j();let p=re(r,"month",8),_=re(r,"aggregate",8);L(()=>$(_()),()=>{b(s,Math.round(_().uniqueChapters/244*100))}),xe(),fe();var g=ia(),f=a(g),B=a(f),S=a(B),A=a(S,!0);t(S),t(B);var E=c(B,2),m=a(E),y=a(m),w=c(a(y),2),N=a(w,!0);t(w),t(y),t(m);var J=c(m,2),O=a(J),U=c(a(O),2),D=a(U,!0);t(U),t(O);var I=c(O,2),d=a(I);t(I);var n=c(I,2),h=a(n);t(n),t(J),t(E),t(f),t(g),se(i=>{T(A,i),T(N,($(_()),C(()=>_().totalReadings))),T(D,($(_()),C(()=>_().uniqueChapters))),He(d,`width: ${e(s)??""}%`),de(d,"aria-valuenow",e(s)),T(h,`${e(s)??""}% of all BOM chapters`)},[()=>($(ne),$(ve),$(p()),C(()=>ne(ve(p(),"yyyy-MM",new Date),"MMMM yyyy")))]),u(l,g),ue()}var da=q('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),ca=q('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),va=q('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),ga=q('<div class="alert alert-info" role="alert"><i class="bi bi-info-circle me-2"></i> No reading submissions yet. Be the first to start reading!</div>'),ua=q('<div class="bom-submissions"><div class="mb-3"><!></div> <div class="submissions-list svelte-1qt8gnu"><!></div></div>');function fa(l,r){ge(r,!1);const s=()=>ce(S,"$groupedByDate",f),p=()=>ce(A,"$aggregatedByDate",f),_=()=>ce(E,"$aggregatedByWeek",f),g=()=>ce(m,"$aggregatedByMonth",f),[f,B]=De(),{stores:{groupedByDate:S,aggregatedByDate:A,aggregatedByWeek:E,aggregatedByMonth:m}}=je();let y=j("by-day");fe();var w=ua(),N=a(w),J=a(N);_t(J,{options:[{key:"By Submission",value:"by-submission"},{key:"By Day",value:"by-day"},{key:"By Week",value:"by-week"},{key:"By Month",value:"by-month"}],label:"View",disabled:!1,get value(){return e(y)},set value(d){b(y,d)},$$legacy:!0}),t(N);var O=c(N,2),U=a(O);{var D=d=>{var n=ae(),h=V(n);{var i=v=>{var x=da();u(v,x)},o=v=>{var x=ae(),F=V(x);ye(F,1,()=>Object.entries(s()),_e,(Y,W)=>{var P=Ce(()=>Se(e(W),2));let K=()=>e(P)[0],Q=()=>e(P)[1];aa(Y,{get date(){return K()},get entries(){return Q()}})}),u(v,x)};H(h,v=>{Object.keys(s()).length===0?v(i):v(o,!1)})}u(d,n)},I=d=>{var n=ae(),h=V(n);{var i=v=>{var x=ae(),F=V(x);{var Y=P=>{var K=ca();u(P,K)},W=P=>{var K=ae(),Q=V(K);ye(Q,1,()=>Object.entries(p()),_e,(k,M)=>{var R=Ce(()=>Se(e(M),2));let z=()=>e(R)[0],X=()=>e(R)[1];sa(k,{get date(){return z()},get aggregate(){return X()}})}),u(P,K)};H(F,P=>{Object.keys(p()).length===0?P(Y):P(W,!1)})}u(v,x)},o=v=>{var x=ae(),F=V(x);{var Y=P=>{var K=ae(),Q=V(K);{var k=R=>{var z=va();u(R,z)},M=R=>{var z=ae(),X=V(z);ye(X,1,()=>Object.entries(_()),_e,(Z,G)=>{var ee=Ce(()=>Se(e(G),2));let me=()=>e(ee)[0],oe=()=>e(ee)[1];na(Z,{get week(){return me()},get aggregate(){return oe()}})}),u(R,z)};H(Q,R=>{Object.keys(_()).length===0?R(k):R(M,!1)})}u(P,K)},W=P=>{var K=ae(),Q=V(K);{var k=M=>{var R=ae(),z=V(R);{var X=G=>{var ee=ga();u(G,ee)},Z=G=>{var ee=ae(),me=V(ee);ye(me,1,()=>Object.entries(g()),_e,(oe,ie)=>{var pe=Ce(()=>Se(e(ie),2));let be=()=>e(pe)[0],we=()=>e(pe)[1];la(oe,{get month(){return be()},get aggregate(){return we()}})}),u(G,ee)};H(z,G=>{Object.keys(g()).length===0?G(X):G(Z,!1)})}u(M,R)};H(Q,M=>{e(y)==="by-month"&&M(k)},!0)}u(P,K)};H(F,P=>{e(y)==="by-week"?P(Y):P(W,!1)},!0)}u(v,x)};H(h,v=>{e(y)==="by-day"?v(i):v(o,!1)},!0)}u(d,n)};H(U,d=>{e(y)==="by-submission"?d(D):d(I,!1)})}t(O),t(w),u(l,w),ue(),B()}var ma=q(`<div class="card"><div class="card-header"><div class="d-flex align-items-center gap-2"><span class="fw-600 svelte-8saayj">Book of Mormon Challenge</span></div></div> <div class="card-body"><div class="d-flex flex-column gap-3"><div><div class="d-flex justify-content-between align-items-center mb-2"><h5 class="mb-0">Overall Completion</h5> <span class="badge bg-primary fs-5"> </span></div> <div class="progress mb-2" style="height: 10px;"><div class="progress-bar bg-success" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div></div> <p class="text-muted mb-0"> </p></div> <div class="row g-3"><div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-calendar3 fs-1 text-primary mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">Days Remaining</p></div></div></div> <div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-book fs-1 text-primary mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">BOM Chapters</p></div></div></div> <div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-check-circle fs-1 text-success mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">Chapters Read</p></div></div></div> <div class="col-6"><div class="card border"><div class="card-body text-center p-3"><i class="bi bi-people fs-1 text-warning mb-2"></i> <h2 class="mb-1"> </h2> <p class="text-muted mb-0">Reading Submissions</p></div></div></div></div> <div class="alert alert-info mb-0" role="alert"><div class="d-flex gap-2"><i class="bi bi-info-circle"></i> <div>This progress shows how many chapters have been read by <strong>anyone</strong> in the ward.
						Each person can mark chapters as read anonymously.</div></div></div> <div class="d-flex flex-column gap-2"><div class="d-block"><button class="btn btn-sm btn-primary w-100" type="button" data-bs-toggle="offcanvas">Join the Challenge</button></div> <div class="d-block"><button class="btn btn-sm btn-outline-primary w-100" type="button" data-bs-toggle="offcanvas">Record Your Reading</button></div> <div class="d-block"><button class="btn btn-sm btn-link w-100" type="button" data-bs-toggle="offcanvas">See all submissions</button></div></div></div></div></div>`);function pa(l,r){ge(r,!1);const s=()=>ce(U,"$chapterProgress",_),p=()=>ce(D,"$entries",_),[_,g]=De(),f=j(),B=j(),S=j(),A=j(),E=j(),m=j(),y=j();let w=re(r,"scheduleDrawerId",8),N=re(r,"submissionsDrawerId",8),J=re(r,"onJoinClick",8),O=re(r,"onRecordClick",8);const{stores:{chapterProgress:U,entries:D}}=je();function I(te){return te.toLocaleString("en-US")}L(()=>s(),()=>{b(f,s().filter(te=>te.book_name!=="Review"))}),L(()=>e(f),()=>{b(B,Array.from(new Set(e(f).map(te=>te.chapter_ref))))}),L(()=>e(B),()=>{b(S,e(B).length)}),L(()=>(e(B),e(f)),()=>{b(A,e(B).filter(te=>e(f).find($e=>$e.chapter_ref===te&&$e.read_count>0)).length)}),L(()=>p(),()=>{b(E,p().length)}),L(()=>(e(S),e(A)),()=>{b(m,e(S)>0?Math.round(e(A)/e(S)*100):0)}),L(()=>{},()=>{b(y,(()=>{const te=new Date,Ke=new Date(te.getFullYear(),11,31).getTime()-te.getTime(),Ae=Math.ceil(Ke/(1e3*60*60*24));return Ae>0?Ae:0})())}),xe(),fe();var d=ma(),n=c(a(d),2),h=a(n),i=a(h),o=a(i),v=c(a(o),2),x=a(v);t(v),t(o);var F=c(o,2),Y=a(F);t(F);var W=c(F,2),P=a(W);t(W),t(i);var K=c(i,2),Q=a(K),k=a(Q),M=a(k),R=c(a(M),2),z=a(R,!0);t(R),he(2),t(M),t(k),t(Q);var X=c(Q,2),Z=a(X),G=a(Z),ee=c(a(G),2),me=a(ee,!0);t(ee),he(2),t(G),t(Z),t(X);var oe=c(X,2),ie=a(oe),pe=a(ie),be=c(a(pe),2),we=a(be);t(be),he(2),t(pe),t(ie),t(oe);var ke=c(oe,2),Ee=a(ke),Me=a(Ee),Pe=c(a(Me),2),Je=a(Pe,!0);t(Pe),he(2),t(Me),t(Ee),t(ke),t(K);var Te=c(K,4),Re=a(Te),Ye=a(Re);t(Re);var Le=c(Re,2),Ge=a(Le);t(Le);var et=c(Le,2),tt=a(et);t(et),t(Te),t(h),t(n),t(d),se((te,$e,Ke,Ae,ct,vt,gt)=>{T(x,`${e(m)??""}%`),He(Y,`width: ${e(m)??""}%`),de(Y,"aria-valuenow",e(m)),T(P,`${te??""} of ${$e??""} chapters read by at
					least one person`),T(z,Ke),T(me,Ae),T(we,`${ct??""} / ${vt??""}`),T(Je,gt),de(Ye,"data-bs-target",`#${w()??""}`),de(Ye,"aria-controls",w()),de(Ge,"data-bs-target",`#${w()??""}`),de(Ge,"aria-controls",w()),de(tt,"data-bs-target",`#${N()??""}`),de(tt,"aria-controls",N())},[()=>(e(A),C(()=>I(e(A)))),()=>(e(S),C(()=>I(e(S)))),()=>(e(y),C(()=>I(e(y)))),()=>(e(S),C(()=>I(e(S)))),()=>(e(A),C(()=>I(e(A)))),()=>(e(S),C(()=>I(e(S)))),()=>(e(E),C(()=>I(e(E))))]),Ue("click",Ye,function(...te){J()?.apply(this,te)}),Ue("click",Ge,function(...te){O()?.apply(this,te)}),u(l,d),ue(),g()}var ba=q('<div class="text-center py-5"><div class="spinner-border" role="status"><span class="visually-hidden">Loading reading challenge...</span></div></div>'),ha=q(`<div class="alert alert-info mb-3" role="alert"><h5 class="alert-heading"><i class="bi bi-info-circle me-2"></i>How to Join the Challenge</h5> <p class="mb-2">Our ward is reading the Book of Mormon together! Here's how to participate:</p> <ol class="mb-2"><li>Read any chapter from the Book of Mormon</li> <li>Click the "Read" button next to the chapter you completed</li> <li>Your reading is tracked anonymously to show ward progress</li></ol> <p class="mb-0"><strong>Remember:</strong> You don't have to follow the schedule exactly! Read ahead, catch
					up, or go at your own pace. The goal is to show that our ward is moving forward in reading the
					Book of Mormon together.</p></div>`),ya=q("<!> <!>",1),_a=q("<!> <!> <!>",1);function wa(l,r){ge(r,!1);const s=()=>ce(S,"$loading",_),p=()=>ce(A,"$ready",_),[_,g]=De(),f=rt(),B=rt(),{stores:{loading:S,ready:A},actions:{reload:E}}=je();let m=j(!1);function y(){b(m,!0)}function w(){b(m,!1)}ze(async()=>{await E()}),fe();var N=ae(),J=V(N);{var O=D=>{var I=ba();u(D,I)},U=D=>{var I=_a(),d=V(I);pa(d,{get scheduleDrawerId(){return f},get submissionsDrawerId(){return B},onJoinClick:y,onRecordClick:w});var n=c(d,2);st(n,{get id(){return f},title:"2026 Book of Mormon Reading Challenge",placement:"end",children:(i,o)=>{var v=ya(),x=V(v);{var F=W=>{var P=ha();u(W,P)};H(x,W=>{e(m)&&W(F)})}var Y=c(x,2);Qt(Y,{}),u(i,v)},$$slots:{default:!0}});var h=c(n,2);st(h,{get id(){return B},title:"Reading Submissions",placement:"start",children:(i,o)=>{fa(i,{})},$$slots:{default:!0}}),u(D,I)};H(J,D=>{s()&&!p()?D(O):D(U,!1)})}u(l,N),ue(),g()}function qa(l){ut(l,{pageTitle:"BoM Reading Challenge",children:(r,s)=>{wa(r,{})},$$slots:{default:!0}})}export{qa as component};
