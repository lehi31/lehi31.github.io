import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{o as G}from"../chunks/DjNGvcU6.js";import{p as V,c as T,s as f,r as U,t as H,a as M,f as k,g as N,D as x,E as z,ah as J,$ as K}from"../chunks/JKZwkikK.js";import{p as F,i as h,s as Q,e as $,a as D,b as L}from"../chunks/BxjzTaz1.js";import{f as p,a as t,c as E}from"../chunks/JDsN5plM.js";import{s as W}from"../chunks/Bhs7oqge.js";import{e as X,h as Z}from"../chunks/B2BlSr7K.js";import{i as O}from"../chunks/b8c_lO2i.js";import{c as ee,g as ae}from"../chunks/BsouV8vs.js";import{t as te,d as se}from"../chunks/CYaybGWn.js";const re=!0,Ce=Object.freeze(Object.defineProperty({__proto__:null,prerender:re},Symbol.toStringTag,{value:"Module"}));var oe=p('<i class="bi bi-info-circle"></i>'),ie=p('<i class="bi bi-exclamation-triangle"></i>'),ne=p('<i class="bi bi-x-circle"></i>'),le=p('<i class="bi bi-check-circle"></i>'),ce=p('<div role="alert"><!> <div class="flex-grow-1"> </div> <button type="button" class="btn-close" aria-label="Close"></button></div>');function ve(_,o){V(o,!1);let w=F(o,"message",8),i=F(o,"type",8,"info"),m=F(o,"onClose",8);setTimeout(()=>m()(),5e3),O();var n=ce(),l=T(n);{var c=s=>{var u=oe();t(s,u)},d=s=>{var u=E(),C=k(u);{var P=v=>{var e=ie();t(v,e)},I=v=>{var e=E(),a=k(e);{var r=g=>{var S=ne();t(g,S)},b=g=>{var S=E(),R=k(S);{var Y=q=>{var B=le();t(q,B)};h(R,q=>{i()==="success"&&q(Y)},!0)}t(g,S)};h(a,g=>{i()==="danger"?g(r):g(b,!1)},!0)}t(v,e)};h(C,v=>{i()==="warning"?v(P):v(I,!1)},!0)}t(s,u)};h(l,s=>{i()==="info"?s(c):s(d,!1)})}var y=f(l,2),j=T(y,!0);U(y);var A=f(y,2);U(n),H(()=>{ee(n,1,`alert alert-${i()??""} alert-dismissible d-flex align-items-center gap-2`,"svelte-1jlqy1l"),Q(j,w())}),$("click",A,function(...s){m()?.apply(this,s)}),t(_,n),M()}function fe(_,o){V(o,!1);const w=()=>L(te,"$toasts",i),[i,m]=D();O();var n=E(),l=k(n);X(l,1,w,c=>c.id,(c,d)=>{ve(c,{get message(){return N(d).message},get type(){return N(d).type},onClose:()=>se(N(d).id)})}),t(_,n),M(),m()}var pe=p('<div class="alert alert-info alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-arrow-clockwise"></i> <div class="flex-grow-1"><strong>Update Available</strong><br/> A new version of the app is available. Please reload to get the latest features and bug fixes.</div> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-arrow-clockwise"></i> Reload Now</button> <button type="button" class="btn-close" aria-label="Close"></button></div>'),de=p('<div class="alert alert-warning alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-clock-history"></i> <div><strong>Session Expired</strong><br/> Your authentication token has expired. Please log in again to continue.</div> <button type="button" class="btn-close" aria-label="Close"></button></div>'),me=p("<!> <!> <!> <!>",1);function Ie(_,o){V(o,!1);const w=()=>L(n,"$pageName",i),[i,m]=D(),{stores:{pageName:n}}=ae();let l=z(!1),c=z(!1);const d=async()=>{try{const e=await fetch("/api/version"),{version:a}=await e.json(),r=parseInt(a),b=parseInt("1767851048768");return!isNaN(r)&&!isNaN(b)&&r>b?(console.warn("[App] New version available:",a,"current:","1767851048768","(server is newer)"),!0):(a!=="1767851048768"&&console.log("[App] Version mismatch but client is newer or equal:","server:",a,"client:","1767851048768"),!1)}catch(e){return console.error("[App] Failed to check for updates:",e),!1}};G(()=>{{sessionStorage.getItem("authExpired")==="true"&&(x(l,!0),setTimeout(()=>{x(l,!1),sessionStorage.removeItem("authExpired")},1e4));{const e=async()=>{await d()&&x(c,!0)};e();const a=setInterval(e,5*60*1e3);return()=>clearInterval(a)}}});const y=()=>{x(l,!1),sessionStorage.removeItem("authExpired")},j=async()=>{try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(a=>caches.delete(a))),console.log("[App] Cleared service worker caches")}}catch(e){console.error("[App] Failed to clear caches:",e)}finally{window.location.href=window.location.href}};O();var A=me();Z("12qhfyh",e=>{J(()=>{K.title=`Lehi31 | ${w()??""}`})});var s=k(A);{var u=e=>{var a=pe(),r=f(T(a),4),b=f(r,2);U(a),$("click",r,j),$("click",b,()=>x(c,!1)),t(e,a)};h(s,e=>{N(c)&&e(u)})}var C=f(s,2);{var P=e=>{var a=de(),r=f(T(a),4);U(a),$("click",r,y),t(e,a)};h(C,e=>{N(l)&&e(P)})}var I=f(C,2);fe(I,{});var v=f(I,2);W(v,o,"default",{}),t(_,A),M(),m()}export{Ie as component,Ce as universal};
