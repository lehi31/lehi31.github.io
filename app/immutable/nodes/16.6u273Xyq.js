import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{p as Q,f as Y,a as W,ak as le,D as e,E as m,m as s,s as v,c as u,r as p,B as ne,F as S,e as z}from"../chunks/BWCcv1pC.js";import{i as X}from"../chunks/BeNQ5BU7.js";import{o as ce}from"../chunks/CuVcyAaV.js";import{e as A,i as R,s as de}from"../chunks/KiCntiD6.js";import{c as J,a as l,f as h}from"../chunks/DqgkBxsg.js";import{a as K}from"../chunks/C1uGTM31.js";import{r as F}from"../chunks/DJqvlSKH.js";import{d as Z,e as O}from"../chunks/B_dwA4Xd.js";import{b as M}from"../chunks/CzDGc265.js";import{p as fe}from"../chunks/CdEA5IGF.js";import{g as me}from"../chunks/Du_zg4x4.js";import{L as ve}from"../chunks/BxLtQzFY.js";var ue=h('<div role="alert"><i></i> <div> </div></div>'),pe=h('<div class="input-group"><input type="text" class="form-control" placeholder="At least 8 characters" id="newPassword" aria-describedby="newPassword" required/> <button type="button" class="input-group-text" aria-label="Hide password"><i class="bi bi-eye-slash"></i></button></div>'),ge=h('<div class="input-group"><input type="password" class="form-control" placeholder="At least 8 characters" id="newPassword" aria-describedby="newPassword" required/> <button type="button" class="input-group-text" aria-label="Show password"><i class="bi bi-eye"></i></button></div>'),be=h('<form class="d-flex gap-3 flex-column"><div><label for="newPassword" class="form-label">New Password</label> <!> <small class="text-muted">Minimum 8 characters</small></div> <div><label for="confirmPassword" class="form-label">Confirm New Password</label> <input type="password" class="form-control" placeholder="Re-enter password" id="confirmPassword" aria-describedby="confirmPassword" required/></div> <div class="d-flex justify-content-between align-items-center"><a href="/auth/login" class="btn-link btn">Back to login</a> <button type="submit" class="btn btn-primary">Reset Password</button></div></form>'),we=h('<div class="alert alert-success d-flex align-items-center gap-2" role="alert"><i class="bi bi-check-circle-fill"></i> <div><strong>Success!</strong><br/> Your password has been reset. Redirecting to login page...</div></div> <a href="/auth/login" class="btn btn-primary">Go to Login</a>',1),he=h('<div class="alert alert-danger d-flex align-items-center gap-2" role="alert"><i class="bi bi-exclamation-triangle-fill"></i> <div><strong>Invalid Link</strong><br/> This password reset link is invalid or has expired. Please request a new one.</div></div> <div class="d-flex flex-column gap-2"><a href="/auth/forgot-password" class="btn btn-primary">Request New Reset Link</a> <a href="/auth/login" class="btn btn-link">Back to Login</a></div>',1),_e=h('<div class="container d-flex flex-column gap-3 mt-5 mb-5 svelte-a0ilio"><a href="/home" class="header-content d-flex align-items-center gap-2 text-decoration-none svelte-a0ilio"><img src="/assets/logo.png" alt="logo" class="logo svelte-a0ilio"/> <h1 class="mb-0 h4">Lehi Tolutaha</h1></a> <h2 class="h5">Reset Password</h2> <p class="text-muted small">Enter your new password below.</p> <!> <!></div>');function Pe(I,N){Q(N,!1);const{actions:{resetPassword:T}}=Z();let g=m(!1),n=m(""),q=m(""),B=m(!1),t=m(""),_=m("error"),y=m(""),L=m(!1);ce(()=>{const a=new URLSearchParams(window.location.search);e(y,a.get("token")||""),s(y)||(e(t,"Invalid or missing reset token. Please request a new password reset."),e(_,"error"))});const j=async()=>{if(e(g,!0),e(t,""),e(_,"error"),!s(n)||!s(q)){e(t,"Password and confirmation are required"),e(g,!1);return}if(s(n)!==s(q)){e(t,"Passwords do not match"),e(g,!1);return}if(s(n).length<8){e(t,"Password must be at least 8 characters"),e(g,!1);return}if(!s(y)){e(t,"Invalid reset token. Please request a new password reset."),e(g,!1);return}const a=await T(s(y),s(n));a.success?(e(_,"success"),e(t,a.message||"Password has been reset successfully!"),e(L,!0),setTimeout(()=>{me("/auth/login")},3e3)):(e(_,"error"),e(t,a.error||"Failed to reset password"),e(g,!1))},C=()=>{e(B,!s(B))},$=a=>{a.key==="Enter"&&!s(L)&&j()},G=a=>{a.focus()};X();var H=J();A("keydown",le,$);var ee=Y(H);{var se=a=>{ve(a,{message:"Resetting your password..."})},ae=a=>{var E=_e(),U=v(u(E),6);{var re=o=>{var r=ue(),c=u(r),P=v(c,2),k=u(P,!0);p(P),p(r),ne(()=>{O(r,1,`alert ${s(_)==="success"?"alert-success":"alert-danger"} d-flex align-items-center gap-2`),O(c,1,`bi ${s(_)==="success"?"bi-check-circle-fill":"bi-exclamation-triangle-fill"}`),de(k,s(t))}),l(o,r)};R(U,o=>{s(t)&&o(re)})}var te=v(U,2);{var oe=o=>{var r=be(),c=u(r),P=v(u(c),2);{var k=f=>{var b=pe(),i=u(b);F(i),z(()=>M(i,()=>s(n),w=>e(n,w))),K(i,w=>G?.(w));var D=v(i,2);p(b),A("click",D,C),l(f,b)},d=f=>{var b=ge(),i=u(b);F(i),z(()=>M(i,()=>s(n),w=>e(n,w))),K(i,w=>G?.(w));var D=v(i,2);p(b),A("click",D,C),l(f,b)};R(P,f=>{s(B)?f(k):f(d,!1)})}S(2),p(c);var x=v(c,2),V=v(u(x),2);F(V),p(x),S(2),p(r),M(V,()=>s(q),f=>e(q,f)),A("submit",r,fe(j)),l(o,r)},ie=o=>{var r=J(),c=Y(r);{var P=d=>{var x=we();S(2),l(d,x)},k=d=>{var x=he();S(2),l(d,x)};R(c,d=>{s(L)?d(P):d(k,!1)},!0)}l(o,r)};R(te,o=>{!s(L)&&s(y)?o(oe):o(ie,!1)})}p(E),l(a,E)};R(ee,a=>{s(g)?a(se):a(ae,!1)})}l(I,H),W()}function Fe(I,N){Q(N,!1);const{stores:{pageName:T}}=Z();T.set("Auth - Reset Password"),X(),Pe(I,{}),W()}export{Fe as component};
