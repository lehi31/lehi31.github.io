import{a as gt}from"../chunks/B5LTcAhG.js";import{P as Ye,g as mt,c as Pe}from"../chunks/E7AE84A2.js";import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{P as yt}from"../chunks/8xLiG6lg.js";import{w as vt,g as st,o as wt}from"../chunks/DHXte27T.js";import{p as it,ai as Ke,w as ut,g as a,aj as pt,c as m,t as ne,a as nt,E as _e,s as w,D as q,u as D,r as f,as as et,f as ve,F as Ue,i as ct,R as kt}from"../chunks/CPOcesE7.js";import{p as Ve,b as Ne,i as Q,e as ze,a as ot,s as pe,d as xt,o as Et,c as ft}from"../chunks/CCh4w6lW.js";import{e as rt,i as at}from"../chunks/DAwrR-3T.js";import{f as $,a as C,c as je,t as ht}from"../chunks/YsHTGu5k.js";import{r as qe,e as Ct,b as St,s as Je}from"../chunks/C_leIos3.js";import{b as Be}from"../chunks/QDlYjqxz.js";import{i as lt}from"../chunks/C2Q_9cr2.js";import{S as Ge}from"../chunks/a4HR5F4n.js";import{c as Rt}from"../chunks/B5wgTIMG.js";import{g as dt}from"../chunks/DDDUdtZL.js";import{c as Dt,a as tt,b as Mt,V as It}from"../chunks/Bai7YTd4.js";import{d as Ot,u as Ft,c as Lt,a as Tt}from"../chunks/CX8NJ9P1.js";import{c as At,g as $t}from"../chunks/Cpj98o6Y.js";import{v as Pt,D as jt}from"../chunks/3K5gm_sU.js";const Nt=!1,zt=async()=>(gt(Ye.ViewMembers,"View Members"),{}),da=Object.freeze(Object.defineProperty({__proto__:null,load:zt,ssr:Nt},Symbol.toStringTag,{value:"Module"})),Ut=Dt().shape({first_name:tt().required("First name is required").min(2,"First name must be at least 2 characters").max(100,"First name cannot exceed 100 characters"),last_name:tt().nullable().min(2,"Last name must be at least 2 characters").max(100,"Last name cannot exceed 100 characters"),date_of_birth:Mt().nullable().max(new Date,"Date of birth cannot be in the future").test("reasonable-age","Date of birth must be after 1900",function(N){return N?N>=new Date("1900-01-01"):!0}),phone_number:tt().nullable().matches(/^[0-9()\s.-]*$/,"Invalid phone number format (use digits, dashes, parentheses, spaces)").min(10,"Phone number must be at least 10 characters").max(20,"Phone number cannot exceed 20 characters")});function _t(){const N=vt({});async function B(O){try{return await Ut.validate(O,{abortEarly:!1}),N.set({}),!0}catch(W){if(W instanceof It){const H={};return W.inner.forEach(oe=>{oe.path&&(H[oe.path]=oe.message)}),N.set(H),!1}return!1}}function s(){N.set({})}function d(){return Object.values(N).filter(W=>W.length>0)}return{validationErrors:N,validate:B,clearErrors:s,getErrorMessages:d}}async function Vt({id:N,first_name:B,last_name:s,date_of_birth:d,phone_number:O}){const W={first_name:B,last_name:s||"",date_of_birth:d?new Date(d):void 0,phone_number:O||void 0};return N?{action:"update",member:await Ft(N,W)}:{action:"create",member:await Lt(W)}}async function qt(N){await Ot(N)}function Bt(){return{saveMember:Vt,deleteMemberById:qt}}var Ht=$('<div class="invalid-feedback"> </div>'),Kt=$('<div class="invalid-feedback"> </div>'),Wt=$('<div class="invalid-feedback"> </div>'),Qt=$('<div class="invalid-feedback"> </div>'),Jt=$('<div><label for="member-dob" class="form-label">Date of Birth</label> <input id="member-dob" type="date"/> <!></div> <div><label for="member-phone" class="form-label">Phone Number</label> <input id="member-phone" type="tel" placeholder="(555) 123-4567"/> <!></div>',1),Yt=$('<div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> Date of birth and phone number fields are restricted to bishopric and clerks.</div>'),Gt=$('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),Zt=$("<span>Save</span>"),Xt=$("<span>Create</span>"),er=$('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),tr=$('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-3"><h2 class="h5 mb-0">Member Details</h2> <div><label for="member-first-name" class="form-label">First Name <span class="text-danger">*</span></label> <input id="member-first-name" type="text" placeholder="John"/> <!></div> <div><label for="member-last-name" class="form-label">Last Name</label> <input id="member-last-name" type="text" placeholder="Doe"/> <!></div> <!></div> <div class="d-flex justify-content-between align-items-center gap-2 flex-row"><div class="d-flex flex-row gap-2"><!></div> <div class="d-flex flex-row gap-2"><button class="btn btn-secondary position-relative">Cancel</button> <button class="btn btn-primary position-relative"><!> <!></button></div></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span></div></div>');function rr(N,B){it(B,!1);const s=()=>Ne(fe,"$currentUserHasPermission",O),d=()=>Ne(Ce,"$validationErrors",O),[O,W]=ot(),H=_e(),oe=_e();let se=Ve(B,"memberId",8,void 0),h=Ve(B,"drawerId",8,"");const{stores:{currentUserHasPermission:fe}}=mt(),{stores:{members:De},actions:{reload:Ee}}=dt(),ye=s()(Ye.ViewSensitiveMemberData),{validationErrors:Ce,validate:Me,clearErrors:ue,getErrorMessages:xe}=_t(),{saveMember:we,deleteMemberById:ke}=Bt();let Z=_e(!1),ge={first_name:"",last_name:"",date_of_birth:void 0,phone_number:void 0},te=_e({...ge}),S=_e({message:"",type:"info"}),e=_e(""),t=_e(""),r=_e(""),u=_e("");function c(){if(!se()){M();return}q(Z,!0);const i=st(De).find(b=>b.id===se());i&&(ge={...i},q(te,{...i}),q(e,i.first_name||""),q(t,i.last_name||""),q(r,i.date_of_birth?new Date(i.date_of_birth).toISOString().split("T")[0]:""),q(u,i.phone_number?.toString()||"")),q(Z,!1)}function M(){ge={first_name:"",last_name:"",date_of_birth:void 0,phone_number:void 0},q(te,{...ge}),q(e,""),q(t,""),q(r,""),q(u,""),ue()}const X=()=>{const i=`[data-bs-target="#${h()}"]`,b=document.querySelector(i);b&&b.click()},re=(i,b=0,me="info")=>{et(S,a(S).message=i),et(S,a(S).type=me),b&&setTimeout(()=>{et(S,a(S).message="")},b)},he=async()=>{if(!a(H)){re("Member ID is not defined",0,"danger");return}try{await ke(a(H)),await Ee(),setTimeout(()=>{q(Z,!1),re("Member Deleted",3e3,"success"),X()},800)}catch(i){setTimeout(()=>{q(Z,!1),console.error("Delete failed:",i),re("Failed to delete member. Please try again.",7e3,"danger")},800)}},F=async()=>{q(Z,!0),Rt({title:"Delete Confirmation",message:"Are you sure you want to delete this member? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:i=>{i?he():q(Z,!1)}})},v=async()=>{if(a(H)&&!a(oe)){re("Nothing has changed, there is nothing to save.",7e3);return}if(!await Me({first_name:a(e),last_name:a(t),date_of_birth:a(r),phone_number:a(u)})){const b=xe();b.length&&re(b.join(". ")+". Please address accordingly.",0,"danger");return}if(!a(Z)){re("Saving ..."),q(Z,!0);try{await we({id:a(H),first_name:a(e),last_name:a(t),date_of_birth:a(r),phone_number:a(u)}),await Ee(),setTimeout(()=>{q(Z,!1),q(te,{...ge,id:a(H)}),re("Saved",3e3,"success"),X()},800)}catch(b){setTimeout(()=>{q(Z,!1),console.error("Save failed:",b),re("Failed to save member. Please try again.",7e3,"danger")},800)}}};Ke(()=>ut(se()),()=>{q(H,se())}),Ke(()=>(a(te),a(e),a(t),a(r),a(u)),()=>{q(oe,a(te).first_name!==a(e)||a(te).last_name!==a(t)||a(te).date_of_birth?.toString()!==(a(r)||void 0)||a(te).phone_number?.toString()!==(a(u)||void 0))}),Ke(()=>(ut(se()),a(te)),()=>{se()!==void 0&&se()!==a(te).id&&c()}),pt(),lt();var n=tr(),P=m(n),g=w(m(P),2),k=w(m(g),2);qe(k);let o;var j=w(k,2);{var U=i=>{var b=Ht(),me=m(b,!0);f(b),ne(()=>pe(me,(d(),D(()=>d().first_name)))),C(i,b)};Q(j,i=>{d(),D(()=>d().first_name)&&i(U)})}f(g);var K=w(g,2),J=w(m(K),2);qe(J);let p;var E=w(J,2);{var T=i=>{var b=Kt(),me=m(b,!0);f(b),ne(()=>pe(me,(d(),D(()=>d().last_name)))),C(i,b)};Q(E,i=>{d(),D(()=>d().last_name)&&i(T)})}f(K);var _=w(K,2);{var x=i=>{var b=Jt(),me=ve(b),Fe=w(m(me),2);qe(Fe);let We;var Oe=w(Fe,2);{var Le=Re=>{var $e=Wt(),Xe=m($e,!0);f($e),ne(()=>pe(Xe,(d(),D(()=>d().date_of_birth)))),C(Re,$e)};Q(Oe,Re=>{d(),D(()=>d().date_of_birth)&&Re(Le)})}f(me);var Te=w(me,2),Ae=w(m(Te),2);qe(Ae);let Qe;var He=w(Ae,2);{var Ze=Re=>{var $e=Qt(),Xe=m($e,!0);f($e),ne(()=>pe(Xe,(d(),D(()=>d().phone_number)))),C(Re,$e)};Q(He,Re=>{d(),D(()=>d().phone_number)&&Re(Ze)})}f(Te),ne(()=>{We=Pe(Fe,1,"form-control",null,We,{"is-invalid":d().date_of_birth}),Fe.disabled=a(Z),Qe=Pe(Ae,1,"form-control",null,Qe,{"is-invalid":d().phone_number}),Ae.disabled=a(Z)}),Be(Fe,()=>a(r),Re=>q(r,Re)),Be(Ae,()=>a(u),Re=>q(u,Re)),C(i,b)},A=i=>{var b=Yt();C(i,b)};Q(_,i=>{ye?i(x):i(A,!1)})}f(P);var R=w(P,2),I=m(R),y=m(I);{var z=i=>{var b=Gt();ne(()=>b.disabled=a(Z)),ze("click",b,F),C(i,b)};Q(y,i=>{a(H)&&i(z)})}f(I);var l=w(I,2),L=m(l),le=w(L,2),ce=m(le);{var ie=i=>{var b=Zt();C(i,b)},be=i=>{var b=Xt();C(i,b)};Q(ce,i=>{a(H)?i(ie):i(be,!1)})}var ee=w(ce,2);{var Y=i=>{var b=er();C(i,b)};Q(ee,i=>{a(oe)&&i(Y)})}f(le),f(l),f(R);var V=w(R,2),G=m(V),de=m(G,!0);f(G);var Se=w(G,2);let Ie;var ae=m(Se);Ge(ae,{size:"xs"}),f(Se),f(V),f(n),ne(()=>{o=Pe(k,1,"form-control",null,o,{"is-invalid":d().first_name}),k.disabled=a(Z),p=Pe(J,1,"form-control",null,p,{"is-invalid":d().last_name}),J.disabled=a(Z),L.disabled=a(Z),le.disabled=a(Z),Pe(G,1,`fw-lighter fst-italic text-${a(S),D(()=>a(S).type)??""}`),pe(de,(a(S),D(()=>a(S).message))),Ie=Pe(Se,1,"",null,Ie,{"d-none":!a(Z)})}),Be(k,()=>a(e),i=>q(e,i)),Be(J,()=>a(t),i=>q(t,i)),ze("click",L,X),ze("click",le,v),C(N,n),nt(),W()}var bt={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(N,B){((s,d)=>{N.exports=d()})(At,function s(){var d=typeof self<"u"?self:typeof window<"u"?window:d!==void 0?d:{},O,W=!d.document&&!!d.postMessage,H=d.IS_PAPA_WORKER||!1,oe={},se=0,h={};function fe(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var r=ge(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new Me(r),(this._handle.streamer=this)._config=r}.call(this,e),this.parseChunk=function(t,r){var u=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<u){let M=this._config.newline;M||(c=this._config.quoteChar||'"',M=this._handle.guessLineEndings(t,c)),t=[...t.split(M).slice(u)].join(M)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(c=this._config.beforeFirstChunk(t))!==void 0&&(t=c),this.isFirstChunk=!1,this._halted=!1;var u=this._partialLine+t,c=(this._partialLine="",this._handle.parse(u,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=c.meta.cursor,u=(this._finished||(this._partialLine=u.substring(t-this._baseIndex),this._baseIndex=t),c&&c.data&&(this._rowCount+=c.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),H)d.postMessage({results:c,workerId:h.WORKER_ID,finished:u});else if(S(this._config.chunk)&&!r){if(this._config.chunk(c,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=c=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(c.data),this._completeResults.errors=this._completeResults.errors.concat(c.errors),this._completeResults.meta=c.meta),this._completed||!u||!S(this._config.complete)||c&&c.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||c&&c.meta.paused||this._nextChunk(),c}this._halted=!0},this._sendError=function(t){S(this._config.error)?this._config.error(t):H&&this._config.error&&d.postMessage({workerId:h.WORKER_ID,error:t,finished:!1})}}function De(e){var t;(e=e||{}).chunkSize||(e.chunkSize=h.RemoteChunkSize),fe.call(this,e),this._nextChunk=W?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),W||(t.onload=te(this._chunkLoaded,this),t.onerror=te(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!W),this._config.downloadRequestHeaders){var r,u=this._config.downloadRequestHeaders;for(r in u)t.setRequestHeader(r,u[r])}var c;this._config.chunkSize&&(c=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+c));try{t.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}W&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function Ee(e){(e=e||{}).chunkSize||(e.chunkSize=h.LocalChunkSize),fe.call(this,e);var t,r,u=typeof FileReader<"u";this.stream=function(c){this._input=c,r=c.slice||c.webkitSlice||c.mozSlice,u?((t=new FileReader).onload=te(this._chunkLoaded,this),t.onerror=te(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var c=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),c=r.call(c,this._start,M)),t.readAsText(c,this._config.encoding));u||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(c){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(c.target.result)},this._chunkError=function(){this._sendError(t.error)}}function ye(e){var t;fe.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,u;if(!this._finished)return r=this._config.chunkSize,t=r?(u=t.substring(0,r),t.substring(r)):(u=t,""),this._finished=!t,this.parseChunk(u)}}function Ce(e){fe.call(this,e=e||{});var t=[],r=!0,u=!1;this.pause=function(){fe.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){fe.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(c){this._input=c,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){u&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=te(function(c){try{t.push(typeof c=="string"?c:c.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(M){this._streamError(M)}},this),this._streamError=te(function(c){this._streamCleanUp(),this._sendError(c)},this),this._streamEnd=te(function(){this._streamCleanUp(),u=!0,this._streamData("")},this),this._streamCleanUp=te(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Me(e){var t,r,u,c,M=Math.pow(2,53),X=-M,re=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,he=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,F=this,v=0,n=0,P=!1,g=!1,k=[],o={data:[],errors:[],meta:{}};function j(p){return e.skipEmptyLines==="greedy"?p.join("").trim()==="":p.length===1&&p[0].length===0}function U(){if(o&&u&&(J("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+h.DefaultDelimiter+"'"),u=!1),e.skipEmptyLines&&(o.data=o.data.filter(function(_){return!j(_)})),K()){let _=function(x,A){S(e.transformHeader)&&(x=e.transformHeader(x,A)),k.push(x)};if(o)if(Array.isArray(o.data[0])){for(var p=0;K()&&p<o.data.length;p++)o.data[p].forEach(_);o.data.splice(0,1)}else o.data.forEach(_)}function E(_,x){for(var A=e.header?{}:[],R=0;R<_.length;R++){var I=R,y=_[R],y=((z,l)=>(L=>(e.dynamicTypingFunction&&e.dynamicTyping[L]===void 0&&(e.dynamicTyping[L]=e.dynamicTypingFunction(L)),(e.dynamicTyping[L]||e.dynamicTyping)===!0))(z)?l==="true"||l==="TRUE"||l!=="false"&&l!=="FALSE"&&((L=>{if(re.test(L)&&(L=parseFloat(L),X<L&&L<M))return 1})(l)?parseFloat(l):he.test(l)?new Date(l):l===""?null:l):l)(I=e.header?R>=k.length?"__parsed_extra":k[R]:I,y=e.transform?e.transform(y,I):y);I==="__parsed_extra"?(A[I]=A[I]||[],A[I].push(y)):A[I]=y}return e.header&&(R>k.length?J("FieldMismatch","TooManyFields","Too many fields: expected "+k.length+" fields but parsed "+R,n+x):R<k.length&&J("FieldMismatch","TooFewFields","Too few fields: expected "+k.length+" fields but parsed "+R,n+x)),A}var T;o&&(e.header||e.dynamicTyping||e.transform)&&(T=1,!o.data.length||Array.isArray(o.data[0])?(o.data=o.data.map(E),T=o.data.length):o.data=E(o.data,0),e.header&&o.meta&&(o.meta.fields=k),n+=T)}function K(){return e.header&&k.length===0}function J(p,E,T,_){p={type:p,code:E,message:T},_!==void 0&&(p.row=_),o.errors.push(p)}S(e.step)&&(c=e.step,e.step=function(p){o=p,K()?U():(U(),o.data.length!==0&&(v+=p.data.length,e.preview&&v>e.preview?r.abort():(o.data=o.data[0],c(o,F))))}),this.parse=function(p,E,T){var _=e.quoteChar||'"',_=(e.newline||(e.newline=this.guessLineEndings(p,_)),u=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(p),o.meta.delimiter=e.delimiter):((_=((x,A,R,I,y)=>{var z,l,L,le;y=y||[",","	","|",";",h.RECORD_SEP,h.UNIT_SEP];for(var ce=0;ce<y.length;ce++){for(var ie,be=y[ce],ee=0,Y=0,V=0,G=(L=void 0,new xe({comments:I,delimiter:be,newline:A,preview:10}).parse(x)),de=0;de<G.data.length;de++)R&&j(G.data[de])?V++:(ie=G.data[de].length,Y+=ie,L===void 0?L=ie:0<ie&&(ee+=Math.abs(ie-L),L=ie));0<G.data.length&&(Y/=G.data.length-V),(l===void 0||ee<=l)&&(le===void 0||le<Y)&&1.99<Y&&(l=ee,z=be,le=Y)}return{successful:!!(e.delimiter=z),bestDelimiter:z}})(p,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=_.bestDelimiter:(u=!0,e.delimiter=h.DefaultDelimiter),o.meta.delimiter=e.delimiter),ge(e));return e.preview&&e.header&&_.preview++,t=p,r=new xe(_),o=r.parse(t,E,T),U(),P?{meta:{paused:!0}}:o||{meta:{paused:!1}}},this.paused=function(){return P},this.pause=function(){P=!0,r.abort(),t=S(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){F.streamer._halted?(P=!1,F.streamer.parseChunk(t,!0)):setTimeout(F.resume,3)},this.aborted=function(){return g},this.abort=function(){g=!0,r.abort(),o.meta.aborted=!0,S(e.complete)&&e.complete(o),t=""},this.guessLineEndings=function(x,_){x=x.substring(0,1048576);var _=new RegExp(ue(_)+"([^]*?)"+ue(_),"gm"),T=(x=x.replace(_,"")).split("\r"),_=x.split(`
`),x=1<_.length&&_[0].length<T[0].length;if(T.length===1||x)return`
`;for(var A=0,R=0;R<T.length;R++)T[R][0]===`
`&&A++;return A>=T.length/2?`\r
`:"\r"}}function ue(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function xe(e){var t=(e=e||{}).delimiter,r=e.newline,u=e.comments,c=e.step,M=e.preview,X=e.fastMode,re=null,he=!1,F=e.quoteChar==null?'"':e.quoteChar,v=F;if(e.escapeChar!==void 0&&(v=e.escapeChar),(typeof t!="string"||-1<h.BAD_DELIMITERS.indexOf(t))&&(t=","),u===t)throw new Error("Comment character same as delimiter");u===!0?u="#":(typeof u!="string"||-1<h.BAD_DELIMITERS.indexOf(u))&&(u=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var n=0,P=!1;this.parse=function(g,k,o){if(typeof g!="string")throw new Error("Input must be a string");var j=g.length,U=t.length,K=r.length,J=u.length,p=S(c),E=[],T=[],_=[],x=n=0;if(!g)return ee();if(X||X!==!1&&g.indexOf(F)===-1){for(var A=g.split(r),R=0;R<A.length;R++){if(_=A[R],n+=_.length,R!==A.length-1)n+=r.length;else if(o)return ee();if(!u||_.substring(0,J)!==u){if(p){if(E=[],le(_.split(t)),Y(),P)return ee()}else le(_.split(t));if(M&&M<=R)return E=E.slice(0,M),ee(!0)}}return ee()}for(var I=g.indexOf(t,n),y=g.indexOf(r,n),z=new RegExp(ue(v)+ue(F),"g"),l=g.indexOf(F,n);;)if(g[n]===F)for(l=n,n++;;){if((l=g.indexOf(F,l+1))===-1)return o||T.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:E.length,index:n}),ie();if(l===j-1)return ie(g.substring(n,l).replace(z,F));if(F===v&&g[l+1]===v)l++;else if(F===v||l===0||g[l-1]!==v){I!==-1&&I<l+1&&(I=g.indexOf(t,l+1));var L=ce((y=y!==-1&&y<l+1?g.indexOf(r,l+1):y)===-1?I:Math.min(I,y));if(g.substr(l+1+L,U)===t){_.push(g.substring(n,l).replace(z,F)),g[n=l+1+L+U]!==F&&(l=g.indexOf(F,n)),I=g.indexOf(t,n),y=g.indexOf(r,n);break}if(L=ce(y),g.substring(l+1+L,l+1+L+K)===r){if(_.push(g.substring(n,l).replace(z,F)),be(l+1+L+K),I=g.indexOf(t,n),l=g.indexOf(F,n),p&&(Y(),P))return ee();if(M&&E.length>=M)return ee(!0);break}T.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:E.length,index:n}),l++}}else if(u&&_.length===0&&g.substring(n,n+J)===u){if(y===-1)return ee();n=y+K,y=g.indexOf(r,n),I=g.indexOf(t,n)}else if(I!==-1&&(I<y||y===-1))_.push(g.substring(n,I)),n=I+U,I=g.indexOf(t,n);else{if(y===-1)break;if(_.push(g.substring(n,y)),be(y+K),p&&(Y(),P))return ee();if(M&&E.length>=M)return ee(!0)}return ie();function le(V){E.push(V),x=n}function ce(V){var G=0;return G=V!==-1&&(V=g.substring(l+1,V))&&V.trim()===""?V.length:G}function ie(V){return o||(V===void 0&&(V=g.substring(n)),_.push(V),n=j,le(_),p&&Y()),ee()}function be(V){n=V,le(_),_=[],y=g.indexOf(r,n)}function ee(V){if(e.header&&!k&&E.length&&!he){var G=E[0],de=Object.create(null),Se=new Set(G);let Ie=!1;for(let ae=0;ae<G.length;ae++){let i=G[ae];if(de[i=S(e.transformHeader)?e.transformHeader(i,ae):i]){let b,me=de[i];for(;b=i+"_"+me,me++,Se.has(b););Se.add(b),G[ae]=b,de[i]++,Ie=!0,(re=re===null?{}:re)[b]=i}else de[i]=1,G[ae]=i;Se.add(i)}Ie&&console.warn("Duplicate headers found and renamed."),he=!0}return{data:E,errors:T,meta:{delimiter:t,linebreak:r,aborted:P,truncated:!!V,cursor:x+(k||0),renamedHeaders:re}}}function Y(){c(ee()),E=[],T=[]}},this.abort=function(){P=!0},this.getCharIndex=function(){return n}}function we(e){var t=e.data,r=oe[t.workerId],u=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var c={abort:function(){u=!0,ke(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Z,resume:Z};if(S(r.userStep)){for(var M=0;M<t.results.data.length&&(r.userStep({data:t.results.data[M],errors:t.results.errors,meta:t.results.meta},c),!u);M++);delete t.results}else S(r.userChunk)&&(r.userChunk(t.results,c,t.file),delete t.results)}t.finished&&!u&&ke(t.workerId,t.results)}function ke(e,t){var r=oe[e];S(r.userComplete)&&r.userComplete(t),r.terminate(),delete oe[e]}function Z(){throw new Error("Not implemented.")}function ge(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ge(e[t]);return r}function te(e,t){return function(){e.apply(t,arguments)}}function S(e){return typeof e=="function"}return h.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(S(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!S(t.transform)&&t.transform,!t.worker||!h.WORKERS_SUPPORTED)return r=null,h.NODE_STREAM_INPUT,typeof e=="string"?(e=(u=>u.charCodeAt(0)!==65279?u:u.slice(1))(e),r=new(t.download?De:ye)(t)):e.readable===!0&&S(e.read)&&S(e.on)?r=new Ce(t):(d.File&&e instanceof File||e instanceof Object)&&(r=new Ee(t)),r.stream(e);(r=(()=>{var u;return!!h.WORKERS_SUPPORTED&&(u=(()=>{var c=d.URL||d.webkitURL||null,M=s.toString();return h.BLOB_URL||(h.BLOB_URL=c.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(u=new d.Worker(u)).onmessage=we,u.id=se++,oe[u.id]=u)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=S(t.step),t.chunk=S(t.chunk),t.complete=S(t.complete),t.error=S(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},h.unparse=function(e,t){var r=!1,u=!0,c=",",M=`\r
`,X='"',re=X+X,he=!1,F=null,v=!1,n=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||h.BAD_DELIMITERS.filter(function(k){return t.delimiter.indexOf(k)!==-1}).length||(c=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(he=t.skipEmptyLines),typeof t.newline=="string"&&(M=t.newline),typeof t.quoteChar=="string"&&(X=t.quoteChar),typeof t.header=="boolean"&&(u=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");F=t.columns}t.escapeChar!==void 0&&(re=t.escapeChar+X),t.escapeFormulae instanceof RegExp?v=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(v=/^[=+\-@\t\r].*$/)}})(),new RegExp(ue(X),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return P(null,e,he);if(typeof e[0]=="object")return P(F||Object.keys(e[0]),e,he)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||F),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),P(e.fields||[],e.data||[],he);throw new Error("Unable to serialize unrecognized input");function P(k,o,j){var U="",K=(typeof k=="string"&&(k=JSON.parse(k)),typeof o=="string"&&(o=JSON.parse(o)),Array.isArray(k)&&0<k.length),J=!Array.isArray(o[0]);if(K&&u){for(var p=0;p<k.length;p++)0<p&&(U+=c),U+=g(k[p],p);0<o.length&&(U+=M)}for(var E=0;E<o.length;E++){var T=(K?k:o[E]).length,_=!1,x=K?Object.keys(o[E]).length===0:o[E].length===0;if(j&&!K&&(_=j==="greedy"?o[E].join("").trim()==="":o[E].length===1&&o[E][0].length===0),j==="greedy"&&K){for(var A=[],R=0;R<T;R++){var I=J?k[R]:R;A.push(o[E][I])}_=A.join("").trim()===""}if(!_){for(var y=0;y<T;y++){0<y&&!x&&(U+=c);var z=K&&J?k[y]:y;U+=g(o[E][z],y)}E<o.length-1&&(!j||0<T&&!x)&&(U+=M)}}return U}function g(k,o){var j,U;return k==null?"":k.constructor===Date?JSON.stringify(k).slice(1,25):(U=!1,v&&typeof k=="string"&&v.test(k)&&(k="'"+k,U=!0),j=k.toString().replace(n,re),(U=U||r===!0||typeof r=="function"&&r(k,o)||Array.isArray(r)&&r[o]||((K,J)=>{for(var p=0;p<J.length;p++)if(-1<K.indexOf(J[p]))return!0;return!1})(j,h.BAD_DELIMITERS)||-1<j.indexOf(c)||j.charAt(0)===" "||j.charAt(j.length-1)===" ")?X+j+X:j)}},h.RECORD_SEP="",h.UNIT_SEP="",h.BYTE_ORDER_MARK="\uFEFF",h.BAD_DELIMITERS=["\r",`
`,'"',h.BYTE_ORDER_MARK],h.WORKERS_SUPPORTED=!W&&!!d.Worker,h.NODE_STREAM_INPUT=1,h.LocalChunkSize=10485760,h.RemoteChunkSize=5242880,h.DefaultDelimiter=",",h.Parser=xe,h.ParserHandle=Me,h.NetworkStreamer=De,h.FileStreamer=Ee,h.StringStreamer=ye,h.ReadableStreamStreamer=Ce,d.jQuery&&((O=d.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(M){if(!(O(this).prop("tagName").toUpperCase()==="INPUT"&&O(this).attr("type").toLowerCase()==="file"&&d.FileReader)||!this.files||this.files.length===0)return!0;for(var X=0;X<this.files.length;X++)r.push({file:this.files[X],inputElem:this,instanceConfig:O.extend({},t)})}),u(),this;function u(){if(r.length===0)S(e.complete)&&e.complete();else{var M,X,re,he,F=r[0];if(S(e.before)){var v=e.before(F.file,F.inputElem);if(typeof v=="object"){if(v.action==="abort")return M="AbortError",X=F.file,re=F.inputElem,he=v.reason,void(S(e.error)&&e.error({name:M},X,re,he));if(v.action==="skip")return void c();typeof v.config=="object"&&(F.instanceConfig=O.extend(F.instanceConfig,v.config))}else if(v==="skip")return void c()}var n=F.instanceConfig.complete;F.instanceConfig.complete=function(P){S(n)&&n(P,F.file,F.inputElem),c()},h.parse(F.file,F.instanceConfig)}}function c(){r.splice(0,1),u()}}),H&&(d.onmessage=function(e){e=e.data,h.WORKER_ID===void 0&&e&&(h.WORKER_ID=e.workerId),typeof e.input=="string"?d.postMessage({workerId:h.WORKER_ID,results:h.parse(e.input,e.config),finished:!0}):(d.File&&e.input instanceof File||e.input instanceof Object)&&(e=h.parse(e.input,e.config))&&d.postMessage({workerId:h.WORKER_ID,results:e,finished:!0})}),(De.prototype=Object.create(fe.prototype)).constructor=De,(Ee.prototype=Object.create(fe.prototype)).constructor=Ee,(ye.prototype=Object.create(ye.prototype)).constructor=ye,(Ce.prototype=Object.create(fe.prototype)).constructor=Ce,h})})(bt);var ar=bt.exports;const sr=$t(ar);async function ir(N){return new Promise((B,s)=>{sr.parse(N,{header:!0,skipEmptyLines:!0,complete:d=>{const O=d.data,W=d.meta.fields||[];B({data:O,columns:W})},error:d=>s(d)})})}function nr(N,B){return N.map(d=>{const O=d.toLowerCase().trim();if(O.includes("first")&&O.includes("name"))return{csvColumn:d,memberField:"first_name"};if(O.includes("last")&&O.includes("name"))return{csvColumn:d,memberField:"last_name"};if(B){if(O.includes("birth")||O.includes("dob"))return{csvColumn:d,memberField:"date_of_birth"};if(O.includes("phone"))return{csvColumn:d,memberField:"phone_number"}}return{csvColumn:d,memberField:null}})}async function or(N,B){const{validate:s,validationErrors:d}=_t(),O={first_name:""};B.forEach(oe=>{const se=N[oe.csvColumn];if(!oe.memberField||!se)return;const h=se.trim();switch(oe.memberField){case"first_name":O.first_name=h;break;case"last_name":O.last_name=h;break;case"date_of_birth":O.date_of_birth=h;break;case"phone_number":O.phone_number=h;break}}),await s(O);const W=st(d),H=Object.values(W).filter(Boolean);return{isValid:H.length===0,errors:H}}function lr(N,B){const s=dt();return s?st(s.stores.members).some(O=>O.first_name.toLowerCase()===N.toLowerCase()&&(O.last_name||"").toLowerCase()===(B||"").toLowerCase()):!1}async function dr(N,B){const s={success:0,duplicates:0,validationErrors:0,errors:[]},d=[];for(let O=0;O<N.length;O++){const W=N[O],H={};if(B.forEach(h=>{if(h.memberField&&W[h.csvColumn]){const fe=W[h.csvColumn].trim();h.memberField==="date_of_birth"?H[h.memberField]=new Date(fe):H[h.memberField]=fe}}),!H.first_name){s.validationErrors++,s.errors.push({row:O+1,field:"first_name",message:"First name is required"});continue}if(lr(H.first_name,H.last_name||"")){s.duplicates++;continue}const se=await or(W,B);if(!se.isValid){s.validationErrors++,se.errors.forEach(h=>{s.errors.push({row:O+1,field:"unknown",message:h})});continue}d.push(H)}return d.length>0&&(await Tt(d),s.success=d.length),s}function ur(N){const B=vt({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null});return{state:B,parseCsvFile:ir,autoDetectMappings:s=>nr(s,N),importMembers:dr,reset:()=>B.set({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null})}}var cr=$(`<div class="mb-3"><label for="csvFile" class="form-label">Select CSV File</label> <input type="file" class="form-control" id="csvFile" accept=".csv"/> <div class="form-text">CSV file should include columns for: First Name, Last Name, Date of Birth, Phone
							Number</div></div>`),fr=$("<option>Date of Birth</option> <option>Phone Number</option>",1),hr=$('<tr><td> </td><td><select class="form-select form-select-sm"><option>-- Skip --</option><option>First Name</option><option>Last Name</option><!></select></td></tr>'),mr=$('<h6>Map CSV Columns to Member Fields</h6> <p class="text-muted"> </p> <table class="table table-sm"><thead><tr><th>CSV Column</th><th>Maps To</th></tr></thead><tbody></tbody></table>',1),vr=$('<div class="text-center py-5"><!> <p class="mt-3">Importing members...</p></div>'),pr=$("<li><strong> </strong> duplicates skipped</li>"),_r=$("<li><strong> </strong> rows had validation errors</li>"),br=$("<li> </li>"),gr=$("<li><em> </em></li>"),yr=$('<div class="alert alert-warning"><h6>Validation Errors:</h6> <ul class="mb-0" style="max-height: 200px; overflow-y: auto;"><!> <!></ul></div>'),wr=$('<div class="alert alert-success"><h6>Import Complete</h6> <ul class="mb-0"><li><strong> </strong> members imported successfully</li> <!> <!></ul></div> <!>',1),kr=$('<button type="button" class="btn btn-secondary">Cancel</button>'),xr=$('<button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary"> </button>',1),Er=$('<button type="button" class="btn btn-secondary" disabled>Cancel</button> <button type="button" class="btn btn-primary" disabled><!> Importing...</button>',1),Cr=$('<button type="button" class="btn btn-primary">Done</button>'),Sr=$('<div class="modal-backdrop fade show"></div>'),Rr=$('<div tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Import Members from CSV</h5> <button type="button" class="btn-close" aria-label="Close import modal"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><!></div></div></div></div> <!>',1);function Dr(N,B){it(B,!1);const s=()=>Ne(h,"$state",d),[d,O]=ot();let W=Ve(B,"isOpen",8,!1),H=Ve(B,"onClose",8),oe=Ve(B,"onComplete",8),se=Ve(B,"canViewSensitiveData",8,!1);const{state:h,parseCsvFile:fe,autoDetectMappings:De,importMembers:Ee,reset:ye}=ur(se());async function Ce(v){const n=v.target.files?.[0];if(n)try{const{data:P,columns:g}=await fe(n),k=De(g);h.update(o=>({...o,step:"mapping",csvData:P,csvColumns:g,columnMappings:k}))}catch(P){console.error("Failed to parse CSV:",P),alert("Failed to parse CSV file. Please check the file format.")}}async function Me(){try{const v=await Ee(s().csvData,s().columnMappings);h.update(n=>({...n,step:"complete",importResult:v})),oe()()}catch(v){console.error("Failed to import members:",v),alert("Failed to import members. Please try again.")}}function ue(){ye(),H()()}lt();var xe=Rr(),we=ve(xe);let ke;var Z=m(we),ge=m(Z),te=m(ge),S=w(m(te),2);S.__click=ue,f(te);var e=w(te,2),t=m(e);{var r=v=>{var n=cr(),P=w(m(n),2);P.__change=Ce,Ue(2),f(n),C(v,n)},u=v=>{var n=je(),P=ve(n);{var g=o=>{var j=mr(),U=w(ve(j),2),K=m(U);f(U);var J=w(U,2),p=w(m(J));rt(p,5,()=>(s(),D(()=>s().columnMappings)),at,(E,T,_)=>{var x=hr(),A=m(x),R=m(A,!0);f(A);var I=w(A),y=m(I);ne(()=>{a(T),ct(()=>{se()})});var z=m(y);z.value=(z.__value=null)??"";var l=w(z);l.value=l.__value="first_name";var L=w(l);L.value=L.__value="last_name";var le=w(L);{var ce=ie=>{var be=fr(),ee=ve(be);ee.value=ee.__value="date_of_birth";var Y=w(ee,2);Y.value=Y.__value="phone_number",C(ie,be)};Q(le,ie=>{se()&&ie(ce)})}f(y),f(I),f(x),ne(()=>pe(R,(a(T),D(()=>a(T).csvColumn)))),St(y,()=>a(T).memberField,ie=>(a(T).memberField=ie,ct(()=>s()),Et(d,"$state"))),C(E,x)}),f(p),f(J),ne(()=>pe(K,`Found ${s(),D(()=>s().csvData.length)??""} rows in CSV`)),C(o,j)},k=o=>{var j=je(),U=ve(j);{var K=p=>{var E=vr(),T=m(E);Ge(T,{}),Ue(2),f(E),C(p,E)},J=p=>{var E=je(),T=ve(E);{var _=x=>{var A=wr(),R=ve(A),I=w(m(R),2),y=m(I),z=m(y),l=m(z,!0);f(z),Ue(),f(y);var L=w(y,2);{var le=Y=>{var V=pr(),G=m(V),de=m(G,!0);f(G),Ue(),f(V),ne(()=>pe(de,(s(),D(()=>s().importResult.duplicates)))),C(Y,V)};Q(L,Y=>{s(),D(()=>s().importResult?.duplicates&&s().importResult.duplicates>0)&&Y(le)})}var ce=w(L,2);{var ie=Y=>{var V=_r(),G=m(V),de=m(G,!0);f(G),Ue(),f(V),ne(()=>pe(de,(s(),D(()=>s().importResult.validationErrors)))),C(Y,V)};Q(ce,Y=>{s(),D(()=>s().importResult?.validationErrors&&s().importResult.validationErrors>0)&&Y(ie)})}f(I),f(R);var be=w(R,2);{var ee=Y=>{var V=yr(),G=w(m(V),2),de=m(G);rt(de,1,()=>(s(),D(()=>s().importResult.errors.slice(0,10))),at,(ae,i)=>{var b=br(),me=m(b);f(b),ne(()=>pe(me,`Row ${a(i),D(()=>a(i).row)??""}: ${a(i),D(()=>a(i).message)??""}`)),C(ae,b)});var Se=w(de,2);{var Ie=ae=>{var i=gr(),b=m(i),me=m(b);f(b),f(i),ne(()=>pe(me,`... and ${s(),D(()=>s().importResult.errors.length-10)??""} more errors`)),C(ae,i)};Q(Se,ae=>{s(),D(()=>s().importResult.errors.length>10)&&ae(Ie)})}f(G),f(V),C(Y,V)};Q(be,Y=>{s(),D(()=>s().importResult?.errors&&s().importResult.errors.length>0)&&Y(ee)})}ne(()=>pe(l,(s(),D(()=>s().importResult?.success||0)))),C(x,A)};Q(T,x=>{s(),D(()=>s().step==="complete")&&x(_)},!0)}C(p,E)};Q(U,p=>{s(),D(()=>s().step==="importing")?p(K):p(J,!1)},!0)}C(o,j)};Q(P,o=>{s(),D(()=>s().step==="mapping")?o(g):o(k,!1)},!0)}C(v,n)};Q(t,v=>{s(),D(()=>s().step==="upload")?v(r):v(u,!1)})}f(e);var c=w(e,2),M=m(c);{var X=v=>{var n=kr();n.__click=ue,C(v,n)},re=v=>{var n=je(),P=ve(n);{var g=o=>{var j=xr(),U=ve(j);U.__click=ue;var K=w(U,2);K.__click=Me;var J=m(K);f(K),ne(()=>pe(J,`Import ${s(),D(()=>s().csvData.length)??""} Members`)),C(o,j)},k=o=>{var j=je(),U=ve(j);{var K=p=>{var E=Er(),T=w(ve(E),2),_=m(T);Ge(_,{size:"sm"}),Ue(),f(T),C(p,E)},J=p=>{var E=je(),T=ve(E);{var _=x=>{var A=Cr();A.__click=ue,C(x,A)};Q(T,x=>{s(),D(()=>s().step==="complete")&&x(_)},!0)}C(p,E)};Q(U,p=>{s(),D(()=>s().step==="importing")?p(K):p(J,!1)},!0)}C(o,j)};Q(P,o=>{s(),D(()=>s().step==="mapping")?o(g):o(k,!1)},!0)}C(v,n)};Q(M,v=>{s(),D(()=>s().step==="upload")?v(X):v(re,!1)})}f(c),f(ge),f(Z),f(we);var he=w(we,2);{var F=v=>{var n=Sr();C(v,n)};Q(he,v=>{W()&&v(F)})}ne(()=>{ke=Pe(we,1,"modal fade",null,ke,{show:W()}),Ct(we,`display: ${W()?"block":"none"}`)}),C(N,xe),nt(),O()}xt(["click","change"]);var Mr=$('<div class="dropdown"><button class="btn btn-sm btn-primary dropdown-toggle" type="button" id="addMemberDropdown" data-bs-toggle="dropdown" aria-label="Add member actions" aria-expanded="false"><i class="bi bi-plus"></i></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="addMemberDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-person-plus me-2"></i>Create Member</button></li> <li><button class="dropdown-item" type="button"><i class="bi bi-file-earmark-arrow-up me-2"></i>Import CSV</button></li></ul></div>'),Ir=$("<!> ",1),Or=$("<!> <!>",1),Fr=$('<span class="fst-italic">Contact info restricted</span>'),Lr=$('<div class="member-actions svelte-65f73k"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit member"><i class="bi bi-pencil-square"></i></button></div>'),Tr=$('<li class="list-group-item py-2"><div class="member-row svelte-65f73k"><div class="member-content svelte-65f73k"><div><strong> </strong></div> <div class="text-muted small"><!></div></div> <!></div></li>'),Ar=$('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),$r=$('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Pr=$('<div class="card-body"><div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> No members match your search.</div></div>'),jr=$('<div class="card-body"><div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> No members yet.</div></div>'),Nr=$('<div class="card"><div class="card-header"><div class="header-container"><div class="d-flex justify-content-between align-items-center w-100"><span>Members</span> <div class="d-flex align-items-center gap-2"><input type="text" class="form-control form-control-sm search-desktop svelte-65f73k" placeholder="Search members..."/> <!></div></div> <div class="search-mobile mt-2 svelte-65f73k"><input type="text" class="form-control form-control-sm" placeholder="Search members..."/></div></div></div> <!></div>'),zr=$('<div class="d-flex flex-column gap-4"><!></div>'),Ur=$("<!> <!> <!>",1);function Vr(N,B){it(B,!1);const s=()=>Ne(Ee,"$filteredMembers",H),d=()=>Ne(fe,"$currentUserHasPermission",H),O=()=>Ne(De,"$ready",H),W=()=>Ne(ye,"$searchQuery",H),[H,oe]=ot(),se=_e(),h=_e(),{stores:{currentUserHasPermission:fe}}=mt(),{stores:{ready:De,filteredMembers:Ee,searchQuery:ye},actions:{reload:Ce}}=dt(),Me={first_name:"",last_name:"",date_of_birth:void 0,phone_number:void 0},ue=Pt();let xe=_e(!1),we=_e(!1),ke=_e({...Me}),Z=_e(!1);const ge=20,te=20;let S=_e(ge);function e(){q(S,a(S)+te)}wt(async()=>{q(xe,d()(Ye.EditMembers)),q(we,d()(Ye.ViewSensitiveMemberData)),await Ce()});const t=v=>{q(ke,{...v})};function r(v){return v?new Date(v).toLocaleDateString():""}function u(){Ce()}Ke(()=>(s(),a(S)),()=>{q(se,(s()??[]).slice(0,a(S)))}),Ke(()=>(s(),a(S)),()=>{q(h,(s()?.length??0)>a(S))}),pt(),lt();var c=Ur(),M=ve(c);{let v=kt(()=>(a(ke),D(()=>a(ke).id?"Edit Member":"Create Member")));jt(M,{get title(){return a(v)},get id(){return ue},children:(n,P)=>{rr(n,{get memberId(){return a(ke),D(()=>a(ke).id)},get drawerId(){return ue}})},$$slots:{default:!0}})}var X=w(M,2);Dr(X,{get isOpen(){return a(Z)},onClose:()=>q(Z,!1),onComplete:u,get canViewSensitiveData(){return a(we)}});var re=w(X,2);{var he=v=>{var n=Nr(),P=m(n),g=m(P),k=m(g),o=w(m(k),2),j=m(o);qe(j);var U=w(j,2);{var K=x=>{var A=Mr(),R=w(m(A),2),I=m(R),y=m(I);f(I);var z=w(I,2),l=m(z);f(z),f(R),f(A),ne(()=>{Je(y,"data-bs-target",`#${ue??""}`),Je(y,"aria-controls",ue)}),ze("click",y,()=>t(Me)),ze("click",l,()=>q(Z,!0)),C(x,A)};Q(U,x=>{a(xe)&&x(K)})}f(o),f(k);var J=w(k,2),p=m(J);qe(p),f(J),f(g),f(P);var E=w(P,2);{var T=x=>{var A=$r(),R=ve(A);rt(R,5,()=>a(se),at,(z,l)=>{var L=Tr(),le=m(L),ce=m(le),ie=m(ce),be=m(ie),ee=m(be);f(be),f(ie);var Y=w(ie,2),V=m(Y);{var G=ae=>{var i=Or(),b=ve(i);{var me=Oe=>{var Le=ht();ne(Te=>pe(Le,`DOB: ${Te??""}`),[()=>(a(l),D(()=>r(a(l).date_of_birth)))]),C(Oe,Le)};Q(b,Oe=>{a(l),D(()=>a(l).date_of_birth)&&Oe(me)})}var Fe=w(b,2);{var We=Oe=>{var Le=Ir(),Te=ve(Le);{var Ae=He=>{var Ze=ht("â€¢");C(He,Ze)};Q(Te,He=>{a(l),D(()=>a(l).date_of_birth)&&He(Ae)})}var Qe=w(Te);ne(()=>pe(Qe,` Phone: ${a(l),D(()=>a(l).phone_number)??""}`)),C(Oe,Le)};Q(Fe,Oe=>{a(l),D(()=>a(l).phone_number)&&Oe(We)})}C(ae,i)},de=ae=>{var i=Fr();C(ae,i)};Q(V,ae=>{a(we)?ae(G):ae(de,!1)})}f(Y),f(ce);var Se=w(ce,2);{var Ie=ae=>{var i=Lr(),b=m(i);f(i),ne(()=>{Je(b,"data-bs-target",`#${ue??""}`),Je(b,"aria-controls",ue)}),ze("click",b,()=>t(a(l))),C(ae,i)};Q(Se,ae=>{a(xe)&&ae(Ie)})}f(le),f(L),ne(()=>pe(ee,`${a(l),D(()=>a(l).first_name)??""} ${a(l),D(()=>a(l).last_name||"")??""}`)),C(z,L)}),f(R);var I=w(R,2);{var y=z=>{var l=Ar(),L=m(l),le=m(L);f(L);var ce=w(L,2);f(l),ne(()=>pe(le,`Showing ${a(S)??""} of ${s(),D(()=>s()?.length??0)??""}`)),ze("click",ce,e),C(z,l)};Q(I,z=>{a(h)&&z(y)})}C(x,A)},_=x=>{var A=je(),R=ve(A);{var I=z=>{var l=Pr();C(z,l)},y=z=>{var l=jr();C(z,l)};Q(R,z=>{W(),D(()=>W().trim())?z(I):z(y,!1)},!0)}C(x,A)};Q(E,x=>{a(se),D(()=>a(se).length)?x(T):x(_,!1)})}f(n),Be(j,W,x=>ft(ye,x)),Be(p,W,x=>ft(ye,x)),C(v,n)},F=v=>{var n=zr(),P=m(n);Ge(P,{}),f(n),C(v,n)};Q(re,v=>{O()?v(he):v(F,!1)})}C(N,c),nt(),oe()}function ua(N){yt(N,{pageTitle:"Members",children:(B,s)=>{Vr(B,{})},$$slots:{default:!0}})}export{ua as component,da as universal};
