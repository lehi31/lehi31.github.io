import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{o as O,a as B}from"../chunks/DjNGvcU6.js";import{p as j,c as T,s as d,r as U,t as G,a as P,f as N,g as x,E as M,D as w,ah as H,$ as J}from"../chunks/JKZwkikK.js";import{p as D,i as y,s as Q,e as S,a as z,b as K}from"../chunks/BxjzTaz1.js";import{f as u,a as t,c as E}from"../chunks/JDsN5plM.js";import{s as X}from"../chunks/Bhs7oqge.js";import{e as Z,h as ee}from"../chunks/B2BlSr7K.js";import{i as V}from"../chunks/b8c_lO2i.js";import{c as ae,g as te}from"../chunks/QGfKgKU-.js";import{t as se,d as re}from"../chunks/CYaybGWn.js";import{b as oe}from"../chunks/ip-cLIP0.js";const ie=!0,Te=Object.freeze(Object.defineProperty({__proto__:null,prerender:ie},Symbol.toStringTag,{value:"Module"}));var ne=u('<i class="bi bi-info-circle"></i>'),le=u('<i class="bi bi-exclamation-triangle"></i>'),ce=u('<i class="bi bi-x-circle"></i>'),ve=u('<i class="bi bi-check-circle"></i>'),fe=u('<div role="alert"><!> <div class="flex-grow-1"> </div> <button type="button" class="btn-close" aria-label="Close"></button></div>');function pe(b,r){j(r,!1);let m=D(r,"message",8),s=D(r,"type",8,"info"),c=D(r,"onClose",8);setTimeout(()=>c()(),5e3),V();var o=fe(),v=T(o);{var f=i=>{var h=ne();t(i,h)},g=i=>{var h=E(),C=N(h);{var F=p=>{var _=le();t(p,_)},$=p=>{var _=E(),e=N(_);{var a=n=>{var I=ce();t(n,I)},l=n=>{var I=E(),L=N(I);{var W=R=>{var Y=ve();t(R,Y)};y(L,R=>{s()==="success"&&R(W)},!0)}t(n,I)};y(e,n=>{s()==="danger"?n(a):n(l,!1)},!0)}t(p,_)};y(C,p=>{s()==="warning"?p(F):p($,!1)},!0)}t(i,h)};y(v,i=>{s()==="info"?i(f):i(g,!1)})}var k=d(v,2),q=T(k,!0);U(k);var A=d(k,2);U(o),G(()=>{ae(o,1,`alert alert-${s()??""} alert-dismissible d-flex align-items-center gap-2`,"svelte-1jlqy1l"),Q(q,m())}),S("click",A,function(...i){c()?.apply(this,i)}),t(b,o),P()}function de(b,r){j(r,!1);const m=()=>K(se,"$toasts",s),[s,c]=z();V();var o=E(),v=N(o);Z(v,1,m,f=>f.id,(f,g)=>{pe(f,{get message(){return x(g).message},get type(){return x(g).type},onClose:()=>re(x(g).id)})}),t(b,o),P(),c()}var ue=u("<div></div>");function me(b,r){j(r,!1);let m=M(),s=null;O(async()=>{}),B(()=>{s?.unmount(),s=null}),V();var c=ue();oe(c,o=>w(m,o),()=>x(m)),t(b,c),P()}var be=u('<div class="alert alert-info alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-arrow-clockwise"></i> <div class="flex-grow-1"><strong>Update Available</strong><br/> A new version of the app is available. Please reload to get the latest features and bug fixes.</div> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-arrow-clockwise"></i> Reload Now</button> <button type="button" class="btn-close" aria-label="Close"></button></div>'),ge=u('<div class="alert alert-warning alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-clock-history"></i> <div><strong>Session Expired</strong><br/> Your authentication token has expired. Please log in again to continue.</div> <button type="button" class="btn-close" aria-label="Close"></button></div>'),he=u("<!> <!> <!> <!> <!>",1);function Ue(b,r){j(r,!1);const m=()=>K(o,"$pageName",s),[s,c]=z(),{stores:{pageName:o}}=te();let v=M(!1),f=M(!1);const g=async()=>{try{const e=await fetch("/api/version"),{version:a}=await e.json(),l=parseInt(a),n=parseInt("1767902245739");return!isNaN(l)&&!isNaN(n)&&l>n?(console.warn("[App] New version available:",a,"current:","1767902245739","(server is newer)"),!0):(a!=="1767902245739"&&console.log("[App] Version mismatch but client is newer or equal:","server:",a,"client:","1767902245739"),!1)}catch(e){return console.error("[App] Failed to check for updates:",e),!1}};O(()=>{{sessionStorage.getItem("authExpired")==="true"&&(w(v,!0),setTimeout(()=>{w(v,!1),sessionStorage.removeItem("authExpired")},1e4));{const e=async()=>{await g()&&w(f,!0)};e();const a=setInterval(e,5*60*1e3);return()=>clearInterval(a)}}});const k=()=>{w(v,!1),sessionStorage.removeItem("authExpired")},q=async()=>{try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(a=>caches.delete(a))),console.log("[App] Cleared service worker caches")}}catch(e){console.error("[App] Failed to clear caches:",e)}finally{window.location.href=window.location.href}};V();var A=he();ee("12qhfyh",e=>{H(()=>{J.title=`Lehi31 | ${m()??""}`})});var i=N(A);{var h=e=>{var a=be(),l=d(T(a),4),n=d(l,2);U(a),S("click",l,q),S("click",n,()=>w(f,!1)),t(e,a)};y(i,e=>{x(f)&&e(h)})}var C=d(i,2);{var F=e=>{var a=ge(),l=d(T(a),4);U(a),S("click",l,k),t(e,a)};y(C,e=>{x(v)&&e(F)})}var $=d(C,2);de($,{});var p=d($,2);me(p,{});var _=d(p,2);X(_,r,"default",{}),t(b,A),P(),c()}export{Ue as component,Te as universal};
