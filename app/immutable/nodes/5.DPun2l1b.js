import{S as ve,i as he,s as ge,d as m,e as q,t as P,a as S,H as re,G as oe,m as B,h as D,n as W,l as O,W as se,q as z,p as L,A as Z,B as Ie,v as k,f as g,j as $,k as I,x as be,o as y,C as Y,a0 as ie,O as ke,r as ne,y as X,z as H}from"../chunks/nwXANin4.js";import"../chunks/IHki7fMi.js";import{P as De}from"../chunks/CD2zr40G.js";import{A as Me,E as Pe}from"../chunks/n8tr6h_f.js";import{g as Se,s as ce,e as Ae,A as Te,b as Ce,E as Ne,d as Ve}from"../chunks/D4ijUQOn.js";import{e as ae,u as Ee,o as $e}from"../chunks/CAfoy-Mx.js";import{g as Oe,F as Le}from"../chunks/Bt7UrgIT.js";import{d as x}from"../chunks/Du9eYGCx.js";import{S as Fe}from"../chunks/Da4JOgRV.js";import{D as Re,v as Ge}from"../chunks/CwnywY_P.js";import{p as U,s as Ue,f as j,U as je}from"../chunks/h7dItX6f.js";const qe=!0,_t=Object.freeze(Object.defineProperty({__proto__:null,prerender:qe},Symbol.toStringTag,{value:"Module"})),{Map:ye}=Ce;function fe(c,e,t){const l=c.slice();return l[24]=e[t],l}function ue(c,e,t){const l=c.slice();return l[27]=e[t],l}function Be(c){let e,t;return e=new Te({props:{eventItem:c[4],drawerId:c[0],name:"past-event-item-form"}}),{c(){z(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){B(e,l,s),t=!0},p(l,s){const a={};s&16&&(a.eventItem=l[4]),s&1&&(a.drawerId=l[0]),e.$set(a)},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){q(e,l)}}}function We(c){let e,t,l;return t=new Fe({}),{c(){e=y("div"),z(t.$$.fragment),this.h()},l(s){e=$(s,"DIV",{class:!0});var a=I(e);W(t.$$.fragment,a),a.forEach(m),this.h()},h(){g(e,"class","d-flex flex-column gap-4")},m(s,a){D(s,e,a),B(t,e,null),l=!0},p:Y,i(s){l||(S(t.$$.fragment,s),l=!0)},o(s){P(t.$$.fragment,s),l=!1},d(s){s&&m(e),q(t)}}}function ze(c){let e,t,l,s,a="Past Events",r,o,n,i,f,d=c[6]&&c[7]&&_e(c);const _=[Je,He],u=[];function h(v,b){return v[9].length?0:1}return n=h(c),i=u[n]=_[n](c),{c(){e=y("div"),t=y("div"),l=y("div"),s=y("span"),s.textContent=a,r=L(),d&&d.c(),o=L(),i.c(),this.h()},l(v){e=$(v,"DIV",{class:!0});var b=I(e);t=$(b,"DIV",{class:!0});var A=I(t);l=$(A,"DIV",{class:!0});var N=I(l);s=$(N,"SPAN",{"data-svelte-h":!0}),be(s)!=="svelte-15uqv9t"&&(s.textContent=a),r=O(N),d&&d.l(N),N.forEach(m),A.forEach(m),o=O(b),i.l(b),b.forEach(m),this.h()},h(){g(l,"class","d-flex justify-content-between align-items-center gap-3 flex-wrap"),g(t,"class","card-header"),g(e,"class","card")},m(v,b){D(v,e,b),k(e,t),k(t,l),k(l,s),k(l,r),d&&d.m(l,null),k(e,o),u[n].m(e,null),f=!0},p(v,b){v[6]&&v[7]?d?d.p(v,b):(d=_e(v),d.c(),d.m(l,null)):d&&(d.d(1),d=null);let A=n;n=h(v),n===A?u[n].p(v,b):(re(),P(u[A],1,1,()=>{u[A]=null}),oe(),i=u[n],i?i.p(v,b):(i=u[n]=_[n](v),i.c()),S(i,1),i.m(e,null))},i(v){f||(S(i),f=!0)},o(v){P(i),f=!1},d(v){v&&m(e),d&&d.d(),u[n].d()}}}function _e(c){let e,t,l;function s(o,n){return o[2]?Xe:Ke}let a=s(c),r=a(c);return{c(){e=y("button"),r.c(),this.h()},l(o){e=$(o,"BUTTON",{class:!0,type:!0});var n=I(e);r.l(n),n.forEach(m),this.h()},h(){g(e,"class","btn btn-sm btn-outline-danger"),g(e,"type","button"),e.disabled=c[2]},m(o,n){D(o,e,n),r.m(e,null),t||(l=ke(e,"click",c[16]),t=!0)},p(o,n){a===(a=s(o))&&r?r.p(o,n):(r.d(1),r=a(o),r&&(r.c(),r.m(e,null))),n&4&&(e.disabled=o[2])},d(o){o&&m(e),r.d(),t=!1,l()}}}function Ke(c){let e,t,l;return{c(){e=H("Delete Past Events ("),t=H(c[8]),l=H(")")},l(s){e=X(s,"Delete Past Events ("),t=X(s,c[8]),l=X(s,")")},m(s,a){D(s,e,a),D(s,t,a),D(s,l,a)},p(s,a){a&256&&ne(t,s[8])},d(s){s&&(m(e),m(t),m(l))}}}function Xe(c){let e;return{c(){e=H("Deleting…")},l(t){e=X(t,"Deleting…")},m(t,l){D(t,e,l)},p:Y,d(t){t&&m(e)}}}function He(c){let e,t="No past events available.";return{c(){e=y("div"),e.textContent=t,this.h()},l(l){e=$(l,"DIV",{class:!0,"data-svelte-h":!0}),be(e)!=="svelte-aczpuf"&&(e.textContent=t),this.h()},h(){g(e,"class","card-body text-muted small")},m(l,s){D(l,e,s)},p:Y,i:Y,o:Y,d(l){l&&m(e)}}}function Je(c){let e,t=[],l=new ye,s,a=ae(c[9]);const r=o=>o[24].key;for(let o=0;o<a.length;o+=1){let n=fe(c,a,o),i=r(n);l.set(i,t[o]=pe(i,n))}return{c(){e=y("ul");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=$(o,"UL",{class:!0});var n=I(e);for(let i=0;i<t.length;i+=1)t[i].l(n);n.forEach(m),this.h()},h(){g(e,"class","list-group list-group-flush border-top-0")},m(o,n){D(o,e,n);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null);s=!0},p(o,n){n&2563&&(a=ae(o[9]),re(),t=Ee(t,n,r,1,o,a,l,e,$e,pe,null,fe),oe())},i(o){if(!s){for(let n=0;n<a.length;n+=1)S(t[n]);s=!0}},o(o){for(let n=0;n<t.length;n+=1)P(t[n]);s=!1},d(o){o&&m(e);for(let n=0;n<t.length;n+=1)t[n].d()}}}function de(c){let e,t,l,s,a,r;function o(){return c[17](c[27])}return{c(){e=y("div"),t=y("button"),l=y("i"),this.h()},l(n){e=$(n,"DIV",{class:!0});var i=I(e);t=$(i,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var f=I(t);l=$(f,"I",{class:!0}),I(l).forEach(m),f.forEach(m),i.forEach(m),this.h()},h(){g(l,"class","bi bi-pencil-square"),g(t,"class","btn btn-sm btn-primary"),g(t,"type","button"),g(t,"data-bs-toggle","offcanvas"),g(t,"data-bs-target",s="#"+c[0]),g(t,"aria-controls",c[0]),g(e,"class","event-actions svelte-kxknx")},m(n,i){D(n,e,i),k(e,t),k(t,l),a||(r=ke(t,"click",o),a=!0)},p(n,i){c=n,i&1&&s!==(s="#"+c[0])&&g(t,"data-bs-target",s),i&1&&g(t,"aria-controls",c[0])},d(n){n&&m(e),a=!1,r()}}}function me(c,e){let t,l,s,a,r=j(U(e[27].start_time??""),"EEE")+"",o,n,i,f=j(U(e[27].start_time??""),"MMM d")+"",d,_,u,h,v,b,A,N,F;b=new Ne({props:{item:e[27],showDate:!1}});let w=e[1]&&de(e);return{key:c,first:null,c(){t=y("li"),l=y("div"),s=y("div"),a=y("strong"),o=H(r),n=L(),i=y("small"),d=H(f),_=L(),u=y("div"),h=y("div"),v=y("div"),z(b.$$.fragment),A=L(),w&&w.c(),N=L(),this.h()},l(M){t=$(M,"LI",{class:!0});var T=I(t);l=$(T,"DIV",{class:!0});var V=I(l);s=$(V,"DIV",{class:!0});var R=I(s);a=$(R,"STRONG",{});var ee=I(a);o=X(ee,r),ee.forEach(m),n=O(R),i=$(R,"SMALL",{class:!0});var te=I(i);d=X(te,f),te.forEach(m),R.forEach(m),_=O(V),u=$(V,"DIV",{class:!0});var p=I(u);h=$(p,"DIV",{class:!0});var C=I(h);v=$(C,"DIV",{class:!0});var E=I(v);W(b.$$.fragment,E),E.forEach(m),A=O(C),w&&w.l(C),C.forEach(m),p.forEach(m),V.forEach(m),N=O(T),T.forEach(m),this.h()},h(){g(i,"class","text-muted"),g(s,"class","event-date-column d-flex flex-column align-items-start text-nowrap svelte-kxknx"),g(v,"class","event-content svelte-kxknx"),g(h,"class","daily-event-row svelte-kxknx"),g(u,"class","d-flex flex-column gap-3 flex-grow-1"),g(l,"class","d-flex flex-column flex-md-row gap-3"),g(t,"class","list-group-item py-3"),this.first=t},m(M,T){D(M,t,T),k(t,l),k(l,s),k(s,a),k(a,o),k(s,n),k(s,i),k(i,d),k(l,_),k(l,u),k(u,h),k(h,v),B(b,v,null),k(h,A),w&&w.m(h,null),k(t,N),F=!0},p(M,T){e=M,(!F||T&512)&&r!==(r=j(U(e[27].start_time??""),"EEE")+"")&&ne(o,r),(!F||T&512)&&f!==(f=j(U(e[27].start_time??""),"MMM d")+"")&&ne(d,f);const V={};T&512&&(V.item=e[27]),b.$set(V),e[1]?w?w.p(e,T):(w=de(e),w.c(),w.m(h,null)):w&&(w.d(1),w=null)},i(M){F||(S(b.$$.fragment,M),F=!0)},o(M){P(b.$$.fragment,M),F=!1},d(M){M&&m(t),q(b),w&&w.d()}}}function pe(c,e){let t,l=e[24].label+"",s,a,r=[],o=new ye,n,i,f=ae(e[24].events);const d=_=>_[27].id??_[27].start_time;for(let _=0;_<f.length;_+=1){let u=ue(e,f,_),h=d(u);o.set(h,r[_]=me(h,u))}return{key:c,first:null,c(){t=y("li"),s=H(l),a=L();for(let _=0;_<r.length;_+=1)r[_].c();n=se(),this.h()},l(_){t=$(_,"LI",{class:!0});var u=I(t);s=X(u,l),u.forEach(m),a=O(_);for(let h=0;h<r.length;h+=1)r[h].l(_);n=se(),this.h()},h(){g(t,"class","list-group-item list-group-item-light text-uppercase small fw-semibold"),this.first=t},m(_,u){D(_,t,u),k(t,s),D(_,a,u);for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(_,u);D(_,n,u),i=!0},p(_,u){e=_,(!i||u&512)&&l!==(l=e[24].label+"")&&ne(s,l),u&2563&&(f=ae(e[24].events),re(),r=Ee(r,u,d,1,e,f,o,n.parentNode,$e,me,n,ue),oe())},i(_){if(!i){for(let u=0;u<f.length;u+=1)S(r[u]);i=!0}},o(_){for(let u=0;u<r.length;u+=1)P(r[u]);i=!1},d(_){_&&(m(t),m(a),m(n));for(let u=0;u<r.length;u+=1)r[u].d(_)}}}function Qe(c){let e,t,l,s,a,r;e=new Re({props:{title:c[3],id:c[0],$$slots:{default:[Be]},$$scope:{ctx:c}}});const o=[ze,We],n=[];function i(f,d){return f[5]?0:1}return l=i(c),s=n[l]=o[l](c),{c(){z(e.$$.fragment),t=L(),s.c(),a=se()},l(f){W(e.$$.fragment,f),t=O(f),s.l(f),a=se()},m(f,d){B(e,f,d),D(f,t,d),n[l].m(f,d),D(f,a,d),r=!0},p(f,[d]){const _={};d&8&&(_.title=f[3]),d&1&&(_.id=f[0]),d&1073741841&&(_.$$scope={dirty:d,ctx:f}),e.$set(_);let u=l;l=i(f),l===u?n[l].p(f,d):(re(),P(n[u],1,1,()=>{n[u]=null}),oe(),s=n[l],s?s.p(f,d):(s=n[l]=o[l](f),s.c()),S(s,1),s.m(a.parentNode,a))},i(f){r||(S(e.$$.fragment,f),S(s),r=!0)},o(f){P(e.$$.fragment,f),P(s),r=!1},d(f){f&&(m(t),m(a)),q(e,f),n[l].d(f)}}}function Ye(c,e,t){let l,s,a,r,o;const{actions:{featureIsEnabled:n},stores:{currentUser:i}}=Oe(),{stores:{ready:f,dbData:d},actions:{reload:_}}=Se();Z(c,f,p=>t(5,l=p));const u={title:"Event",description:"",location:"",event_type:"calendar_event"};let{formId:h=Ge()}=e,v=!1,b=!1,A="",N={...u};const F=p=>{t(3,A="Event Item"),t(4,N={...p,category:p?.meta_data?.category})},w=x(d,p=>{const C=ce();return(p??[]).filter(E=>E.event_type!=="calendar_event"||!E.start_time?!1:U(E.start_time)<C)}),M=x(w,p=>p.length);Z(c,M,p=>t(8,r=p));const T=x(w,p=>{const C=new Map;for(const E of p){if(!E.start_time)continue;const G=U(E.start_time),K=Ue(G,{weekStartsOn:1}),J=j(K,"yyyy-MM-dd"),le=`${j(K,"EEE MMM d")} – ${j(Ae(K,{weekStartsOn:1}),"EEE MMM d, yyyy")}`;let Q=C.get(J);Q||(Q={key:J,label:le,events:[]},C.set(J,Q)),Q.events.push(E)}return Array.from(C.values()).sort((E,G)=>E.key<G.key?1:-1).map(E=>({...E,events:E.events.slice().sort((G,K)=>{const J=G.is_all_day?0:1,le=K.is_all_day?0:1;if(J!==le)return J-le;const Q=G.start_time?U(G.start_time).getTime():Number.MAX_SAFE_INTEGER,we=K.start_time?U(K.start_time).getTime():Number.MAX_SAFE_INTEGER;return Q-we})}))});Z(c,T,p=>t(9,o=p));const V=x(i,p=>p.role===je.Root);Z(c,V,p=>t(6,s=p));const R=x(w,p=>p.length>0);Z(c,R,p=>t(7,a=p));const ee=async()=>{if(!v||b||!ie(V)||!ie(R))return;const p=ce(),C=j(p,"MMM d, yyyy");if(confirm(`Delete all events that occurred before ${C}?`)){t(2,b=!0);try{const E=await Ve(p);await _(),E>0?alert(`Deleted ${E} past event${E===1?"":"s"}.`):alert("No past events to delete.")}catch(E){console.error("Failed to delete past events",E),alert("Failed to delete past events. Please try again.")}finally{t(2,b=!1)}}};Ie(async()=>{t(1,v=n(Le.EditDBCalendarEvent)),await _()});const te=p=>F(p);return c.$$set=p=>{"formId"in p&&t(0,h=p.formId)},[h,v,b,A,N,l,s,a,r,o,f,F,M,T,V,R,ee,te]}class Ze extends ve{constructor(e){super(),he(this,e,Ye,Qe,ge,{formId:0})}}function xe(c){let e,t,l,s,a,r,o;return t=new Me({}),s=new Pe({}),r=new Ze({}),{c(){e=y("div"),z(t.$$.fragment),l=L(),z(s.$$.fragment),a=L(),z(r.$$.fragment),this.h()},l(n){e=$(n,"DIV",{class:!0});var i=I(e);W(t.$$.fragment,i),l=O(i),W(s.$$.fragment,i),a=O(i),W(r.$$.fragment,i),i.forEach(m),this.h()},h(){g(e,"class","d-flex flex-column gap-4")},m(n,i){D(n,e,i),B(t,e,null),k(e,l),B(s,e,null),k(e,a),B(r,e,null),o=!0},p:Y,i(n){o||(S(t.$$.fragment,n),S(s.$$.fragment,n),S(r.$$.fragment,n),o=!0)},o(n){P(t.$$.fragment,n),P(s.$$.fragment,n),P(r.$$.fragment,n),o=!1},d(n){n&&m(e),q(t),q(s),q(r)}}}function et(c){let e,t;return e=new De({props:{pageTitle:"Announcements & Events",$$slots:{default:[xe]},$$scope:{ctx:c}}}),{c(){z(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){B(e,l,s),t=!0},p(l,[s]){const a={};s&1&&(a.$$scope={dirty:s,ctx:l}),e.$set(a)},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){q(e,l)}}}class dt extends ve{constructor(e){super(),he(this,e,null,et,ge,{})}}export{dt as component,_t as universal};
