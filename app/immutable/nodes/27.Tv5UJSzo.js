import{s as rt,n as Ie,d as i,D as Ne,y as Ye,G as Fe,z as _e,a as ne,i as K,b as n,A as ce,p as a,H as dt,c as f,e as b,w as re,g as A,f as j,h as d,j as N,t as F,k as Ae,r as vt,K as ht,M as lt,x as nt}from"../chunks/pH736Kvp.js";import{S as ot,i as at,d as Ge,t as Pe,a as Ue,m as Ke,c as qe,b as Qe,g as $t,e as el}from"../chunks/THtqwFCh.js";import{e as be}from"../chunks/B0tmKvdH.js";import{P as tl}from"../chunks/CwG9T8t-.js";import{O as Tt,g as Zt,i as ll,j as sl,k as nl,r as rl,l as ol,P as al}from"../chunks/Q_p5oESd.js";import{u as il}from"../chunks/YFl7ySEM.js";import{g as cl}from"../chunks/C_DKLa2h.js";import{D as xt}from"../chunks/CghRhIDj.js";import{f as ul,g as fl,h as dl,e as hl,p as _l,i as ml,j as vl,r as pl,k as bl,m as gl,n as El}from"../chunks/TBGC1Dub.js";function Ct(s,e,t){const l=s.slice();return l[26]=e[t],l}function Dt(s,e,t){const l=s.slice();return l[29]=e[t],l}function wt(s,e,t){const l=s.slice();return l[29]=e[t],l}function yt(s,e,t){const l=s.slice();return l[34]=e[t],l}function It(s,e,t){const l=s.slice();return l[37]=e[t],l}function Ot(s){let e,t,l,r,o,h;return{c(){e=d("div"),t=F(s[4]),l=N(),r=d("button"),this.h()},l(u){e=f(u,"DIV",{class:!0,role:!0});var c=b(e);t=j(c,s[4]),l=A(c),r=f(c,"BUTTON",{type:!0,class:!0,"aria-label":!0}),b(r).forEach(i),c.forEach(i),this.h()},h(){a(r,"type","button"),a(r,"class","btn-close"),a(r,"aria-label","Close"),a(e,"class","alert alert-danger alert-dismissible fade show"),a(e,"role","alert")},m(u,c){K(u,e,c),n(e,t),n(e,l),n(e,r),o||(h=ce(r,"click",s[17]),o=!0)},p(u,c){c[0]&16&&ne(t,u[4])},d(u){u&&i(e),o=!1,h()}}}function Lt(s){let e,t=(s[37].display_name||s[37].email)+"",l,r,o=s[37].email+"",h,u,c;return{c(){e=d("option"),l=F(t),r=F(" ("),h=F(o),u=F(`)
							`),this.h()},l(_){e=f(_,"OPTION",{});var p=b(e);l=j(p,t),r=j(p," ("),h=j(p,o),u=j(p,`)
							`),p.forEach(i),this.h()},h(){e.__value=c=s[37].id,_e(e,e.__value)},m(_,p){K(_,e,p),n(e,l),n(e,r),n(e,h),n(e,u)},p(_,p){p[0]&1024&&t!==(t=(_[37].display_name||_[37].email)+"")&&ne(l,t),p[0]&1024&&o!==(o=_[37].email+"")&&ne(h,o),p[0]&1024&&c!==(c=_[37].id)&&(e.__value=c,_e(e,e.__value))},d(_){_&&i(e)}}}function At(s){let e,t=s[34].name+"",l,r;return{c(){e=d("option"),l=F(t),this.h()},l(o){e=f(o,"OPTION",{});var h=b(e);l=j(h,t),h.forEach(i),this.h()},h(){e.__value=r=s[34].id,_e(e,e.__value)},m(o,h){K(o,e,h),n(e,l)},p(o,h){h[0]&260&&t!==(t=o[34].name+"")&&ne(l,t),h[0]&260&&r!==(r=o[34].id)&&(e.__value=r,_e(e,e.__value))},d(o){o&&i(e)}}}function Nt(s){let e,t,l=be(s[2][s[29]]),r=[];for(let o=0;o<l.length;o+=1)r[o]=At(yt(s,l,o));return{c(){e=d("optgroup");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=f(o,"OPTGROUP",{label:!0});var h=b(e);for(let u=0;u<r.length;u+=1)r[u].l(h);h.forEach(i),this.h()},h(){a(e,"label",t=mt(s[29]))},m(o,h){K(o,e,h);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null)},p(o,h){if(h[0]&260){l=be(o[2][o[29]]);let u;for(u=0;u<l.length;u+=1){const c=yt(o,l,u);r[u]?r[u].p(c,h):(r[u]=At(c),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=l.length}h[0]&256&&t!==(t=mt(o[29]))&&a(e,"label",t)},d(o){o&&i(e),Ne(r,o)}}}function Rt(s){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0,role:!0}),b(e).forEach(i),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,l){K(t,e,l)},d(t){t&&i(e)}}}function St(s){let e,t=mt(s[29])+"",l;return{c(){e=d("option"),l=F(t),this.h()},l(r){e=f(r,"OPTION",{});var o=b(e);l=j(o,t),o.forEach(i),this.h()},h(){e.__value=s[29],_e(e,e.__value)},m(r,o){K(r,e,o),n(e,l)},p:Ie,d(r){r&&i(e)}}}function kl(s){let e,t,l,r='<tr><th scope="col" class="svelte-1h4f1is">Name</th> <th scope="col" class="d-none d-md-table-cell svelte-1h4f1is">Email</th> <th scope="col" class="svelte-1h4f1is">Role</th> <th scope="col" class="d-none d-lg-table-cell svelte-1h4f1is">Organization</th> <th scope="col" class="d-none d-lg-table-cell svelte-1h4f1is">Assigned Date</th> <th scope="col" class="d-none d-xl-table-cell svelte-1h4f1is">Notes</th> <th scope="col" class="text-end svelte-1h4f1is">Actions</th></tr>',o,h,u=be(s[9]),c=[];for(let _=0;_<u.length;_+=1)c[_]=Vt(Ct(s,u,_));return{c(){e=d("div"),t=d("table"),l=d("thead"),l.innerHTML=r,o=N(),h=d("tbody");for(let _=0;_<c.length;_+=1)c[_].c();this.h()},l(_){e=f(_,"DIV",{class:!0});var p=b(e);t=f(p,"TABLE",{class:!0});var m=b(t);l=f(m,"THEAD",{"data-svelte-h":!0}),re(l)!=="svelte-1wg3omm"&&(l.innerHTML=r),o=A(m),h=f(m,"TBODY",{class:!0});var k=b(h);for(let U=0;U<c.length;U+=1)c[U].l(k);k.forEach(i),m.forEach(i),p.forEach(i),this.h()},h(){a(h,"class","table-group-divider"),a(t,"class","table table-hover align-middle svelte-1h4f1is"),a(e,"class","table-responsive")},m(_,p){K(_,e,p),n(e,t),n(t,l),n(t,o),n(t,h);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(h,null)},p(_,p){if(p[0]&33288){u=be(_[9]);let m;for(m=0;m<u.length;m+=1){const k=Ct(_,u,m);c[m]?c[m].p(k,p):(c[m]=Vt(k),c[m].c(),c[m].m(h,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=u.length}},d(_){_&&i(e),Ne(c,_)}}}function Tl(s){let e,t,l=s[1]!=="all"&&Pt();return{c(){e=d("div"),t=F(`No active role assignments found.
			`),l&&l.c(),this.h()},l(r){e=f(r,"DIV",{class:!0});var o=b(e);t=j(o,`No active role assignments found.
			`),l&&l.l(o),o.forEach(i),this.h()},h(){a(e,"class","alert alert-info")},m(r,o){K(r,e,o),n(e,t),l&&l.m(e,null)},p(r,o){r[1]!=="all"?l||(l=Pt(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(r){r&&i(e),l&&l.d()}}}function Cl(s){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-mlx3u2"&&(e.innerHTML=t),this.h()},h(){a(e,"class","text-center py-5")},m(l,r){K(l,e,r)},p:Ie,d(l){l&&i(e)}}}function Vt(s){let e,t,l,r=(s[26].user?.display_name||"Unknown")+"",o,h,u,c=(s[26].user?.email||"N/A")+"",_,p,m,k,U=(s[26].user?.email||"N/A")+"",y,V,v,g,R=s[26].roleName+"",I,E,C,L,T=st(s[26].roleOrganization)+"",P,M,D,q,Y=st(s[26].roleOrganization)+"",w,x,X,W,oe=new Date(s[26].assigned_date).toLocaleDateString()+"",ie,fe,ee,H,O=(s[26].notes||"—")+"",$,G,ae,J,te,le,Q,B;function ue(){return s[22](s[26])}return{c(){e=d("tr"),t=d("td"),l=d("div"),o=F(r),h=N(),u=d("small"),_=F(c),p=N(),m=d("td"),k=d("small"),y=F(U),V=N(),v=d("td"),g=d("strong"),I=F(R),E=N(),C=d("div"),L=d("span"),P=F(T),M=N(),D=d("td"),q=d("span"),w=F(Y),x=N(),X=d("td"),W=d("small"),ie=F(oe),fe=N(),ee=d("td"),H=d("small"),$=F(O),G=N(),ae=d("td"),J=d("button"),te=d("i"),le=N(),this.h()},l(me){e=f(me,"TR",{});var Z=b(e);t=f(Z,"TD",{});var ke=b(t);l=f(ke,"DIV",{class:!0});var ge=b(l);o=j(ge,r),ge.forEach(i),h=A(ke),u=f(ke,"SMALL",{class:!0});var Te=b(u);_=j(Te,c),Te.forEach(i),ke.forEach(i),p=A(Z),m=f(Z,"TD",{class:!0});var De=b(m);k=f(De,"SMALL",{class:!0});var ze=b(k);y=j(ze,U),ze.forEach(i),De.forEach(i),V=A(Z),v=f(Z,"TD",{});var Re=b(v);g=f(Re,"STRONG",{});var Se=b(g);I=j(Se,R),Se.forEach(i),E=A(Re),C=f(Re,"DIV",{class:!0});var Me=b(C);L=f(Me,"SPAN",{class:!0});var Be=b(L);P=j(Be,T),Be.forEach(i),Me.forEach(i),Re.forEach(i),M=A(Z),D=f(Z,"TD",{class:!0});var He=b(D);q=f(He,"SPAN",{class:!0});var Xe=b(q);w=j(Xe,Y),Xe.forEach(i),He.forEach(i),x=A(Z),X=f(Z,"TD",{class:!0});var ve=b(X);W=f(ve,"SMALL",{});var Oe=b(W);ie=j(Oe,oe),Oe.forEach(i),ve.forEach(i),fe=A(Z),ee=f(Z,"TD",{class:!0});var de=b(ee);H=f(de,"SMALL",{class:!0});var Le=b(H);$=j(Le,O),Le.forEach(i),de.forEach(i),G=A(Z),ae=f(Z,"TD",{class:!0});var he=b(ae);J=f(he,"BUTTON",{class:!0});var pe=b(J);te=f(pe,"I",{class:!0}),b(te).forEach(i),pe.forEach(i),he.forEach(i),le=A(Z),Z.forEach(i),this.h()},h(){a(l,"class","fw-semibold"),a(u,"class","d-md-none text-muted d-block"),a(k,"class","text-muted"),a(m,"class","d-none d-md-table-cell"),a(L,"class","badge bg-info"),a(C,"class","d-lg-none mt-1"),a(q,"class","badge bg-info"),a(D,"class","d-none d-lg-table-cell"),a(X,"class","d-none d-lg-table-cell"),a(H,"class","text-muted"),a(ee,"class","d-none d-xl-table-cell"),a(te,"class","bi bi-x-circle"),a(J,"class","btn btn-sm btn-outline-danger"),J.disabled=s[3],a(ae,"class","text-end")},m(me,Z){K(me,e,Z),n(e,t),n(t,l),n(l,o),n(t,h),n(t,u),n(u,_),n(e,p),n(e,m),n(m,k),n(k,y),n(e,V),n(e,v),n(v,g),n(g,I),n(v,E),n(v,C),n(C,L),n(L,P),n(e,M),n(e,D),n(D,q),n(q,w),n(e,x),n(e,X),n(X,W),n(W,ie),n(e,fe),n(e,ee),n(ee,H),n(H,$),n(e,G),n(e,ae),n(ae,J),n(J,te),n(e,le),Q||(B=ce(J,"click",ue),Q=!0)},p(me,Z){s=me,Z[0]&512&&r!==(r=(s[26].user?.display_name||"Unknown")+"")&&ne(o,r),Z[0]&512&&c!==(c=(s[26].user?.email||"N/A")+"")&&ne(_,c),Z[0]&512&&U!==(U=(s[26].user?.email||"N/A")+"")&&ne(y,U),Z[0]&512&&R!==(R=s[26].roleName+"")&&ne(I,R),Z[0]&512&&T!==(T=st(s[26].roleOrganization)+"")&&ne(P,T),Z[0]&512&&Y!==(Y=st(s[26].roleOrganization)+"")&&ne(w,Y),Z[0]&512&&oe!==(oe=new Date(s[26].assigned_date).toLocaleDateString()+"")&&ne(ie,oe),Z[0]&512&&O!==(O=(s[26].notes||"—")+"")&&ne($,O),Z[0]&8&&(J.disabled=s[3])},d(me){me&&i(e),Q=!1,B()}}}function Pt(s){let e;return{c(){e=F("Try selecting a different organization.")},l(t){e=j(t,"Try selecting a different organization.")},m(t,l){K(t,e,l)},d(t){t&&i(e)}}}function Dl(s){let e,t,l,r="Role Assignments",o,h,u,c,_,p,m,k,U='<h5 class="mb-0">Assign New Role</h5>',y,V,v,g,R,I="Select User",E,C,L,T="Choose a user...",P,M,D,q="Select Role",Y,w,x,X="Choose a role...",W,oe,ie,fe="Notes (Optional)",ee,H,O,$,G,ae,J,te,le,Q,B,ue,me="All Organizations",Z,ke,ge,Te,De=s[9].length+"",ze,Re,Se=s[9].length!==1?"s":"",Me,Be,He,Xe,ve=s[4]&&Ot(s),Oe=be(s[10]),de=[];for(let S=0;S<Oe.length;S+=1)de[S]=Lt(It(s,Oe,S));let Le=be(s[8]),he=[];for(let S=0;S<Le.length;S+=1)he[S]=Nt(wt(s,Le,S));let pe=s[3]&&Rt(),je=be(Object.values(Tt)),Ee=[];for(let S=0;S<je.length;S+=1)Ee[S]=St(Dt(s,je,S));function pt(S,se){return S[3]&&S[0].length===0?Cl:S[9].length===0?Tl:kl}let We=pt(s),we=We(s);return{c(){e=d("div"),t=d("div"),l=d("h2"),l.textContent=r,o=N(),h=d("button"),u=d("i"),c=F(" Refresh"),_=N(),ve&&ve.c(),p=N(),m=d("div"),k=d("div"),k.innerHTML=U,y=N(),V=d("div"),v=d("div"),g=d("div"),R=d("label"),R.textContent=I,E=N(),C=d("select"),L=d("option"),L.textContent=T;for(let S=0;S<de.length;S+=1)de[S].c();P=N(),M=d("div"),D=d("label"),D.textContent=q,Y=N(),w=d("select"),x=d("option"),x.textContent=X;for(let S=0;S<he.length;S+=1)he[S].c();W=N(),oe=d("div"),ie=d("label"),ie.textContent=fe,ee=N(),H=d("input"),O=N(),$=d("div"),G=d("button"),pe&&pe.c(),ae=F(`
						Assign Role`),te=N(),le=d("div"),Q=d("div"),B=d("select"),ue=d("option"),ue.textContent=me;for(let S=0;S<Ee.length;S+=1)Ee[S].c();Z=N(),ke=d("div"),ge=d("div"),Te=F("Showing "),ze=F(De),Re=F(" active role"),Me=F(Se),Be=N(),we.c(),this.h()},l(S){e=f(S,"DIV",{class:!0});var se=b(e);t=f(se,"DIV",{class:!0});var z=b(t);l=f(z,"H2",{"data-svelte-h":!0}),re(l)!=="svelte-1xkrq8g"&&(l.textContent=r),o=A(z),h=f(z,"BUTTON",{class:!0});var Ce=b(h);u=f(Ce,"I",{class:!0}),b(u).forEach(i),c=j(Ce," Refresh"),Ce.forEach(i),z.forEach(i),_=A(se),ve&&ve.l(se),p=A(se),m=f(se,"DIV",{class:!0});var Ze=b(m);k=f(Ze,"DIV",{class:!0,"data-svelte-h":!0}),re(k)!=="svelte-1dkbtll"&&(k.innerHTML=U),y=A(Ze),V=f(Ze,"DIV",{class:!0});var bt=b(V);v=f(bt,"DIV",{class:!0});var Ve=b(v);g=f(Ve,"DIV",{class:!0});var xe=b(g);R=f(xe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(R)!=="svelte-1s8xk4p"&&(R.textContent=I),E=A(xe),C=f(xe,"SELECT",{id:!0,class:!0});var it=b(C);L=f(it,"OPTION",{"data-svelte-h":!0}),re(L)!=="svelte-kua526"&&(L.textContent=T);for(let ye=0;ye<de.length;ye+=1)de[ye].l(it);it.forEach(i),xe.forEach(i),P=A(Ve),M=f(Ve,"DIV",{class:!0});var $e=b(M);D=f($e,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(D)!=="svelte-rwhvvv"&&(D.textContent=q),Y=A($e),w=f($e,"SELECT",{id:!0,class:!0});var ct=b(w);x=f(ct,"OPTION",{"data-svelte-h":!0}),re(x)!=="svelte-1fatopy"&&(x.textContent=X);for(let ye=0;ye<he.length;ye+=1)he[ye].l(ct);ct.forEach(i),$e.forEach(i),W=A(Ve),oe=f(Ve,"DIV",{class:!0});var et=b(oe);ie=f(et,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(ie)!=="svelte-vpme2u"&&(ie.textContent=fe),ee=A(et),H=f(et,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),et.forEach(i),O=A(Ve),$=f(Ve,"DIV",{class:!0});var gt=b($);G=f(gt,"BUTTON",{class:!0});var ut=b(G);pe&&pe.l(ut),ae=j(ut,`
						Assign Role`),ut.forEach(i),gt.forEach(i),Ve.forEach(i),bt.forEach(i),Ze.forEach(i),te=A(se),le=f(se,"DIV",{class:!0});var tt=b(le);Q=f(tt,"DIV",{class:!0});var Et=b(Q);B=f(Et,"SELECT",{class:!0});var ft=b(B);ue=f(ft,"OPTION",{"data-svelte-h":!0}),re(ue)!=="svelte-1vw7buo"&&(ue.textContent=me);for(let ye=0;ye<Ee.length;ye+=1)Ee[ye].l(ft);ft.forEach(i),Et.forEach(i),Z=A(tt),ke=f(tt,"DIV",{class:!0});var kt=b(ke);ge=f(kt,"DIV",{class:!0});var Je=b(ge);Te=j(Je,"Showing "),ze=j(Je,De),Re=j(Je," active role"),Me=j(Je,Se),Je.forEach(i),kt.forEach(i),tt.forEach(i),Be=A(se),we.l(se),se.forEach(i),this.h()},h(){a(u,"class","bi bi-arrow-clockwise"),a(h,"class","btn btn-primary"),h.disabled=s[3],a(t,"class","d-flex justify-content-between align-items-center mb-4"),a(k,"class","card-header svelte-1h4f1is"),a(R,"for","user-select"),a(R,"class","form-label"),L.__value=null,_e(L,L.__value),a(C,"id","user-select"),a(C,"class","form-select"),C.disabled=s[3],s[5]===void 0&&dt(()=>s[18].call(C)),a(g,"class","col-md-4"),a(D,"for","role-select"),a(D,"class","form-label"),x.__value="",_e(x,x.__value),a(w,"id","role-select"),a(w,"class","form-select"),w.disabled=s[3],s[6]===void 0&&dt(()=>s[19].call(w)),a(M,"class","col-md-4"),a(ie,"for","notes-input"),a(ie,"class","form-label"),a(H,"id","notes-input"),a(H,"type","text"),a(H,"class","form-control"),a(H,"placeholder","Assignment notes..."),H.disabled=s[3],a(oe,"class","col-md-4"),a(G,"class","btn btn-success"),G.disabled=J=s[3]||!s[5]||!s[6],a($,"class","col-12"),a(v,"class","row g-3"),a(V,"class","card-body"),a(m,"class","card mb-4"),ue.__value="all",_e(ue,ue.__value),a(B,"class","form-select"),s[1]===void 0&&dt(()=>s[21].call(B)),a(Q,"class","col-md-4"),a(ge,"class","text-muted mt-2"),a(ke,"class","col-md-8"),a(le,"class","row mb-3"),a(e,"class","role-assignment svelte-1h4f1is")},m(S,se){K(S,e,se),n(e,t),n(t,l),n(t,o),n(t,h),n(h,u),n(h,c),n(e,_),ve&&ve.m(e,null),n(e,p),n(e,m),n(m,k),n(m,y),n(m,V),n(V,v),n(v,g),n(g,R),n(g,E),n(g,C),n(C,L);for(let z=0;z<de.length;z+=1)de[z]&&de[z].m(C,null);Fe(C,s[5],!0),n(v,P),n(v,M),n(M,D),n(M,Y),n(M,w),n(w,x);for(let z=0;z<he.length;z+=1)he[z]&&he[z].m(w,null);Fe(w,s[6],!0),n(v,W),n(v,oe),n(oe,ie),n(oe,ee),n(oe,H),_e(H,s[7]),n(v,O),n(v,$),n($,G),pe&&pe.m(G,null),n(G,ae),n(e,te),n(e,le),n(le,Q),n(Q,B),n(B,ue);for(let z=0;z<Ee.length;z+=1)Ee[z]&&Ee[z].m(B,null);Fe(B,s[1],!0),n(le,Z),n(le,ke),n(ke,ge),n(ge,Te),n(ge,ze),n(ge,Re),n(ge,Me),n(e,Be),we.m(e,null),He||(Xe=[ce(h,"click",s[13]),ce(C,"change",s[18]),ce(w,"change",s[19]),ce(H,"input",s[20]),ce(G,"click",s[14]),ce(B,"change",s[21])],He=!0)},p(S,se){if(se[0]&8&&(h.disabled=S[3]),S[4]?ve?ve.p(S,se):(ve=Ot(S),ve.c(),ve.m(e,p)):ve&&(ve.d(1),ve=null),se[0]&1024){Oe=be(S[10]);let z;for(z=0;z<Oe.length;z+=1){const Ce=It(S,Oe,z);de[z]?de[z].p(Ce,se):(de[z]=Lt(Ce),de[z].c(),de[z].m(C,null))}for(;z<de.length;z+=1)de[z].d(1);de.length=Oe.length}if(se[0]&8&&(C.disabled=S[3]),se[0]&1056&&Fe(C,S[5]),se[0]&260){Le=be(S[8]);let z;for(z=0;z<Le.length;z+=1){const Ce=wt(S,Le,z);he[z]?he[z].p(Ce,se):(he[z]=Nt(Ce),he[z].c(),he[z].m(w,null))}for(;z<he.length;z+=1)he[z].d(1);he.length=Le.length}if(se[0]&8&&(w.disabled=S[3]),se[0]&324&&Fe(w,S[6]),se[0]&8&&(H.disabled=S[3]),se[0]&128&&H.value!==S[7]&&_e(H,S[7]),S[3]?pe||(pe=Rt(),pe.c(),pe.m(G,ae)):pe&&(pe.d(1),pe=null),se[0]&1388&&J!==(J=S[3]||!S[5]||!S[6])&&(G.disabled=J),se&0){je=be(Object.values(Tt));let z;for(z=0;z<je.length;z+=1){const Ce=Dt(S,je,z);Ee[z]?Ee[z].p(Ce,se):(Ee[z]=St(Ce),Ee[z].c(),Ee[z].m(B,null))}for(;z<Ee.length;z+=1)Ee[z].d(1);Ee.length=je.length}se[0]&2&&Fe(B,S[1]),se[0]&512&&De!==(De=S[9].length+"")&&ne(ze,De),se[0]&512&&Se!==(Se=S[9].length!==1?"s":"")&&ne(Me,Se),We===(We=pt(S))&&we?we.p(S,se):(we.d(1),we=We(S),we&&(we.c(),we.m(e,null)))},i:Ie,o:Ie,d(S){S&&i(e),ve&&ve.d(),Ne(de,S),Ne(he,S),pe&&pe.d(),Ne(Ee,S),we.d(),He=!1,Ye(Xe)}}}function mt(s){return s.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function st(s){return s?s.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Unknown"}function wl(s,e,t){let l,r,o,h,u,c;const{stores:_,actions:p}=il,{users:m}=_;Ae(s,m,w=>t(10,c=w));const{stores:{currentUser:k}}=Zt();Ae(s,k,w=>t(23,u=w));let U=[],y=!1,V=null,v=null,g="",R="",I="all";vt(async()=>{await p.fetchUsers(),await E()});async function E(){t(3,y=!0),t(4,V=null);try{const w=await ll();t(0,U=w.map(x=>{const X=c.find(oe=>oe.id===x.user_id),W=x.roles;return{...x,user:X,roleName:W?.name||String(x.role_id),roleOrganization:W?.organization}}))}catch(w){t(4,V=w instanceof Error?w.message:"Failed to load roles")}finally{t(3,y=!1)}}async function C(){if(!v||!g){t(4,V="Please select both a user and a role");return}if(!u?.id){t(4,V="Unable to determine current user. Please refresh and try again.");return}t(3,y=!0),t(4,V=null);try{const w=await ol(v,g,u.id,R||void 0);w.success?(t(5,v=null),t(6,g=""),t(7,R=""),await E()):t(4,V=w.error||"Failed to assign role")}catch(w){t(4,V=w instanceof Error?w.message:"Failed to assign role")}finally{t(3,y=!1)}}async function L(w){if(confirm("Are you sure you want to release this role?")){t(3,y=!0),t(4,V=null);try{const x=await rl(w);x.success?await E():t(4,V=x.error||"Failed to release role")}catch(x){t(4,V=x instanceof Error?x.message:"Failed to release role")}finally{t(3,y=!1)}}}const T=()=>t(4,V=null);function P(){v=ht(this),t(5,v)}function M(){g=ht(this),t(6,g),t(2,o),t(16,r),t(8,h),t(2,o),t(16,r)}function D(){R=this.value,t(7,R)}function q(){I=ht(this),t(1,I)}const Y=w=>L(w.id);return s.$$.update=()=>{s.$$.dirty[0]&3&&t(9,l=U.filter(w=>I==="all"?!0:w.roleOrganization===I)),s.$$.dirty[0]&65536&&t(2,o=r.reduce((w,x)=>{const X=sl(x);if(X){const W=X.organization;w[W]||(w[W]=[]),w[W].push(X)}return w},{})),s.$$.dirty[0]&4&&t(8,h=Object.keys(o))},t(16,r=nl()),[U,I,o,y,V,v,g,R,h,l,c,m,k,E,C,L,r,T,P,M,D,q,Y]}class yl extends ot{constructor(e){super(),at(this,e,wl,Dl,rt,{},null,[-1,-1])}}function Ut(s){let e,t;return{c(){e=d("div"),t=F(s[6]),this.h()},l(l){e=f(l,"DIV",{class:!0,role:!0});var r=b(e);t=j(r,s[6]),r.forEach(i),this.h()},h(){a(e,"class","alert alert-danger"),a(e,"role","alert")},m(l,r){K(l,e,r),n(e,t)},p(l,r){r&64&&ne(t,l[6])},d(l){l&&i(e)}}}function zt(s){let e,t="Key cannot be changed after creation";return{c(){e=d("div"),e.textContent=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1k89ihx"&&(e.textContent=t),this.h()},h(){a(e,"class","form-text")},m(l,r){K(l,e,r)},d(l){l&&i(e)}}}function Mt(s){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0,role:!0}),b(e).forEach(i),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,l){K(t,e,l)},d(t){t&&i(e)}}}function Il(s){let e,t,l,r,o='Key <span class="text-danger">*</span>',h,u,c,_,p,m,k='Name <span class="text-danger">*</span>',U,y,V,v,g,R="Organization",I,E,C,L,T="Used for grouping roles",P,M,D,q="Description",Y,w,x,X,W,oe,ie=s[7]?"Update":"Create",fe,ee,H,O,$,G,ae,J=s[6]&&Ut(s),te=s[7]&&zt(),le=s[5]&&Mt();return{c(){e=d("form"),J&&J.c(),t=N(),l=d("div"),r=d("label"),r.innerHTML=o,h=N(),u=d("input"),c=N(),te&&te.c(),_=N(),p=d("div"),m=d("label"),m.innerHTML=k,U=N(),y=d("input"),V=N(),v=d("div"),g=d("label"),g.textContent=R,I=N(),E=d("input"),C=N(),L=d("div"),L.textContent=T,P=N(),M=d("div"),D=d("label"),D.textContent=q,Y=N(),w=d("textarea"),x=N(),X=d("div"),W=d("button"),le&&le.c(),oe=N(),fe=F(ie),ee=F(" Role"),H=N(),O=d("button"),$=F("Cancel"),this.h()},l(Q){e=f(Q,"FORM",{});var B=b(e);J&&J.l(B),t=A(B),l=f(B,"DIV",{class:!0});var ue=b(l);r=f(ue,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(r)!=="svelte-136wa73"&&(r.innerHTML=o),h=A(ue),u=f(ue,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),c=A(ue),te&&te.l(ue),ue.forEach(i),_=A(B),p=f(B,"DIV",{class:!0});var me=b(p);m=f(me,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(m)!=="svelte-kgvawd"&&(m.innerHTML=k),U=A(me),y=f(me,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),me.forEach(i),V=A(B),v=f(B,"DIV",{class:!0});var Z=b(v);g=f(Z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(g)!=="svelte-hzptp9"&&(g.textContent=R),I=A(Z),E=f(Z,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),C=A(Z),L=f(Z,"DIV",{class:!0,"data-svelte-h":!0}),re(L)!=="svelte-a7bjz3"&&(L.textContent=T),Z.forEach(i),P=A(B),M=f(B,"DIV",{class:!0});var ke=b(M);D=f(ke,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),re(D)!=="svelte-1wym8yn"&&(D.textContent=q),Y=A(ke),w=f(ke,"TEXTAREA",{class:!0,id:!0,rows:!0,placeholder:!0}),b(w).forEach(i),ke.forEach(i),x=A(B),X=f(B,"DIV",{class:!0});var ge=b(X);W=f(ge,"BUTTON",{type:!0,class:!0});var Te=b(W);le&&le.l(Te),oe=A(Te),fe=j(Te,ie),ee=j(Te," Role"),Te.forEach(i),H=A(ge),O=f(ge,"BUTTON",{type:!0,class:!0,"data-bs-dismiss":!0});var De=b(O);$=j(De,"Cancel"),De.forEach(i),ge.forEach(i),B.forEach(i),this.h()},h(){a(r,"for","role-key"),a(r,"class","form-label"),a(u,"type","text"),a(u,"class","form-control"),a(u,"id","role-key"),u.required=!0,u.disabled=s[7],a(u,"placeholder","e.g., primary-president"),a(l,"class","mb-3"),a(m,"for","role-name"),a(m,"class","form-label"),a(y,"type","text"),a(y,"class","form-control"),a(y,"id","role-name"),y.required=!0,a(y,"placeholder","e.g., Primary President"),a(p,"class","mb-3"),a(g,"for","role-organization"),a(g,"class","form-label"),a(E,"type","text"),a(E,"class","form-control"),a(E,"id","role-organization"),a(E,"placeholder","e.g., primary, bishopric, relief-society"),a(L,"class","form-text"),a(v,"class","mb-3"),a(D,"for","role-description"),a(D,"class","form-label"),a(w,"class","form-control"),a(w,"id","role-description"),a(w,"rows","3"),a(w,"placeholder","Describe this role..."),a(M,"class","mb-3"),a(W,"type","submit"),a(W,"class","btn btn-primary"),W.disabled=s[5],a(O,"type","button"),a(O,"class","btn btn-secondary"),a(O,"data-bs-dismiss","offcanvas"),O.disabled=s[5],a(X,"class","d-flex gap-2")},m(Q,B){K(Q,e,B),J&&J.m(e,null),n(e,t),n(e,l),n(l,r),n(l,h),n(l,u),_e(u,s[1]),n(l,c),te&&te.m(l,null),n(e,_),n(e,p),n(p,m),n(p,U),n(p,y),_e(y,s[2]),n(e,V),n(e,v),n(v,g),n(v,I),n(v,E),_e(E,s[3]),n(v,C),n(v,L),n(e,P),n(e,M),n(M,D),n(M,Y),n(M,w),_e(w,s[4]),n(e,x),n(e,X),n(X,W),le&&le.m(W,null),n(W,oe),n(W,fe),n(W,ee),n(X,H),n(X,O),n(O,$),G||(ae=[ce(u,"input",s[11]),ce(y,"input",s[12]),ce(E,"input",s[13]),ce(w,"input",s[14]),ce(e,"submit",s[8])],G=!0)},p(Q,B){Q[6]?J?J.p(Q,B):(J=Ut(Q),J.c(),J.m(e,t)):J&&(J.d(1),J=null),B&128&&(u.disabled=Q[7]),B&2&&u.value!==Q[1]&&_e(u,Q[1]),Q[7]?te||(te=zt(),te.c(),te.m(l,null)):te&&(te.d(1),te=null),B&4&&y.value!==Q[2]&&_e(y,Q[2]),B&8&&E.value!==Q[3]&&_e(E,Q[3]),B&16&&_e(w,Q[4]),Q[5]?le||(le=Mt(),le.c(),le.m(W,oe)):le&&(le.d(1),le=null),B&128&&ie!==(ie=Q[7]?"Update":"Create")&&ne(fe,ie),B&32&&(W.disabled=Q[5]),B&32&&(O.disabled=Q[5])},d(Q){Q&&i(e),J&&J.d(),te&&te.d(),le&&le.d(),G=!1,Ye(ae)}}}function Ol(s){let e,t;return e=new xt({props:{title:s[7]?"Edit Role":"Create Role",id:s[0],$$slots:{default:[Il]},$$scope:{ctx:s}}}),{c(){Qe(e.$$.fragment)},l(l){qe(e.$$.fragment,l)},m(l,r){Ke(e,l,r),t=!0},p(l,[r]){const o={};r&128&&(o.title=l[7]?"Edit Role":"Create Role"),r&1&&(o.id=l[0]),r&131326&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function Ll(s,e,t){let l,{id:r="role-form-drawer"}=e,{role:o=null}=e,{onSave:h=null}=e,u="",c="",_="",p="",m=!1,k="";async function U(E){E.preventDefault(),t(5,m=!0),t(6,k="");try{l&&o?await ul(o.id,{name:c,organization:_||null,description:p||null}):await fl({key:u,name:c,organization:_||null,description:p||null});const C=document.getElementById(r);if(C){const T=window.bootstrap?.Offcanvas?.getInstance(C);T&&T.hide()}y(),h&&h()}catch(C){t(6,k=C instanceof Error?C.message:"Failed to save role")}finally{t(5,m=!1)}}function y(){t(1,u=""),t(2,c=""),t(3,_=""),t(4,p=""),t(6,k="")}function V(){y()}vt(()=>{const E=document.getElementById(r);if(E)return E.addEventListener("hidden.bs.offcanvas",V),()=>{E.removeEventListener("hidden.bs.offcanvas",V)}});function v(){u=this.value,t(1,u),t(9,o)}function g(){c=this.value,t(2,c),t(9,o)}function R(){_=this.value,t(3,_),t(9,o)}function I(){p=this.value,t(4,p),t(9,o)}return s.$$set=E=>{"id"in E&&t(0,r=E.id),"role"in E&&t(9,o=E.role),"onSave"in E&&t(10,h=E.onSave)},s.$$.update=()=>{s.$$.dirty&512&&t(7,l=o!==null),s.$$.dirty&512&&o&&(t(1,u=o.key),t(2,c=o.name),t(3,_=o.organization||""),t(4,p=o.description||""))},[r,u,c,_,p,m,k,l,U,o,h,v,g,R,I]}class Al extends ot{constructor(e){super(),at(this,e,Ll,Ol,rt,{id:0,role:9,onSave:10})}}function Bt(s,e,t){const l=s.slice();return l[13]=e[t][0],l[14]=e[t][1],l}function Ht(s,e,t){const l=s.slice();return l[17]=e[t],l}function jt(s){let e,t;return{c(){e=d("div"),t=F(s[4]),this.h()},l(l){e=f(l,"DIV",{class:!0,role:!0});var r=b(e);t=j(r,s[4]),r.forEach(i),this.h()},h(){a(e,"class","alert alert-danger"),a(e,"role","alert")},m(l,r){K(l,e,r),n(e,t)},p(l,r){r&16&&ne(t,l[4])},d(l){l&&i(e)}}}function Nl(s){let e,t="Please select a role to manage permissions.";return{c(){e=d("div"),e.textContent=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-d823lb"&&(e.textContent=t),this.h()},h(){a(e,"class","alert alert-info")},m(l,r){K(l,e,r)},p:Ie,d(l){l&&i(e)}}}function Rl(s){let e,t,l,r,o="Role:",h,u=s[1].name+"",c,_,p,m,k="Select All",U,y,V="Deselect All",v,g,R=s[2].size+"",I,E,C=s[5].length+"",L,T,P,M,D,q,Y,w,x,X,W,oe,ie,fe=be(Object.entries(s[6])),ee=[];for(let O=0;O<fe.length;O+=1)ee[O]=Kt(Bt(s,fe,O));let H=s[3]&&qt();return{c(){e=d("div"),t=d("div"),l=d("div"),r=d("strong"),r.textContent=o,h=N(),c=F(u),_=N(),p=d("div"),m=d("button"),m.textContent=k,U=N(),y=d("button"),y.textContent=V,v=N(),g=d("div"),I=F(R),E=F(" of "),L=F(C),T=F(" permissions selected"),P=N(),M=d("div");for(let O=0;O<ee.length;O+=1)ee[O].c();D=N(),q=d("div"),Y=d("button"),H&&H.c(),w=F(`
					Save Permissions`),x=N(),X=d("button"),W=F("Cancel"),this.h()},l(O){e=f(O,"DIV",{class:!0});var $=b(e);t=f($,"DIV",{class:!0});var G=b(t);l=f(G,"DIV",{});var ae=b(l);r=f(ae,"STRONG",{"data-svelte-h":!0}),re(r)!=="svelte-4i7x80"&&(r.textContent=o),h=A(ae),c=j(ae,u),ae.forEach(i),_=A(G),p=f(G,"DIV",{});var J=b(p);m=f(J,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),re(m)!=="svelte-grzpeo"&&(m.textContent=k),U=A(J),y=f(J,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),re(y)!=="svelte-18kd0i8"&&(y.textContent=V),J.forEach(i),G.forEach(i),v=A($),g=f($,"DIV",{class:!0});var te=b(g);I=j(te,R),E=j(te," of "),L=j(te,C),T=j(te," permissions selected"),te.forEach(i),$.forEach(i),P=A(O),M=f(O,"DIV",{class:!0});var le=b(M);for(let me=0;me<ee.length;me+=1)ee[me].l(le);le.forEach(i),D=A(O),q=f(O,"DIV",{class:!0});var Q=b(q);Y=f(Q,"BUTTON",{type:!0,class:!0});var B=b(Y);H&&H.l(B),w=j(B,`
					Save Permissions`),B.forEach(i),x=A(Q),X=f(Q,"BUTTON",{type:!0,class:!0,"data-bs-dismiss":!0});var ue=b(X);W=j(ue,"Cancel"),ue.forEach(i),Q.forEach(i),this.h()},h(){a(m,"type","button"),a(m,"class","btn btn-sm btn-outline-primary me-1"),a(y,"type","button"),a(y,"class","btn btn-sm btn-outline-secondary"),a(t,"class","d-flex justify-content-between align-items-center mb-2"),a(g,"class","text-muted small"),a(e,"class","mb-3"),a(M,"class","mb-3"),a(Y,"type","submit"),a(Y,"class","btn btn-primary"),Y.disabled=s[3],a(X,"type","button"),a(X,"class","btn btn-secondary"),a(X,"data-bs-dismiss","offcanvas"),X.disabled=s[3],a(q,"class","d-flex gap-2 sticky-bottom bg-body pt-3 border-top svelte-nth4dh")},m(O,$){K(O,e,$),n(e,t),n(t,l),n(l,r),n(l,h),n(l,c),n(t,_),n(t,p),n(p,m),n(p,U),n(p,y),n(e,v),n(e,g),n(g,I),n(g,E),n(g,L),n(g,T),K(O,P,$),K(O,M,$);for(let G=0;G<ee.length;G+=1)ee[G]&&ee[G].m(M,null);K(O,D,$),K(O,q,$),n(q,Y),H&&H.m(Y,null),n(Y,w),n(q,x),n(q,X),n(X,W),oe||(ie=[ce(m,"click",s[8]),ce(y,"click",s[9])],oe=!0)},p(O,$){if($&2&&u!==(u=O[1].name+"")&&ne(c,u),$&4&&R!==(R=O[2].size+"")&&ne(I,R),$&32&&C!==(C=O[5].length+"")&&ne(L,C),$&196){fe=be(Object.entries(O[6]));let G;for(G=0;G<fe.length;G+=1){const ae=Bt(O,fe,G);ee[G]?ee[G].p(ae,$):(ee[G]=Kt(ae),ee[G].c(),ee[G].m(M,null))}for(;G<ee.length;G+=1)ee[G].d(1);ee.length=fe.length}O[3]?H||(H=qt(),H.c(),H.m(Y,w)):H&&(H.d(1),H=null),$&8&&(Y.disabled=O[3]),$&8&&(X.disabled=O[3])},d(O){O&&(i(e),i(P),i(M),i(D),i(q)),Ne(ee,O),H&&H.d(),oe=!1,Ye(ie)}}}function Ft(s){let e,t=s[17].description+"",l;return{c(){e=d("div"),l=F(t),this.h()},l(r){e=f(r,"DIV",{class:!0});var o=b(e);l=j(o,t),o.forEach(i),this.h()},h(){a(e,"class","text-muted small")},m(r,o){K(r,e,o),n(e,l)},p(r,o){o&64&&t!==(t=r[17].description+"")&&ne(l,t)},d(r){r&&i(e)}}}function Gt(s){let e,t,l,r,o,h,u,c,_=s[17].name+"",p,m,k,U,y=s[17].key+"",V,v,g,R,I,E;function C(){return s[12](s[17])}let L=s[17].description&&Ft(s);return{c(){e=d("div"),t=d("input"),o=N(),h=d("label"),u=d("div"),c=d("strong"),p=F(_),m=N(),k=d("span"),U=F("("),V=F(y),v=F(")"),g=N(),L&&L.c(),this.h()},l(T){e=f(T,"DIV",{class:!0});var P=b(e);t=f(P,"INPUT",{class:!0,type:!0,id:!0}),o=A(P),h=f(P,"LABEL",{class:!0,for:!0});var M=b(h);u=f(M,"DIV",{});var D=b(u);c=f(D,"STRONG",{});var q=b(c);p=j(q,_),q.forEach(i),m=A(D),k=f(D,"SPAN",{class:!0});var Y=b(k);U=j(Y,"("),V=j(Y,y),v=j(Y,")"),Y.forEach(i),D.forEach(i),g=A(M),L&&L.l(M),M.forEach(i),P.forEach(i),this.h()},h(){a(t,"class","form-check-input"),a(t,"type","checkbox"),a(t,"id",l="permission-"+s[17].id),t.checked=r=s[2].has(s[17].id),a(k,"class","text-muted small"),a(h,"class","form-check-label"),a(h,"for",R="permission-"+s[17].id),a(e,"class","form-check mb-2")},m(T,P){K(T,e,P),n(e,t),n(e,o),n(e,h),n(h,u),n(u,c),n(c,p),n(u,m),n(u,k),n(k,U),n(k,V),n(k,v),n(h,g),L&&L.m(h,null),I||(E=ce(t,"change",C),I=!0)},p(T,P){s=T,P&64&&l!==(l="permission-"+s[17].id)&&a(t,"id",l),P&68&&r!==(r=s[2].has(s[17].id))&&(t.checked=r),P&64&&_!==(_=s[17].name+"")&&ne(p,_),P&64&&y!==(y=s[17].key+"")&&ne(V,y),s[17].description?L?L.p(s,P):(L=Ft(s),L.c(),L.m(h,null)):L&&(L.d(1),L=null),P&64&&R!==(R="permission-"+s[17].id)&&a(h,"for",R)},d(T){T&&i(e),L&&L.d(),I=!1,E()}}}function Kt(s){let e,t,l=s[13]+"",r,o,h,u=be(s[14]),c=[];for(let _=0;_<u.length;_+=1)c[_]=Gt(Ht(s,u,_));return{c(){e=d("div"),t=d("h6"),r=F(l),o=N();for(let _=0;_<c.length;_+=1)c[_].c();h=N(),this.h()},l(_){e=f(_,"DIV",{class:!0});var p=b(e);t=f(p,"H6",{class:!0});var m=b(t);r=j(m,l),m.forEach(i),o=A(p);for(let k=0;k<c.length;k+=1)c[k].l(p);h=A(p),p.forEach(i),this.h()},h(){a(t,"class","text-uppercase text-muted small mb-2"),a(e,"class","mb-3")},m(_,p){K(_,e,p),n(e,t),n(t,r),n(e,o);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(e,null);n(e,h)},p(_,p){if(p&64&&l!==(l=_[13]+"")&&ne(r,l),p&196){u=be(_[14]);let m;for(m=0;m<u.length;m+=1){const k=Ht(_,u,m);c[m]?c[m].p(k,p):(c[m]=Gt(k),c[m].c(),c[m].m(e,h))}for(;m<c.length;m+=1)c[m].d(1);c.length=u.length}},d(_){_&&i(e),Ne(c,_)}}}function qt(s){let e;return{c(){e=d("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0,role:!0}),b(e).forEach(i),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,l){K(t,e,l)},d(t){t&&i(e)}}}function Sl(s){let e,t,l,r,o=s[4]&&jt(s);function h(_,p){return _[1]?Rl:Nl}let u=h(s),c=u(s);return{c(){e=d("form"),o&&o.c(),t=N(),c.c()},l(_){e=f(_,"FORM",{});var p=b(e);o&&o.l(p),t=A(p),c.l(p),p.forEach(i)},m(_,p){K(_,e,p),o&&o.m(e,null),n(e,t),c.m(e,null),l||(r=ce(e,"submit",s[10]),l=!0)},p(_,p){_[4]?o?o.p(_,p):(o=jt(_),o.c(),o.m(e,t)):o&&(o.d(1),o=null),u===(u=h(_))&&c?c.p(_,p):(c.d(1),c=u(_),c&&(c.c(),c.m(e,null)))},d(_){_&&i(e),o&&o.d(),c.d(),l=!1,r()}}}function Vl(s){let e,t;return e=new xt({props:{title:s[1]?`Manage Permissions: ${s[1].name}`:"Manage Permissions",id:s[0],$$slots:{default:[Sl]},$$scope:{ctx:s}}}),{c(){Qe(e.$$.fragment)},l(l){qe(e.$$.fragment,l)},m(l,r){Ke(e,l,r),t=!0},p(l,[r]){const o={};r&2&&(o.title=l[1]?`Manage Permissions: ${l[1].name}`:"Manage Permissions"),r&1&&(o.id=l[0]),r&1048702&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function Pl(s,e,t){let l,r;Ae(s,hl,v=>t(5,l=v)),Ae(s,_l,v=>t(6,r=v));let{id:o="role-permissions-drawer"}=e,{role:h=null}=e,{onSave:u=null}=e,c=new Set,_=!1,p="";function m(v){c.has(v)?c.delete(v):c.add(v),t(2,c),t(1,h)}function k(){t(2,c=new Set(l.map(v=>v.id)))}function U(){t(2,c=new Set)}async function y(v){if(v.preventDefault(),!!h){t(3,_=!0),t(4,p="");try{await dl(h.id,Array.from(c));const g=document.getElementById(o);if(g){const I=window.bootstrap?.Offcanvas?.getInstance(g);I&&I.hide()}u&&u()}catch(g){t(4,p=g instanceof Error?g.message:"Failed to assign permissions")}finally{t(3,_=!1)}}}const V=v=>m(v.id);return s.$$set=v=>{"id"in v&&t(0,o=v.id),"role"in v&&t(1,h=v.role),"onSave"in v&&t(11,u=v.onSave)},s.$$.update=()=>{s.$$.dirty&2&&h&&t(2,c=new Set(h.permissions.map(v=>v.id)))},[o,h,c,_,p,l,r,m,k,U,y,u,V]}class Ul extends ot{constructor(e){super(),at(this,e,Pl,Vl,rt,{id:0,role:1,onSave:11})}}function Qt(s,e,t){const l=s.slice();return l[23]=e[t][0],l[24]=e[t][1],l}function Yt(s,e,t){const l=s.slice();return l[27]=e[t],l}function zl(s){let e,t,l="Role Definitions",r,o,h=`<i class="bi bi-plus-lg me-1"></i>
					Create Role`,u,c,_,p,m,k,U,y,V,v=s[5]&&Xt(s);function g(E,C){return E[6]?jl:E[7].length===0?Hl:Bl}let R=g(s),I=R(s);return{c(){e=d("div"),t=d("h2"),t.textContent=l,r=N(),o=d("button"),o.innerHTML=h,u=N(),v&&v.c(),c=N(),_=d("div"),p=d("div"),m=d("input"),k=N(),I.c(),U=nt(),this.h()},l(E){e=f(E,"DIV",{class:!0});var C=b(e);t=f(C,"H2",{"data-svelte-h":!0}),re(t)!=="svelte-104zljo"&&(t.textContent=l),r=A(C),o=f(C,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),re(o)!=="svelte-gydj2j"&&(o.innerHTML=h),C.forEach(i),u=A(E),v&&v.l(E),c=A(E),_=f(E,"DIV",{class:!0});var L=b(_);p=f(L,"DIV",{class:!0});var T=b(p);m=f(T,"INPUT",{type:!0,class:!0,placeholder:!0}),T.forEach(i),L.forEach(i),k=A(E),I.l(E),U=nt(),this.h()},h(){a(o,"type","button"),a(o,"class","btn btn-primary"),a(e,"class","d-flex justify-content-between align-items-center mb-4"),a(m,"type","text"),a(m,"class","form-control"),a(m,"placeholder","Search roles..."),a(p,"class","card-body"),a(_,"class","card mb-4")},m(E,C){K(E,e,C),n(e,t),n(e,r),n(e,o),K(E,u,C),v&&v.m(E,C),K(E,c,C),K(E,_,C),n(_,p),n(p,m),_e(m,s[0]),K(E,k,C),I.m(E,C),K(E,U,C),y||(V=[ce(o,"click",s[9]),ce(m,"input",s[16])],y=!0)},p(E,C){E[5]?v?v.p(E,C):(v=Xt(E),v.c(),v.m(c.parentNode,c)):v&&(v.d(1),v=null),C&1&&m.value!==E[0]&&_e(m,E[0]),R===(R=g(E))&&I?I.p(E,C):(I.d(1),I=R(E),I&&(I.c(),I.m(U.parentNode,U)))},i:Ie,o:Ie,d(E){E&&(i(e),i(u),i(c),i(_),i(k),i(U)),v&&v.d(E),I.d(E),y=!1,Ye(V)}}}function Ml(s){let e,t;return e=new yl({}),{c(){Qe(e.$$.fragment)},l(l){qe(e.$$.fragment,l)},m(l,r){Ke(e,l,r),t=!0},p:Ie,i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function Xt(s){let e,t,l,r;return{c(){e=d("div"),t=d("i"),l=N(),r=F(s[5]),this.h()},l(o){e=f(o,"DIV",{class:!0,role:!0});var h=b(e);t=f(h,"I",{class:!0}),b(t).forEach(i),l=A(h),r=j(h,s[5]),h.forEach(i),this.h()},h(){a(t,"class","bi bi-exclamation-triangle me-2"),a(e,"class","alert alert-danger"),a(e,"role","alert")},m(o,h){K(o,e,h),n(e,t),n(e,l),n(e,r)},p(o,h){h&32&&ne(r,o[5])},d(o){o&&i(e)}}}function Bl(s){let e,t=be(s[4]),l=[];for(let r=0;r<t.length;r+=1)l[r]=Wt(Qt(s,t,r));return{c(){for(let r=0;r<l.length;r+=1)l[r].c();e=nt()},l(r){for(let o=0;o<l.length;o+=1)l[o].l(r);e=nt()},m(r,o){for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(r,o);K(r,e,o)},p(r,o){if(o&7184){t=be(r[4]);let h;for(h=0;h<t.length;h+=1){const u=Qt(r,t,h);l[h]?l[h].p(u,o):(l[h]=Wt(u),l[h].c(),l[h].m(e.parentNode,e))}for(;h<l.length;h+=1)l[h].d(1);l.length=t.length}},d(r){r&&i(e),Ne(l,r)}}}function Hl(s){let e,t="No roles found. Create your first role to get started.";return{c(){e=d("div"),e.textContent=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1hcv02t"&&(e.textContent=t),this.h()},h(){a(e,"class","alert alert-info")},m(l,r){K(l,e,r)},p:Ie,d(l){l&&i(e)}}}function jl(s){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=d("div"),e.innerHTML=t,this.h()},l(l){e=f(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1xj70p"&&(e.innerHTML=t),this.h()},h(){a(e,"class","d-flex justify-content-center align-items-center py-5")},m(l,r){K(l,e,r)},p:Ie,d(l){l&&i(e)}}}function Jt(s){let e,t,l,r=s[27].name+"",o,h,u,c,_=s[27].key+"",p,m,k,U=(s[27].description||"-")+"",y,V,v,g,R=s[27].permissions.length+"",I,E,C,L,T,P='<i class="bi bi-key"></i>',M,D,q='<i class="bi bi-pencil"></i>',Y,w,x='<i class="bi bi-trash"></i>',X,W,oe;function ie(){return s[17](s[27])}function fe(){return s[18](s[27])}function ee(){return s[19](s[27])}return{c(){e=d("tr"),t=d("td"),l=d("strong"),o=F(r),h=N(),u=d("td"),c=d("code"),p=F(_),m=N(),k=d("td"),y=F(U),V=N(),v=d("td"),g=d("span"),I=F(R),E=F(" permissions"),C=N(),L=d("td"),T=d("button"),T.innerHTML=P,M=N(),D=d("button"),D.innerHTML=q,Y=N(),w=d("button"),w.innerHTML=x,X=N(),this.h()},l(H){e=f(H,"TR",{});var O=b(e);t=f(O,"TD",{});var $=b(t);l=f($,"STRONG",{});var G=b(l);o=j(G,r),G.forEach(i),$.forEach(i),h=A(O),u=f(O,"TD",{});var ae=b(u);c=f(ae,"CODE",{});var J=b(c);p=j(J,_),J.forEach(i),ae.forEach(i),m=A(O),k=f(O,"TD",{});var te=b(k);y=j(te,U),te.forEach(i),V=A(O),v=f(O,"TD",{});var le=b(v);g=f(le,"SPAN",{class:!0});var Q=b(g);I=j(Q,R),E=j(Q," permissions"),Q.forEach(i),le.forEach(i),C=A(O),L=f(O,"TD",{});var B=b(L);T=f(B,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),re(T)!=="svelte-1jg2ize"&&(T.innerHTML=P),M=A(B),D=f(B,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),re(D)!=="svelte-rmv7u4"&&(D.innerHTML=q),Y=A(B),w=f(B,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),re(w)!=="svelte-bhg5w1"&&(w.innerHTML=x),B.forEach(i),X=A(O),O.forEach(i),this.h()},h(){a(g,"class","badge bg-secondary"),a(T,"type","button"),a(T,"class","btn btn-sm btn-outline-success me-1"),a(T,"title","Manage Permissions"),a(D,"type","button"),a(D,"class","btn btn-sm btn-outline-primary me-1"),a(D,"title","Edit"),a(w,"type","button"),a(w,"class","btn btn-sm btn-outline-danger"),a(w,"title","Delete")},m(H,O){K(H,e,O),n(e,t),n(t,l),n(l,o),n(e,h),n(e,u),n(u,c),n(c,p),n(e,m),n(e,k),n(k,y),n(e,V),n(e,v),n(v,g),n(g,I),n(g,E),n(e,C),n(e,L),n(L,T),n(L,M),n(L,D),n(L,Y),n(L,w),n(e,X),W||(oe=[ce(T,"click",ie),ce(D,"click",fe),ce(w,"click",ee)],W=!0)},p(H,O){s=H,O&16&&r!==(r=s[27].name+"")&&ne(o,r),O&16&&_!==(_=s[27].key+"")&&ne(p,_),O&16&&U!==(U=(s[27].description||"-")+"")&&ne(y,U),O&16&&R!==(R=s[27].permissions.length+"")&&ne(I,R)},d(H){H&&i(e),W=!1,Ye(oe)}}}function Wt(s){let e,t,l,r=s[23]+"",o,h,u,c,_,p,m='<tr><th>Name</th> <th>Key</th> <th>Description</th> <th>Permissions</th> <th style="width: 200px;">Actions</th></tr>',k,U,y,V=be(s[24]),v=[];for(let g=0;g<V.length;g+=1)v[g]=Jt(Yt(s,V,g));return{c(){e=d("div"),t=d("div"),l=d("h5"),o=F(r),h=N(),u=d("div"),c=d("div"),_=d("table"),p=d("thead"),p.innerHTML=m,k=N(),U=d("tbody");for(let g=0;g<v.length;g+=1)v[g].c();y=N(),this.h()},l(g){e=f(g,"DIV",{class:!0});var R=b(e);t=f(R,"DIV",{class:!0});var I=b(t);l=f(I,"H5",{class:!0});var E=b(l);o=j(E,r),E.forEach(i),I.forEach(i),h=A(R),u=f(R,"DIV",{class:!0});var C=b(u);c=f(C,"DIV",{class:!0});var L=b(c);_=f(L,"TABLE",{class:!0});var T=b(_);p=f(T,"THEAD",{"data-svelte-h":!0}),re(p)!=="svelte-106iwxu"&&(p.innerHTML=m),k=A(T),U=f(T,"TBODY",{});var P=b(U);for(let M=0;M<v.length;M+=1)v[M].l(P);P.forEach(i),T.forEach(i),L.forEach(i),C.forEach(i),y=A(R),R.forEach(i),this.h()},h(){a(l,"class","mb-0 text-uppercase"),a(t,"class","card-header"),a(_,"class","table table-hover mb-0"),a(c,"class","table-responsive"),a(u,"class","card-body"),a(e,"class","card mb-3")},m(g,R){K(g,e,R),n(e,t),n(t,l),n(l,o),n(e,h),n(e,u),n(u,c),n(c,_),n(_,p),n(_,k),n(_,U);for(let I=0;I<v.length;I+=1)v[I]&&v[I].m(U,null);n(e,y)},p(g,R){if(R&16&&r!==(r=g[23]+"")&&ne(o,r),R&7184){V=be(g[24]);let I;for(I=0;I<V.length;I+=1){const E=Yt(g,V,I);v[I]?v[I].p(E,R):(v[I]=Jt(E),v[I].c(),v[I].m(U,null))}for(;I<v.length;I+=1)v[I].d(1);v.length=V.length}},d(g){g&&i(e),Ne(v,g)}}}function Fl(s){let e,t,l,r,o="User Role Assignments",h,u,c,_="Role Definitions",p,m,k,U,y,V,v,g,R,I;const E=[Ml,zl],C=[];function L(T,P){return T[3]==="assignments"?0:1}return m=L(s),k=C[m]=E[m](s),y=new Al({props:{id:"role-form-drawer",role:s[1],onSave:s[20]}}),v=new Ul({props:{id:"role-permissions-drawer",role:s[2],onSave:s[21]}}),{c(){e=d("div"),t=d("ul"),l=d("li"),r=d("button"),r.textContent=o,h=N(),u=d("li"),c=d("button"),c.textContent=_,p=N(),k.c(),U=N(),Qe(y.$$.fragment),V=N(),Qe(v.$$.fragment),this.h()},l(T){e=f(T,"DIV",{class:!0});var P=b(e);t=f(P,"UL",{class:!0});var M=b(t);l=f(M,"LI",{class:!0});var D=b(l);r=f(D,"BUTTON",{class:!0,"data-svelte-h":!0}),re(r)!=="svelte-1ja0zxy"&&(r.textContent=o),D.forEach(i),h=A(M),u=f(M,"LI",{class:!0});var q=b(u);c=f(q,"BUTTON",{class:!0,"data-svelte-h":!0}),re(c)!=="svelte-1rl4saz"&&(c.textContent=_),q.forEach(i),M.forEach(i),p=A(P),k.l(P),P.forEach(i),U=A(T),qe(y.$$.fragment,T),V=A(T),qe(v.$$.fragment,T),this.h()},h(){a(r,"class","nav-link"),lt(r,"active",s[3]==="assignments"),a(l,"class","nav-item"),a(c,"class","nav-link"),lt(c,"active",s[3]==="definitions"),a(u,"class","nav-item"),a(t,"class","nav nav-tabs mb-4"),a(e,"class","container-fluid py-4")},m(T,P){K(T,e,P),n(e,t),n(t,l),n(l,r),n(t,h),n(t,u),n(u,c),n(e,p),C[m].m(e,null),K(T,U,P),Ke(y,T,P),K(T,V,P),Ke(v,T,P),g=!0,R||(I=[ce(r,"click",s[14]),ce(c,"click",s[15])],R=!0)},p(T,P){(!g||P&8)&&lt(r,"active",T[3]==="assignments"),(!g||P&8)&&lt(c,"active",T[3]==="definitions");let M=m;m=L(T),m===M?C[m].p(T,P):($t(),Pe(C[M],1,1,()=>{C[M]=null}),el(),k=C[m],k?k.p(T,P):(k=C[m]=E[m](T),k.c()),Ue(k,1),k.m(e,null));const D={};P&2&&(D.role=T[1]),P&2&&(D.onSave=T[20]),y.$set(D);const q={};P&4&&(q.role=T[2]),P&4&&(q.onSave=T[21]),v.$set(q)},i(T){g||(Ue(k),Ue(y.$$.fragment,T),Ue(v.$$.fragment,T),g=!0)},o(T){Pe(k),Pe(y.$$.fragment,T),Pe(v.$$.fragment,T),g=!1},d(T){T&&(i(e),i(U),i(V)),C[m].d(),Ge(y,T),Ge(v,T),R=!1,Ye(I)}}}function Gl(s){let e,t;return e=new tl({props:{pageTitle:"Manage Roles",$$slots:{default:[Fl]},$$scope:{ctx:s}}}),{c(){Qe(e.$$.fragment)},l(l){qe(e.$$.fragment,l)},m(l,r){Ke(e,l,r),t=!0},p(l,[r]){const o={};r&1073742079&&(o.$$scope={dirty:r,ctx:l}),e.$set(o)},i(l){t||(Ue(e.$$.fragment,l),t=!0)},o(l){Pe(e.$$.fragment,l),t=!1},d(l){Ge(e,l)}}}function _t(s){const e=document.getElementById(s);if(e){const t=window.bootstrap;t?.Offcanvas&&new t.Offcanvas(e).show()}}function Kl(s,e,t){let l,r,o,h,u,c;Ae(s,pl,D=>t(13,r=D)),Ae(s,bl,D=>t(5,h=D)),Ae(s,gl,D=>t(6,u=D)),Ae(s,El,D=>t(7,c=D));const{stores:{currentUserHasPermission:_}}=Zt();Ae(s,_,D=>t(22,o=D));let p=null,m=null,k="",U="assignments";vt(async()=>{if(!o(al.AssignCallings)){cl("/home");return}await ml()});function y(){t(1,p=null),_t("role-form-drawer")}function V(D){t(1,p=D),_t("role-form-drawer")}function v(D){t(2,m=D),_t("role-permissions-drawer")}async function g(D){if(confirm(`Are you sure you want to delete the role "${D.name}"? This will remove it from all users.`))try{await vl(D.id)}catch(q){alert(`Failed to delete role: ${q instanceof Error?q.message:"Unknown error"}`)}}const R=()=>t(3,U="assignments"),I=()=>t(3,U="definitions");function E(){k=this.value,t(0,k)}const C=D=>v(D),L=D=>V(D),T=D=>g(D),P=()=>{t(1,p=null)},M=()=>{t(2,m=null)};return s.$$.update=()=>{s.$$.dirty&8193&&t(4,l=Object.entries(r).filter(([D,q])=>{if(!k)return!0;const Y=k.toLowerCase();return D.toLowerCase().includes(Y)||q.some(w=>w.name.toLowerCase().includes(Y)||w.key.toLowerCase().includes(Y)||w.description?.toLowerCase().includes(Y))}))},[k,p,m,U,l,h,u,c,_,y,V,v,g,r,R,I,E,C,L,T,P,M]}class es extends ot{constructor(e){super(),at(this,e,Kl,Gl,rt,{})}}export{es as component};
