import{s as We,k as ce,r as Ze,d as h,y as Te,I as De,D as J,B as Ue,a as re,i as K,b as n,C as x,p as a,E as tt,c as u,e as D,g as H,w as z,f as $,h as f,j as M,t as ee,H as st,n as xe,J as Se}from"../chunks/BQ7GsIJB.js";import{S as $e,i as et,d as Ie,t as Le,a as Pe,m as Oe,c as He,b as Me}from"../chunks/BJAXi6Wx.js";import{e as ue}from"../chunks/B1F1ThW2.js";import{P as rt}from"../chunks/BqZCCBoh.js";import{g as lt,P as nt}from"../chunks/Cm9A8jpH.js";import{g as ot}from"../chunks/PIcvKOdQ.js";import{D as it}from"../chunks/4kTNVrYs.js";import{u as at,c as ct,a as ut,i as ft,d as dt,p as ht,b as mt,l as _t,e as pt}from"../chunks/DnBfnk7m.js";function Ae(r,e,t){const s=r.slice();return s[21]=e[t],s}function je(r){let e,t;return{c(){e=f("div"),t=ee(r[8]),this.h()},l(s){e=u(s,"DIV",{class:!0,role:!0});var l=D(e);t=$(l,r[8]),l.forEach(h),this.h()},h(){a(e,"class","alert alert-danger"),a(e,"role","alert")},m(s,l){K(s,e,l),n(e,t)},p(s,l){l&256&&re(t,s[8])},d(s){s&&h(e)}}}function qe(r){let e,t="Key cannot be changed after creation";return{c(){e=f("div"),e.textContent=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1k89ihx"&&(e.textContent=t),this.h()},h(){a(e,"class","form-text")},m(s,l){K(s,e,l)},d(s){s&&h(e)}}}function Fe(r){let e,t=r[21]+"",s,l;return{c(){e=f("option"),s=ee(t),this.h()},l(c){e=u(c,"OPTION",{});var o=D(e);s=$(o,t),o.forEach(h),this.h()},h(){e.__value=l=r[21],J(e,e.__value)},m(c,o){K(c,e,o),n(e,s)},p(c,o){o&8&&t!==(t=c[21]+"")&&re(s,t),o&8&&l!==(l=c[21])&&(e.__value=l,J(e,e.__value))},d(c){c&&h(e)}}}function Re(r){let e,t,s;return{c(){e=f("input"),this.h()},l(l){e=u(l,"INPUT",{type:!0,class:!0,placeholder:!0}),this.h()},h(){a(e,"type","text"),a(e,"class","form-control mt-2"),a(e,"placeholder","Enter custom category")},m(l,c){K(l,e,c),J(e,r[2]),t||(s=x(e,"input",r[17]),t=!0)},p(l,c){c&4&&e.value!==l[2]&&J(e,l[2])},d(l){l&&h(e),t=!1,s()}}}function bt(r){let e,t="Used for grouping permissions";return{c(){e=f("div"),e.textContent=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1ahflu"&&(e.textContent=t),this.h()},h(){a(e,"class","form-text")},m(s,l){K(s,e,l)},d(s){s&&h(e)}}}function vt(r){let e,t="Category cannot be changed after creation";return{c(){e=f("div"),e.textContent=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-15pz51a"&&(e.textContent=t),this.h()},h(){a(e,"class","form-text")},m(s,l){K(s,e,l)},d(s){s&&h(e)}}}function ze(r){let e;return{c(){e=f("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0,role:!0}),D(e).forEach(h),this.h()},h(){a(e,"class","spinner-border spinner-border-sm me-2"),a(e,"role","status")},m(t,s){K(t,e,s)},d(t){t&&h(e)}}}function gt(r){let e,t,s,l,c='Key <span class="text-danger">*</span>',o,v,L,w,g,k,C='Name <span class="text-danger">*</span>',I,T,P,p,m,V="Description",i,E,A,y,_,d="Category",N,S,U,j="Select a category...",X,fe="Other (custom)...",oe,le,ie,Y,W,me,de=r[9]?"Update":"Create",_e,ye,Ee,Z,Ce,we,Ve,F=r[8]&&je(r),Q=r[9]&&qe(),ae=ue(r[3]),q=[];for(let b=0;b<ae.length;b+=1)q[b]=Fe(Ae(r,ae,b));let R=r[1]==="__other__"&&!r[9]&&Re(r);function Ne(b,O){return b[9]?vt:bt}let pe=Ne(r),te=pe(r),G=r[7]&&ze();return{c(){e=f("form"),F&&F.c(),t=M(),s=f("div"),l=f("label"),l.innerHTML=c,o=M(),v=f("input"),L=M(),Q&&Q.c(),w=M(),g=f("div"),k=f("label"),k.innerHTML=C,I=M(),T=f("input"),P=M(),p=f("div"),m=f("label"),m.textContent=V,i=M(),E=f("textarea"),A=M(),y=f("div"),_=f("label"),_.textContent=d,N=M(),S=f("select"),U=f("option"),U.textContent=j;for(let b=0;b<q.length;b+=1)q[b].c();X=f("option"),X.textContent=fe,oe=M(),R&&R.c(),le=M(),te.c(),ie=M(),Y=f("div"),W=f("button"),G&&G.c(),me=M(),_e=ee(de),ye=ee(" Permission"),Ee=M(),Z=f("button"),Ce=ee("Cancel"),this.h()},l(b){e=u(b,"FORM",{});var O=D(e);F&&F.l(O),t=H(O),s=u(O,"DIV",{class:!0});var B=D(s);l=u(B,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(l)!=="svelte-jkzn9g"&&(l.innerHTML=c),o=H(B),v=u(B,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),L=H(B),Q&&Q.l(B),B.forEach(h),w=H(O),g=u(O,"DIV",{class:!0});var ne=D(g);k=u(ne,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(k)!=="svelte-y7giqe"&&(k.innerHTML=C),I=H(ne),T=u(ne,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),ne.forEach(h),P=H(O),p=u(O,"DIV",{class:!0});var be=D(p);m=u(be,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(m)!=="svelte-ayuqpw"&&(m.textContent=V),i=H(be),E=u(be,"TEXTAREA",{class:!0,id:!0,rows:!0,placeholder:!0}),D(E).forEach(h),be.forEach(h),A=H(O),y=u(O,"DIV",{class:!0});var se=D(y);_=u(se,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(_)!=="svelte-fumam8"&&(_.textContent=d),N=H(se),S=u(se,"SELECT",{class:!0,id:!0});var ve=D(S);U=u(ve,"OPTION",{"data-svelte-h":!0}),z(U)!=="svelte-xy5cex"&&(U.textContent=j);for(let ke=0;ke<q.length;ke+=1)q[ke].l(ve);X=u(ve,"OPTION",{"data-svelte-h":!0}),z(X)!=="svelte-1wgdywq"&&(X.textContent=fe),ve.forEach(h),oe=H(se),R&&R.l(se),le=H(se),te.l(se),se.forEach(h),ie=H(O),Y=u(O,"DIV",{class:!0});var ge=D(Y);W=u(ge,"BUTTON",{type:!0,class:!0});var he=D(W);G&&G.l(he),me=H(he),_e=$(he,de),ye=$(he," Permission"),he.forEach(h),Ee=H(ge),Z=u(ge,"BUTTON",{type:!0,class:!0,"data-bs-dismiss":!0});var Be=D(Z);Ce=$(Be,"Cancel"),Be.forEach(h),ge.forEach(h),O.forEach(h),this.h()},h(){a(l,"for","permission-key"),a(l,"class","form-label"),a(v,"type","text"),a(v,"class","form-control"),a(v,"id","permission-key"),v.required=!0,v.disabled=r[9],a(v,"placeholder","e.g., manage-events"),a(s,"class","mb-3"),a(k,"for","permission-name"),a(k,"class","form-label"),a(T,"type","text"),a(T,"class","form-control"),a(T,"id","permission-name"),T.required=!0,a(T,"placeholder","e.g., Manage Events"),a(g,"class","mb-3"),a(m,"for","permission-description"),a(m,"class","form-label"),a(E,"class","form-control"),a(E,"id","permission-description"),a(E,"rows","3"),a(E,"placeholder","Describe what this permission allows..."),a(p,"class","mb-3"),a(_,"for","permission-category"),a(_,"class","form-label"),U.__value="",J(U,U.__value),X.__value="__other__",J(X,X.__value),a(S,"class","form-select"),a(S,"id","permission-category"),S.disabled=r[9],r[1]===void 0&&tt(()=>r[16].call(S)),a(y,"class","mb-3"),a(W,"type","submit"),a(W,"class","btn btn-primary"),W.disabled=r[7],a(Z,"type","button"),a(Z,"class","btn btn-secondary"),a(Z,"data-bs-dismiss","offcanvas"),Z.disabled=r[7],a(Y,"class","d-flex gap-2")},m(b,O){K(b,e,O),F&&F.m(e,null),n(e,t),n(e,s),n(s,l),n(s,o),n(s,v),J(v,r[4]),n(s,L),Q&&Q.m(s,null),n(e,w),n(e,g),n(g,k),n(g,I),n(g,T),J(T,r[5]),n(e,P),n(e,p),n(p,m),n(p,i),n(p,E),J(E,r[6]),n(e,A),n(e,y),n(y,_),n(y,N),n(y,S),n(S,U);for(let B=0;B<q.length;B+=1)q[B]&&q[B].m(S,null);n(S,X),Ue(S,r[1],!0),n(y,oe),R&&R.m(y,null),n(y,le),te.m(y,null),n(e,ie),n(e,Y),n(Y,W),G&&G.m(W,null),n(W,me),n(W,_e),n(W,ye),n(Y,Ee),n(Y,Z),n(Z,Ce),we||(Ve=[x(v,"input",r[13]),x(T,"input",r[14]),x(E,"input",r[15]),x(S,"change",r[16]),x(e,"submit",r[10])],we=!0)},p(b,O){if(b[8]?F?F.p(b,O):(F=je(b),F.c(),F.m(e,t)):F&&(F.d(1),F=null),O&512&&(v.disabled=b[9]),O&16&&v.value!==b[4]&&J(v,b[4]),b[9]?Q||(Q=qe(),Q.c(),Q.m(s,null)):Q&&(Q.d(1),Q=null),O&32&&T.value!==b[5]&&J(T,b[5]),O&64&&J(E,b[6]),O&8){ae=ue(b[3]);let B;for(B=0;B<ae.length;B+=1){const ne=Ae(b,ae,B);q[B]?q[B].p(ne,O):(q[B]=Fe(ne),q[B].c(),q[B].m(S,X))}for(;B<q.length;B+=1)q[B].d(1);q.length=ae.length}O&512&&(S.disabled=b[9]),O&10&&Ue(S,b[1]),b[1]==="__other__"&&!b[9]?R?R.p(b,O):(R=Re(b),R.c(),R.m(y,le)):R&&(R.d(1),R=null),pe!==(pe=Ne(b))&&(te.d(1),te=pe(b),te&&(te.c(),te.m(y,null))),b[7]?G||(G=ze(),G.c(),G.m(W,me)):G&&(G.d(1),G=null),O&512&&de!==(de=b[9]?"Update":"Create")&&re(_e,de),O&128&&(W.disabled=b[7]),O&128&&(Z.disabled=b[7])},d(b){b&&h(e),F&&F.d(),Q&&Q.d(),Te(q,b),R&&R.d(),te.d(),G&&G.d(),we=!1,De(Ve)}}}function yt(r){let e,t;return e=new it({props:{title:r[9]?"Edit Permission":"Create Permission",id:r[0],$$slots:{default:[gt]},$$scope:{ctx:r}}}),{c(){Me(e.$$.fragment)},l(s){He(e.$$.fragment,s)},m(s,l){Oe(e,s,l),t=!0},p(s,[l]){const c={};l&512&&(c.title=s[9]?"Edit Permission":"Create Permission"),l&1&&(c.id=s[0]),l&16778238&&(c.$$scope={dirty:l,ctx:s}),e.$set(c)},i(s){t||(Pe(e.$$.fragment,s),t=!0)},o(s){Le(e.$$.fragment,s),t=!1},d(s){Ie(e,s)}}}function Et(r,e,t){let s,l;ce(r,ut,d=>t(3,l=d));let{id:c="permission-form-drawer"}=e,{permission:o=null}=e,{onSave:v=null}=e,L="",w="",g="",k="",C="",I="",T=!1,P="";async function p(d){d.preventDefault(),t(7,T=!0),t(8,P="");try{s&&o?await at(o.id,{name:w,description:g||null,category:k||null}):await ct({key:L,name:w,description:g||null,category:k||null});const N=document.getElementById(c);if(N){const U=window.bootstrap?.Offcanvas?.getInstance(N);U&&U.hide()}m(),v&&v()}catch(N){t(8,P=N instanceof Error?N.message:"Failed to save permission")}finally{t(7,T=!1)}}function m(){t(4,L=""),t(5,w=""),t(6,g=""),k="",t(1,C=""),t(2,I=""),t(8,P="")}function V(){m()}Ze(()=>{const d=document.getElementById(c);if(d)return d.addEventListener("hidden.bs.offcanvas",V),()=>{d.removeEventListener("hidden.bs.offcanvas",V)}});function i(){L=this.value,t(4,L),t(11,o),t(3,l)}function E(){w=this.value,t(5,w),t(11,o),t(3,l)}function A(){g=this.value,t(6,g),t(11,o),t(3,l)}function y(){C=st(this),t(1,C),t(11,o),t(3,l)}function _(){I=this.value,t(2,I),t(11,o),t(3,l)}return r.$$set=d=>{"id"in d&&t(0,c=d.id),"permission"in d&&t(11,o=d.permission),"onSave"in d&&t(12,v=d.onSave)},r.$$.update=()=>{if(r.$$.dirty&2048&&t(9,s=o!==null),r.$$.dirty&2056&&o){t(4,L=o.key),t(5,w=o.name),t(6,g=o.description||"");const d=o.category||"";d&&l.includes(d)?(t(1,C=d),t(2,I="")):d?(t(1,C="__other__"),t(2,I=d)):(t(1,C=""),t(2,I=""))}r.$$.dirty&6&&(k=C==="__other__"?I:C)},[c,C,I,l,L,w,g,T,P,s,p,o,v,i,E,A,y,_]}class Ct extends $e{constructor(e){super(),et(this,e,Et,yt,We,{id:0,permission:11,onSave:12})}}function Ke(r,e,t){const s=r.slice();return s[16]=e[t][0],s[17]=e[t][1],s}function Qe(r,e,t){const s=r.slice();return s[20]=e[t],s}function Ge(r){let e,t,s,l;return{c(){e=f("div"),t=f("i"),s=M(),l=ee(r[3]),this.h()},l(c){e=u(c,"DIV",{class:!0,role:!0});var o=D(e);t=u(o,"I",{class:!0}),D(t).forEach(h),s=H(o),l=$(o,r[3]),o.forEach(h),this.h()},h(){a(t,"class","bi bi-exclamation-triangle me-2"),a(e,"class","alert alert-danger"),a(e,"role","alert")},m(c,o){K(c,e,o),n(e,t),n(e,s),n(e,l)},p(c,o){o&8&&re(l,c[3])},d(c){c&&h(e)}}}function wt(r){let e,t=ue(r[2]),s=[];for(let l=0;l<t.length;l+=1)s[l]=Xe(Ke(r,t,l));return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=Se()},l(l){for(let c=0;c<s.length;c+=1)s[c].l(l);e=Se()},m(l,c){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(l,c);K(l,e,c)},p(l,c){if(c&772){t=ue(l[2]);let o;for(o=0;o<t.length;o+=1){const v=Ke(l,t,o);s[o]?s[o].p(v,c):(s[o]=Xe(v),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=t.length}},d(l){l&&h(e),Te(s,l)}}}function kt(r){let e,t="No permissions found. Create your first permission to get started.";return{c(){e=f("div"),e.textContent=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1mj26ks"&&(e.textContent=t),this.h()},h(){a(e,"class","alert alert-info")},m(s,l){K(s,e,l)},p:xe,d(s){s&&h(e)}}}function Tt(r){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(s){e=u(s,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1ne6c0j"&&(e.innerHTML=t),this.h()},h(){a(e,"class","d-flex justify-content-center align-items-center py-5")},m(s,l){K(s,e,l)},p:xe,d(s){s&&h(e)}}}function Je(r){let e,t,s,l=r[20].name+"",c,o,v,L,w=r[20].key+"",g,k,C,I=(r[20].description||"-")+"",T,P,p,m,V='<i class="bi bi-pencil"></i>',i,E,A='<i class="bi bi-trash"></i>',y,_,d;function N(){return r[12](r[20])}function S(){return r[13](r[20])}return{c(){e=f("tr"),t=f("td"),s=f("strong"),c=ee(l),o=M(),v=f("td"),L=f("code"),g=ee(w),k=M(),C=f("td"),T=ee(I),P=M(),p=f("td"),m=f("button"),m.innerHTML=V,i=M(),E=f("button"),E.innerHTML=A,y=M(),this.h()},l(U){e=u(U,"TR",{});var j=D(e);t=u(j,"TD",{});var X=D(t);s=u(X,"STRONG",{});var fe=D(s);c=$(fe,l),fe.forEach(h),X.forEach(h),o=H(j),v=u(j,"TD",{});var oe=D(v);L=u(oe,"CODE",{});var le=D(L);g=$(le,w),le.forEach(h),oe.forEach(h),k=H(j),C=u(j,"TD",{});var ie=D(C);T=$(ie,I),ie.forEach(h),P=H(j),p=u(j,"TD",{});var Y=D(p);m=u(Y,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),z(m)!=="svelte-bt5p8s"&&(m.innerHTML=V),i=H(Y),E=u(Y,"BUTTON",{type:!0,class:!0,title:!0,"data-svelte-h":!0}),z(E)!=="svelte-151u9xf"&&(E.innerHTML=A),Y.forEach(h),y=H(j),j.forEach(h),this.h()},h(){a(m,"type","button"),a(m,"class","btn btn-sm btn-outline-primary me-1"),a(m,"title","Edit"),a(E,"type","button"),a(E,"class","btn btn-sm btn-outline-danger"),a(E,"title","Delete")},m(U,j){K(U,e,j),n(e,t),n(t,s),n(s,c),n(e,o),n(e,v),n(v,L),n(L,g),n(e,k),n(e,C),n(C,T),n(e,P),n(e,p),n(p,m),n(p,i),n(p,E),n(e,y),_||(d=[x(m,"click",N),x(E,"click",S)],_=!0)},p(U,j){r=U,j&4&&l!==(l=r[20].name+"")&&re(c,l),j&4&&w!==(w=r[20].key+"")&&re(g,w),j&4&&I!==(I=(r[20].description||"-")+"")&&re(T,I)},d(U){U&&h(e),_=!1,De(d)}}}function Xe(r){let e,t,s,l=r[16]+"",c,o,v,L,w,g,k='<tr><th>Name</th> <th>Key</th> <th>Description</th> <th style="width: 150px;">Actions</th></tr>',C,I,T,P=ue(r[17]),p=[];for(let m=0;m<P.length;m+=1)p[m]=Je(Qe(r,P,m));return{c(){e=f("div"),t=f("div"),s=f("h5"),c=ee(l),o=M(),v=f("div"),L=f("div"),w=f("table"),g=f("thead"),g.innerHTML=k,C=M(),I=f("tbody");for(let m=0;m<p.length;m+=1)p[m].c();T=M(),this.h()},l(m){e=u(m,"DIV",{class:!0});var V=D(e);t=u(V,"DIV",{class:!0});var i=D(t);s=u(i,"H5",{class:!0});var E=D(s);c=$(E,l),E.forEach(h),i.forEach(h),o=H(V),v=u(V,"DIV",{class:!0});var A=D(v);L=u(A,"DIV",{class:!0});var y=D(L);w=u(y,"TABLE",{class:!0});var _=D(w);g=u(_,"THEAD",{"data-svelte-h":!0}),z(g)!=="svelte-1y3mg69"&&(g.innerHTML=k),C=H(_),I=u(_,"TBODY",{});var d=D(I);for(let N=0;N<p.length;N+=1)p[N].l(d);d.forEach(h),_.forEach(h),y.forEach(h),A.forEach(h),T=H(V),V.forEach(h),this.h()},h(){a(s,"class","mb-0 text-uppercase"),a(t,"class","card-header"),a(w,"class","table table-hover mb-0"),a(L,"class","table-responsive"),a(v,"class","card-body"),a(e,"class","card mb-3")},m(m,V){K(m,e,V),n(e,t),n(t,s),n(s,c),n(e,o),n(e,v),n(v,L),n(L,w),n(w,g),n(w,C),n(w,I);for(let i=0;i<p.length;i+=1)p[i]&&p[i].m(I,null);n(e,T)},p(m,V){if(V&4&&l!==(l=m[16]+"")&&re(c,l),V&772){P=ue(m[17]);let i;for(i=0;i<P.length;i+=1){const E=Qe(m,P,i);p[i]?p[i].p(E,V):(p[i]=Je(E),p[i].c(),p[i].m(I,null))}for(;i<p.length;i+=1)p[i].d(1);p.length=P.length}},d(m){m&&h(e),Te(p,m)}}}function Dt(r){let e,t,s,l="Permissions",c,o,v=`<i class="bi bi-plus-lg me-1"></i>
				Create Permission`,L,w,g,k,C,I,T,P,p,m,V,i=r[3]&&Ge(r);function E(_,d){return _[4]?Tt:_[5].length===0?kt:wt}let A=E(r),y=A(r);return P=new Ct({props:{id:"permission-form-drawer",permission:r[1],onSave:r[14]}}),{c(){e=f("div"),t=f("div"),s=f("h2"),s.textContent=l,c=M(),o=f("button"),o.innerHTML=v,L=M(),i&&i.c(),w=M(),g=f("div"),k=f("div"),C=f("input"),I=M(),y.c(),T=M(),Me(P.$$.fragment),this.h()},l(_){e=u(_,"DIV",{class:!0});var d=D(e);t=u(d,"DIV",{class:!0});var N=D(t);s=u(N,"H2",{"data-svelte-h":!0}),z(s)!=="svelte-1dupqde"&&(s.textContent=l),c=H(N),o=u(N,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),z(o)!=="svelte-mxnanj"&&(o.innerHTML=v),N.forEach(h),L=H(d),i&&i.l(d),w=H(d),g=u(d,"DIV",{class:!0});var S=D(g);k=u(S,"DIV",{class:!0});var U=D(k);C=u(U,"INPUT",{type:!0,class:!0,placeholder:!0}),U.forEach(h),S.forEach(h),I=H(d),y.l(d),d.forEach(h),T=H(_),He(P.$$.fragment,_),this.h()},h(){a(o,"type","button"),a(o,"class","btn btn-primary"),a(t,"class","d-flex justify-content-between align-items-center mb-4"),a(C,"type","text"),a(C,"class","form-control"),a(C,"placeholder","Search permissions..."),a(k,"class","card-body"),a(g,"class","card mb-4"),a(e,"class","container-fluid py-4")},m(_,d){K(_,e,d),n(e,t),n(t,s),n(t,c),n(t,o),n(e,L),i&&i.m(e,null),n(e,w),n(e,g),n(g,k),n(k,C),J(C,r[0]),n(e,I),y.m(e,null),K(_,T,d),Oe(P,_,d),p=!0,m||(V=[x(o,"click",r[7]),x(C,"input",r[11])],m=!0)},p(_,d){_[3]?i?i.p(_,d):(i=Ge(_),i.c(),i.m(e,w)):i&&(i.d(1),i=null),d&1&&C.value!==_[0]&&J(C,_[0]),A===(A=E(_))&&y?y.p(_,d):(y.d(1),y=A(_),y&&(y.c(),y.m(e,null)));const N={};d&2&&(N.permission=_[1]),d&2&&(N.onSave=_[14]),P.$set(N)},i(_){p||(Pe(P.$$.fragment,_),p=!0)},o(_){Le(P.$$.fragment,_),p=!1},d(_){_&&(h(e),h(T)),i&&i.d(),y.d(),Ie(P,_),m=!1,De(V)}}}function It(r){let e,t;return e=new rt({props:{pageTitle:"Manage Permissions",$$slots:{default:[Dt]},$$scope:{ctx:r}}}),{c(){Me(e.$$.fragment)},l(s){He(e.$$.fragment,s)},m(s,l){Oe(e,s,l),t=!0},p(s,[l]){const c={};l&8388671&&(c.$$scope={dirty:l,ctx:s}),e.$set(c)},i(s){t||(Pe(e.$$.fragment,s),t=!0)},o(s){Le(e.$$.fragment,s),t=!1},d(s){Ie(e,s)}}}function Ye(r){const e=document.getElementById(r);if(e){const t=window.bootstrap;t?.Offcanvas&&new t.Offcanvas(e).show()}}function Lt(r,e,t){let s,l,c,o,v,L;ce(r,ht,i=>t(10,l=i)),ce(r,mt,i=>t(3,o=i)),ce(r,_t,i=>t(4,v=i)),ce(r,pt,i=>t(5,L=i));const{stores:{currentUserHasPermission:w}}=lt();ce(r,w,i=>t(15,c=i));let g=null,k="";Ze(async()=>{if(!c(nt.ManageUsers)){ot("/home");return}await ft()});function C(){t(1,g=null),Ye("permission-form-drawer")}function I(i){t(1,g=i),Ye("permission-form-drawer")}async function T(i){if(confirm(`Are you sure you want to delete the permission "${i.name}"? This will remove it from all roles.`))try{await dt(i.id)}catch(E){alert(`Failed to delete permission: ${E instanceof Error?E.message:"Unknown error"}`)}}function P(){k=this.value,t(0,k)}const p=i=>I(i),m=i=>T(i),V=()=>{t(1,g=null)};return r.$$.update=()=>{r.$$.dirty&1025&&t(2,s=Object.entries(l).filter(([i,E])=>{if(!k)return!0;const A=k.toLowerCase();return i.toLowerCase().includes(A)||E.some(y=>y.name.toLowerCase().includes(A)||y.key.toLowerCase().includes(A)||y.description?.toLowerCase().includes(A))}))},[k,g,s,o,v,L,w,C,I,T,l,P,p,m,V]}class St extends $e{constructor(e){super(),et(this,e,Lt,It,We,{})}}export{St as component};
