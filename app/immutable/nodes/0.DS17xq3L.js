import{s as U,l as C,d as b,u as V,m as H,o as O,i as y,q as j,g as w,j as g,k as D,r as P,n as M,y as q,b as m,A as I,p as d,c as _,e as k,w as E,h as v}from"../chunks/Dvm0vAjZ.js";import{S as B,i as F,t as z,a as R}from"../chunks/C0L9un44.js";import{g as Y}from"../chunks/Bw6F-9P_.js";const G=!0,Z=Object.freeze(Object.defineProperty({__proto__:null,prerender:G},Symbol.toStringTag,{value:"Module"}));function L(u){let s,r,f,o,p=`<strong>Update Available</strong><br/>
			A new version of the app is available. Please reload to get the latest features and bug fixes.`,l,t,h='<i class="bi bi-arrow-clockwise"></i> Reload Now',i,e,a,N;return{c(){s=v("div"),r=v("i"),f=g(),o=v("div"),o.innerHTML=p,l=g(),t=v("button"),t.innerHTML=h,i=g(),e=v("button"),this.h()},l(n){s=_(n,"DIV",{class:!0,role:!0});var c=k(s);r=_(c,"I",{class:!0}),k(r).forEach(b),f=w(c),o=_(c,"DIV",{class:!0,"data-svelte-h":!0}),E(o)!=="svelte-deeehk"&&(o.innerHTML=p),l=w(c),t=_(c,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),E(t)!=="svelte-1fsc537"&&(t.innerHTML=h),i=w(c),e=_(c,"BUTTON",{type:!0,class:!0,"aria-label":!0}),k(e).forEach(b),c.forEach(b),this.h()},h(){d(r,"class","bi bi-arrow-clockwise"),d(o,"class","flex-grow-1"),d(t,"type","button"),d(t,"class","btn btn-sm btn-primary"),d(e,"type","button"),d(e,"class","btn-close"),d(e,"aria-label","Close"),d(s,"class","alert alert-info alert-dismissible d-flex align-items-center gap-2 m-3"),d(s,"role","alert")},m(n,c){y(n,s,c),m(s,r),m(s,f),m(s,o),m(s,l),m(s,t),m(s,i),m(s,e),a||(N=[I(t,"click",u[5]),I(e,"click",u[8])],a=!0)},p:M,d(n){n&&b(s),a=!1,q(N)}}}function S(u){let s,r,f,o,p=`<strong>Session Expired</strong><br/>
			Your authentication token has expired. Please log in again to continue.`,l,t,h,i;return{c(){s=v("div"),r=v("i"),f=g(),o=v("div"),o.innerHTML=p,l=g(),t=v("button"),this.h()},l(e){s=_(e,"DIV",{class:!0,role:!0});var a=k(s);r=_(a,"I",{class:!0}),k(r).forEach(b),f=w(a),o=_(a,"DIV",{"data-svelte-h":!0}),E(o)!=="svelte-1pap48h"&&(o.innerHTML=p),l=w(a),t=_(a,"BUTTON",{type:!0,class:!0,"aria-label":!0}),k(t).forEach(b),a.forEach(b),this.h()},h(){d(r,"class","bi bi-clock-history"),d(t,"type","button"),d(t,"class","btn-close"),d(t,"aria-label","Close"),d(s,"class","alert alert-warning alert-dismissible d-flex align-items-center gap-2 m-3"),d(s,"role","alert")},m(e,a){y(e,s,a),m(s,r),m(s,f),m(s,o),m(s,l),m(s,t),h||(i=I(t,"click",u[4]),h=!0)},p:M,d(e){e&&b(s),h=!1,i()}}}function J(u){let s,r,f,o,p;document.title=s="Lehi31 | "+u[2];let l=u[1]&&L(u),t=u[0]&&S(u);const h=u[7].default,i=C(h,u,u[6],null);return{c(){r=g(),l&&l.c(),f=g(),t&&t.c(),o=g(),i&&i.c()},l(e){j("svelte-1y0838e",document.head).forEach(b),r=w(e),l&&l.l(e),f=w(e),t&&t.l(e),o=w(e),i&&i.l(e)},m(e,a){y(e,r,a),l&&l.m(e,a),y(e,f,a),t&&t.m(e,a),y(e,o,a),i&&i.m(e,a),p=!0},p(e,[a]){(!p||a&4)&&s!==(s="Lehi31 | "+e[2])&&(document.title=s),e[1]?l?l.p(e,a):(l=L(e),l.c(),l.m(f.parentNode,f)):l&&(l.d(1),l=null),e[0]?t?t.p(e,a):(t=S(e),t.c(),t.m(o.parentNode,o)):t&&(t.d(1),t=null),i&&i.p&&(!p||a&64)&&V(i,h,e,e[6],p?O(h,e[6],a,null):H(e[6]),null)},i(e){p||(R(i,e),p=!0)},o(e){z(i,e),p=!1},d(e){e&&(b(r),b(f),b(o)),l&&l.d(e),t&&t.d(e),i&&i.d(e)}}}function K(u,s,r){let f,{$$slots:o={},$$scope:p}=s;const{stores:{pageName:l}}=Y();D(u,l,n=>r(2,f=n));let t=!1,h=!1;const i=async()=>{try{const n=await fetch("/api/version"),{version:c}=await n.json(),T=parseInt(c),A=parseInt("1766511800134");return!isNaN(T)&&!isNaN(A)&&T>A?(console.warn("[App] New version available:",c,"current:","1766511800134","(server is newer)"),!0):(c!=="1766511800134"&&console.log("[App] Version mismatch but client is newer or equal:","server:",c,"client:","1766511800134"),!1)}catch(n){return console.error("[App] Failed to check for updates:",n),!1}};P(()=>{{sessionStorage.getItem("authExpired")==="true"&&(r(0,t=!0),setTimeout(()=>{r(0,t=!1),sessionStorage.removeItem("authExpired")},1e4));{const n=async()=>{await i()&&r(1,h=!0)};n();const c=setInterval(n,5*60*1e3);return()=>clearInterval(c)}}});const e=()=>{r(0,t=!1),sessionStorage.removeItem("authExpired")},a=async()=>{try{if("caches"in window){const n=await caches.keys();await Promise.all(n.map(c=>caches.delete(c))),console.log("[App] Cleared service worker caches")}}catch(n){console.error("[App] Failed to clear caches:",n)}finally{window.location.href=window.location.href}},N=()=>r(1,h=!1);return u.$$set=n=>{"$$scope"in n&&r(6,p=n.$$scope)},[t,h,f,l,e,a,p,o,N]}class x extends B{constructor(s){super(),F(this,s,K,J,U,{})}}export{x as component,Z as universal};
