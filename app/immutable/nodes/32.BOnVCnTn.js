import{a as yt}from"../chunks/CnC24E_g.js";import{P as Ze,g as pt,c as Pe}from"../chunks/B81WrLzQ.js";import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{P as wt}from"../chunks/CUEBWtw3.js";import{d as kt,w as Ke,g as nt,o as xt}from"../chunks/DjNGvcU6.js";import{p as ot,aj as We,w as ft,g as a,ak as _t,c as m,t as oe,a as lt,E as _e,s as w,D as K,u as R,r as h,ao as rt,f as ve,F as Ue,i as ht,R as Et}from"../chunks/JKZwkikK.js";import{p as Ve,b as Ne,i as Q,e as ze,a as dt,s as pe,h as Ct,o as St,c as mt}from"../chunks/BxjzTaz1.js";import{e as st,i as it}from"../chunks/B2BlSr7K.js";import{f as P,a as C,c as je,t as vt}from"../chunks/JDsN5plM.js";import{r as qe,d as Mt,b as Rt,s as Ge}from"../chunks/CgfurAch.js";import{b as Be}from"../chunks/BL6gm64P.js";import{i as ut}from"../chunks/b8c_lO2i.js";import{S as Xe}from"../chunks/BLDVij4H.js";import{c as Dt}from"../chunks/Cv_ZP7th.js";import{g as It,d as Ot,u as Ft,c as Lt,a as Tt}from"../chunks/g_Iiv-i0.js";import{c as At,a as at,b as $t,V as Pt,d as jt,g as Nt}from"../chunks/BvzMQ0uj.js";import{v as zt,D as Ut}from"../chunks/CTCkM8Z0.js";const Vt=!1,qt=async()=>(yt(Ze.ViewMembers,"View Members"),{}),ca=Object.freeze(Object.defineProperty({__proto__:null,load:qt,ssr:Vt},Symbol.toStringTag,{value:"Module"}));let Qe=null;const Bt=()=>{const T=Ke(!1),j=Ke([]),s=Ke(""),l=kt([j,s],([N,V])=>{if(!V.trim())return N;const te=V.toLowerCase();return N.filter(ee=>{const c=ee.first_name?.toLowerCase()||"",de=ee.last_name?.toLowerCase()||"",xe=`${c} ${de}`.trim();return c.includes(te)||de.includes(te)||xe.includes(te)})});return Qe={stores:{ready:T,members:j,searchQuery:s,filteredMembers:l},actions:{reload:async()=>{T.set(!1);const N=await It();j.set(N),T.set(!0)}}},Qe},ct=()=>Qe?.stores&&Object.keys(Qe.stores).length>0?Qe:Bt(),Ht=At().shape({first_name:at().required("First name is required").min(2,"First name must be at least 2 characters").max(100,"First name cannot exceed 100 characters"),last_name:at().nullable().min(2,"Last name must be at least 2 characters").max(100,"Last name cannot exceed 100 characters"),date_of_birth:$t().nullable().max(new Date,"Date of birth cannot be in the future").test("reasonable-age","Date of birth must be after 1900",function(T){return T?T>=new Date("1900-01-01"):!0}),phone_number:at().nullable().matches(/^[0-9()\s.-]*$/,"Invalid phone number format (use digits, dashes, parentheses, spaces)").min(10,"Phone number must be at least 10 characters").max(20,"Phone number cannot exceed 20 characters")});function bt(){const T=Ke({});async function j(O){try{return await Ht.validate(O,{abortEarly:!1}),T.set({}),!0}catch(N){if(N instanceof Pt){const V={};return N.inner.forEach(te=>{te.path&&(V[te.path]=te.message)}),T.set(V),!1}return!1}}function s(){T.set({})}function l(){return Object.values(T).filter(N=>N.length>0)}return{validationErrors:T,validate:j,clearErrors:s,getErrorMessages:l}}async function Kt({id:T,first_name:j,last_name:s,date_of_birth:l,phone_number:O}){const N={first_name:j,last_name:s||"",date_of_birth:l?new Date(l):void 0,phone_number:O||void 0};return T?{action:"update",member:await Ft(T,N)}:{action:"create",member:await Lt(N)}}async function Wt(T){await Ot(T)}function Qt(){return{saveMember:Kt,deleteMemberById:Wt}}var Jt=P('<div class="invalid-feedback"> </div>'),Yt=P('<div class="invalid-feedback"> </div>'),Gt=P('<div class="invalid-feedback"> </div>'),Zt=P('<div class="invalid-feedback"> </div>'),Xt=P('<div><label for="member-dob" class="form-label">Date of Birth</label> <input id="member-dob" type="date"/> <!></div> <div><label for="member-phone" class="form-label">Phone Number</label> <input id="member-phone" type="tel" placeholder="(555) 123-4567"/> <!></div>',1),er=P('<div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> Date of birth and phone number fields are restricted to bishopric and clerks.</div>'),tr=P('<button class="btn btn-danger position-relative"><span>Delete</span></button>'),rr=P("<span>Save</span>"),ar=P("<span>Create</span>"),sr=P('<span class="position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"><span class="visually-hidden">Item not saved</span></span>'),ir=P('<div class="d-flex flex-column gap-4"><div class="d-flex flex-column gap-3"><h2 class="h5 mb-0">Member Details</h2> <div><label for="member-first-name" class="form-label">First Name <span class="text-danger">*</span></label> <input id="member-first-name" type="text" placeholder="John"/> <!></div> <div><label for="member-last-name" class="form-label">Last Name</label> <input id="member-last-name" type="text" placeholder="Doe"/> <!></div> <!></div> <div class="d-flex justify-content-between align-items-center gap-2 flex-row"><div class="d-flex flex-row gap-2"><!></div> <div class="d-flex flex-row gap-2"><button class="btn btn-secondary position-relative">Cancel</button> <button class="btn btn-primary position-relative"><!> <!></button></div></div> <div class="d-flex justify-content-end align-items-center gap-2 flex-row"><small> </small> <span><!></span></div></div>');function nr(T,j){ot(j,!1);const s=()=>Ne(de,"$currentUserHasPermission",O),l=()=>Ne(Se,"$validationErrors",O),[O,N]=dt(),V=_e(),te=_e();let ee=Ve(j,"memberId",8,void 0),c=Ve(j,"drawerId",8,"");const{stores:{currentUserHasPermission:de}}=pt(),{stores:{members:xe},actions:{reload:Ce}}=ct(),ye=s()(Ze.ViewSensitiveMemberData),{validationErrors:Se,validate:De,clearErrors:ce,getErrorMessages:Ee}=bt(),{saveMember:we,deleteMemberById:ke}=Qt();let Z=_e(!1),ge={first_name:"",last_name:"",date_of_birth:void 0,phone_number:void 0},ae=_e({...ge}),S=_e({message:"",type:"info"}),e=_e(""),t=_e(""),r=_e(""),u=_e("");function f(){if(!ee()){D();return}K(Z,!0);const i=nt(xe).find(b=>b.id===ee());i&&(ge={...i},K(ae,{...i}),K(e,i.first_name||""),K(t,i.last_name||""),K(r,i.date_of_birth?new Date(i.date_of_birth).toISOString().split("T")[0]:""),K(u,i.phone_number?.toString()||"")),K(Z,!1)}function D(){ge={first_name:"",last_name:"",date_of_birth:void 0,phone_number:void 0},K(ae,{...ge}),K(e,""),K(t,""),K(r,""),K(u,""),ce()}const X=()=>{const i=`[data-bs-target="#${c()}"]`,b=document.querySelector(i);b&&b.click()},se=(i,b=0,me="info")=>{rt(S,a(S).message=i),rt(S,a(S).type=me),b&&setTimeout(()=>{rt(S,a(S).message="")},b)},he=async()=>{if(!a(V)){se("Member ID is not defined",0,"danger");return}try{await ke(a(V)),await Ce(),setTimeout(()=>{K(Z,!1),se("Member Deleted",3e3,"success"),X()},800)}catch(i){setTimeout(()=>{K(Z,!1),console.error("Delete failed:",i),se("Failed to delete member. Please try again.",7e3,"danger")},800)}},F=async()=>{K(Z,!0),Dt({title:"Delete Confirmation",message:"Are you sure you want to delete this member? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:i=>{i?he():K(Z,!1)}})},v=async()=>{if(a(V)&&!a(te)){se("Nothing has changed, there is nothing to save.",7e3);return}if(!await De({first_name:a(e),last_name:a(t),date_of_birth:a(r),phone_number:a(u)})){const b=Ee();b.length&&se(b.join(". ")+". Please address accordingly.",0,"danger");return}if(!a(Z)){se("Saving ..."),K(Z,!0);try{await we({id:a(V),first_name:a(e),last_name:a(t),date_of_birth:a(r),phone_number:a(u)}),await Ce(),setTimeout(()=>{K(Z,!1),K(ae,{...ge,id:a(V)}),se("Saved",3e3,"success"),X()},800)}catch(b){setTimeout(()=>{K(Z,!1),console.error("Save failed:",b),se("Failed to save member. Please try again.",7e3,"danger")},800)}}};We(()=>ft(ee()),()=>{K(V,ee())}),We(()=>(a(ae),a(e),a(t),a(r),a(u)),()=>{K(te,a(ae).first_name!==a(e)||a(ae).last_name!==a(t)||a(ae).date_of_birth?.toString()!==(a(r)||void 0)||a(ae).phone_number?.toString()!==(a(u)||void 0))}),We(()=>(ft(ee()),a(ae)),()=>{ee()!==void 0&&ee()!==a(ae).id&&f()}),_t(),ut();var n=ir(),z=m(n),g=w(m(z),2),k=w(m(g),2);qe(k);let o;var U=w(k,2);{var B=i=>{var b=Jt(),me=m(b,!0);h(b),oe(()=>pe(me,(l(),R(()=>l().first_name)))),C(i,b)};Q(U,i=>{l(),R(()=>l().first_name)&&i(B)})}h(g);var W=w(g,2),J=w(m(W),2);qe(J);let p;var E=w(J,2);{var A=i=>{var b=Yt(),me=m(b,!0);h(b),oe(()=>pe(me,(l(),R(()=>l().last_name)))),C(i,b)};Q(E,i=>{l(),R(()=>l().last_name)&&i(A)})}h(W);var _=w(W,2);{var x=i=>{var b=Xt(),me=ve(b),Fe=w(m(me),2);qe(Fe);let Je;var Oe=w(Fe,2);{var Le=Re=>{var $e=Gt(),tt=m($e,!0);h($e),oe(()=>pe(tt,(l(),R(()=>l().date_of_birth)))),C(Re,$e)};Q(Oe,Re=>{l(),R(()=>l().date_of_birth)&&Re(Le)})}h(me);var Te=w(me,2),Ae=w(m(Te),2);qe(Ae);let Ye;var He=w(Ae,2);{var et=Re=>{var $e=Zt(),tt=m($e,!0);h($e),oe(()=>pe(tt,(l(),R(()=>l().phone_number)))),C(Re,$e)};Q(He,Re=>{l(),R(()=>l().phone_number)&&Re(et)})}h(Te),oe(()=>{Je=Pe(Fe,1,"form-control",null,Je,{"is-invalid":l().date_of_birth}),Fe.disabled=a(Z),Ye=Pe(Ae,1,"form-control",null,Ye,{"is-invalid":l().phone_number}),Ae.disabled=a(Z)}),Be(Fe,()=>a(r),Re=>K(r,Re)),Be(Ae,()=>a(u),Re=>K(u,Re)),C(i,b)},$=i=>{var b=er();C(i,b)};Q(_,i=>{ye?i(x):i($,!1)})}h(z);var M=w(z,2),I=m(M),y=m(I);{var q=i=>{var b=tr();oe(()=>b.disabled=a(Z)),ze("click",b,F),C(i,b)};Q(y,i=>{a(V)&&i(q)})}h(I);var d=w(I,2),L=m(d),le=w(L,2),fe=m(le);{var ne=i=>{var b=rr();C(i,b)},be=i=>{var b=ar();C(i,b)};Q(fe,i=>{a(V)?i(ne):i(be,!1)})}var re=w(fe,2);{var Y=i=>{var b=sr();C(i,b)};Q(re,i=>{a(te)&&i(Y)})}h(le),h(d),h(M);var H=w(M,2),G=m(H),ue=m(G,!0);h(G);var Me=w(G,2);let Ie;var ie=m(Me);Xe(ie,{size:"xs"}),h(Me),h(H),h(n),oe(()=>{o=Pe(k,1,"form-control",null,o,{"is-invalid":l().first_name}),k.disabled=a(Z),p=Pe(J,1,"form-control",null,p,{"is-invalid":l().last_name}),J.disabled=a(Z),L.disabled=a(Z),le.disabled=a(Z),Pe(G,1,`fw-lighter fst-italic text-${a(S),R(()=>a(S).type)??""}`),pe(ue,(a(S),R(()=>a(S).message))),Ie=Pe(Me,1,"",null,Ie,{"d-none":!a(Z)})}),Be(k,()=>a(e),i=>K(e,i)),Be(J,()=>a(t),i=>K(t,i)),ze("click",L,X),ze("click",le,v),C(T,n),lt(),N()}var gt={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(T,j){((s,l)=>{T.exports=l()})(jt,function s(){var l=typeof self<"u"?self:typeof window<"u"?window:l!==void 0?l:{},O,N=!l.document&&!!l.postMessage,V=l.IS_PAPA_WORKER||!1,te={},ee=0,c={};function de(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var r=ge(t);r.chunkSize=parseInt(r.chunkSize),t.step||t.chunk||(r.chunkSize=null),this._handle=new De(r),(this._handle.streamer=this)._config=r}.call(this,e),this.parseChunk=function(t,r){var u=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<u){let D=this._config.newline;D||(f=this._config.quoteChar||'"',D=this._handle.guessLineEndings(t,f)),t=[...t.split(D).slice(u)].join(D)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&(f=this._config.beforeFirstChunk(t))!==void 0&&(t=f),this.isFirstChunk=!1,this._halted=!1;var u=this._partialLine+t,f=(this._partialLine="",this._handle.parse(u,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=f.meta.cursor,u=(this._finished||(this._partialLine=u.substring(t-this._baseIndex),this._baseIndex=t),f&&f.data&&(this._rowCount+=f.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),V)l.postMessage({results:f,workerId:c.WORKER_ID,finished:u});else if(S(this._config.chunk)&&!r){if(this._config.chunk(f,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=f=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(f.data),this._completeResults.errors=this._completeResults.errors.concat(f.errors),this._completeResults.meta=f.meta),this._completed||!u||!S(this._config.complete)||f&&f.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||f&&f.meta.paused||this._nextChunk(),f}this._halted=!0},this._sendError=function(t){S(this._config.error)?this._config.error(t):V&&this._config.error&&l.postMessage({workerId:c.WORKER_ID,error:t,finished:!1})}}function xe(e){var t;(e=e||{}).chunkSize||(e.chunkSize=c.RemoteChunkSize),de.call(this,e),this._nextChunk=N?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(r){this._input=r,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),N||(t.onload=ae(this._chunkLoaded,this),t.onerror=ae(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!N),this._config.downloadRequestHeaders){var r,u=this._config.downloadRequestHeaders;for(r in u)t.setRequestHeader(r,u[r])}var f;this._config.chunkSize&&(f=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+f));try{t.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}N&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(r=>(r=r.getResponseHeader("Content-Range"))!==null?parseInt(r.substring(r.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(r){r=t.statusText||r,this._sendError(new Error(r))}}function Ce(e){(e=e||{}).chunkSize||(e.chunkSize=c.LocalChunkSize),de.call(this,e);var t,r,u=typeof FileReader<"u";this.stream=function(f){this._input=f,r=f.slice||f.webkitSlice||f.mozSlice,u?((t=new FileReader).onload=ae(this._chunkLoaded,this),t.onerror=ae(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var f=this._input,D=(this._config.chunkSize&&(D=Math.min(this._start+this._config.chunkSize,this._input.size),f=r.call(f,this._start,D)),t.readAsText(f,this._config.encoding));u||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(f){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(f.target.result)},this._chunkError=function(){this._sendError(t.error)}}function ye(e){var t;de.call(this,e=e||{}),this.stream=function(r){return t=r,this._nextChunk()},this._nextChunk=function(){var r,u;if(!this._finished)return r=this._config.chunkSize,t=r?(u=t.substring(0,r),t.substring(r)):(u=t,""),this._finished=!t,this.parseChunk(u)}}function Se(e){de.call(this,e=e||{});var t=[],r=!0,u=!1;this.pause=function(){de.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){de.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(f){this._input=f,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){u&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=ae(function(f){try{t.push(typeof f=="string"?f:f.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(D){this._streamError(D)}},this),this._streamError=ae(function(f){this._streamCleanUp(),this._sendError(f)},this),this._streamEnd=ae(function(){this._streamCleanUp(),u=!0,this._streamData("")},this),this._streamCleanUp=ae(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function De(e){var t,r,u,f,D=Math.pow(2,53),X=-D,se=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,he=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,F=this,v=0,n=0,z=!1,g=!1,k=[],o={data:[],errors:[],meta:{}};function U(p){return e.skipEmptyLines==="greedy"?p.join("").trim()==="":p.length===1&&p[0].length===0}function B(){if(o&&u&&(J("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),u=!1),e.skipEmptyLines&&(o.data=o.data.filter(function(_){return!U(_)})),W()){let _=function(x,$){S(e.transformHeader)&&(x=e.transformHeader(x,$)),k.push(x)};if(o)if(Array.isArray(o.data[0])){for(var p=0;W()&&p<o.data.length;p++)o.data[p].forEach(_);o.data.splice(0,1)}else o.data.forEach(_)}function E(_,x){for(var $=e.header?{}:[],M=0;M<_.length;M++){var I=M,y=_[M],y=((q,d)=>(L=>(e.dynamicTypingFunction&&e.dynamicTyping[L]===void 0&&(e.dynamicTyping[L]=e.dynamicTypingFunction(L)),(e.dynamicTyping[L]||e.dynamicTyping)===!0))(q)?d==="true"||d==="TRUE"||d!=="false"&&d!=="FALSE"&&((L=>{if(se.test(L)&&(L=parseFloat(L),X<L&&L<D))return 1})(d)?parseFloat(d):he.test(d)?new Date(d):d===""?null:d):d)(I=e.header?M>=k.length?"__parsed_extra":k[M]:I,y=e.transform?e.transform(y,I):y);I==="__parsed_extra"?($[I]=$[I]||[],$[I].push(y)):$[I]=y}return e.header&&(M>k.length?J("FieldMismatch","TooManyFields","Too many fields: expected "+k.length+" fields but parsed "+M,n+x):M<k.length&&J("FieldMismatch","TooFewFields","Too few fields: expected "+k.length+" fields but parsed "+M,n+x)),$}var A;o&&(e.header||e.dynamicTyping||e.transform)&&(A=1,!o.data.length||Array.isArray(o.data[0])?(o.data=o.data.map(E),A=o.data.length):o.data=E(o.data,0),e.header&&o.meta&&(o.meta.fields=k),n+=A)}function W(){return e.header&&k.length===0}function J(p,E,A,_){p={type:p,code:E,message:A},_!==void 0&&(p.row=_),o.errors.push(p)}S(e.step)&&(f=e.step,e.step=function(p){o=p,W()?B():(B(),o.data.length!==0&&(v+=p.data.length,e.preview&&v>e.preview?r.abort():(o.data=o.data[0],f(o,F))))}),this.parse=function(p,E,A){var _=e.quoteChar||'"',_=(e.newline||(e.newline=this.guessLineEndings(p,_)),u=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(p),o.meta.delimiter=e.delimiter):((_=((x,$,M,I,y)=>{var q,d,L,le;y=y||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var fe=0;fe<y.length;fe++){for(var ne,be=y[fe],re=0,Y=0,H=0,G=(L=void 0,new Ee({comments:I,delimiter:be,newline:$,preview:10}).parse(x)),ue=0;ue<G.data.length;ue++)M&&U(G.data[ue])?H++:(ne=G.data[ue].length,Y+=ne,L===void 0?L=ne:0<ne&&(re+=Math.abs(ne-L),L=ne));0<G.data.length&&(Y/=G.data.length-H),(d===void 0||re<=d)&&(le===void 0||le<Y)&&1.99<Y&&(d=re,q=be,le=Y)}return{successful:!!(e.delimiter=q),bestDelimiter:q}})(p,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=_.bestDelimiter:(u=!0,e.delimiter=c.DefaultDelimiter),o.meta.delimiter=e.delimiter),ge(e));return e.preview&&e.header&&_.preview++,t=p,r=new Ee(_),o=r.parse(t,E,A),B(),z?{meta:{paused:!0}}:o||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,r.abort(),t=S(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){F.streamer._halted?(z=!1,F.streamer.parseChunk(t,!0)):setTimeout(F.resume,3)},this.aborted=function(){return g},this.abort=function(){g=!0,r.abort(),o.meta.aborted=!0,S(e.complete)&&e.complete(o),t=""},this.guessLineEndings=function(x,_){x=x.substring(0,1048576);var _=new RegExp(ce(_)+"([^]*?)"+ce(_),"gm"),A=(x=x.replace(_,"")).split("\r"),_=x.split(`
`),x=1<_.length&&_[0].length<A[0].length;if(A.length===1||x)return`
`;for(var $=0,M=0;M<A.length;M++)A[M][0]===`
`&&$++;return $>=A.length/2?`\r
`:"\r"}}function ce(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ee(e){var t=(e=e||{}).delimiter,r=e.newline,u=e.comments,f=e.step,D=e.preview,X=e.fastMode,se=null,he=!1,F=e.quoteChar==null?'"':e.quoteChar,v=F;if(e.escapeChar!==void 0&&(v=e.escapeChar),(typeof t!="string"||-1<c.BAD_DELIMITERS.indexOf(t))&&(t=","),u===t)throw new Error("Comment character same as delimiter");u===!0?u="#":(typeof u!="string"||-1<c.BAD_DELIMITERS.indexOf(u))&&(u=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var n=0,z=!1;this.parse=function(g,k,o){if(typeof g!="string")throw new Error("Input must be a string");var U=g.length,B=t.length,W=r.length,J=u.length,p=S(f),E=[],A=[],_=[],x=n=0;if(!g)return re();if(X||X!==!1&&g.indexOf(F)===-1){for(var $=g.split(r),M=0;M<$.length;M++){if(_=$[M],n+=_.length,M!==$.length-1)n+=r.length;else if(o)return re();if(!u||_.substring(0,J)!==u){if(p){if(E=[],le(_.split(t)),Y(),z)return re()}else le(_.split(t));if(D&&D<=M)return E=E.slice(0,D),re(!0)}}return re()}for(var I=g.indexOf(t,n),y=g.indexOf(r,n),q=new RegExp(ce(v)+ce(F),"g"),d=g.indexOf(F,n);;)if(g[n]===F)for(d=n,n++;;){if((d=g.indexOf(F,d+1))===-1)return o||A.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:E.length,index:n}),ne();if(d===U-1)return ne(g.substring(n,d).replace(q,F));if(F===v&&g[d+1]===v)d++;else if(F===v||d===0||g[d-1]!==v){I!==-1&&I<d+1&&(I=g.indexOf(t,d+1));var L=fe((y=y!==-1&&y<d+1?g.indexOf(r,d+1):y)===-1?I:Math.min(I,y));if(g.substr(d+1+L,B)===t){_.push(g.substring(n,d).replace(q,F)),g[n=d+1+L+B]!==F&&(d=g.indexOf(F,n)),I=g.indexOf(t,n),y=g.indexOf(r,n);break}if(L=fe(y),g.substring(d+1+L,d+1+L+W)===r){if(_.push(g.substring(n,d).replace(q,F)),be(d+1+L+W),I=g.indexOf(t,n),d=g.indexOf(F,n),p&&(Y(),z))return re();if(D&&E.length>=D)return re(!0);break}A.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:E.length,index:n}),d++}}else if(u&&_.length===0&&g.substring(n,n+J)===u){if(y===-1)return re();n=y+W,y=g.indexOf(r,n),I=g.indexOf(t,n)}else if(I!==-1&&(I<y||y===-1))_.push(g.substring(n,I)),n=I+B,I=g.indexOf(t,n);else{if(y===-1)break;if(_.push(g.substring(n,y)),be(y+W),p&&(Y(),z))return re();if(D&&E.length>=D)return re(!0)}return ne();function le(H){E.push(H),x=n}function fe(H){var G=0;return G=H!==-1&&(H=g.substring(d+1,H))&&H.trim()===""?H.length:G}function ne(H){return o||(H===void 0&&(H=g.substring(n)),_.push(H),n=U,le(_),p&&Y()),re()}function be(H){n=H,le(_),_=[],y=g.indexOf(r,n)}function re(H){if(e.header&&!k&&E.length&&!he){var G=E[0],ue=Object.create(null),Me=new Set(G);let Ie=!1;for(let ie=0;ie<G.length;ie++){let i=G[ie];if(ue[i=S(e.transformHeader)?e.transformHeader(i,ie):i]){let b,me=ue[i];for(;b=i+"_"+me,me++,Me.has(b););Me.add(b),G[ie]=b,ue[i]++,Ie=!0,(se=se===null?{}:se)[b]=i}else ue[i]=1,G[ie]=i;Me.add(i)}Ie&&console.warn("Duplicate headers found and renamed."),he=!0}return{data:E,errors:A,meta:{delimiter:t,linebreak:r,aborted:z,truncated:!!H,cursor:x+(k||0),renamedHeaders:se}}}function Y(){f(re()),E=[],A=[]}},this.abort=function(){z=!0},this.getCharIndex=function(){return n}}function we(e){var t=e.data,r=te[t.workerId],u=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var f={abort:function(){u=!0,ke(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Z,resume:Z};if(S(r.userStep)){for(var D=0;D<t.results.data.length&&(r.userStep({data:t.results.data[D],errors:t.results.errors,meta:t.results.meta},f),!u);D++);delete t.results}else S(r.userChunk)&&(r.userChunk(t.results,f,t.file),delete t.results)}t.finished&&!u&&ke(t.workerId,t.results)}function ke(e,t){var r=te[e];S(r.userComplete)&&r.userComplete(t),r.terminate(),delete te[e]}function Z(){throw new Error("Not implemented.")}function ge(e){if(typeof e!="object"||e===null)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=ge(e[t]);return r}function ae(e,t){return function(){e.apply(t,arguments)}}function S(e){return typeof e=="function"}return c.parse=function(e,t){var r=(t=t||{}).dynamicTyping||!1;if(S(r)&&(t.dynamicTypingFunction=r,r={}),t.dynamicTyping=r,t.transform=!!S(t.transform)&&t.transform,!t.worker||!c.WORKERS_SUPPORTED)return r=null,c.NODE_STREAM_INPUT,typeof e=="string"?(e=(u=>u.charCodeAt(0)!==65279?u:u.slice(1))(e),r=new(t.download?xe:ye)(t)):e.readable===!0&&S(e.read)&&S(e.on)?r=new Se(t):(l.File&&e instanceof File||e instanceof Object)&&(r=new Ce(t)),r.stream(e);(r=(()=>{var u;return!!c.WORKERS_SUPPORTED&&(u=(()=>{var f=l.URL||l.webkitURL||null,D=s.toString();return c.BLOB_URL||(c.BLOB_URL=f.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))})(),(u=new l.Worker(u)).onmessage=we,u.id=ee++,te[u.id]=u)})()).userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=S(t.step),t.chunk=S(t.chunk),t.complete=S(t.complete),t.error=S(t.error),delete t.worker,r.postMessage({input:e,config:t,workerId:r.id})},c.unparse=function(e,t){var r=!1,u=!0,f=",",D=`\r
`,X='"',se=X+X,he=!1,F=null,v=!1,n=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||c.BAD_DELIMITERS.filter(function(k){return t.delimiter.indexOf(k)!==-1}).length||(f=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(r=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(he=t.skipEmptyLines),typeof t.newline=="string"&&(D=t.newline),typeof t.quoteChar=="string"&&(X=t.quoteChar),typeof t.header=="boolean"&&(u=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");F=t.columns}t.escapeChar!==void 0&&(se=t.escapeChar+X),t.escapeFormulae instanceof RegExp?v=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(v=/^[=+\-@\t\r].*$/)}})(),new RegExp(ce(X),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return z(null,e,he);if(typeof e[0]=="object")return z(F||Object.keys(e[0]),e,he)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||F),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),z(e.fields||[],e.data||[],he);throw new Error("Unable to serialize unrecognized input");function z(k,o,U){var B="",W=(typeof k=="string"&&(k=JSON.parse(k)),typeof o=="string"&&(o=JSON.parse(o)),Array.isArray(k)&&0<k.length),J=!Array.isArray(o[0]);if(W&&u){for(var p=0;p<k.length;p++)0<p&&(B+=f),B+=g(k[p],p);0<o.length&&(B+=D)}for(var E=0;E<o.length;E++){var A=(W?k:o[E]).length,_=!1,x=W?Object.keys(o[E]).length===0:o[E].length===0;if(U&&!W&&(_=U==="greedy"?o[E].join("").trim()==="":o[E].length===1&&o[E][0].length===0),U==="greedy"&&W){for(var $=[],M=0;M<A;M++){var I=J?k[M]:M;$.push(o[E][I])}_=$.join("").trim()===""}if(!_){for(var y=0;y<A;y++){0<y&&!x&&(B+=f);var q=W&&J?k[y]:y;B+=g(o[E][q],y)}E<o.length-1&&(!U||0<A&&!x)&&(B+=D)}}return B}function g(k,o){var U,B;return k==null?"":k.constructor===Date?JSON.stringify(k).slice(1,25):(B=!1,v&&typeof k=="string"&&v.test(k)&&(k="'"+k,B=!0),U=k.toString().replace(n,se),(B=B||r===!0||typeof r=="function"&&r(k,o)||Array.isArray(r)&&r[o]||((W,J)=>{for(var p=0;p<J.length;p++)if(-1<W.indexOf(J[p]))return!0;return!1})(U,c.BAD_DELIMITERS)||-1<U.indexOf(f)||U.charAt(0)===" "||U.charAt(U.length-1)===" ")?X+U+X:U)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!N&&!!l.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=Ee,c.ParserHandle=De,c.NetworkStreamer=xe,c.FileStreamer=Ce,c.StringStreamer=ye,c.ReadableStreamStreamer=Se,l.jQuery&&((O=l.jQuery).fn.parse=function(e){var t=e.config||{},r=[];return this.each(function(D){if(!(O(this).prop("tagName").toUpperCase()==="INPUT"&&O(this).attr("type").toLowerCase()==="file"&&l.FileReader)||!this.files||this.files.length===0)return!0;for(var X=0;X<this.files.length;X++)r.push({file:this.files[X],inputElem:this,instanceConfig:O.extend({},t)})}),u(),this;function u(){if(r.length===0)S(e.complete)&&e.complete();else{var D,X,se,he,F=r[0];if(S(e.before)){var v=e.before(F.file,F.inputElem);if(typeof v=="object"){if(v.action==="abort")return D="AbortError",X=F.file,se=F.inputElem,he=v.reason,void(S(e.error)&&e.error({name:D},X,se,he));if(v.action==="skip")return void f();typeof v.config=="object"&&(F.instanceConfig=O.extend(F.instanceConfig,v.config))}else if(v==="skip")return void f()}var n=F.instanceConfig.complete;F.instanceConfig.complete=function(z){S(n)&&n(z,F.file,F.inputElem),f()},c.parse(F.file,F.instanceConfig)}}function f(){r.splice(0,1),u()}}),V&&(l.onmessage=function(e){e=e.data,c.WORKER_ID===void 0&&e&&(c.WORKER_ID=e.workerId),typeof e.input=="string"?l.postMessage({workerId:c.WORKER_ID,results:c.parse(e.input,e.config),finished:!0}):(l.File&&e.input instanceof File||e.input instanceof Object)&&(e=c.parse(e.input,e.config))&&l.postMessage({workerId:c.WORKER_ID,results:e,finished:!0})}),(xe.prototype=Object.create(de.prototype)).constructor=xe,(Ce.prototype=Object.create(de.prototype)).constructor=Ce,(ye.prototype=Object.create(ye.prototype)).constructor=ye,(Se.prototype=Object.create(de.prototype)).constructor=Se,c})})(gt);var or=gt.exports;const lr=Nt(or);async function dr(T){return new Promise((j,s)=>{lr.parse(T,{header:!0,skipEmptyLines:!0,complete:l=>{const O=l.data,N=l.meta.fields||[];j({data:O,columns:N})},error:l=>s(l)})})}function ur(T,j){return T.map(l=>{const O=l.toLowerCase().trim();if(O.includes("first")&&O.includes("name"))return{csvColumn:l,memberField:"first_name"};if(O.includes("last")&&O.includes("name"))return{csvColumn:l,memberField:"last_name"};if(j){if(O.includes("birth")||O.includes("dob"))return{csvColumn:l,memberField:"date_of_birth"};if(O.includes("phone"))return{csvColumn:l,memberField:"phone_number"}}return{csvColumn:l,memberField:null}})}async function cr(T,j){const{validate:s,validationErrors:l}=bt(),O={first_name:""};j.forEach(te=>{const ee=T[te.csvColumn];if(!te.memberField||!ee)return;const c=ee.trim();switch(te.memberField){case"first_name":O.first_name=c;break;case"last_name":O.last_name=c;break;case"date_of_birth":O.date_of_birth=c;break;case"phone_number":O.phone_number=c;break}}),await s(O);const N=nt(l),V=Object.values(N).filter(Boolean);return{isValid:V.length===0,errors:V}}function fr(T,j){const s=ct();return s?nt(s.stores.members).some(O=>O.first_name.toLowerCase()===T.toLowerCase()&&(O.last_name||"").toLowerCase()===(j||"").toLowerCase()):!1}async function hr(T,j){const s={success:0,duplicates:0,validationErrors:0,errors:[]},l=[];for(let O=0;O<T.length;O++){const N=T[O],V={};if(j.forEach(c=>{if(c.memberField&&N[c.csvColumn]){const de=N[c.csvColumn].trim();c.memberField==="date_of_birth"?V[c.memberField]=new Date(de):V[c.memberField]=de}}),!V.first_name){s.validationErrors++,s.errors.push({row:O+1,field:"first_name",message:"First name is required"});continue}if(fr(V.first_name,V.last_name||"")){s.duplicates++;continue}const ee=await cr(N,j);if(!ee.isValid){s.validationErrors++,ee.errors.forEach(c=>{s.errors.push({row:O+1,field:"unknown",message:c})});continue}l.push(V)}return l.length>0&&(await Tt(l),s.success=l.length),s}function mr(T){const j=Ke({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null});return{state:j,parseCsvFile:dr,autoDetectMappings:s=>ur(s,T),importMembers:hr,reset:()=>j.set({step:"upload",csvData:[],csvColumns:[],columnMappings:[],importResult:null})}}var vr=P(`<div class="mb-3"><label for="csvFile" class="form-label">Select CSV File</label> <input type="file" class="form-control" id="csvFile" accept=".csv"/> <div class="form-text">CSV file should include columns for: First Name, Last Name, Date of Birth, Phone
							Number</div></div>`),pr=P("<option>Date of Birth</option> <option>Phone Number</option>",1),_r=P('<tr><td> </td><td><select class="form-select form-select-sm"><option>-- Skip --</option><option>First Name</option><option>Last Name</option><!></select></td></tr>'),br=P('<h6>Map CSV Columns to Member Fields</h6> <p class="text-muted"> </p> <table class="table table-sm"><thead><tr><th>CSV Column</th><th>Maps To</th></tr></thead><tbody></tbody></table>',1),gr=P('<div class="text-center py-5"><!> <p class="mt-3">Importing members...</p></div>'),yr=P("<li><strong> </strong> duplicates skipped</li>"),wr=P("<li><strong> </strong> rows had validation errors</li>"),kr=P("<li> </li>"),xr=P("<li><em> </em></li>"),Er=P('<div class="alert alert-warning"><h6>Validation Errors:</h6> <ul class="mb-0" style="max-height: 200px; overflow-y: auto;"><!> <!></ul></div>'),Cr=P('<div class="alert alert-success"><h6>Import Complete</h6> <ul class="mb-0"><li><strong> </strong> members imported successfully</li> <!> <!></ul></div> <!>',1),Sr=P('<button type="button" class="btn btn-secondary">Cancel</button>'),Mr=P('<button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-primary"> </button>',1),Rr=P('<button type="button" class="btn btn-secondary" disabled>Cancel</button> <button type="button" class="btn btn-primary" disabled><!> Importing...</button>',1),Dr=P('<button type="button" class="btn btn-primary">Done</button>'),Ir=P('<div class="modal-backdrop fade show"></div>'),Or=P('<div tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Import Members from CSV</h5> <button type="button" class="btn-close" aria-label="Close import modal"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><!></div></div></div></div> <!>',1);function Fr(T,j){ot(j,!1);const s=()=>Ne(c,"$state",l),[l,O]=dt();let N=Ve(j,"isOpen",8,!1),V=Ve(j,"onClose",8),te=Ve(j,"onComplete",8),ee=Ve(j,"canViewSensitiveData",8,!1);const{state:c,parseCsvFile:de,autoDetectMappings:xe,importMembers:Ce,reset:ye}=mr(ee());async function Se(v){const n=v.target.files?.[0];if(n)try{const{data:z,columns:g}=await de(n),k=xe(g);c.update(o=>({...o,step:"mapping",csvData:z,csvColumns:g,columnMappings:k}))}catch(z){console.error("Failed to parse CSV:",z),alert("Failed to parse CSV file. Please check the file format.")}}async function De(){try{const v=await Ce(s().csvData,s().columnMappings);c.update(n=>({...n,step:"complete",importResult:v})),te()()}catch(v){console.error("Failed to import members:",v),alert("Failed to import members. Please try again.")}}function ce(){ye(),V()()}ut();var Ee=Or(),we=ve(Ee);let ke;var Z=m(we),ge=m(Z),ae=m(ge),S=w(m(ae),2);S.__click=ce,h(ae);var e=w(ae,2),t=m(e);{var r=v=>{var n=vr(),z=w(m(n),2);z.__change=Se,Ue(2),h(n),C(v,n)},u=v=>{var n=je(),z=ve(n);{var g=o=>{var U=br(),B=w(ve(U),2),W=m(B);h(B);var J=w(B,2),p=w(m(J));st(p,5,()=>(s(),R(()=>s().columnMappings)),it,(E,A,_)=>{var x=_r(),$=m(x),M=m($,!0);h($);var I=w($),y=m(I);oe(()=>{a(A),ht(()=>{ee()})});var q=m(y);q.value=(q.__value=null)??"";var d=w(q);d.value=d.__value="first_name";var L=w(d);L.value=L.__value="last_name";var le=w(L);{var fe=ne=>{var be=pr(),re=ve(be);re.value=re.__value="date_of_birth";var Y=w(re,2);Y.value=Y.__value="phone_number",C(ne,be)};Q(le,ne=>{ee()&&ne(fe)})}h(y),h(I),h(x),oe(()=>pe(M,(a(A),R(()=>a(A).csvColumn)))),Rt(y,()=>a(A).memberField,ne=>(a(A).memberField=ne,ht(()=>s()),St(l,"$state"))),C(E,x)}),h(p),h(J),oe(()=>pe(W,`Found ${s(),R(()=>s().csvData.length)??""} rows in CSV`)),C(o,U)},k=o=>{var U=je(),B=ve(U);{var W=p=>{var E=gr(),A=m(E);Xe(A,{}),Ue(2),h(E),C(p,E)},J=p=>{var E=je(),A=ve(E);{var _=x=>{var $=Cr(),M=ve($),I=w(m(M),2),y=m(I),q=m(y),d=m(q,!0);h(q),Ue(),h(y);var L=w(y,2);{var le=Y=>{var H=yr(),G=m(H),ue=m(G,!0);h(G),Ue(),h(H),oe(()=>pe(ue,(s(),R(()=>s().importResult.duplicates)))),C(Y,H)};Q(L,Y=>{s(),R(()=>s().importResult?.duplicates&&s().importResult.duplicates>0)&&Y(le)})}var fe=w(L,2);{var ne=Y=>{var H=wr(),G=m(H),ue=m(G,!0);h(G),Ue(),h(H),oe(()=>pe(ue,(s(),R(()=>s().importResult.validationErrors)))),C(Y,H)};Q(fe,Y=>{s(),R(()=>s().importResult?.validationErrors&&s().importResult.validationErrors>0)&&Y(ne)})}h(I),h(M);var be=w(M,2);{var re=Y=>{var H=Er(),G=w(m(H),2),ue=m(G);st(ue,1,()=>(s(),R(()=>s().importResult.errors.slice(0,10))),it,(ie,i)=>{var b=kr(),me=m(b);h(b),oe(()=>pe(me,`Row ${a(i),R(()=>a(i).row)??""}: ${a(i),R(()=>a(i).message)??""}`)),C(ie,b)});var Me=w(ue,2);{var Ie=ie=>{var i=xr(),b=m(i),me=m(b);h(b),h(i),oe(()=>pe(me,`... and ${s(),R(()=>s().importResult.errors.length-10)??""} more errors`)),C(ie,i)};Q(Me,ie=>{s(),R(()=>s().importResult.errors.length>10)&&ie(Ie)})}h(G),h(H),C(Y,H)};Q(be,Y=>{s(),R(()=>s().importResult?.errors&&s().importResult.errors.length>0)&&Y(re)})}oe(()=>pe(d,(s(),R(()=>s().importResult?.success||0)))),C(x,$)};Q(A,x=>{s(),R(()=>s().step==="complete")&&x(_)},!0)}C(p,E)};Q(B,p=>{s(),R(()=>s().step==="importing")?p(W):p(J,!1)},!0)}C(o,U)};Q(z,o=>{s(),R(()=>s().step==="mapping")?o(g):o(k,!1)},!0)}C(v,n)};Q(t,v=>{s(),R(()=>s().step==="upload")?v(r):v(u,!1)})}h(e);var f=w(e,2),D=m(f);{var X=v=>{var n=Sr();n.__click=ce,C(v,n)},se=v=>{var n=je(),z=ve(n);{var g=o=>{var U=Mr(),B=ve(U);B.__click=ce;var W=w(B,2);W.__click=De;var J=m(W);h(W),oe(()=>pe(J,`Import ${s(),R(()=>s().csvData.length)??""} Members`)),C(o,U)},k=o=>{var U=je(),B=ve(U);{var W=p=>{var E=Rr(),A=w(ve(E),2),_=m(A);Xe(_,{size:"sm"}),Ue(),h(A),C(p,E)},J=p=>{var E=je(),A=ve(E);{var _=x=>{var $=Dr();$.__click=ce,C(x,$)};Q(A,x=>{s(),R(()=>s().step==="complete")&&x(_)},!0)}C(p,E)};Q(B,p=>{s(),R(()=>s().step==="importing")?p(W):p(J,!1)},!0)}C(o,U)};Q(z,o=>{s(),R(()=>s().step==="mapping")?o(g):o(k,!1)},!0)}C(v,n)};Q(D,v=>{s(),R(()=>s().step==="upload")?v(X):v(se,!1)})}h(f),h(ge),h(Z),h(we);var he=w(we,2);{var F=v=>{var n=Ir();C(v,n)};Q(he,v=>{N()&&v(F)})}oe(()=>{ke=Pe(we,1,"modal fade",null,ke,{show:N()}),Mt(we,`display: ${N()?"block":"none"}`)}),C(T,Ee),lt(),O()}Ct(["click","change"]);var Lr=P('<div class="dropdown"><button class="btn btn-sm btn-primary dropdown-toggle" type="button" id="addMemberDropdown" data-bs-toggle="dropdown" aria-label="Add member actions" aria-expanded="false"><i class="bi bi-plus"></i></button> <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="addMemberDropdown"><li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas"><i class="bi bi-person-plus me-2"></i>Create Member</button></li> <li><button class="dropdown-item" type="button"><i class="bi bi-file-earmark-arrow-up me-2"></i>Import CSV</button></li></ul></div>'),Tr=P("<!> ",1),Ar=P("<!> <!>",1),$r=P('<span class="fst-italic">Contact info restricted</span>'),Pr=P('<div class="member-actions svelte-10iclz7"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit member"><i class="bi bi-pencil-square"></i></button></div>'),jr=P('<li class="list-group-item py-2"><div class="member-row svelte-10iclz7"><div class="member-content svelte-10iclz7"><div><strong> </strong></div> <div class="text-muted small"><!></div></div> <!></div></li>'),Nr=P('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <button class="btn btn-primary btn-sm">More</button></div>'),zr=P('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Ur=P('<div class="card-body"><div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> No members match your search.</div></div>'),Vr=P('<div class="card-body"><div class="alert alert-info mb-0"><i class="bi bi-info-circle me-2"></i> No members yet.</div></div>'),qr=P('<div class="card"><div class="card-header"><div class="header-container"><div class="d-flex justify-content-between align-items-center w-100"><span>Members</span> <div class="d-flex align-items-center gap-2"><input type="text" class="form-control form-control-sm search-desktop svelte-10iclz7" placeholder="Search members..."/> <!></div></div> <div class="search-mobile mt-2 svelte-10iclz7"><input type="text" class="form-control form-control-sm" placeholder="Search members..."/></div></div></div> <!></div>'),Br=P('<div class="d-flex flex-column gap-4"><!></div>'),Hr=P("<!> <!> <!>",1);function Kr(T,j){ot(j,!1);const s=()=>Ne(Ce,"$filteredMembers",V),l=()=>Ne(de,"$currentUserHasPermission",V),O=()=>Ne(xe,"$ready",V),N=()=>Ne(ye,"$searchQuery",V),[V,te]=dt(),ee=_e(),c=_e(),{stores:{currentUserHasPermission:de}}=pt(),{stores:{ready:xe,filteredMembers:Ce,searchQuery:ye},actions:{reload:Se}}=ct(),De={first_name:"",last_name:"",date_of_birth:void 0,phone_number:void 0},ce=zt();let Ee=_e(!1),we=_e(!1),ke=_e({...De}),Z=_e(!1);const ge=20,ae=20;let S=_e(ge);function e(){K(S,a(S)+ae)}xt(async()=>{K(Ee,l()(Ze.EditMembers)),K(we,l()(Ze.ViewSensitiveMemberData)),await Se()});const t=v=>{K(ke,{...v})};function r(v){return v?new Date(v).toLocaleDateString():""}function u(){Se()}We(()=>(s(),a(S)),()=>{K(ee,(s()??[]).slice(0,a(S)))}),We(()=>(s(),a(S)),()=>{K(c,(s()?.length??0)>a(S))}),_t(),ut();var f=Hr(),D=ve(f);{let v=Et(()=>(a(ke),R(()=>a(ke).id?"Edit Member":"Create Member")));Ut(D,{get title(){return a(v)},get id(){return ce},children:(n,z)=>{nr(n,{get memberId(){return a(ke),R(()=>a(ke).id)},get drawerId(){return ce}})},$$slots:{default:!0}})}var X=w(D,2);Fr(X,{get isOpen(){return a(Z)},onClose:()=>K(Z,!1),onComplete:u,get canViewSensitiveData(){return a(we)}});var se=w(X,2);{var he=v=>{var n=qr(),z=m(n),g=m(z),k=m(g),o=w(m(k),2),U=m(o);qe(U);var B=w(U,2);{var W=x=>{var $=Lr(),M=w(m($),2),I=m(M),y=m(I);h(I);var q=w(I,2),d=m(q);h(q),h(M),h($),oe(()=>{Ge(y,"data-bs-target",`#${ce??""}`),Ge(y,"aria-controls",ce)}),ze("click",y,()=>t(De)),ze("click",d,()=>K(Z,!0)),C(x,$)};Q(B,x=>{a(Ee)&&x(W)})}h(o),h(k);var J=w(k,2),p=m(J);qe(p),h(J),h(g),h(z);var E=w(z,2);{var A=x=>{var $=zr(),M=ve($);st(M,5,()=>a(ee),it,(q,d)=>{var L=jr(),le=m(L),fe=m(le),ne=m(fe),be=m(ne),re=m(be);h(be),h(ne);var Y=w(ne,2),H=m(Y);{var G=ie=>{var i=Ar(),b=ve(i);{var me=Oe=>{var Le=vt();oe(Te=>pe(Le,`DOB: ${Te??""}`),[()=>(a(d),R(()=>r(a(d).date_of_birth)))]),C(Oe,Le)};Q(b,Oe=>{a(d),R(()=>a(d).date_of_birth)&&Oe(me)})}var Fe=w(b,2);{var Je=Oe=>{var Le=Tr(),Te=ve(Le);{var Ae=He=>{var et=vt("â€¢");C(He,et)};Q(Te,He=>{a(d),R(()=>a(d).date_of_birth)&&He(Ae)})}var Ye=w(Te);oe(()=>pe(Ye,` Phone: ${a(d),R(()=>a(d).phone_number)??""}`)),C(Oe,Le)};Q(Fe,Oe=>{a(d),R(()=>a(d).phone_number)&&Oe(Je)})}C(ie,i)},ue=ie=>{var i=$r();C(ie,i)};Q(H,ie=>{a(we)?ie(G):ie(ue,!1)})}h(Y),h(fe);var Me=w(fe,2);{var Ie=ie=>{var i=Pr(),b=m(i);h(i),oe(()=>{Ge(b,"data-bs-target",`#${ce??""}`),Ge(b,"aria-controls",ce)}),ze("click",b,()=>t(a(d))),C(ie,i)};Q(Me,ie=>{a(Ee)&&ie(Ie)})}h(le),h(L),oe(()=>pe(re,`${a(d),R(()=>a(d).first_name)??""} ${a(d),R(()=>a(d).last_name||"")??""}`)),C(q,L)}),h(M);var I=w(M,2);{var y=q=>{var d=Nr(),L=m(d),le=m(L);h(L);var fe=w(L,2);h(d),oe(()=>pe(le,`Showing ${a(S)??""} of ${s(),R(()=>s()?.length??0)??""}`)),ze("click",fe,e),C(q,d)};Q(I,q=>{a(c)&&q(y)})}C(x,$)},_=x=>{var $=je(),M=ve($);{var I=q=>{var d=Ur();C(q,d)},y=q=>{var d=Vr();C(q,d)};Q(M,q=>{N(),R(()=>N().trim())?q(I):q(y,!1)},!0)}C(x,$)};Q(E,x=>{a(ee),R(()=>a(ee).length)?x(A):x(_,!1)})}h(n),Be(U,N,x=>mt(ye,x)),Be(p,N,x=>mt(ye,x)),C(v,n)},F=v=>{var n=Br(),z=m(n);Xe(z,{}),h(n),C(v,n)};Q(se,v=>{O()?v(he):v(F,!1)})}C(T,f),lt(),te()}function fa(T){wt(T,{pageTitle:"Members",children:(j,s)=>{Kr(j,{})},$$slots:{default:!0}})}export{fa as component,ca as universal};
