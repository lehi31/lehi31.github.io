import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{o as ie}from"../chunks/Bxf54LvK.js";import{p as z,c as n,s,r as c,B as ee,a as D,f as M,m as a,E as C,D as r,ap as le,F as X,aj as ne,$ as ce}from"../chunks/DimshypG.js";import{p as G,i as T,s as de,e as E,b as ae,a as te}from"../chunks/BxPd6b7X.js";import{f,a as o,c as Y}from"../chunks/BpMnIePG.js";import{s as ve}from"../chunks/naA3k6PG.js";import{e as be,h as fe}from"../chunks/DQUjufRY.js";import{i as W}from"../chunks/PCWoV1YN.js";import{e as me,b as ue,f as pe,d as ge}from"../chunks/C-0IFSAy.js";import{t as _e,d as he}from"../chunks/cv_p02_A.js";import{r as Z}from"../chunks/BIuV8CE4.js";import{b as K}from"../chunks/BArOhmIA.js";import{p as ye}from"../chunks/CdEA5IGF.js";const ke=!0,Ze=Object.freeze(Object.defineProperty({__proto__:null,prerender:ke},Symbol.toStringTag,{value:"Module"}));var we=f('<i class="bi bi-info-circle"></i>'),xe=f('<i class="bi bi-exclamation-triangle"></i>'),Se=f('<i class="bi bi-x-circle"></i>'),Ne=f('<i class="bi bi-check-circle"></i>'),Te=f('<div role="alert"><!> <div class="flex-grow-1"> </div> <button type="button" class="btn-close" aria-label="Close"></button></div>');function Ae($,_){z(_,!1);let h=G(_,"message",8),d=G(_,"type",8,"info"),y=G(_,"onClose",8);setTimeout(()=>y()(),5e3),W();var l=Te(),i=n(l);{var v=m=>{var A=we();o(m,A)},S=m=>{var A=Y(),k=M(A);{var P=u=>{var F=xe();o(u,F)},j=u=>{var F=Y(),e=M(F);{var t=p=>{var w=Se();o(p,w)},g=p=>{var w=Y(),x=M(w);{var U=O=>{var V=Ne();o(O,V)};T(x,O=>{d()==="success"&&O(U)},!0)}o(p,w)};T(e,p=>{d()==="danger"?p(t):p(g,!1)},!0)}o(u,F)};T(k,u=>{d()==="warning"?u(P):u(j,!1)},!0)}o(m,A)};T(i,m=>{d()==="info"?m(v):m(S,!1)})}var N=s(i,2),q=n(N,!0);c(N);var I=s(N,2);c(l),ee(()=>{me(l,1,`alert alert-${d()??""} alert-dismissible d-flex align-items-center gap-2`,"svelte-1jlqy1l"),de(q,h())}),E("click",I,function(...m){y()?.apply(this,m)}),o($,l),D()}function Fe($,_){z(_,!1);const h=()=>te(_e,"$toasts",d),[d,y]=ae();W();var l=Y(),i=M(l);be(i,1,h,v=>v.id,(v,S)=>{Ae(v,{get message(){return a(S).message},get type(){return a(S).type},onClose:()=>he(a(S).id)})}),o($,l),D(),y()}var Ce=f('<div class="text-center py-4"><i class="bi bi-check-circle text-success" style="font-size: 3rem;"></i> <p class="mt-3 mb-3">Thank you for your feedback!<br/> The bishopric will review and get back to you.</p> <button type="button" class="btn btn-sm btn-outline-secondary">Close</button></div>'),Ee=f('<span class="spinner-border spinner-border-sm me-1" role="status"></span> Sending...',1),$e=f('<i class="bi bi-send me-1"></i> Send Feedback',1),Ie=f(`<form><div class="mb-3"><label for="feedback-name" class="form-label small">Name (optional)</label> <input type="text" class="form-control form-control-sm" id="feedback-name" placeholder="Your name"/></div> <div class="mb-3"><label for="feedback-email" class="form-label small">Email (optional)</label> <input type="email" class="form-control form-control-sm" id="feedback-email" placeholder="your@email.com"/></div> <div class="mb-3"><label for="feedback-message" class="form-label small">Message <span class="text-danger">*</span></label> <textarea class="form-control form-control-sm" id="feedback-message" placeholder="Tell us what's on your mind..." rows="4" required></textarea></div> <div class="d-grid"><button type="submit" class="btn btn-primary btn-sm"><!></button></div></form>`),Pe=f('<div class="feedback-panel shadow-lg svelte-1csgcly"><div class="card h-100 feedback-card svelte-1csgcly"><div class="card-header d-flex justify-content-between align-items-center bg-body-tertiary"><h5 class="mb-0">Send Feedback</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <div class="card-body overflow-auto"><!></div></div></div>'),je=f('<button class="btn btn-primary rounded-circle feedback-button shadow svelte-1csgcly" aria-label="Send feedback" title="Send feedback"><i class="bi bi-chat-dots"></i></button> <!>',1);function Ue($,_){z(_,!1);let h=C(!1),d=C(""),y=C(""),l=C(""),i=C(!1),v=C(!1);async function S(){if(a(l).trim()){r(i,!0);try{(await fetch(`${ue}/functions/v1/website-feedback`,{method:"POST",headers:pe(!0,{useAuthToken:!1}),body:JSON.stringify({name:a(d).trim()||void 0,email:a(y).trim()||void 0,message:a(l).trim(),page_url:window.location.href,user_agent:navigator.userAgent})})).ok?(r(v,!0),setTimeout(()=>{r(h,!1),r(v,!1),r(d,""),r(y,""),r(l,"")},8e3)):alert("Failed to submit feedback. Please try again.")}catch(k){console.error("Error submitting feedback:",k),alert("Failed to submit feedback. Please try again.")}finally{r(i,!1)}}}function N(){r(h,!a(h)),a(h)||r(v,!1)}W();var q=je(),I=M(q),m=s(I,2);{var A=k=>{var P=Pe(),j=n(P),u=n(j),F=s(n(u),2);c(u);var e=s(u,2),t=n(e);{var g=w=>{var x=Ce(),U=s(n(x),4);c(x),E("click",U,N),o(w,x)},p=w=>{var x=Ie(),U=n(x),O=s(n(U),2);Z(O),c(U);var V=s(U,2),B=s(n(V),2);Z(B),c(V);var H=s(V,2),J=s(n(H),2);le(J),c(H);var Q=s(H,2),L=n(Q),se=n(L);{var re=b=>{var R=Ee();X(),o(b,R)},oe=b=>{var R=$e();X(),o(b,R)};T(se,b=>{a(i)?b(re):b(oe,!1)})}c(L),c(Q),c(x),ee(b=>{O.disabled=a(i),B.disabled=a(i),J.disabled=a(i),L.disabled=b},[()=>a(i)||!a(l).trim()]),K(O,()=>a(d),b=>r(d,b)),K(B,()=>a(y),b=>r(y,b)),K(J,()=>a(l),b=>r(l,b)),E("submit",x,ye(S)),o(w,x)};T(t,w=>{a(v)?w(g):w(p,!1)})}c(e),c(j),c(P),E("click",F,N),o(k,P)};T(m,k=>{a(h)&&k(A)})}E("click",I,N),o($,q),D()}var Oe=f('<div class="alert alert-info alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-arrow-clockwise"></i> <div class="flex-grow-1"><strong>Update Available</strong><br/> A new version of the app is available. Please reload to get the latest features and bug fixes.</div> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-arrow-clockwise"></i> Reload Now</button> <button type="button" class="btn-close" aria-label="Close"></button></div>'),qe=f('<div class="alert alert-warning alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-clock-history"></i> <div><strong>Session Expired</strong><br/> Your authentication token has expired. Please log in again to continue.</div> <button type="button" class="btn-close" aria-label="Close"></button></div>'),Me=f("<!> <!> <!> <!> <!>",1);function ea($,_){z(_,!1);const h=()=>te(l,"$pageName",d),[d,y]=ae(),{stores:{pageName:l}}=ge();let i=C(!1),v=C(!1);const S=async()=>{try{const e=await fetch("/api/version"),{version:t}=await e.json(),g=parseInt(t),p=parseInt("1771630584806");return!isNaN(g)&&!isNaN(p)&&g>p?(console.warn("[App] New version available:",t,"current:","1771630584806","(server is newer)"),!0):(t!=="1771630584806"&&console.log("[App] Version mismatch but client is newer or equal:","server:",t,"client:","1771630584806"),!1)}catch(e){return console.error("[App] Failed to check for updates:",e),!1}};ie(()=>{{sessionStorage.getItem("authExpired")==="true"&&(r(i,!0),setTimeout(()=>{r(i,!1),sessionStorage.removeItem("authExpired")},1e4));{const e=async()=>{await S()&&r(v,!0)};e();const t=setInterval(e,5*60*1e3);return()=>clearInterval(t)}}});const N=()=>{r(i,!1),sessionStorage.removeItem("authExpired")},q=async()=>{try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(t=>caches.delete(t))),console.log("[App] Cleared service worker caches")}}catch(e){console.error("[App] Failed to clear caches:",e)}finally{window.location.href=window.location.href}};W();var I=Me();fe("12qhfyh",e=>{ne(()=>{ce.title=`Lehi31 | ${h()??""}`})});var m=M(I);{var A=e=>{var t=Oe(),g=s(n(t),4),p=s(g,2);c(t),E("click",g,q),E("click",p,()=>r(v,!1)),o(e,t)};T(m,e=>{a(v)&&e(A)})}var k=s(m,2);{var P=e=>{var t=qe(),g=s(n(t),4);c(t),E("click",g,N),o(e,t)};T(k,e=>{a(i)&&e(P)})}var j=s(k,2);Fe(j,{});var u=s(j,2);ve(u,_,"default",{});var F=s(u,2);Ue(F,{}),o($,I),D(),y()}export{ea as component,Ze as universal};
