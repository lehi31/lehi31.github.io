import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{o as re}from"../chunks/Bxf54LvK.js";import{p as z,c as u,s as r,r as p,B as X,a as D,f as O,m as a,E as C,D as o,ap as oe,F as K,aj as ie,$ as le}from"../chunks/DimshypG.js";import{p as L,i as N,s as ne,e as E,b as Z,a as ee}from"../chunks/BxPd6b7X.js";import{f,a as i,c as Y}from"../chunks/BpMnIePG.js";import{s as ce}from"../chunks/naA3k6PG.js";import{e as de,h as ve}from"../chunks/DQUjufRY.js";import{i as W}from"../chunks/PCWoV1YN.js";import{e as be,b as fe,f as me,d as ue}from"../chunks/BVgOCOjr.js";import{t as pe,d as ge}from"../chunks/cv_p02_A.js";import{r as Q}from"../chunks/jcCY8395.js";import{b as R}from"../chunks/BArOhmIA.js";import{p as _e}from"../chunks/CdEA5IGF.js";const he=!0,Qe=Object.freeze(Object.defineProperty({__proto__:null,prerender:he},Symbol.toStringTag,{value:"Module"}));var ye=f('<i class="bi bi-info-circle"></i>'),ke=f('<i class="bi bi-exclamation-triangle"></i>'),we=f('<i class="bi bi-x-circle"></i>'),xe=f('<i class="bi bi-check-circle"></i>'),Se=f('<div role="alert"><!> <div class="flex-grow-1"> </div> <button type="button" class="btn-close" aria-label="Close"></button></div>');function Ne($,g){z(g,!1);let _=L(g,"message",8),d=L(g,"type",8,"info"),h=L(g,"onClose",8);setTimeout(()=>h()(),5e3),W();var c=Se(),l=u(c);{var v=m=>{var T=ye();i(m,T)},x=m=>{var T=Y(),y=O(T);{var P=k=>{var F=ke();i(k,F)},A=k=>{var F=Y(),e=O(F);{var t=s=>{var w=we();i(s,w)},n=s=>{var w=Y(),q=O(w);{var M=U=>{var V=xe();i(U,V)};N(q,U=>{d()==="success"&&U(M)},!0)}i(s,w)};N(e,s=>{d()==="danger"?s(t):s(n,!1)},!0)}i(k,F)};N(y,k=>{d()==="warning"?k(P):k(A,!1)},!0)}i(m,T)};N(l,m=>{d()==="info"?m(v):m(x,!1)})}var S=r(l,2),j=u(S,!0);p(S);var I=r(S,2);p(c),X(()=>{be(c,1,`alert alert-${d()??""} alert-dismissible d-flex align-items-center gap-2`,"svelte-1jlqy1l"),ne(j,_())}),E("click",I,function(...m){h()?.apply(this,m)}),i($,c),D()}function Te($,g){z(g,!1);const _=()=>ee(pe,"$toasts",d),[d,h]=Z();W();var c=Y(),l=O(c);de(l,1,_,v=>v.id,(v,x)=>{Ne(v,{get message(){return a(x).message},get type(){return a(x).type},onClose:()=>ge(a(x).id)})}),i($,c),D(),h()}var Ae=f('<div class="feedback-body text-center py-5 svelte-1csgcly"><i class="bi bi-check-circle text-success" style="font-size: 3rem;"></i> <p class="mt-3">Thank you for your feedback!<br/> The bishopric will review and get back to you.</p> <button type="button" class="btn btn-sm btn-outline-secondary">Close</button></div>'),Fe=f('<span class="spinner-border spinner-border-sm me-1" role="status"></span> Sending...',1),Ce=f('<i class="bi bi-send me-1"></i> Send Feedback',1),Ee=f(`<form class="feedback-body svelte-1csgcly"><div class="mb-3"><label for="feedback-name" class="form-label small">Name (optional)</label> <input type="text" class="form-control form-control-sm" id="feedback-name" placeholder="Your name"/></div> <div class="mb-3"><label for="feedback-email" class="form-label small">Email (optional)</label> <input type="email" class="form-control form-control-sm" id="feedback-email" placeholder="your@email.com"/></div> <div class="mb-3"><label for="feedback-message" class="form-label small">Message <span class="text-danger">*</span></label> <textarea class="form-control form-control-sm" id="feedback-message" placeholder="Tell us what's on your mind..." rows="4" required></textarea></div> <div class="d-grid"><button type="submit" class="btn btn-primary btn-sm"><!></button></div></form>`),$e=f('<div class="feedback-panel svelte-1csgcly"><div class="feedback-header svelte-1csgcly"><h5 class="mb-0 svelte-1csgcly">Send Feedback</h5> <button type="button" class="btn-close" aria-label="Close"></button></div> <!></div>'),Ie=f('<button class="feedback-button svelte-1csgcly" aria-label="Send feedback" title="Send feedback"><i class="bi bi-chat-dots"></i></button> <!>',1);function Pe($,g){z(g,!1);let _=C(!1),d=C(""),h=C(""),c=C(""),l=C(!1),v=C(!1);async function x(){if(a(c).trim()){o(l,!0);try{(await fetch(`${fe}/functions/v1/website-feedback`,{method:"POST",headers:me(!0,{useAuthToken:!1}),body:JSON.stringify({name:a(d).trim()||void 0,email:a(h).trim()||void 0,message:a(c).trim(),page_url:window.location.href,user_agent:navigator.userAgent})})).ok?(o(v,!0),setTimeout(()=>{o(_,!1),o(v,!1),o(d,""),o(h,""),o(c,"")},8e3)):alert("Failed to submit feedback. Please try again.")}catch(y){console.error("Error submitting feedback:",y),alert("Failed to submit feedback. Please try again.")}finally{o(l,!1)}}}function S(){o(_,!a(_)),a(_)||o(v,!1)}W();var j=Ie(),I=O(j),m=r(I,2);{var T=y=>{var P=$e(),A=u(P),k=r(u(A),2);p(A);var F=r(A,2);{var e=n=>{var s=Ae(),w=r(u(s),4);p(s),E("click",w,S),i(n,s)},t=n=>{var s=Ee(),w=u(s),q=r(u(w),2);Q(q),p(w);var M=r(w,2),U=r(u(M),2);Q(U),p(M);var V=r(M,2),B=r(u(V),2);oe(B),p(V);var G=r(V,2),H=u(G),ae=u(H);{var te=b=>{var J=Fe();K(),i(b,J)},se=b=>{var J=Ce();K(),i(b,J)};N(ae,b=>{a(l)?b(te):b(se,!1)})}p(H),p(G),p(s),X(b=>{q.disabled=a(l),U.disabled=a(l),B.disabled=a(l),H.disabled=b},[()=>a(l)||!a(c).trim()]),R(q,()=>a(d),b=>o(d,b)),R(U,()=>a(h),b=>o(h,b)),R(B,()=>a(c),b=>o(c,b)),E("submit",s,_e(x)),i(n,s)};N(F,n=>{a(v)?n(e):n(t,!1)})}p(P),E("click",k,S),i(y,P)};N(m,y=>{a(_)&&y(T)})}E("click",I,S),i($,j),D()}var Ue=f('<div class="alert alert-info alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-arrow-clockwise"></i> <div class="flex-grow-1"><strong>Update Available</strong><br/> A new version of the app is available. Please reload to get the latest features and bug fixes.</div> <button type="button" class="btn btn-sm btn-primary"><i class="bi bi-arrow-clockwise"></i> Reload Now</button> <button type="button" class="btn-close" aria-label="Close"></button></div>'),je=f('<div class="alert alert-warning alert-dismissible d-flex align-items-center gap-2 m-3" role="alert"><i class="bi bi-clock-history"></i> <div><strong>Session Expired</strong><br/> Your authentication token has expired. Please log in again to continue.</div> <button type="button" class="btn-close" aria-label="Close"></button></div>'),Oe=f("<!> <!> <!> <!> <!>",1);function Xe($,g){z(g,!1);const _=()=>ee(c,"$pageName",d),[d,h]=Z(),{stores:{pageName:c}}=ue();let l=C(!1),v=C(!1);const x=async()=>{try{const e=await fetch("/api/version"),{version:t}=await e.json(),n=parseInt(t),s=parseInt("1771629249825");return!isNaN(n)&&!isNaN(s)&&n>s?(console.warn("[App] New version available:",t,"current:","1771629249825","(server is newer)"),!0):(t!=="1771629249825"&&console.log("[App] Version mismatch but client is newer or equal:","server:",t,"client:","1771629249825"),!1)}catch(e){return console.error("[App] Failed to check for updates:",e),!1}};re(()=>{{sessionStorage.getItem("authExpired")==="true"&&(o(l,!0),setTimeout(()=>{o(l,!1),sessionStorage.removeItem("authExpired")},1e4));{const e=async()=>{await x()&&o(v,!0)};e();const t=setInterval(e,5*60*1e3);return()=>clearInterval(t)}}});const S=()=>{o(l,!1),sessionStorage.removeItem("authExpired")},j=async()=>{try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(t=>caches.delete(t))),console.log("[App] Cleared service worker caches")}}catch(e){console.error("[App] Failed to clear caches:",e)}finally{window.location.href=window.location.href}};W();var I=Oe();ve("12qhfyh",e=>{ie(()=>{le.title=`Lehi31 | ${_()??""}`})});var m=O(I);{var T=e=>{var t=Ue(),n=r(u(t),4),s=r(n,2);p(t),E("click",n,j),E("click",s,()=>o(v,!1)),i(e,t)};N(m,e=>{a(v)&&e(T)})}var y=r(m,2);{var P=e=>{var t=je(),n=r(u(t),4);p(t),E("click",n,S),i(e,t)};N(y,e=>{a(l)&&e(P)})}var A=r(y,2);Te(A,{});var k=r(A,2);ce(k,g,"default",{});var F=r(k,2);Pe(F,{}),i($,I),D(),h()}export{Xe as component,Qe as universal};
