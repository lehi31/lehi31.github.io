import{s as kt,n as We,d as i,D as je,v as St,G as Me,w as pe,a as Z,i as le,b as a,x as Le,p as c,H as et,c as u,e as v,y as me,g as O,f as R,h as f,j as L,t as S,k as Tt,r as Dt,K as tt}from"../chunks/D5uXae_z.js";import{S as At,i as Ct,d as It,t as wt,a as Ot,m as Lt,c as Nt,b as Rt}from"../chunks/hU46bQpI.js";import{P as Pt}from"../chunks/-KtY-WaW.js";import{e as ge}from"../chunks/Cy5wLYlB.js";import{O as rt,b as Vt,c as Qe,d as Ut,r as yt,e as zt,g as Mt,P as Ht}from"../chunks/DhFDXdRu.js";import{u as Bt}from"../chunks/BR1MXGLs.js";import{g as jt}from"../chunks/DSaT5POE.js";function it(s,e,t){const l=s.slice();l[24]=e[t];const n=Qe(l[24].role_id);return l[25]=n,l}function ct(s,e,t){const l=s.slice();return l[28]=e[t],l}function ut(s,e,t){const l=s.slice();return l[28]=e[t],l}function ft(s,e,t){const l=s.slice();return l[33]=e[t],l}function dt(s,e,t){const l=s.slice();return l[36]=e[t],l}function ht(s){let e,t,l,n,o,_;return{c(){e=f("div"),t=S(s[4]),l=L(),n=f("button"),this.h()},l(h){e=u(h,"DIV",{class:!0,role:!0});var m=v(e);t=R(m,s[4]),l=O(m),n=u(m,"BUTTON",{type:!0,class:!0,"aria-label":!0}),v(n).forEach(i),m.forEach(i),this.h()},h(){c(n,"type","button"),c(n,"class","btn-close"),c(n,"aria-label","Close"),c(e,"class","alert alert-danger alert-dismissible fade show"),c(e,"role","alert")},m(h,m){le(h,e,m),a(e,t),a(e,l),a(e,n),o||(_=Le(n,"click",s[16]),o=!0)},p(h,m){m[0]&16&&Z(t,h[4])},d(h){h&&i(e),o=!1,_()}}}function _t(s){let e,t=(s[36].display_name||s[36].email)+"",l,n,o=s[36].email+"",_,h,m;return{c(){e=f("option"),l=S(t),n=S(" ("),_=S(o),h=S(`)
							`),this.h()},l(p){e=u(p,"OPTION",{});var k=v(e);l=R(k,t),n=R(k," ("),_=R(k,o),h=R(k,`)
							`),k.forEach(i),this.h()},h(){e.__value=m=s[36].id,pe(e,e.__value)},m(p,k){le(p,e,k),a(e,l),a(e,n),a(e,_),a(e,h)},p(p,k){k[0]&1024&&t!==(t=(p[36].display_name||p[36].email)+"")&&Z(l,t),k[0]&1024&&o!==(o=p[36].email+"")&&Z(_,o),k[0]&1024&&m!==(m=p[36].id)&&(e.__value=m,pe(e,e.__value))},d(p){p&&i(e)}}}function vt(s){let e,t=s[33].name+"",l,n;return{c(){e=f("option"),l=S(t),this.h()},l(o){e=u(o,"OPTION",{});var _=v(e);l=R(_,t),_.forEach(i),this.h()},h(){e.__value=n=s[33].id,pe(e,e.__value)},m(o,_){le(o,e,_),a(e,l)},p(o,_){_[0]&260&&t!==(t=o[33].name+"")&&Z(l,t),_[0]&260&&n!==(n=o[33].id)&&(e.__value=n,pe(e,e.__value))},d(o){o&&i(e)}}}function mt(s){let e,t,l=ge(s[2][s[28]]),n=[];for(let o=0;o<l.length;o+=1)n[o]=vt(ft(s,l,o));return{c(){e=f("optgroup");for(let o=0;o<n.length;o+=1)n[o].c();this.h()},l(o){e=u(o,"OPTGROUP",{label:!0});var _=v(e);for(let h=0;h<n.length;h+=1)n[h].l(_);_.forEach(i),this.h()},h(){c(e,"label",t=Se(s[28]))},m(o,_){le(o,e,_);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(e,null)},p(o,_){if(_[0]&260){l=ge(o[2][o[28]]);let h;for(h=0;h<l.length;h+=1){const m=ft(o,l,h);n[h]?n[h].p(m,_):(n[h]=vt(m),n[h].c(),n[h].m(e,null))}for(;h<n.length;h+=1)n[h].d(1);n.length=l.length}_[0]&256&&t!==(t=Se(o[28]))&&c(e,"label",t)},d(o){o&&i(e),je(n,o)}}}function gt(s){let e;return{c(){e=f("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0,role:!0}),v(e).forEach(i),this.h()},h(){c(e,"class","spinner-border spinner-border-sm me-2"),c(e,"role","status")},m(t,l){le(t,e,l)},d(t){t&&i(e)}}}function pt(s){let e,t=Se(s[28])+"",l;return{c(){e=f("option"),l=S(t),this.h()},l(n){e=u(n,"OPTION",{});var o=v(e);l=R(o,t),o.forEach(i),this.h()},h(){e.__value=s[28],pe(e,e.__value)},m(n,o){le(n,e,o),a(e,l)},p:We,d(n){n&&i(e)}}}function Ft(s){let e,t,l,n='<tr><th scope="col" class="svelte-1h4f1is">Name</th> <th scope="col" class="d-none d-md-table-cell svelte-1h4f1is">Email</th> <th scope="col" class="svelte-1h4f1is">Role</th> <th scope="col" class="d-none d-lg-table-cell svelte-1h4f1is">Organization</th> <th scope="col" class="d-none d-lg-table-cell svelte-1h4f1is">Assigned Date</th> <th scope="col" class="d-none d-xl-table-cell svelte-1h4f1is">Notes</th> <th scope="col" class="text-end svelte-1h4f1is">Actions</th></tr>',o,_,h=ge(s[9]),m=[];for(let p=0;p<h.length;p+=1)m[p]=bt(it(s,h,p));return{c(){e=f("div"),t=f("table"),l=f("thead"),l.innerHTML=n,o=L(),_=f("tbody");for(let p=0;p<m.length;p+=1)m[p].c();this.h()},l(p){e=u(p,"DIV",{class:!0});var k=v(e);t=u(k,"TABLE",{class:!0});var g=v(t);l=u(g,"THEAD",{"data-svelte-h":!0}),me(l)!=="svelte-1wg3omm"&&(l.innerHTML=n),o=O(g),_=u(g,"TBODY",{class:!0});var D=v(_);for(let I=0;I<m.length;I+=1)m[I].l(D);D.forEach(i),g.forEach(i),k.forEach(i),this.h()},h(){c(_,"class","table-group-divider"),c(t,"class","table table-hover align-middle svelte-1h4f1is"),c(e,"class","table-responsive")},m(p,k){le(p,e,k),a(e,t),a(t,l),a(t,o),a(t,_);for(let g=0;g<m.length;g+=1)m[g]&&m[g].m(_,null)},p(p,k){if(k[0]&16904){h=ge(p[9]);let g;for(g=0;g<h.length;g+=1){const D=it(p,h,g);m[g]?m[g].p(D,k):(m[g]=bt(D),m[g].c(),m[g].m(_,null))}for(;g<m.length;g+=1)m[g].d(1);m.length=h.length}},d(p){p&&i(e),je(m,p)}}}function Gt(s){let e,t,l=s[1]!=="all"&&Et();return{c(){e=f("div"),t=S(`No active role assignments found.
			`),l&&l.c(),this.h()},l(n){e=u(n,"DIV",{class:!0});var o=v(e);t=R(o,`No active role assignments found.
			`),l&&l.l(o),o.forEach(i),this.h()},h(){c(e,"class","alert alert-info")},m(n,o){le(n,e,o),a(e,t),l&&l.m(e,null)},p(n,o){n[1]!=="all"?l||(l=Et(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(n){n&&i(e),l&&l.d()}}}function qt(s){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(l){e=u(l,"DIV",{class:!0,"data-svelte-h":!0}),me(e)!=="svelte-mlx3u2"&&(e.innerHTML=t),this.h()},h(){c(e,"class","text-center py-5")},m(l,n){le(l,e,n)},p:We,d(l){l&&i(e)}}}function bt(s){let e,t,l,n=(s[24].user?.display_name||"Unknown")+"",o,_,h,m=(s[24].user?.email||"N/A")+"",p,k,g,D,I=(s[24].user?.email||"N/A")+"",K,F,A,P,z=s[24].roleName+"",be,ue,w,B,fe=(s[25]?Se(s[25].organization):"Unknown")+"",de,Q,G,b,N=(s[25]?Se(s[25].organization):"Unknown")+"",C,M,se,Ee,W=new Date(s[24].assigned_date).toLocaleDateString()+"",$,Pe,he,V,ke=(s[24].notes||"—")+"",ae,Y,ne,X,Te,x,_e,J;function oe(){return s[21](s[24])}return{c(){e=f("tr"),t=f("td"),l=f("div"),o=S(n),_=L(),h=f("small"),p=S(m),k=L(),g=f("td"),D=f("small"),K=S(I),F=L(),A=f("td"),P=f("strong"),be=S(z),ue=L(),w=f("div"),B=f("span"),de=S(fe),Q=L(),G=f("td"),b=f("span"),C=S(N),M=L(),se=f("td"),Ee=f("small"),$=S(W),Pe=L(),he=f("td"),V=f("small"),ae=S(ke),Y=L(),ne=f("td"),X=f("button"),Te=f("i"),x=L(),this.h()},l(ve){e=u(ve,"TR",{});var T=v(e);t=u(T,"TD",{});var re=v(t);l=u(re,"DIV",{class:!0});var ee=v(l);o=R(ee,n),ee.forEach(i),_=O(re),h=u(re,"SMALL",{class:!0});var Ve=v(h);p=R(Ve,m),Ve.forEach(i),re.forEach(i),k=O(T),g=u(T,"TD",{class:!0});var Ce=v(g);D=u(Ce,"SMALL",{class:!0});var Ne=v(D);K=R(Ne,I),Ne.forEach(i),Ce.forEach(i),F=O(T),A=u(T,"TD",{});var Ie=v(A);P=u(Ie,"STRONG",{});var we=v(P);be=R(we,z),we.forEach(i),ue=O(Ie),w=u(Ie,"DIV",{class:!0});var Re=v(w);B=u(Re,"SPAN",{class:!0});var Ue=v(B);de=R(Ue,fe),Ue.forEach(i),Re.forEach(i),Ie.forEach(i),Q=O(T),G=u(T,"TD",{class:!0});var ye=v(G);b=u(ye,"SPAN",{class:!0});var He=v(b);C=R(He,N),He.forEach(i),ye.forEach(i),M=O(T),se=u(T,"TD",{class:!0});var H=v(se);Ee=u(H,"SMALL",{});var De=v(Ee);$=R(De,W),De.forEach(i),H.forEach(i),Pe=O(T),he=u(T,"TD",{class:!0});var U=v(he);V=u(U,"SMALL",{class:!0});var Ae=v(V);ae=R(Ae,ke),Ae.forEach(i),U.forEach(i),Y=O(T),ne=u(T,"TD",{class:!0});var y=v(ne);X=u(y,"BUTTON",{class:!0});var j=v(X);Te=u(j,"I",{class:!0}),v(Te).forEach(i),j.forEach(i),y.forEach(i),x=O(T),T.forEach(i),this.h()},h(){c(l,"class","fw-semibold"),c(h,"class","d-md-none text-muted d-block"),c(D,"class","text-muted"),c(g,"class","d-none d-md-table-cell"),c(B,"class","badge bg-info"),c(w,"class","d-lg-none mt-1"),c(b,"class","badge bg-info"),c(G,"class","d-none d-lg-table-cell"),c(se,"class","d-none d-lg-table-cell"),c(V,"class","text-muted"),c(he,"class","d-none d-xl-table-cell"),c(Te,"class","bi bi-x-circle"),c(X,"class","btn btn-sm btn-outline-danger"),X.disabled=s[3],c(ne,"class","text-end")},m(ve,T){le(ve,e,T),a(e,t),a(t,l),a(l,o),a(t,_),a(t,h),a(h,p),a(e,k),a(e,g),a(g,D),a(D,K),a(e,F),a(e,A),a(A,P),a(P,be),a(A,ue),a(A,w),a(w,B),a(B,de),a(e,Q),a(e,G),a(G,b),a(b,C),a(e,M),a(e,se),a(se,Ee),a(Ee,$),a(e,Pe),a(e,he),a(he,V),a(V,ae),a(e,Y),a(e,ne),a(ne,X),a(X,Te),a(e,x),_e||(J=Le(X,"click",oe),_e=!0)},p(ve,T){s=ve,T[0]&512&&n!==(n=(s[24].user?.display_name||"Unknown")+"")&&Z(o,n),T[0]&512&&m!==(m=(s[24].user?.email||"N/A")+"")&&Z(p,m),T[0]&512&&I!==(I=(s[24].user?.email||"N/A")+"")&&Z(K,I),T[0]&512&&z!==(z=s[24].roleName+"")&&Z(be,z),T[0]&512&&fe!==(fe=(s[25]?Se(s[25].organization):"Unknown")+"")&&Z(de,fe),T[0]&512&&N!==(N=(s[25]?Se(s[25].organization):"Unknown")+"")&&Z(C,N),T[0]&512&&W!==(W=new Date(s[24].assigned_date).toLocaleDateString()+"")&&Z($,W),T[0]&512&&ke!==(ke=(s[24].notes||"—")+"")&&Z(ae,ke),T[0]&8&&(X.disabled=s[3])},d(ve){ve&&i(e),_e=!1,J()}}}function Et(s){let e;return{c(){e=S("Try selecting a different organization.")},l(t){e=R(t,"Try selecting a different organization.")},m(t,l){le(t,e,l)},d(t){t&&i(e)}}}function Kt(s){let e,t,l,n="Role Assignments",o,_,h,m,p,k,g,D,I='<h5 class="mb-0">Assign New Role</h5>',K,F,A,P,z,be="Select User",ue,w,B,fe="Choose a user...",de,Q,G,b="Select Role",N,C,M,se="Choose a role...",Ee,W,$,Pe="Notes (Optional)",he,V,ke,ae,Y,ne,X,Te,x,_e,J,oe,ve="All Organizations",T,re,ee,Ve,Ce=s[9].length+"",Ne,Ie,we=s[9].length!==1?"s":"",Re,Ue,ye,He,H=s[4]&&ht(s),De=ge(s[10]),U=[];for(let r=0;r<De.length;r+=1)U[r]=_t(dt(s,De,r));let Ae=ge(s[8]),y=[];for(let r=0;r<Ae.length;r+=1)y[r]=mt(ut(s,Ae,r));let j=s[3]&&gt(),ze=ge(Object.values(rt)),q=[];for(let r=0;r<ze.length;r+=1)q[r]=pt(ct(s,ze,r));function lt(r,E){return r[3]&&r[0].length===0?qt:r[9].length===0?Gt:Ft}let Fe=lt(s),ie=Fe(s);return{c(){e=f("div"),t=f("div"),l=f("h2"),l.textContent=n,o=L(),_=f("button"),h=f("i"),m=S(" Refresh"),p=L(),H&&H.c(),k=L(),g=f("div"),D=f("div"),D.innerHTML=I,K=L(),F=f("div"),A=f("div"),P=f("div"),z=f("label"),z.textContent=be,ue=L(),w=f("select"),B=f("option"),B.textContent=fe;for(let r=0;r<U.length;r+=1)U[r].c();de=L(),Q=f("div"),G=f("label"),G.textContent=b,N=L(),C=f("select"),M=f("option"),M.textContent=se;for(let r=0;r<y.length;r+=1)y[r].c();Ee=L(),W=f("div"),$=f("label"),$.textContent=Pe,he=L(),V=f("input"),ke=L(),ae=f("div"),Y=f("button"),j&&j.c(),ne=S(`
						Assign Role`),Te=L(),x=f("div"),_e=f("div"),J=f("select"),oe=f("option"),oe.textContent=ve;for(let r=0;r<q.length;r+=1)q[r].c();T=L(),re=f("div"),ee=f("div"),Ve=S("Showing "),Ne=S(Ce),Ie=S(" active role"),Re=S(we),Ue=L(),ie.c(),this.h()},l(r){e=u(r,"DIV",{class:!0});var E=v(e);t=u(E,"DIV",{class:!0});var d=v(t);l=u(d,"H2",{"data-svelte-h":!0}),me(l)!=="svelte-1xkrq8g"&&(l.textContent=n),o=O(d),_=u(d,"BUTTON",{class:!0});var te=v(_);h=u(te,"I",{class:!0}),v(h).forEach(i),m=R(te," Refresh"),te.forEach(i),d.forEach(i),p=O(E),H&&H.l(E),k=O(E),g=u(E,"DIV",{class:!0});var Ge=v(g);D=u(Ge,"DIV",{class:!0,"data-svelte-h":!0}),me(D)!=="svelte-1dkbtll"&&(D.innerHTML=I),K=O(Ge),F=u(Ge,"DIV",{class:!0});var st=v(F);A=u(st,"DIV",{class:!0});var Oe=v(A);P=u(Oe,"DIV",{class:!0});var qe=v(P);z=u(qe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),me(z)!=="svelte-1s8xk4p"&&(z.textContent=be),ue=O(qe),w=u(qe,"SELECT",{id:!0,class:!0});var Xe=v(w);B=u(Xe,"OPTION",{"data-svelte-h":!0}),me(B)!=="svelte-kua526"&&(B.textContent=fe);for(let ce=0;ce<U.length;ce+=1)U[ce].l(Xe);Xe.forEach(i),qe.forEach(i),de=O(Oe),Q=u(Oe,"DIV",{class:!0});var Ke=v(Q);G=u(Ke,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),me(G)!=="svelte-rwhvvv"&&(G.textContent=b),N=O(Ke),C=u(Ke,"SELECT",{id:!0,class:!0});var Ze=v(C);M=u(Ze,"OPTION",{"data-svelte-h":!0}),me(M)!=="svelte-1fatopy"&&(M.textContent=se);for(let ce=0;ce<y.length;ce+=1)y[ce].l(Ze);Ze.forEach(i),Ke.forEach(i),Ee=O(Oe),W=u(Oe,"DIV",{class:!0});var Ye=v(W);$=u(Ye,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),me($)!=="svelte-vpme2u"&&($.textContent=Pe),he=O(Ye),V=u(Ye,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),Ye.forEach(i),ke=O(Oe),ae=u(Oe,"DIV",{class:!0});var at=v(ae);Y=u(at,"BUTTON",{class:!0});var $e=v(Y);j&&j.l($e),ne=R($e,`
						Assign Role`),$e.forEach(i),at.forEach(i),Oe.forEach(i),st.forEach(i),Ge.forEach(i),Te=O(E),x=u(E,"DIV",{class:!0});var Je=v(x);_e=u(Je,"DIV",{class:!0});var nt=v(_e);J=u(nt,"SELECT",{class:!0});var xe=v(J);oe=u(xe,"OPTION",{"data-svelte-h":!0}),me(oe)!=="svelte-1vw7buo"&&(oe.textContent=ve);for(let ce=0;ce<q.length;ce+=1)q[ce].l(xe);xe.forEach(i),nt.forEach(i),T=O(Je),re=u(Je,"DIV",{class:!0});var ot=v(re);ee=u(ot,"DIV",{class:!0});var Be=v(ee);Ve=R(Be,"Showing "),Ne=R(Be,Ce),Ie=R(Be," active role"),Re=R(Be,we),Be.forEach(i),ot.forEach(i),Je.forEach(i),Ue=O(E),ie.l(E),E.forEach(i),this.h()},h(){c(h,"class","bi bi-arrow-clockwise"),c(_,"class","btn btn-primary"),_.disabled=s[3],c(t,"class","d-flex justify-content-between align-items-center mb-4"),c(D,"class","card-header svelte-1h4f1is"),c(z,"for","user-select"),c(z,"class","form-label"),B.__value=null,pe(B,B.__value),c(w,"id","user-select"),c(w,"class","form-select"),w.disabled=s[3],s[5]===void 0&&et(()=>s[17].call(w)),c(P,"class","col-md-4"),c(G,"for","role-select"),c(G,"class","form-label"),M.__value="",pe(M,M.__value),c(C,"id","role-select"),c(C,"class","form-select"),C.disabled=s[3],s[6]===void 0&&et(()=>s[18].call(C)),c(Q,"class","col-md-4"),c($,"for","notes-input"),c($,"class","form-label"),c(V,"id","notes-input"),c(V,"type","text"),c(V,"class","form-control"),c(V,"placeholder","Assignment notes..."),V.disabled=s[3],c(W,"class","col-md-4"),c(Y,"class","btn btn-success"),Y.disabled=X=s[3]||!s[5]||!s[6],c(ae,"class","col-12"),c(A,"class","row g-3"),c(F,"class","card-body"),c(g,"class","card mb-4"),oe.__value="all",pe(oe,oe.__value),c(J,"class","form-select"),s[1]===void 0&&et(()=>s[20].call(J)),c(_e,"class","col-md-4"),c(ee,"class","text-muted mt-2"),c(re,"class","col-md-8"),c(x,"class","row mb-3"),c(e,"class","role-assignment svelte-1h4f1is")},m(r,E){le(r,e,E),a(e,t),a(t,l),a(t,o),a(t,_),a(_,h),a(_,m),a(e,p),H&&H.m(e,null),a(e,k),a(e,g),a(g,D),a(g,K),a(g,F),a(F,A),a(A,P),a(P,z),a(P,ue),a(P,w),a(w,B);for(let d=0;d<U.length;d+=1)U[d]&&U[d].m(w,null);Me(w,s[5],!0),a(A,de),a(A,Q),a(Q,G),a(Q,N),a(Q,C),a(C,M);for(let d=0;d<y.length;d+=1)y[d]&&y[d].m(C,null);Me(C,s[6],!0),a(A,Ee),a(A,W),a(W,$),a(W,he),a(W,V),pe(V,s[7]),a(A,ke),a(A,ae),a(ae,Y),j&&j.m(Y,null),a(Y,ne),a(e,Te),a(e,x),a(x,_e),a(_e,J),a(J,oe);for(let d=0;d<q.length;d+=1)q[d]&&q[d].m(J,null);Me(J,s[1],!0),a(x,T),a(x,re),a(re,ee),a(ee,Ve),a(ee,Ne),a(ee,Ie),a(ee,Re),a(e,Ue),ie.m(e,null),ye||(He=[Le(_,"click",s[12]),Le(w,"change",s[17]),Le(C,"change",s[18]),Le(V,"input",s[19]),Le(Y,"click",s[13]),Le(J,"change",s[20])],ye=!0)},p(r,E){if(E[0]&8&&(_.disabled=r[3]),r[4]?H?H.p(r,E):(H=ht(r),H.c(),H.m(e,k)):H&&(H.d(1),H=null),E[0]&1024){De=ge(r[10]);let d;for(d=0;d<De.length;d+=1){const te=dt(r,De,d);U[d]?U[d].p(te,E):(U[d]=_t(te),U[d].c(),U[d].m(w,null))}for(;d<U.length;d+=1)U[d].d(1);U.length=De.length}if(E[0]&8&&(w.disabled=r[3]),E[0]&1056&&Me(w,r[5]),E[0]&260){Ae=ge(r[8]);let d;for(d=0;d<Ae.length;d+=1){const te=ut(r,Ae,d);y[d]?y[d].p(te,E):(y[d]=mt(te),y[d].c(),y[d].m(C,null))}for(;d<y.length;d+=1)y[d].d(1);y.length=Ae.length}if(E[0]&8&&(C.disabled=r[3]),E[0]&324&&Me(C,r[6]),E[0]&8&&(V.disabled=r[3]),E[0]&128&&V.value!==r[7]&&pe(V,r[7]),r[3]?j||(j=gt(),j.c(),j.m(Y,ne)):j&&(j.d(1),j=null),E[0]&1388&&X!==(X=r[3]||!r[5]||!r[6])&&(Y.disabled=X),E&0){ze=ge(Object.values(rt));let d;for(d=0;d<ze.length;d+=1){const te=ct(r,ze,d);q[d]?q[d].p(te,E):(q[d]=pt(te),q[d].c(),q[d].m(J,null))}for(;d<q.length;d+=1)q[d].d(1);q.length=ze.length}E[0]&2&&Me(J,r[1]),E[0]&512&&Ce!==(Ce=r[9].length+"")&&Z(Ne,Ce),E[0]&512&&we!==(we=r[9].length!==1?"s":"")&&Z(Re,we),Fe===(Fe=lt(r))&&ie?ie.p(r,E):(ie.d(1),ie=Fe(r),ie&&(ie.c(),ie.m(e,null)))},i:We,o:We,d(r){r&&i(e),H&&H.d(),je(U,r),je(y,r),j&&j.d(),je(q,r),ie.d(),ye=!1,St(He)}}}function Se(s){return s.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function Yt(s,e,t){let l,n,o,_,h;const{stores:m,actions:p}=Bt,{users:k}=m;Tt(s,k,b=>t(10,h=b));let g=[],D=!1,I=null,K=null,F="",A="",P="all";Dt(async()=>{await p.fetchUsers(),await z()});async function z(){t(3,D=!0),t(4,I=null);try{const b=await Vt();t(0,g=b.map(N=>{const C=h.find(se=>se.id===N.user_id),M=Qe(N.role_id);return{...N,user:C,roleName:M?.name||N.role_id}}))}catch(b){t(4,I=b instanceof Error?b.message:"Failed to load roles")}finally{t(3,D=!1)}}async function be(){if(!K||!F){t(4,I="Please select both a user and a role");return}t(3,D=!0),t(4,I=null);try{const b=await zt(K,F,1,A||void 0);b.success?(t(5,K=null),t(6,F=""),t(7,A=""),await z()):t(4,I=b.error||"Failed to assign role")}catch(b){t(4,I=b instanceof Error?b.message:"Failed to assign role")}finally{t(3,D=!1)}}async function ue(b){if(confirm("Are you sure you want to release this role?")){t(3,D=!0),t(4,I=null);try{const N=await yt(b);N.success?await z():t(4,I=N.error||"Failed to release role")}catch(N){t(4,I=N instanceof Error?N.message:"Failed to release role")}finally{t(3,D=!1)}}}const w=()=>t(4,I=null);function B(){K=tt(this),t(5,K)}function fe(){F=tt(this),t(6,F),t(2,o),t(15,n),t(8,_),t(2,o),t(15,n)}function de(){A=this.value,t(7,A)}function Q(){P=tt(this),t(1,P)}const G=b=>ue(b.id);return s.$$.update=()=>{s.$$.dirty[0]&3&&t(9,l=g.filter(b=>P==="all"?!0:Qe(b.role_id)?.organization===P)),s.$$.dirty[0]&32768&&t(2,o=n.reduce((b,N)=>{const C=Qe(N);if(C){const M=C.organization;b[M]||(b[M]=[]),b[M].push(C)}return b},{})),s.$$.dirty[0]&4&&t(8,_=Object.keys(o))},t(15,n=Ut()),[g,P,o,D,I,K,F,A,_,l,h,k,z,be,ue,n,w,B,fe,de,Q,G]}class Jt extends At{constructor(e){super(),Ct(this,e,Yt,Kt,kt,{},null,[-1,-1])}}function Qt(s){let e,t;return e=new Jt({}),{c(){Rt(e.$$.fragment)},l(l){Nt(e.$$.fragment,l)},m(l,n){Lt(e,l,n),t=!0},i(l){t||(Ot(e.$$.fragment,l),t=!0)},o(l){wt(e.$$.fragment,l),t=!1},d(l){It(e,l)}}}function Wt(s){let e,t;return e=new Pt({props:{pageTitle:"Manage Roles",$$slots:{default:[Qt]},$$scope:{ctx:s}}}),{c(){Rt(e.$$.fragment)},l(l){Nt(e.$$.fragment,l)},m(l,n){Lt(e,l,n),t=!0},p(l,[n]){const o={};n&4&&(o.$$scope={dirty:n,ctx:l}),e.$set(o)},i(l){t||(Ot(e.$$.fragment,l),t=!0)},o(l){wt(e.$$.fragment,l),t=!1},d(l){It(e,l)}}}function Xt(s,e,t){let l;const{stores:{currentUserHasPermission:n}}=Mt();return Tt(s,n,o=>t(1,l=o)),Dt(()=>{l(Ht.AssignCallings)||jt("/home")}),[n]}class al extends At{constructor(e){super(),Ct(this,e,Xt,Wt,kt,{})}}export{al as component};
