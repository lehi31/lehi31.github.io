import{s as _t,n as Qe,d as u,r as ft,F as L,D as Ye,a as xe,i as se,b as l,E as ue,p as r,G as ht,c as s,e as v,K as m,g as T,f as de,M as lt,h as a,j as k,t as _e,k as Fe,x as vt,J as nt,y as st}from"../chunks/D_4avEwm.js";import{S as pt,i as mt,d as bt,t as Ct,a as gt,m as yt,c as Tt,b as kt}from"../chunks/DHraVsKH.js";import{P as Ot}from"../chunks/F8O8jmt1.js";import{e as at,u as Dt,d as Nt}from"../chunks/BCouCHAn.js";import{d as Et,w as Xe}from"../chunks/B4i-PGPN.js";import{a as xt,b as wt,g as Lt}from"../chunks/C6tLQbzg.js";import{g as Pt}from"../chunks/DEpWrbiB.js";const Je=Xe([]),Se=Xe(!1),qe=Xe(null);async function It(){Se.set(!0),qe.set(null);try{const o=localStorage.getItem("authToken"),e=await fetch(`${xt}/functions/v1/admin-get-users`,{headers:{"x-auth-token":o??"",apikey:wt}}),t=await e.json();if(!e.ok)throw new Error(t.error||"Failed to fetch users");if(t.users)Je.set(t.users);else throw new Error("No users data returned")}catch(o){const e=o instanceof Error?o.message:"Unknown error occurred";qe.set(e),console.error("Fetch users error:",o)}finally{Se.set(!1)}}async function At(o,e){Se.set(!0),qe.set(null);try{const t=localStorage.getItem("authToken"),n=await fetch(`${xt}/functions/v1/admin-update-user`,{method:"POST",headers:{"Content-Type":"application/json","x-auth-token":t??"",apikey:wt},body:JSON.stringify({userId:o,updates:e})}),i=await n.json();if(!n.ok)throw new Error(i.error||"Failed to update user");if(i.success)return await It(),{success:!0};throw new Error(i.error||"Update failed")}catch(t){const n=t instanceof Error?t.message:"Unknown error occurred";return qe.set(n),console.error("Update user error:",t),{success:!1,error:n}}finally{Se.set(!1)}}Et(Je,o=>o.filter(e=>e.is_active));Et(Je,o=>{const e={};return o.forEach(t=>{e[t.role]||(e[t.role]=[]),e[t.role].push(t)}),e});const Ut={stores:{users:Je,loading:Se,error:qe},actions:{fetchUsers:It,updateUser:At}};function ot(o,e,t){const n=o.slice();return n[26]=e[t],n}function rt(o){let e,t,n,i,p,x;return{c(){e=a("div"),t=_e(o[5]),n=k(),i=a("button"),this.h()},l(b){e=s(b,"DIV",{class:!0,role:!0});var g=v(e);t=de(g,o[5]),n=T(g),i=s(g,"BUTTON",{type:!0,class:!0,"aria-label":!0}),v(i).forEach(u),g.forEach(u),this.h()},h(){r(i,"type","button"),r(i,"class","btn-close"),r(i,"aria-label","Close"),r(e,"class","alert alert-danger alert-dismissible fade show"),r(e,"role","alert")},m(b,g){se(b,e,g),l(e,t),l(e,n),l(e,i),p||(x=ue(i,"click",o[15]),p=!0)},p(b,g){g&32&&xe(t,b[5])},d(b){b&&u(e),p=!1,x()}}}function St(o){let e,t,n,i="<tr><th>Email</th> <th>Display Name</th> <th>Role</th> <th>Status</th> <th>Created</th> <th>Last Login</th> <th>Actions</th></tr>",p,x,b=[],g=new Map,z,E=at(o[4]);const M=f=>f[26].id;for(let f=0;f<E.length;f+=1){let h=ot(o,E,f),d=M(h);g.set(d,b[f]=it(d,h))}let c=o[4].length===0&&ct();return{c(){e=a("div"),t=a("table"),n=a("thead"),n.innerHTML=i,p=k(),x=a("tbody");for(let f=0;f<b.length;f+=1)b[f].c();z=k(),c&&c.c(),this.h()},l(f){e=s(f,"DIV",{class:!0});var h=v(e);t=s(h,"TABLE",{class:!0});var d=v(t);n=s(d,"THEAD",{"data-svelte-h":!0}),m(n)!=="svelte-dtzgwn"&&(n.innerHTML=i),p=T(d),x=s(d,"TBODY",{});var R=v(x);for(let D=0;D<b.length;D+=1)b[D].l(R);R.forEach(u),d.forEach(u),z=T(h),c&&c.l(h),h.forEach(u),this.h()},h(){r(t,"class","table table-hover"),r(e,"class","table-responsive")},m(f,h){se(f,e,h),l(e,t),l(t,n),l(t,p),l(t,x);for(let d=0;d<b.length;d+=1)b[d]&&b[d].m(x,null);l(e,z),c&&c.m(e,null)},p(f,h){h&2064&&(E=at(f[4]),b=Dt(b,h,M,1,f,E,g,x,Nt,it,null,ot)),f[4].length===0?c||(c=ct(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(f){f&&u(e);for(let h=0;h<b.length;h+=1)b[h].d();c&&c.d()}}}function qt(o){let e,t='<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';return{c(){e=a("div"),e.innerHTML=t,this.h()},l(n){e=s(n,"DIV",{class:!0,"data-svelte-h":!0}),m(e)!=="svelte-mlx3u2"&&(e.innerHTML=t),this.h()},h(){r(e,"class","text-center py-5")},m(n,i){se(n,e,i)},p:Qe,d(n){n&&u(e)}}}function Vt(o){let e,t="Disabled";return{c(){e=a("span"),e.textContent=t,this.h()},l(n){e=s(n,"SPAN",{class:!0,"data-svelte-h":!0}),m(e)!=="svelte-1elwxk3"&&(e.textContent=t),this.h()},h(){r(e,"class","badge bg-danger")},m(n,i){se(n,e,i)},d(n){n&&u(e)}}}function Mt(o){let e,t="Active";return{c(){e=a("span"),e.textContent=t,this.h()},l(n){e=s(n,"SPAN",{class:!0,"data-svelte-h":!0}),m(e)!=="svelte-1at42hn"&&(e.textContent=t),this.h()},h(){r(e,"class","badge bg-success")},m(n,i){se(n,e,i)},d(n){n&&u(e)}}}function Rt(o){let e,t="Never";return{c(){e=a("small"),e.textContent=t,this.h()},l(n){e=s(n,"SMALL",{class:!0,"data-svelte-h":!0}),m(e)!=="svelte-g83u0a"&&(e.textContent=t),this.h()},h(){r(e,"class","text-muted")},m(n,i){se(n,e,i)},p:Qe,d(n){n&&u(e)}}}function Bt(o){let e,t=new Date(o[26].last_login).toLocaleDateString()+"",n;return{c(){e=a("small"),n=_e(t)},l(i){e=s(i,"SMALL",{});var p=v(e);n=de(p,t),p.forEach(u)},m(i,p){se(i,e,p),l(e,n)},p(i,p){p&16&&t!==(t=new Date(i[26].last_login).toLocaleDateString()+"")&&xe(n,t)},d(i){i&&u(e)}}}function it(o,e){let t,n,i=e[26].email+"",p,x,b,g=(e[26].display_name||"-")+"",z,E,M,c,f=e[26].role+"",h,d,R,D,Q,H,P,oe=new Date(e[26].created_at).toLocaleDateString()+"",F,w,O,fe,N,X,S='<i class="bi bi-pencil"></i> Edit',q,A,pe;function B(j,_){return j[26].is_active?Mt:Vt}let me=B(e),I=me(e);function we(j,_){return j[26].last_login?Bt:Rt}let V=we(e),G=V(e);function le(){return e[18](e[26])}return{key:o,first:null,c(){t=a("tr"),n=a("td"),p=_e(i),x=k(),b=a("td"),z=_e(g),E=k(),M=a("td"),c=a("span"),h=_e(f),R=k(),D=a("td"),I.c(),Q=k(),H=a("td"),P=a("small"),F=_e(oe),w=k(),O=a("td"),G.c(),fe=k(),N=a("td"),X=a("button"),X.innerHTML=S,q=k(),this.h()},l(j){t=s(j,"TR",{});var _=v(t);n=s(_,"TD",{});var Te=v(n);p=de(Te,i),Te.forEach(u),x=T(_),b=s(_,"TD",{});var K=v(b);z=de(K,g),K.forEach(u),E=T(_),M=s(_,"TD",{});var be=v(M);c=s(be,"SPAN",{class:!0});var Ce=v(c);h=de(Ce,f),Ce.forEach(u),be.forEach(u),R=T(_),D=s(_,"TD",{});var $=v(D);I.l($),$.forEach(u),Q=T(_),H=s(_,"TD",{});var ge=v(H);P=s(ge,"SMALL",{});var ye=v(P);F=de(ye,oe),ye.forEach(u),ge.forEach(u),w=T(_),O=s(_,"TD",{});var Z=v(O);G.l(Z),Z.forEach(u),fe=T(_),N=s(_,"TD",{});var W=v(N);X=s(W,"BUTTON",{class:!0,"data-svelte-h":!0}),m(X)!=="svelte-10e47bw"&&(X.innerHTML=S),W.forEach(u),q=T(_),_.forEach(u),this.h()},h(){r(c,"class",d="badge bg-"+dt(e[26].role)+" svelte-1icdqq8"),r(X,"class","btn btn-sm btn-outline-primary"),st(t,"table-secondary",!e[26].is_active),this.first=t},m(j,_){se(j,t,_),l(t,n),l(n,p),l(t,x),l(t,b),l(b,z),l(t,E),l(t,M),l(M,c),l(c,h),l(t,R),l(t,D),I.m(D,null),l(t,Q),l(t,H),l(H,P),l(P,F),l(t,w),l(t,O),G.m(O,null),l(t,fe),l(t,N),l(N,X),l(t,q),A||(pe=ue(X,"click",le),A=!0)},p(j,_){e=j,_&16&&i!==(i=e[26].email+"")&&xe(p,i),_&16&&g!==(g=(e[26].display_name||"-")+"")&&xe(z,g),_&16&&f!==(f=e[26].role+"")&&xe(h,f),_&16&&d!==(d="badge bg-"+dt(e[26].role)+" svelte-1icdqq8")&&r(c,"class",d),me!==(me=B(e))&&(I.d(1),I=me(e),I&&(I.c(),I.m(D,null))),_&16&&oe!==(oe=new Date(e[26].created_at).toLocaleDateString()+"")&&xe(F,oe),V===(V=we(e))&&G?G.p(e,_):(G.d(1),G=V(e),G&&(G.c(),G.m(O,null))),_&16&&st(t,"table-secondary",!e[26].is_active)},d(j){j&&u(t),I.d(),G.d(),A=!1,pe()}}}function ct(o){let e,t="<p>No users found matching your filters.</p>";return{c(){e=a("div"),e.innerHTML=t,this.h()},l(n){e=s(n,"DIV",{class:!0,"data-svelte-h":!0}),m(e)!=="svelte-i4erte"&&(e.innerHTML=t),this.h()},h(){r(e,"class","text-center py-5 text-muted")},m(n,i){se(n,e,i)},d(n){n&&u(e)}}}function ut(o){let e,t,n,i,p,x,b=o[2].email+"",g,z,E,M,c,f,h,d="Display Name",R,D,Q,H,P,oe="Role",F,w,O,fe="Root",N,X="Admin",S,q="Primary",A,pe="Relief Society",B,me="Elders Quorum",I,we="Teachers Quorum",V,G="Young Women",le,j="Sunday School",_,Te="Authenticated",K,be="Un-Authenticated",Ce,$,ge="Assign a church calling role to grant permissions",ye,Z,W,re,De,U,Ue="Active Account",Ie,Y,J="Disabled accounts cannot login",C,y,ie,ke="Admin Notes",Ne,ae,ee,he,ne,$e="Cancel",Ke,Ee,Ze="Save Changes",Ve,Le,We,et;return{c(){e=a("div"),t=a("div"),n=a("div"),i=a("div"),p=a("h5"),x=_e("Edit User: "),g=_e(b),z=k(),E=a("button"),M=k(),c=a("div"),f=a("div"),h=a("label"),h.textContent=d,R=k(),D=a("input"),Q=k(),H=a("div"),P=a("label"),P.textContent=oe,F=k(),w=a("select"),O=a("option"),O.textContent=fe,N=a("option"),N.textContent=X,S=a("option"),S.textContent=q,A=a("option"),A.textContent=pe,B=a("option"),B.textContent=me,I=a("option"),I.textContent=we,V=a("option"),V.textContent=G,le=a("option"),le.textContent=j,_=a("option"),_.textContent=Te,K=a("option"),K.textContent=be,Ce=k(),$=a("div"),$.textContent=ge,ye=k(),Z=a("div"),W=a("div"),re=a("input"),De=k(),U=a("label"),U.textContent=Ue,Ie=k(),Y=a("div"),Y.textContent=J,C=k(),y=a("div"),ie=a("label"),ie.textContent=ke,Ne=k(),ae=a("textarea"),ee=k(),he=a("div"),ne=a("button"),ne.textContent=$e,Ke=k(),Ee=a("button"),Ee.textContent=Ze,Ve=k(),Le=a("div"),this.h()},l(te){e=s(te,"DIV",{class:!0,tabindex:!0});var ce=v(e);t=s(ce,"DIV",{class:!0});var tt=v(t);n=s(tt,"DIV",{class:!0});var Pe=v(n);i=s(Pe,"DIV",{class:!0});var Me=v(i);p=s(Me,"H5",{class:!0});var Ge=v(p);x=de(Ge,"Edit User: "),g=de(Ge,b),Ge.forEach(u),z=T(Me),E=s(Me,"BUTTON",{type:!0,class:!0}),v(E).forEach(u),Me.forEach(u),M=T(Pe),c=s(Pe,"DIV",{class:!0});var Oe=v(c);f=s(Oe,"DIV",{class:!0});var Re=v(f);h=s(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),m(h)!=="svelte-1qww9aa"&&(h.textContent=d),R=T(Re),D=s(Re,"INPUT",{type:!0,class:!0,id:!0,placeholder:!0}),Re.forEach(u),Q=T(Oe),H=s(Oe,"DIV",{class:!0});var Ae=v(H);P=s(Ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),m(P)!=="svelte-qedzc3"&&(P.textContent=oe),F=T(Ae),w=s(Ae,"SELECT",{class:!0,id:!0});var ve=v(w);O=s(ve,"OPTION",{"data-svelte-h":!0}),m(O)!=="svelte-j6h65q"&&(O.textContent=fe),N=s(ve,"OPTION",{"data-svelte-h":!0}),m(N)!=="svelte-17op260"&&(N.textContent=X),S=s(ve,"OPTION",{"data-svelte-h":!0}),m(S)!=="svelte-afolwu"&&(S.textContent=q),A=s(ve,"OPTION",{"data-svelte-h":!0}),m(A)!=="svelte-caqcsh"&&(A.textContent=pe),B=s(ve,"OPTION",{"data-svelte-h":!0}),m(B)!=="svelte-z5bf0h"&&(B.textContent=me),I=s(ve,"OPTION",{"data-svelte-h":!0}),m(I)!=="svelte-h2ndd"&&(I.textContent=we),V=s(ve,"OPTION",{"data-svelte-h":!0}),m(V)!=="svelte-13e2z3"&&(V.textContent=G),le=s(ve,"OPTION",{"data-svelte-h":!0}),m(le)!=="svelte-1gqwsr1"&&(le.textContent=j),_=s(ve,"OPTION",{"data-svelte-h":!0}),m(_)!=="svelte-1hh738g"&&(_.textContent=Te),K=s(ve,"OPTION",{"data-svelte-h":!0}),m(K)!=="svelte-1nm0qee"&&(K.textContent=be),ve.forEach(u),Ce=T(Ae),$=s(Ae,"DIV",{class:!0,"data-svelte-h":!0}),m($)!=="svelte-adi1xr"&&($.textContent=ge),Ae.forEach(u),ye=T(Oe),Z=s(Oe,"DIV",{class:!0});var Be=v(Z);W=s(Be,"DIV",{class:!0});var He=v(W);re=s(He,"INPUT",{class:!0,type:!0,id:!0}),De=T(He),U=s(He,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),m(U)!=="svelte-gc2a6c"&&(U.textContent=Ue),He.forEach(u),Ie=T(Be),Y=s(Be,"DIV",{class:!0,"data-svelte-h":!0}),m(Y)!=="svelte-ip672x"&&(Y.textContent=J),Be.forEach(u),C=T(Oe),y=s(Oe,"DIV",{class:!0});var je=v(y);ie=s(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),m(ie)!=="svelte-17a0zww"&&(ie.textContent=ke),Ne=T(je),ae=s(je,"TEXTAREA",{class:!0,id:!0,rows:!0,placeholder:!0}),v(ae).forEach(u),je.forEach(u),Oe.forEach(u),ee=T(Pe),he=s(Pe,"DIV",{class:!0});var ze=v(he);ne=s(ze,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),m(ne)!=="svelte-1lv7sd1"&&(ne.textContent=$e),Ke=T(ze),Ee=s(ze,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),m(Ee)!=="svelte-ls02qf"&&(Ee.textContent=Ze),ze.forEach(u),Pe.forEach(u),tt.forEach(u),ce.forEach(u),Ve=T(te),Le=s(te,"DIV",{class:!0}),v(Le).forEach(u),this.h()},h(){r(p,"class","modal-title"),r(E,"type","button"),r(E,"class","btn-close"),r(i,"class","modal-header"),r(h,"class","form-label"),r(h,"for","displayName"),r(D,"type","text"),r(D,"class","form-control"),r(D,"id","displayName"),r(D,"placeholder","Display name (optional)"),r(f,"class","mb-3"),r(P,"class","form-label"),r(P,"for","userRole"),O.__value="root",L(O,O.__value),N.__value="admin",L(N,N.__value),S.__value="primary",L(S,S.__value),A.__value="relief-society",L(A,A.__value),B.__value="elders-quorum",L(B,B.__value),I.__value="teachers-quorum",L(I,I.__value),V.__value="young-women",L(V,V.__value),le.__value="sunday-school",L(le,le.__value),_.__value="authenticated",L(_,_.__value),K.__value="un-authenticated",L(K,K.__value),r(w,"class","form-select"),r(w,"id","userRole"),o[2].role===void 0&&ht(()=>o[21].call(w)),r($,"class","form-text"),r(H,"class","mb-3"),r(re,"class","form-check-input"),r(re,"type","checkbox"),r(re,"id","isActive"),r(U,"class","form-check-label"),r(U,"for","isActive"),r(W,"class","form-check form-switch"),r(Y,"class","form-text"),r(Z,"class","mb-3"),r(ie,"class","form-label"),r(ie,"for","adminNotes"),r(ae,"class","form-control"),r(ae,"id","adminNotes"),r(ae,"rows","3"),r(ae,"placeholder","Internal notes about this user..."),r(y,"class","mb-3"),r(c,"class","modal-body"),r(ne,"type","button"),r(ne,"class","btn btn-secondary"),r(Ee,"type","button"),r(Ee,"class","btn btn-primary"),r(he,"class","modal-footer"),r(n,"class","modal-content"),r(t,"class","modal-dialog"),r(e,"class","modal show d-block svelte-1icdqq8"),r(e,"tabindex","-1"),r(Le,"class","modal-backdrop show svelte-1icdqq8")},m(te,ce){se(te,e,ce),l(e,t),l(t,n),l(n,i),l(i,p),l(p,x),l(p,g),l(i,z),l(i,E),l(n,M),l(n,c),l(c,f),l(f,h),l(f,R),l(f,D),L(D,o[2].display_name),l(c,Q),l(c,H),l(H,P),l(H,F),l(H,w),l(w,O),l(w,N),l(w,S),l(w,A),l(w,B),l(w,I),l(w,V),l(w,le),l(w,_),l(w,K),Ye(w,o[2].role,!0),l(H,Ce),l(H,$),l(c,ye),l(c,Z),l(Z,W),l(W,re),re.checked=o[2].is_active,l(W,De),l(W,U),l(Z,Ie),l(Z,Y),l(c,C),l(c,y),l(y,ie),l(y,Ne),l(y,ae),L(ae,o[2].notes),l(n,ee),l(n,he),l(he,ne),l(he,Ke),l(he,Ee),se(te,Ve,ce),se(te,Le,ce),We||(et=[ue(E,"click",o[19]),ue(D,"input",o[20]),ue(w,"change",o[21]),ue(re,"change",o[22]),ue(ae,"input",o[23]),ue(ne,"click",o[24]),ue(Ee,"click",o[12])],We=!0)},p(te,ce){ce&4&&b!==(b=te[2].email+"")&&xe(g,b),ce&4&&D.value!==te[2].display_name&&L(D,te[2].display_name),ce&4&&Ye(w,te[2].role),ce&4&&(re.checked=te[2].is_active),ce&4&&L(ae,te[2].notes)},d(te){te&&(u(e),u(Ve),u(Le)),We=!1,ft(et)}}}function Ht(o){let e,t,n,i="User Management",p,x,b='<i class="bi bi-arrow-clockwise"></i> Refresh',g,z,E,M,c,f,h,d,R,D="All Roles",Q,H="Root",P,oe="Admin",F,w="Primary",O,fe="Relief Society",N,X="Elders Quorum",S,q="Teachers Quorum",A,pe="Young Women",B,me="Sunday School",I,we="Authenticated",V,G="Un-Authenticated",le,j,_,Te,K=o[4].length+"",be,Ce,$=o[4].length!==1?"s":"",ge,ye,Z,W,re,De,U=o[5]&&rt(o);function Ue(C,y){return C[6]?qt:St}let Ie=Ue(o),Y=Ie(o),J=o[3]&&o[2]&&ut(o);return{c(){e=a("div"),t=a("div"),n=a("h2"),n.textContent=i,p=k(),x=a("button"),x.innerHTML=b,g=k(),U&&U.c(),z=k(),E=a("div"),M=a("div"),c=a("input"),f=k(),h=a("div"),d=a("select"),R=a("option"),R.textContent=D,Q=a("option"),Q.textContent=H,P=a("option"),P.textContent=oe,F=a("option"),F.textContent=w,O=a("option"),O.textContent=fe,N=a("option"),N.textContent=X,S=a("option"),S.textContent=q,A=a("option"),A.textContent=pe,B=a("option"),B.textContent=me,I=a("option"),I.textContent=we,V=a("option"),V.textContent=G,le=k(),j=a("div"),_=a("div"),Te=_e("Total: "),be=_e(K),Ce=_e(" user"),ge=_e($),ye=k(),Y.c(),Z=k(),J&&J.c(),W=lt(),this.h()},l(C){e=s(C,"DIV",{class:!0});var y=v(e);t=s(y,"DIV",{class:!0});var ie=v(t);n=s(ie,"H2",{"data-svelte-h":!0}),m(n)!=="svelte-1w9k0u8"&&(n.textContent=i),p=T(ie),x=s(ie,"BUTTON",{class:!0,"data-svelte-h":!0}),m(x)!=="svelte-1t5isil"&&(x.innerHTML=b),ie.forEach(u),g=T(y),U&&U.l(y),z=T(y),E=s(y,"DIV",{class:!0});var ke=v(E);M=s(ke,"DIV",{class:!0});var Ne=v(M);c=s(Ne,"INPUT",{type:!0,class:!0,placeholder:!0}),Ne.forEach(u),f=T(ke),h=s(ke,"DIV",{class:!0});var ae=v(h);d=s(ae,"SELECT",{class:!0});var ee=v(d);R=s(ee,"OPTION",{"data-svelte-h":!0}),m(R)!=="svelte-1yhiy9v"&&(R.textContent=D),Q=s(ee,"OPTION",{"data-svelte-h":!0}),m(Q)!=="svelte-j6h65q"&&(Q.textContent=H),P=s(ee,"OPTION",{"data-svelte-h":!0}),m(P)!=="svelte-17op260"&&(P.textContent=oe),F=s(ee,"OPTION",{"data-svelte-h":!0}),m(F)!=="svelte-afolwu"&&(F.textContent=w),O=s(ee,"OPTION",{"data-svelte-h":!0}),m(O)!=="svelte-caqcsh"&&(O.textContent=fe),N=s(ee,"OPTION",{"data-svelte-h":!0}),m(N)!=="svelte-z5bf0h"&&(N.textContent=X),S=s(ee,"OPTION",{"data-svelte-h":!0}),m(S)!=="svelte-h2ndd"&&(S.textContent=q),A=s(ee,"OPTION",{"data-svelte-h":!0}),m(A)!=="svelte-13e2z3"&&(A.textContent=pe),B=s(ee,"OPTION",{"data-svelte-h":!0}),m(B)!=="svelte-1gqwsr1"&&(B.textContent=me),I=s(ee,"OPTION",{"data-svelte-h":!0}),m(I)!=="svelte-1hh738g"&&(I.textContent=we),V=s(ee,"OPTION",{"data-svelte-h":!0}),m(V)!=="svelte-1nm0qee"&&(V.textContent=G),ee.forEach(u),ae.forEach(u),le=T(ke),j=s(ke,"DIV",{class:!0});var he=v(j);_=s(he,"DIV",{class:!0});var ne=v(_);Te=de(ne,"Total: "),be=de(ne,K),Ce=de(ne," user"),ge=de(ne,$),ne.forEach(u),he.forEach(u),ke.forEach(u),ye=T(y),Y.l(y),y.forEach(u),Z=T(C),J&&J.l(C),W=lt(),this.h()},h(){r(x,"class","btn btn-primary"),r(t,"class","d-flex justify-content-between align-items-center mb-4"),r(c,"type","text"),r(c,"class","form-control"),r(c,"placeholder","Search by email or name..."),r(M,"class","col-md-6"),R.__value="all",L(R,R.__value),Q.__value="root",L(Q,Q.__value),P.__value="admin",L(P,P.__value),F.__value="primary",L(F,F.__value),O.__value="relief-society",L(O,O.__value),N.__value="elders-quorum",L(N,N.__value),S.__value="teachers-quorum",L(S,S.__value),A.__value="young-women",L(A,A.__value),B.__value="sunday-school",L(B,B.__value),I.__value="authenticated",L(I,I.__value),V.__value="un-authenticated",L(V,V.__value),r(d,"class","form-select"),o[0]===void 0&&ht(()=>o[17].call(d)),r(h,"class","col-md-3"),r(_,"class","text-muted mt-2"),r(j,"class","col-md-3"),r(E,"class","row mb-3"),r(e,"class","user-management")},m(C,y){se(C,e,y),l(e,t),l(t,n),l(t,p),l(t,x),l(e,g),U&&U.m(e,null),l(e,z),l(e,E),l(E,M),l(M,c),L(c,o[1]),l(E,f),l(E,h),l(h,d),l(d,R),l(d,Q),l(d,P),l(d,F),l(d,O),l(d,N),l(d,S),l(d,A),l(d,B),l(d,I),l(d,V),Ye(d,o[0],!0),l(E,le),l(E,j),l(j,_),l(_,Te),l(_,be),l(_,Ce),l(_,ge),l(e,ye),Y.m(e,null),se(C,Z,y),J&&J.m(C,y),se(C,W,y),re||(De=[ue(x,"click",o[14]),ue(c,"input",o[16]),ue(d,"change",o[17])],re=!0)},p(C,[y]){C[5]?U?U.p(C,y):(U=rt(C),U.c(),U.m(e,z)):U&&(U.d(1),U=null),y&2&&c.value!==C[1]&&L(c,C[1]),y&1&&Ye(d,C[0]),y&16&&K!==(K=C[4].length+"")&&xe(be,K),y&16&&$!==($=C[4].length!==1?"s":"")&&xe(ge,$),Ie===(Ie=Ue(C))&&Y?Y.p(C,y):(Y.d(1),Y=Ie(C),Y&&(Y.c(),Y.m(e,null))),C[3]&&C[2]?J?J.p(C,y):(J=ut(C),J.c(),J.m(W.parentNode,W)):J&&(J.d(1),J=null)},i:Qe,o:Qe,d(C){C&&(u(e),u(Z),u(W)),U&&U.d(),Y.d(),J&&J.d(C),re=!1,ft(De)}}}function dt(o){switch(o){case"root":return"danger";case"admin":return"primary";case"primary":case"relief-society":case"elders-quorum":case"teachers-quorum":case"young-women":case"sunday-school":return"info";case"authenticated":return"success";case"un-authenticated":return"secondary";default:return"secondary"}}function jt(o,e,t){let n,i,p,x;const{stores:b,actions:g}=Ut,{users:z,loading:E,error:M}=b;Fe(o,z,q=>t(13,i=q)),Fe(o,E,q=>t(6,x=q)),Fe(o,M,q=>t(5,p=q));let c=null,f=!1,h="all",d="";vt(()=>{g.fetchUsers()});function R(q){t(2,c={...q}),t(3,f=!0)}async function D(){if(!c)return;(await g.updateUser(c.id,{role:c.role,is_active:c.is_active,notes:c.notes,display_name:c.display_name})).success&&(t(3,f=!1),t(2,c=null))}const Q=()=>g.fetchUsers(),H=()=>M.set(null);function P(){d=this.value,t(1,d)}function oe(){h=nt(this),t(0,h)}const F=q=>R(q),w=()=>t(3,f=!1);function O(){c.display_name=this.value,t(2,c)}function fe(){c.role=nt(this),t(2,c)}function N(){c.is_active=this.checked,t(2,c)}function X(){c.notes=this.value,t(2,c)}const S=()=>t(3,f=!1);return o.$$.update=()=>{o.$$.dirty&8195&&t(4,n=i.filter(q=>{const A=h==="all"||q.role===h,pe=d===""||q.email.toLowerCase().includes(d.toLowerCase())||q.display_name?.toLowerCase().includes(d.toLowerCase());return A&&pe}))},[h,d,c,f,n,p,x,g,z,E,M,R,D,i,Q,H,P,oe,F,w,O,fe,N,X,S]}class zt extends pt{constructor(e){super(),mt(this,e,jt,Ht,_t,{})}}function Ft(o){let e,t;return e=new zt({}),{c(){kt(e.$$.fragment)},l(n){Tt(e.$$.fragment,n)},m(n,i){yt(e,n,i),t=!0},i(n){t||(gt(e.$$.fragment,n),t=!0)},o(n){Ct(e.$$.fragment,n),t=!1},d(n){bt(e,n)}}}function Qt(o){let e,t;return e=new Ot({props:{pageTitle:"Manage Users",$$slots:{default:[Ft]},$$scope:{ctx:o}}}),{c(){kt(e.$$.fragment)},l(n){Tt(e.$$.fragment,n)},m(n,i){yt(e,n,i),t=!0},p(n,[i]){const p={};i&4&&(p.$$scope={dirty:i,ctx:n}),e.$set(p)},i(n){t||(gt(e.$$.fragment,n),t=!0)},o(n){Ct(e.$$.fragment,n),t=!1},d(n){bt(e,n)}}}function Yt(o,e,t){let n;const{stores:{currentUser:i}}=Lt();return Fe(o,i,p=>t(1,n=p)),vt(()=>{n?.role!=="root"&&n?.role!=="admin"&&Pt("/home")}),[i]}class el extends pt{constructor(e){super(),mt(this,e,Yt,Qt,_t,{})}}export{el as component};
