const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DO0djbQe.js","../chunks/Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{d as Ya,o as ca,g as Va}from"../chunks/CuVcyAaV.js";import{p as vt,c as a,r as t,s as i,a as ct,B as C,C as Xa,m as e,f as be,F as Ma,ai as D,D as v,E as p,aj as ua,u as o,R as Ee,aq as Ja,n as z,ar as Za}from"../chunks/BWCcv1pC.js";import{f as c,a as l,c as ot,t as lt}from"../chunks/DqgkBxsg.js";import{i as b,b as oe,k as $a,a as pa,s as P,p as it,e as j}from"../chunks/KiCntiD6.js";import{i as ut}from"../chunks/BeNQ5BU7.js";import{P as Ga}from"../chunks/BrUqDFES.js";import{e as We,i as va}from"../chunks/CvOYN50o.js";import{r as Pa,b as er,s as dt,i as tr,c as ar,d as rr,e as sr}from"../chunks/BhDwlPrK.js";import{b as nr}from"../chunks/CzDGc265.js";import{e as or,g as fa,d as lr,a as Wt,b as da,i as jt}from"../chunks/ChE2dj8K.js";import{d as Ea,s as Sa,A as ir,E as dr}from"../chunks/6SeCTyAx.js";import{d as _a,p as he,u as vr,i as _e,O as Da,P as Te,e as Ye}from"../chunks/GZlrwSKv.js";import{C as Ra,E as cr,c as ur}from"../chunks/BhPhX5cW.js";import{S as Ca}from"../chunks/Df_v6ygR.js";import{v as Ta,D as Ia}from"../chunks/MVigv8mq.js";import{s as qt}from"../chunks/DyfVHEYA.js";import{e as Ht}from"../chunks/Ca1eXe1w.js";import{B as pr}from"../chunks/CWgD8NYP.js";import{_ as fr}from"../chunks/CmsKOCeN.js";import{s as _r}from"../chunks/CdEA5IGF.js";import{R as St}from"../chunks/qVIilodb.js";function br(le,T){return or(le,-T)}const mr=!0,Bs=Object.freeze(Object.defineProperty({__proto__:null,prerender:mr},Symbol.toStringTag,{value:"Module"}));var yr=c("<option> </option>"),gr=c('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by category"><option>All Categories</option><!></select></div>'),hr=c('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><input type="search" class="form-control form-control" placeholder="Search..."/></div> <!></div></div>');function xr(le,T){vt(T,!1);const N=()=>oe(F,"$searchQuery",O),x=()=>oe(K,"$currentCategories",O),Z=()=>oe(q,"$categoryFilter",O),[O,g]=pa(),{stores:{currentCategories:K,categoryFilter:q,searchQuery:F}}=fa();ut();var ee=hr(),w=a(ee),te=a(w),U=a(te);Pa(U),t(te);var ce=i(te,2);{var A=H=>{var h=gr(),ae=a(h);C(()=>{Z(),Xa(()=>{x()})});var Q=a(ae);Q.value=Q.__value="";var G=i(Q);We(G,1,x,va,(re,$)=>{var L=yr(),Y=a(L,!0);t(L);var ie={};C(()=>{P(Y,e($).label),ie!==(ie=e($).key)&&(L.value=(L.__value=e($).key)??"")}),l(re,L)}),t(ae),t(h),er(ae,Z,re=>$a(q,re)),l(H,h)};b(ce,H=>{x().length&&H(A)})}t(w),t(ee),nr(U,N,H=>$a(F,H)),l(le,ee),ct(),g()}var wr=c('<p class="mb-0">No past events to delete.</p>'),kr=c('<p class="mb-2"><strong> </strong></p>'),$r=c(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Er=c("<!> <!>",1),Sr=c('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Dr(le,T){vt(T,!1);let N=it(T,"deleted",8),x=it(T,"skipped",8),Z=it(T,"callback",8);function O(){Z()()}ut();var g=Sr(),K=a(g),q=a(K),F=a(q),ee=i(a(F),2);t(F);var w=i(F,2),te=a(w);{var U=h=>{var ae=wr();l(h,ae)},ce=h=>{var ae=Er(),Q=be(ae);{var G=L=>{var Y=kr(),ie=a(Y),Se=a(ie);t(ie),t(Y),C(()=>P(Se,`✓ Deleted ${N()??""} past event${N()===1?"":"s"}.`)),l(L,Y)};b(Q,L=>{N()>0&&L(G)})}var re=i(Q,2);{var $=L=>{var Y=$r(),ie=a(Y),Se=a(ie),xe=a(Se);t(Se),t(ie),Ma(2),t(Y),C(()=>P(xe,`⚠ Skipped ${x()??""} recurring event${x()===1?"":"s"}`)),l(L,Y)};b(re,L=>{x()>0&&L($)})}l(h,ae)};b(te,h=>{N()===0&&x()===0?h(U):h(ce,!1)})}t(w);var A=i(w,2),H=a(A);t(A),t(q),t(K),t(g),j("click",ee,O),j("click",H,O),l(le,g),ct()}var Ar=c(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Mr(le,T){vt(T,!1);let N=it(T,"cutoffDate",8),x=it(T,"callback",8);function Z(){x()(!0)}function O(){x()(!1)}ut();var g=Ar(),K=a(g),q=a(K),F=a(q),ee=i(a(F),2);t(F);var w=i(F,2),te=a(w),U=a(te),ce=a(U);t(U),t(te),Ma(2),t(w);var A=i(w,2),H=a(A),h=i(H,2);t(A),t(q),t(K),t(g),C(()=>P(ce,`Are you sure you want to delete all events that occurred before ${N()??""}?`)),j("click",ee,O),j("click",H,O),j("click",h,Z),l(le,g),ct()}var Pr=c('<button class="btn btn-sm btn-outline-secondary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Rr=c('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),Cr=c('<div class="event-actions svelte-1ichfmm"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),Tr=c('<div class="daily-event-row svelte-1ichfmm"><div class="event-content svelte-1ichfmm"><!></div> <!></div>'),Ir=c('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),Or=c('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),Fr=c('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),Ur=c('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),Lr=c('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),Br=c('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Nr=c('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Wr=c('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),jr=c('<div class="card-body text-muted small">No past events available.</div>'),qr=c('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-outline-secondary">Hide</button></div></div></div> <!></div>'),Hr=c('<div class="d-flex flex-column gap-4"><!></div>'),zr=c("<!> <!> <!> <!>",1);function Kr(le,T){vt(T,!1);const N=()=>oe(de,"$weeksExpanded",w),x=()=>oe(W,"$allPastEvents",w),Z=()=>oe(L,"$currentUser",w),O=()=>oe(Se,"$userOrganizations",w),g=()=>oe($,"$currentUserHasPermission",w),K=()=>oe(ie,"$currentUserIsRoot",w),q=()=>oe(Y,"$currentUserIsAdmin",w),F=()=>oe(xe,"$ready",w),ee=()=>oe(De,"$searchQuery",w),[w,te]=pa(),U=p(),ce=p(),A=p(),H=p(),h=p(),ae=p(),Q=p(),G=p(),re=p(),{stores:{currentUserHasPermission:$,currentUser:L,currentUserIsAdmin:Y,currentUserIsRoot:ie,userOrganizations:Se}}=_a(),{stores:{ready:xe,dbData:B,weeksExpanded:de,searchQuery:De},actions:{reload:se}}=fa(),Dt={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let Ve=it(T,"formId",24,Ta),At=p(!1),Xe=p(!1),Je=p(),pt=p(!1),ft=p(!1),Ze=p(!1),Ge=p(new Set),Fe=p(!1),Mt=p(""),et=p({...Dt}),je=p(!1),Pt=p(""),_t=p(!1),k=p({deleted:0,skipped:0});const bt=4,Rt=4;let Ue=p(bt),tt=p(!1);const Ct=qt();let s=p({});function d(r){return e(U).includes(r)}function f(r){const u=e(s)[r]??d(r);v(s,{...e(s),[r]:!u})}const m=r=>{v(Mt,"Event Item"),v(et,{...r,category:r?.meta_data?.category})},W=Ya(B,r=>{const u=qt();return(r??[]).filter(n=>!(n.event_type!=="calendar_event"||!n.start_time||he(n.start_time)>=u||n.recurrence_rule&&(!n.recurrence_end_date||n.recurrence_end_date&&he(n.recurrence_end_date)>=u)))}),Ae=r=>ur(r,{currentUserId:e(Je),isPrivileged:e(Xe),canEditOwnOrgEvents:e(Ze),userOrganizations:e(Ge)});let ve=p(!1);function M(){v(Ue,e(Ue)+Rt)}function me(){v(Ue,520),v(tt,!0)}function Me(){v(Ue,bt),v(tt,!1)}const Ie=()=>{if(!e(At)||e(Fe)||!Va(ie)||!e(G))return;const r=qt();v(Pt,_e(r,"MMM d, yyyy")),v(je,!0)};async function Le(r){if(v(je,!1),!r)return;const u=qt();v(Fe,!0);try{const n=await lr(u);await se(),v(k,n),v(_t,!0)}catch(n){console.error("Failed to delete past events",n),alert("Failed to delete past events. Please try again.")}finally{v(Fe,!1)}}function mt(){v(_t,!1)}ca(async()=>{await se()}),D(()=>(x(),e(Ue)),()=>{v(A,(x()??[]).filter(r=>{if(!r.start_time)return!1;const u=he(r.start_time),n=br(Ct,e(Ue));return u>=n&&u<Ct}))}),D(()=>(e(A),_e),()=>{v(h,(()=>{const r=new Map;for(const u of e(A)){if(!u.start_time)continue;const n=he(u.start_time),R=vr(n,{weekStartsOn:1}),E=Ht(n,{weekStartsOn:1}),S=_e(R,"yyyy-MM-dd"),ne=`${_e(R,"MMM d")} – ${_e(E,"MMM d")}`;let V=r.get(S);V||(V={key:S,label:ne,days:new Map},r.set(S,V));const ke=_e(n,"yyyy-MM-dd");let Pe=V.days.get(ke);Pe||(Pe={key:ke,displayDay:_e(n,"EEE"),displayDate:_e(n,"MMM d"),events:[]},V.days.set(ke,Pe)),Pe.events.push(u)}return Array.from(r.values()).sort((u,n)=>u.key<n.key?1:-1).map(u=>({key:u.key,label:u.label,days:Array.from(u.days.values()).sort((n,R)=>n.key<R.key?1:-1).map(n=>({...n,events:n.events.slice().sort((R,E)=>{const S=R.is_all_day?0:1,ne=E.is_all_day?0:1;if(S!==ne)return S-ne;const V=R.start_time?he(R.start_time).getTime():Number.MAX_SAFE_INTEGER,ke=E.start_time?he(E.start_time).getTime():Number.MAX_SAFE_INTEGER;return V-ke})}))}))})())}),D(()=>e(h),()=>{v(U,(()=>{if(e(h).length===0)return[];const r=[];return e(h)[0]&&r.push(e(h)[0].key),e(h)[1]&&r.push(e(h)[1].key),r})())}),D(()=>(N(),e(s)),()=>{v(ce,r=>N()?!0:e(s)[r]!==void 0?e(s)[r]:d(r))}),D(()=>e(A),()=>{v(H,e(A).length)}),D(()=>(e(h),_e),()=>{v(ae,e(h).reduce((r,u)=>{const n=he(u.key),R=Ht(n,{weekStartsOn:1}),E=_e(R,"yyyy-MM"),S=_e(R,"MMMM yyyy");return r[E]||(r[E]={label:S,weeks:[]}),r[E].weeks.push(u),r},{}))}),D(()=>Z(),()=>{v(Je,Z()?.id)}),D(()=>O(),()=>{v(Ge,O())}),D(()=>e(Je),()=>{v(ft,!!e(Je))}),D(()=>(e(Ge),Da),()=>{v(pt,e(Ge).has(Da.Bishopric))}),D(()=>(g(),Te),()=>{v(Ze,g()(Te.EditOwnOrgEvents))}),D(()=>(K(),q(),e(pt),g(),Te),()=>{v(Xe,K()||q()||e(pt)||g()(Te.EditAllEvents))}),D(()=>(e(Xe),g(),e(Ze),e(ft)),()=>{v(At,e(Xe)||g()(Te.CreateEvents)||e(Ze)||e(ft))}),D(()=>(g(),Te),()=>{v(Q,g()(Te.DeleteEvents))}),D(()=>e(A),()=>{v(G,e(A).length>0)}),D(()=>(x(),e(A)),()=>{v(re,x().length>e(A).length)}),ua(),ut();var at=zr(),yt=be(at);Ia(yt,{get title(){return e(Mt)},get id(){return Ve()},children:(r,u)=>{Ra(r,{get eventItem(){return e(et)},get drawerId(){return Ve()},name:"past-event-item-form",get canDelete(){return e(Q)}})},$$slots:{default:!0}});var we=i(yt,2);{var Tt=r=>{var u=ot(),n=be(u);{var R=S=>{var ne=ot(),V=be(ne);{var ke=Be=>{var $e=Pr(),Oe=i(a($e));t($e),C(()=>P(Oe,` Show Past Events (${x(),o(()=>x().length)??""})`)),j("click",$e,()=>v(ve,!0)),l(Be,$e)},Pe=Be=>{var $e=qr(),Oe=a($e),Ot=a(Oe),gt=i(a(Ot),2),ht=a(gt);{var Qt=pe=>{var ye=Rr(),qe=a(ye);{var wt=X=>{var fe=lt("Deleting…");l(X,fe)},He=X=>{var fe=lt();C(()=>P(fe,`Delete All (${e(H)??""})`)),l(X,fe)};b(qe,X=>{e(Fe)?X(wt):X(He,!1)})}t(ye),C(()=>ye.disabled=e(Fe)),j("click",ye,Ie),l(pe,ye)};b(ht,pe=>{K()&&e(G)&&pe(Qt)})}var xt=i(ht,2);t(gt),t(Ot),t(Oe);var Ft=i(Oe,2);{var Yt=pe=>{var ye=Wr(),qe=be(ye);We(qe,5,()=>(e(ae),o(()=>Object.entries(e(ae)))),([X,fe])=>X,(X,fe)=>{var ze=Ja(()=>Za(e(fe),2));let Ne=()=>e(ze)[1];var Ke=Ur(),Re=be(Ke),rt=a(Re,!0);t(Re);var Ce=i(Re,2);We(Ce,1,()=>(Ne(),o(()=>Ne().weeks)),ge=>ge.key,(ge,J)=>{const _=Ee(()=>(z(he),e(J),o(()=>he(e(J).key)))),y=Ee(()=>(z(Ht),z(e(_)),o(()=>Ht(e(_),{weekStartsOn:1})))),ue=Ee(()=>(z(Sa),z(e(y)),o(()=>Sa(e(y))))),Qe=Ee(()=>(z(Ea),z(e(y)),z(e(ue)),o(()=>Ea(e(y),e(ue),{weekStartsOn:1})+1))),Xt=Ee(()=>(e(ce),e(J),o(()=>e(ce)(e(J).key)))),Ut=Ee(()=>(e(J),o(()=>e(J).days.reduce(($t,Lt)=>$t+Lt.events.length,0))));var ba=Fr(),Jt=be(ba),kt=a(Jt);let ma;var Zt=a(kt),ya=a(Zt),ga=i(ya,2),Oa=a(ga);t(ga),t(Zt);var Gt=i(Zt,2);let ha;var Fa=a(Gt,!0);t(Gt),t(kt),t(Jt);var Ua=i(Jt,2);{var La=$t=>{var Lt=ot(),Ba=be(Lt);{var Na=st=>{var Bt=ot(),ja=be(Bt);We(ja,1,()=>(e(J),o(()=>e(J).days)),ea=>ea.key,(ea,nt)=>{var ta=Ir(),xa=a(ta),aa=a(xa),ra=a(aa),qa=a(ra,!0);t(ra);var wa=i(ra,2),Ha=a(wa,!0);t(wa),t(aa);var ka=i(aa,2);We(ka,5,()=>(e(nt),o(()=>e(nt).events)),Et=>Et.id??`${Et.start_time}-${Et.meta_data?.recurring_instance_index??0}`,(Et,Nt)=>{var sa=Tr(),na=a(sa),za=a(na);cr(za,{get item(){return e(Nt)},showDate:!1,get searchQuery(){return ee()}}),t(na);var Ka=i(na,2);{var Qa=oa=>{var la=Cr(),ia=a(la);t(la),C(()=>{dt(ia,"data-bs-target",`#${Ve()??""}`),dt(ia,"aria-controls",Ve())}),j("click",ia,()=>m(e(Nt))),l(oa,la)};b(Ka,oa=>{e(Nt),o(()=>Ae(e(Nt)))&&oa(Qa)})}t(sa),l(Et,sa)}),t(ka),t(xa),t(ta),C(()=>{P(qa,(e(nt),o(()=>e(nt).displayDay))),P(Ha,(e(nt),o(()=>e(nt).displayDate)))}),l(ea,ta)}),l(st,Bt)},Wa=st=>{var Bt=Or();l(st,Bt)};b(Ba,st=>{e(J),o(()=>e(J).days.length)?st(Na):st(Wa,!1)})}l($t,Lt)};b(Ua,$t=>{e(Xt)&&$t(La)})}C(()=>{ma=Ye(kt,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,ma,{"text-muted":e(Ut)===0}),dt(kt,"title",e(Xt)?"Click to collapse week":"Click to expand week"),Ye(ya,1,`bi ${e(Xt)?"bi-chevron-up":"bi-chevron-down"}`),P(Oa,`Week ${e(Qe)??""} [${e(Ut)??""} Event${e(Ut)===1?"":"s"}]`),ha=Ye(Gt,1,"",null,ha,{"opacity-50":e(Ut)===0}),P(Fa,(e(J),o(()=>e(J).label)))}),j("click",kt,()=>f(e(J).key)),l(ge,ba)}),C(()=>P(rt,(Ne(),o(()=>Ne().label)))),l(X,Ke)}),t(qe);var wt=i(qe,2);{var He=X=>{var fe=Nr(),ze=a(fe),Ne=a(ze);t(ze);var Ke=i(ze,2);{var Re=Ce=>{var ge=Lr();j("click",ge,Me),l(Ce,ge)},rt=Ce=>{var ge=Br(),J=a(ge),_=i(J,2);t(ge),j("click",J,M),j("click",_,me),l(Ce,ge)};b(Ke,Ce=>{e(tt)?Ce(Re):Ce(rt,!1)})}t(fe),C(()=>P(Ne,`Showing ${e(A),o(()=>e(A)?.length??0)??""} of ${x(),o(()=>x()?.length??0)??""}`)),l(X,fe)};b(wt,X=>{(e(re)||e(tt))&&X(He)})}l(pe,ye)},Vt=pe=>{var ye=jr();l(pe,ye)};b(Ft,pe=>{e(h),o(()=>e(h).length)?pe(Yt):pe(Vt,!1)})}t($e),j("click",xt,()=>v(ve,!1)),l(Be,$e)};b(V,Be=>{e(ve)?Be(Pe,!1):Be(ke)})}l(S,ne)},E=S=>{var ne=Hr(),V=a(ne);Ca(V,{}),t(ne),l(S,ne)};b(n,S=>{F()?S(R):S(E,!1)})}l(r,u)};b(we,r=>{K()&&r(Tt)})}var It=i(we,2);{var zt=r=>{Mr(r,{get cutoffDate(){return e(Pt)},callback:Le})};b(It,r=>{e(je)&&r(zt)})}var Kt=i(It,2);{var I=r=>{Dr(r,{get deleted(){return e(k),o(()=>e(k).deleted)},get skipped(){return e(k),o(()=>e(k).skipped)},callback:mt})};b(Kt,r=>{e(_t)&&r(I)})}l(le,at),ct(),te()}var Qr=c('<div class="d-flex flex-column gap-4"><!> <!> <!> <!></div>');function Aa(le){var T=Qr(),N=a(T);xr(N,{});var x=i(N,2);ir(x,{});var Z=i(x,2);dr(Z,{});var O=i(Z,2);Kr(O,{}),t(T),l(le,T)}var Yr=c('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),Vr=c('<button type="button" role="tab"> </button>'),Xr=c("<option> </option>"),Jr=c('<div class="py-5 text-center text-muted"><!></div>'),Zr=c('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),Gr=c("<span> </span>"),es=c('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),ts=c('<span><i class="bi bi-geo-alt"></i> </span>'),as=c('<span><i class="bi bi-arrow-repeat"></i> </span>'),rs=c('<span><i class="bi bi-calendar3"></i> </span>'),ss=c('<span class="text-muted small"> </span>'),ns=c('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-outline-primary" type="button"><i class="bi bi-pencil-square"></i></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),os=c('<div class="d-flex flex-column gap-3"></div>'),ls=c('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="card"><div class="card-header d-flex flex-column gap-3"><div class="d-flex flex-md-row align-items-center justify-content-between gap-2"><div class="mb-0">My Submissions</div> <button class="btn btn-outline-secondary btn-sm"><!></button></div> <div class="submissions-status-tabs nav nav-pills gap-2" role="tablist"></div></div> <div class="card-body d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3"><div class="input-group input-group-sm my-submissions-search svelte-9fakr"><input class="form-control svelte-9fakr" type="search" placeholder="Search title, category, or location"/></div> <div class="type-filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div> <!></div></div></div>'),is=c('<div class="text-muted">Select a submission to edit.</div>'),ds=c("<!> <!>",1);function vs(le,T){vt(T,!1);const N=()=>oe(h,"$currentUserStore",g),x=()=>oe(ae,"$currentUserHasPermission",g),Z=()=>oe(A,"$dbData",g),O=()=>oe(ce,"$ready",g),[g,K]=pa(),q=p(),F=p(),ee=p(),w=p(),te=p(),U=p(),{stores:{ready:ce,dbData:A},actions:{reload:H}}=fa(),{stores:{currentUser:h,currentUserHasPermission:ae}}=_a();let Q=p(!1),G=p([]),re=p([]),$=p(null);const L=Ta();let Y=null;const ie={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},Se={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},xe={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},B=[{value:"pending",label:xe.pending},{value:"needs_review",label:xe.needs_review},{value:"approved",label:xe.approved},{value:"published",label:xe.published}],de=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}],De=()=>({search:"",typeFilter:"all"});let se=p({pending:De(),needs_review:De(),approved:De(),published:De()});ca(async()=>{v(Q,!0),await H(),v(Q,!1),typeof window<"u"&&(Y=(await fr(()=>import("../chunks/DO0djbQe.js").then(d=>d.o),__vite__mapDeps([0,1]),import.meta.url)).default)});const Dt=s=>{const d=s.meta_data?.submitted_at??s.created_at;if(!d)return 0;try{return he(d).getTime()}catch(f){return console.warn("Failed to parse submission timestamp",f),0}},Ve=s=>{const d=s.meta_data?.submitted_at??s.created_at;if(!d)return"—";try{return _e(he(d),"MMM d, yyyy 'at' h:mm a")}catch(f){return console.warn("Failed to format submission timestamp",f),"—"}},At=s=>{if(!s.start_time)return"—";try{return _e(he(s.start_time),"MMM d, yyyy 'at' h:mm a")}catch(d){return console.warn("Failed to format event date",d),"—"}},Xe=s=>s.replace(/<[^>]*>/g,""),Je=(s,d)=>s.length<=d?s:s.substring(0,d).trimEnd()+"…",pt=s=>s.description?Je(Xe(s.description).trim(),120):"",ft=s=>{try{const f=St.fromString(s).origOptions,m=f.interval||1,W=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ae=["","1st","2nd","3rd","4th","5th"];if(f.freq===St.DAILY)return m===1?"Repeats daily":`Repeats every ${m} days`;if(f.freq===St.WEEKLY){if(f.byweekday){const M=(Array.isArray(f.byweekday)?f.byweekday:[f.byweekday]).map(me=>{const Me=typeof me=="number"?me:me.weekday,Ie=Me===6?0:Me+1;return W[Ie]});return m===1?M.length===1?`Repeats every ${M[0]}`:`Repeats on ${M.join(", ")}`:`Repeats every ${m} weeks on ${M.join(", ")}`}return m===1?"Repeats weekly":`Repeats every ${m} weeks`}if(f.freq===St.MONTHLY){if(f.byweekday){const M=(Array.isArray(f.byweekday)?f.byweekday:[f.byweekday])[0];if(M&&typeof M=="object"&&"n"in M&&"weekday"in M){const me=M.weekday,Me=me===6?0:me+1,Ie=M.n,Le=Ae[Ie]||`${Ie}th`;return m===1?`Repeats on the ${Le} ${W[Me]} of the month`:`Repeats on the ${Le} ${W[Me]} every ${m} months`}}if(f.bymonthday){const ve=Array.isArray(f.bymonthday)?f.bymonthday[0]:f.bymonthday,M=ve===1?"st":ve===2?"nd":ve===3?"rd":"th";return m===1?`Repeats on the ${ve}${M} of the month`:`Repeats on the ${ve}${M} every ${m} months`}return m===1?"Repeats monthly":`Repeats every ${m} months`}return f.freq===St.YEARLY?m===1?"Repeats yearly":`Repeats every ${m} years`:"Repeats"}catch{return"Repeats"}},Ze=(s,d)=>{const f=d.trim().toLowerCase();if(!f)return!0;const m=s.meta_data?.category?da(s.meta_data.category)?.label??"":"";return[s.title??"",s.description??"",s.location??"",m??""].join(" ").toLowerCase().includes(f)},Ge=(s,d)=>d==="all"?!0:d==="events"?s.event_type==="calendar_event":s.event_type==="announcement";function Fe(s,d){v(se,{...e(se),[s]:{...e(se)[s],...d}})}const Mt=s=>{const d=new Set,f=[];for(const m of s){const W=m.meta_data?.recurring_parent_id;if(m.meta_data?.recurring_instance&&W!=null){if(d.has(W))continue;d.add(W)}f.push(m)}return f},et=s=>s.meta_data?.recurring_parent_id!=null?`recurring-${s.meta_data.recurring_parent_id}`:`id-${s.id}`,je=s=>{v($,s);const d=document.getElementById(L);d&&Y&&Y.getOrCreateInstance(d).show()},Pt=(s,d)=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),je(d))},_t=async()=>{v(Q,!0),await H(),v(Q,!1)};let k=p("pending");D(()=>N(),()=>{v(q,N())}),D(()=>(x(),Te),()=>{v(F,x()(Te.DeleteEvents))}),D(()=>(Z(),e(q)),()=>{v(G,Mt((Z()??[]).filter(s=>{const d=s.meta_data?.submitted_by_user_id;return d&&e(q)?.id&&d===e(q).id}).sort((s,d)=>Dt(s)-Dt(d))))}),D(()=>e(k),()=>{v(ee,`type-filter-select-submissions-${e(k)}`)}),D(()=>(e(G),Wt),()=>{v(w,B.reduce((s,d)=>(s[d.value]=e(G).filter(f=>Wt(f)===d.value),s),{}))}),D(()=>(e(se),e(w)),()=>{v(te,B.reduce((s,d)=>{const f=e(se)[d.value],m=(e(w)[d.value]??[]).filter(W=>Ge(W,f.typeFilter));return s[d.value]=m.filter(W=>Ze(W,f.search)),s},{}))}),D(()=>(e(te),e(k)),()=>{v(re,e(te)[e(k)]??[])}),D(()=>(e($),e(G)),()=>{e($)&&!e(G).some(s=>et(s)===et(e($)))&&v($,null)}),D(()=>e($),()=>{v(U,e($)?{...e($),id:e($).id??e($).meta_data?.recurring_parent_id,category:e($).meta_data?.category}:null)}),ua(),ut();var bt=ds(),Rt=be(bt);{var Ue=s=>{var d=Yr(),f=a(d);Ca(f,{}),t(d),l(s,d)},tt=s=>{var d=ls(),f=a(d),m=a(f),W=a(m),Ae=i(a(W),2),ve=a(Ae);{var M=I=>{var r=lt("Refreshing…");l(I,r)},me=I=>{var r=lt("Refresh");l(I,r)};b(ve,I=>{e(Q)?I(M):I(me,!1)})}t(Ae),t(W);var Me=i(W,2);We(Me,5,()=>B,va,(I,r)=>{var u=Vr(),n=a(u);t(u),C(()=>{Ye(u,1,(e(k),e(r),o(()=>`nav-link ${e(k)===e(r).value?"active":""}`)),"svelte-9fakr"),dt(u,"aria-selected",(e(k),e(r),o(()=>e(k)===e(r).value))),P(n,`${e(r),o(()=>e(r).label)??""} (${e(w),e(r),o(()=>(e(w)[e(r).value]??[]).length)??""})`)}),j("click",u,()=>v(k,e(r).value)),l(I,u)}),t(Me),t(m);var Ie=i(m,2),Le=a(Ie),mt=a(Le),at=a(mt);Pa(at),t(mt);var yt=i(mt,2),we=a(yt);We(we,5,()=>de,va,(I,r)=>{var u=Xr(),n=a(u,!0);t(u);var R={};C(()=>{P(n,(e(r),o(()=>e(r).label))),R!==(R=(e(r),o(()=>e(r).value)))&&(u.value=(u.__value=(e(r),o(()=>e(r).value)))??"")}),l(I,u)}),t(we);var Tt;tr(we),t(yt),t(Le);var It=i(Le,2);{var zt=I=>{var r=Jr(),u=a(r);{var n=E=>{var S=lt("You haven't submitted any events or announcements yet.");l(E,S)},R=E=>{var S=lt();C(ne=>P(S,`No ${ne??""} submissions match your current filters.`),[()=>(e(k),o(()=>xe[e(k)].toLowerCase()))]),l(E,S)};b(u,E=>{e(G),o(()=>e(G).length===0)?E(n):E(R,!1)})}t(r),l(I,r)},Kt=I=>{var r=os();We(r,5,()=>e(re),u=>et(u),(u,n)=>{const R=Ee(()=>(z(Wt),e(n),o(()=>Wt(e(n))))),E=Ee(()=>(z(e(R)),o(()=>Se[e(R)]))),S=Ee(()=>(e(n),z(da),o(()=>e(n).meta_data?.category?da(e(n).meta_data.category):null))),ne=Ee(()=>(e(n),o(()=>pt(e(n)))));var V=ns(),ke=a(V),Pe=a(ke),Be=a(Pe,!0);t(Pe);var $e=i(Pe,2),Oe=a($e),Ot=a(Oe,!0);t(Oe);var gt=i(Oe,2);t($e),t(ke);var ht=i(ke,2);{var Qt=_=>{var y=Zr(),ue=a(y,!0);t(y),C(()=>P(ue,e(ne))),l(_,y)};b(ht,_=>{e(ne)&&_(Qt)})}var xt=i(ht,2),Ft=a(xt);{var Yt=_=>{var y=Gr(),ue=a(y,!0);t(y),C(()=>{Ye(y,1,`badge rounded-pill bg-color-${z(e(S)),o(()=>e(S).color_number)??""}`,"svelte-9fakr"),P(ue,(z(e(S)),o(()=>e(S).label)))}),l(_,y)},Vt=_=>{var y=es();l(_,y)};b(Ft,_=>{e(S)?_(Yt):_(Vt,!1)})}var pe=i(Ft,2);{var ye=_=>{var y=ts(),ue=i(a(y));t(y),C(()=>P(ue,` ${e(n),o(()=>e(n).location)??""}`)),l(_,y)};b(pe,_=>{e(n),o(()=>e(n).location)&&_(ye)})}var qe=i(pe,2);{var wt=_=>{var y=as(),ue=i(a(y));t(y),C(Qe=>P(ue,` ${Qe??""}`),[()=>(e(n),o(()=>ft(e(n).recurrence_rule)))]),l(_,y)};b(qe,_=>{e(n),o(()=>e(n).recurrence_rule)&&_(wt)})}t(xt);var He=i(xt,2),X=a(He),fe=i(a(X));t(X);var ze=i(X,2);{var Ne=_=>{var y=rs(),ue=i(a(y));t(y),C(Qe=>P(ue,` Event ${Qe??""}`),[()=>(e(n),o(()=>At(e(n))))]),l(_,y)};b(ze,_=>{e(n),o(()=>e(n).event_type==="calendar_event")&&_(Ne)})}t(He);var Ke=i(He,2),Re=a(Ke),rt=a(Re),Ce=i(rt,1,!0);t(Re);var ge=i(Re,2);{var J=_=>{var y=ss(),ue=a(y);t(y),C(Qe=>P(ue,`Approvals: ${Qe??""} of 3`),[()=>(z(jt),e(n),o(()=>jt(e(n))))]),l(_,y)};b(ge,_=>{z(jt),e(n),o(()=>jt(e(n))>0)&&_(J)})}t(Ke),t(V),C(_=>{sr(V,`border-left: 4px solid ${z(e(R)),o(()=>ie[e(R)])??""}`),P(Be,(e(n),o(()=>e(n).title))),P(Ot,(e(n),o(()=>e(n).event_type==="calendar_event"?"Event":"Announcement"))),dt(gt,"aria-label",(e(n),o(()=>`Edit ${e(n).title}`))),P(fe,` Submitted ${_??""}`),Ye(Re,1,(z(e(E)),o(()=>`badge ${e(E).class}`)),"svelte-9fakr"),Ye(rt,1,(z(e(E)),o(()=>`bi ${e(E).icon} me-1`)),"svelte-9fakr"),P(Ce,(z(e(E)),o(()=>e(E).text)))},[()=>(e(n),o(()=>Ve(e(n))))]),j("click",gt,_r(()=>je(e(n)))),j("click",V,()=>je(e(n))),j("keydown",V,_=>Pt(_,e(n))),l(u,V)}),t(r),l(I,r)};b(It,I=>{e(re),o(()=>e(re).length===0)?I(zt):I(Kt,!1)})}t(Ie),t(f),t(d),C(()=>{Ae.disabled=e(Q),ar(at,(e(se),e(k),o(()=>e(se)[e(k)].search))),dt(we,"id",e(ee)),Tt!==(Tt=(e(se),e(k),o(()=>e(se)[e(k)].typeFilter)))&&(we.value=(we.__value=(e(se),e(k),o(()=>e(se)[e(k)].typeFilter)))??"",rr(we,(e(se),e(k),o(()=>e(se)[e(k)].typeFilter))))}),j("click",Ae,_t),j("input",at,I=>Fe(e(k),{search:I.currentTarget.value})),j("change",we,I=>Fe(e(k),{typeFilter:I.currentTarget.value})),l(s,d)};b(Rt,s=>{O()?s(tt,!1):s(Ue)})}var Ct=i(Rt,2);{let s=Ee(()=>(e($),o(()=>e($)?`Edit: ${e($).title}`:"Submission Details")));Ia(Ct,{get id(){return L},get title(){return e(s)},children:(d,f)=>{var m=ot(),W=be(m);{var Ae=M=>{Ra(M,{get eventItem(){return e(U)},get drawerId(){return L},name:"my-submission-form",get canDelete(){return e(F)},canCreate:!1})},ve=M=>{var me=is();l(M,me)};b(W,M=>{e(U)?M(Ae):M(ve,!1)})}l(d,m)},$$slots:{default:!0}})}l(le,bt),ct(),K()}var cs=c('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),us=c('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),ps=c('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),fs=c('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),_s=c('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1);function Ns(le,T){vt(T,!1);const N=p(),{stores:{currentUserHasPermission:x,authenticated:Z}}=_a();let O=p(!1),g=p(!1);ca(()=>{const K=x.subscribe(F=>{const ee=F(Te.ManageWardBusiness);v(O,ee)}),q=Z.subscribe(F=>{v(g,F)});return()=>{K(),q()}}),D(()=>(e(O),e(g)),()=>{v(N,e(O)||e(g))}),ua(),ut(),Ga(le,{pageTitle:"Calendar",children:(K,q)=>{var F=ot(),ee=be(F);{var w=U=>{var ce=_s(),A=be(ce),H=a(A),h=i(a(H),2);{var ae=B=>{var de=cs();l(B,de)};b(h,B=>{e(O)&&B(ae)})}var Q=i(h,2);{var G=B=>{var de=us();l(B,de)};b(Q,B=>{e(g)&&B(G)})}t(H),t(A);var re=i(A,2),$=a(re),L=a($);Aa(L),t($);var Y=i($,2);{var ie=B=>{var de=ps(),De=a(de);pr(De,{}),t(de),l(B,de)};b(Y,B=>{e(O)&&B(ie)})}var Se=i(Y,2);{var xe=B=>{var de=fs(),De=a(de);vs(De,{}),t(de),l(B,de)};b(Se,B=>{e(g)&&B(xe)})}t(re),l(U,ce)},te=U=>{Aa(U)};b(ee,U=>{e(N)?U(w):U(te,!1)})}l(K,F)},$$slots:{default:!0}}),ct()}export{Ns as component,Bs as universal};
