import{s as q,d as f,i as b,x as j,k as D,r as O,n as I,b as y,p,c as h,e as V,w as E,g as k,h as v,j as C,a as R,f as A,t as G}from"../chunks/pH736Kvp.js";import{S as M,i as H,t as N,a as P,e as Y,d as z,m as B,c as F,b as J,g as K}from"../chunks/THtqwFCh.js";import{p as U}from"../chunks/D3f-aiRy.js";import{g as Q}from"../chunks/DuWQdI7-.js";import{s as W,a as X}from"../chunks/C6tFIY0A.js";import{L as Z}from"../chunks/QJNTbXsP.js";function $(m){let e,t,n='<img src="/assets/logo.png" alt="logo" class="logo svelte-aqjxex"/> <h1 class="mb-0 h4">Lehi Tolutaha</h1>',s;function o(r,a){if(r[1])return le;if(r[2])return te}let l=o(m),i=l&&l(m);return{c(){e=v("div"),t=v("a"),t.innerHTML=n,s=C(),i&&i.c(),this.h()},l(r){e=h(r,"DIV",{class:!0});var a=V(e);t=h(a,"A",{href:!0,class:!0,"data-svelte-h":!0}),E(t)!=="svelte-1inzn7"&&(t.innerHTML=n),s=k(a),i&&i.l(a),a.forEach(f),this.h()},h(){p(t,"href","/home"),p(t,"class","header-content d-flex align-items-center gap-2 text-decoration-none"),p(e,"class","container d-flex flex-column gap-3 mt-5 mb-5 svelte-aqjxex")},m(r,a){b(r,e,a),y(e,t),y(e,s),i&&i.m(e,null)},p(r,a){l===(l=o(r))&&i?i.p(r,a):(i&&i.d(1),i=l&&l(r),i&&(i.c(),i.m(e,null)))},i:I,o:I,d(r){r&&f(e),i&&i.d()}}}function ee(m){let e,t;return e=new Z({props:{message:"Verifying your email..."}}),{c(){J(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,s){B(e,n,s),t=!0},p:I,i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){N(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function te(m){let e,t,n,s,o,l="Verification Failed",i,r,a,_,c,u,w="Back to Login",x=m[4]&&L();return{c(){e=v("div"),t=v("i"),n=C(),s=v("div"),o=v("strong"),o.textContent=l,i=C(),r=v("p"),a=G(m[2]),_=C(),x&&x.c(),c=C(),u=v("a"),u.textContent=w,this.h()},l(d){e=h(d,"DIV",{class:!0,role:!0});var g=V(e);t=h(g,"I",{class:!0}),V(t).forEach(f),n=k(g),s=h(g,"DIV",{});var T=V(s);o=h(T,"STRONG",{"data-svelte-h":!0}),E(o)!=="svelte-uh34xm"&&(o.textContent=l),i=k(T),r=h(T,"P",{class:!0});var S=V(r);a=A(S,m[2]),S.forEach(f),T.forEach(f),g.forEach(f),_=k(d),x&&x.l(d),c=k(d),u=h(d,"A",{href:!0,class:!0,"data-svelte-h":!0}),E(u)!=="svelte-r5u2t8"&&(u.textContent=w),this.h()},h(){p(t,"class","bi bi-exclamation-triangle-fill"),p(r,"class","mb-0"),p(e,"class","alert alert-danger d-flex align-items-center gap-2"),p(e,"role","alert"),p(u,"href","/auth/login"),p(u,"class","btn btn-link")},m(d,g){b(d,e,g),y(e,t),y(e,n),y(e,s),y(s,o),y(s,i),y(s,r),y(r,a),b(d,_,g),x&&x.m(d,g),b(d,c,g),b(d,u,g)},p(d,g){g&4&&R(a,d[2]),d[4]?x||(x=L(),x.c(),x.m(c.parentNode,c)):x&&(x.d(1),x=null)},d(d){d&&(f(e),f(_),f(c),f(u)),x&&x.d(d)}}}function le(m){let e,t,n,s,o,l,i="Redirecting to login...";function r(c,u){return c[3]?ne:se}let a=r(m),_=a(m);return{c(){e=v("div"),t=v("i"),n=C(),s=v("div"),_.c(),o=C(),l=v("p"),l.textContent=i,this.h()},l(c){e=h(c,"DIV",{class:!0,role:!0});var u=V(e);t=h(u,"I",{class:!0}),V(t).forEach(f),n=k(u),s=h(u,"DIV",{});var w=V(s);_.l(w),w.forEach(f),u.forEach(f),o=k(c),l=h(c,"P",{class:!0,"data-svelte-h":!0}),E(l)!=="svelte-1icd19m"&&(l.textContent=i),this.h()},h(){p(t,"class","bi bi-check-circle-fill"),p(e,"class","alert alert-success d-flex align-items-center gap-2"),p(e,"role","alert"),p(l,"class","text-muted")},m(c,u){b(c,e,u),y(e,t),y(e,n),y(e,s),_.m(s,null),b(c,o,u),b(c,l,u)},p(c,u){a!==(a=r(c))&&(_.d(1),_=a(c),_&&(_.c(),_.m(s,null)))},d(c){c&&(f(e),f(o),f(l)),_.d()}}}function L(m){let e,t="Request New Verification Email";return{c(){e=v("a"),e.textContent=t,this.h()},l(n){e=h(n,"A",{href:!0,class:!0,"data-svelte-h":!0}),E(e)!=="svelte-e8ivio"&&(e.textContent=t),this.h()},h(){p(e,"href","/auth/resend-verification"),p(e,"class","btn btn-primary")},m(n,s){b(n,e,s)},d(n){n&&f(e)}}}function se(m){let e,t="Email verified successfully!",n,s,o="You can now log in to your account.";return{c(){e=v("strong"),e.textContent=t,n=C(),s=v("p"),s.textContent=o,this.h()},l(l){e=h(l,"STRONG",{"data-svelte-h":!0}),E(e)!=="svelte-8w6q7c"&&(e.textContent=t),n=k(l),s=h(l,"P",{class:!0,"data-svelte-h":!0}),E(s)!=="svelte-1tp2y14"&&(s.textContent=o),this.h()},h(){p(s,"class","mb-0")},m(l,i){b(l,e,i),b(l,n,i),b(l,s,i)},d(l){l&&(f(e),f(n),f(s))}}}function ne(m){let e,t="Email already verified!",n,s,o="You can log in now.";return{c(){e=v("strong"),e.textContent=t,n=C(),s=v("p"),s.textContent=o,this.h()},l(l){e=h(l,"STRONG",{"data-svelte-h":!0}),E(e)!=="svelte-om5mfj"&&(e.textContent=t),n=k(l),s=h(l,"P",{class:!0,"data-svelte-h":!0}),E(s)!=="svelte-mr2mgn"&&(s.textContent=o),this.h()},h(){p(s,"class","mb-0")},m(l,i){b(l,e,i),b(l,n,i),b(l,s,i)},d(l){l&&(f(e),f(n),f(s))}}}function re(m){let e,t,n,s;const o=[ee,$],l=[];function i(r,a){return r[0]?0:1}return e=i(m),t=l[e]=o[e](m),{c(){t.c(),n=j()},l(r){t.l(r),n=j()},m(r,a){l[e].m(r,a),b(r,n,a),s=!0},p(r,[a]){let _=e;e=i(r),e===_?l[e].p(r,a):(K(),N(l[_],1,1,()=>{l[_]=null}),Y(),t=l[e],t?t.p(r,a):(t=l[e]=o[e](r),t.c()),P(t,1),t.m(n.parentNode,n))},i(r){s||(P(t),s=!0)},o(r){N(t),s=!1},d(r){r&&f(n),l[e].d(r)}}}function ie(m,e,t){let n;D(m,U,a=>t(5,n=a));let s=!0,o=!1,l="",i=!1,r=!1;return O(async()=>{const a=n.url.searchParams.get("token");if(!a){t(2,l="Invalid verification link"),t(0,s=!1);return}try{const c=await(await fetch(`${W}/functions/v1/auth-verify-email`,{method:"POST",headers:{"Content-Type":"application/json",apikey:X},body:JSON.stringify({token:a})})).json();c.success?(t(1,o=!0),t(3,i=c.alreadyVerified||!1),setTimeout(()=>{Q("/auth/login")},3e3)):(t(2,l=c.error||"Verification failed"),t(4,r=c.expired||!1))}catch{t(2,l="Network error. Please try again.")}finally{t(0,s=!1)}}),[s,o,l,i,r]}class _e extends M{constructor(e){super(),H(this,e,ie,re,q,{})}}export{_e as component};
