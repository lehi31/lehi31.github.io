const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BOsxNJ5s.js","../chunks/BWCcv1pC.js","../chunks/DIeogL5L.js","../chunks/DqgkBxsg.js","../chunks/CmsKOCeN.js","../chunks/NZTpNUN0.js","../chunks/69_IOA4Y.js","../chunks/CuVcyAaV.js","../chunks/KiCntiD6.js","../chunks/CvOYN50o.js","../chunks/CDrl09S1.js","../chunks/DnVuGurV.js","../chunks/BJhH47Ua.js","../chunks/BUApaBEI.js","../chunks/BeNQ5BU7.js","../chunks/TQLXPvU9.js","../assets/Spinner.DTjfhZ6-.css","../chunks/pEAXO0Hl.js","../chunks/C7eOEiMq.js","../chunks/CzDGc265.js","../chunks/Drf-2KpF.js","../chunks/DwL8UaIJ.js","../chunks/DcWZ5Z_E.js","../chunks/Z1YyCaGw.js","../chunks/D9dADsae.js","../chunks/ByjMlHuk.js","../assets/BishopricApprovalSection.DRGo_BHg.css","../chunks/DO0djbQe.js","../chunks/Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import"../chunks/NZTpNUN0.js";import"../chunks/69_IOA4Y.js";import{d as tr,o as xa,g as ar}from"../chunks/CuVcyAaV.js";import{p as lt,ai as D,D as c,E as _,aj as Bt,c as a,s as i,r as t,u as s,m as e,a as it,B as M,C as rr,f as we,F as Fa,R as Ae,aq as sr,n as O,ar as nr}from"../chunks/BWCcv1pC.js";import{f as u,a as l,c as mt,t as Dt}from"../chunks/DqgkBxsg.js";import{b as G,i as g,k as Ut,a as Wt,e as ee,s as T,p as At}from"../chunks/KiCntiD6.js";import{i as ct}from"../chunks/BeNQ5BU7.js";import{P as or}from"../chunks/CgZT8wvO.js";import{e as Ze,i as ya}from"../chunks/CvOYN50o.js";import{r as La,b as lr,s as et,i as ir,c as cr,d as dr,e as vr}from"../chunks/CDrl09S1.js";import{b as ur}from"../chunks/CzDGc265.js";import{j as _r,g as Nt,d as pr,h as Ca,c as Vt,b as Lt,a as Yt,k as Xt}from"../chunks/BOsxNJ5s.js";import{s as Ta,C as fr,A as br,E as mr}from"../chunks/CC_59okt.js";import{z as ha,v as Pa,B as gr,e as aa,p as ne,i as he,O as Gt,P as xe,f as Ge}from"../chunks/DnVuGurV.js";import{C as $a,E as yr,c as Ba}from"../chunks/Cl2REAJA.js";import{S as Wa}from"../chunks/TQLXPvU9.js";import{v as ea,D as ta}from"../chunks/pEAXO0Hl.js";import{s as Jt}from"../chunks/ByjMlHuk.js";import{e as Zt}from"../chunks/Z1YyCaGw.js";import{_ as wa}from"../chunks/CmsKOCeN.js";import{s as Na}from"../chunks/CdEA5IGF.js";import{B as hr}from"../chunks/D_34wcCb.js";import{R as Ft}from"../chunks/DcWZ5Z_E.js";function Ra(ie,X,N){const $=ha(ie,N),j=ha(X,N),Q=+$-Pa($),h=+j-Pa(j);return Math.round((Q-h)/gr)}function wr(ie,X){return _r(ie,-X)}const xr=!0,nn=Object.freeze(Object.defineProperty({__proto__:null,prerender:xr},Symbol.toStringTag,{value:"Module"}));var $r=u('<button type="button" class="btn-clear-search svelte-14zxluq" aria-label="Clear search" title="Clear search"><i class="bi bi-x-lg"></i></button>'),kr=u("<option> </option>"),Er=u('<div class="col-12 col-md-auto"><select class="form-select form-select" aria-label="Filter by category"><option>All Categories</option><!></select></div>'),Dr=u('<div class="col-12 col-md-auto"><button type="button" class="btn btn-outline-secondary w-100" aria-label="Clear all filters"><i class="bi bi-x-circle me-1"></i> Clear All</button></div>'),Ar=u('<div class="search-filter sticky-top svelte-14zxluq"><div class="row g-2"><div class="col-12 col-md"><div class="search-input-wrapper svelte-14zxluq"><input type="text" class="form-control form-control" placeholder="Search..."/> <!></div></div> <!> <!></div></div>');function Ir(ie,X){lt(X,!1);const N=()=>G(q,"$searchQuery",Q),$=()=>G(z,"$categoryFilter",Q),j=()=>G(A,"$currentCategories",Q),[Q,h]=Wt(),J=_(),{stores:{currentCategories:A,categoryFilter:z,searchQuery:q}}=Nt(),x=()=>{Ut(q,""),Ut(z,"")};D(()=>(N(),$()),()=>{c(J,!!(N()||$()))}),Bt(),ct();var te=Ar(),I=a(te),re=a(I),P=a(re),ce=a(P);La(ce);var F=i(ce,2);{var $e=S=>{var R=$r();ee("click",R,()=>Ut(q,"")),l(S,R)};g(F,S=>{N()&&S($e)})}t(P),t(re);var de=i(re,2);{var ve=S=>{var R=Er(),se=a(R);M(()=>{$(),rr(()=>{j()})});var fe=a(se);fe.value=fe.__value="";var Ee=i(fe);Ze(Ee,1,j,ya,(U,Z)=>{var oe=kr(),V=a(oe,!0);t(oe);var qe={};M(()=>{T(V,(e(Z),s(()=>e(Z).label))),qe!==(qe=(e(Z),s(()=>e(Z).key)))&&(oe.value=(oe.__value=(e(Z),s(()=>e(Z).key)))??"")}),l(U,oe)}),t(se),t(R),lr(se,$,U=>Ut(z,U)),l(S,R)};g(de,S=>{j(),s(()=>j().length)&&S(ve)})}var ke=i(de,2);{var L=S=>{var R=Dr(),se=a(R);t(R),ee("click",se,x),l(S,R)};g(ke,S=>{e(J)&&S(L)})}t(I),t(te),ur(ce,N,S=>Ut(q,S)),l(ie,te),it(),h()}var Sr=u('<p class="mb-0">No past events to delete.</p>'),Or=u('<p class="mb-2"><strong> </strong></p>'),Mr=u(`<div class="alert alert-warning mb-0" role="alert"><p class="mb-2"><strong> </strong></p> <p class="mb-0 small">These recurring events have active future instances and cannot be deleted until all
								future occurrences have passed.</p></div>`),Cr=u("<!> <!>",1),Tr=u('<div class="modal svelte-1u875uh" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-primary text-white"><h5 class="modal-title">Delete Past Events - Results</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><!></div> <div class="modal-footer"><button type="button" class="btn btn-primary">OK</button></div></div></div></div>');function Pr(ie,X){lt(X,!1);let N=At(X,"deleted",8),$=At(X,"skipped",8),j=At(X,"callback",8);function Q(){j()()}ct();var h=Tr(),J=a(h),A=a(J),z=a(A),q=i(a(z),2);t(z);var x=i(z,2),te=a(x);{var I=F=>{var $e=Sr();l(F,$e)},re=F=>{var $e=Cr(),de=we($e);{var ve=S=>{var R=Or(),se=a(R),fe=a(se);t(se),t(R),M(()=>T(fe,`✓ Deleted ${N()??""} past event${N()===1?"":"s"}.`)),l(S,R)};g(de,S=>{N()>0&&S(ve)})}var ke=i(de,2);{var L=S=>{var R=Mr(),se=a(R),fe=a(se),Ee=a(fe);t(fe),t(se),Fa(2),t(R),M(()=>T(Ee,`⚠ Skipped ${$()??""} recurring event${$()===1?"":"s"}`)),l(S,R)};g(ke,S=>{$()>0&&S(L)})}l(F,$e)};g(te,F=>{N()===0&&$()===0?F(I):F(re,!1)})}t(x);var P=i(x,2),ce=a(P);t(P),t(A),t(J),t(h),ee("click",q,Q),ee("click",ce,Q),l(ie,h),it()}var Rr=u(`<div class="modal svelte-dmsnaa" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-danger text-white"><h5 class="modal-title">Delete Past Events</h5> <button type="button" class="btn-close btn-close-white" aria-label="Close"></button></div> <div class="modal-body"><p class="mb-3"><strong> </strong></p> <p class="mb-0 text-muted small">This action cannot be undone. Recurring events with future instances will be skipped
					automatically.</p></div> <div class="modal-footer"><button type="button" class="btn btn-secondary">Cancel</button> <button type="button" class="btn btn-danger">Delete</button></div></div></div></div>`);function Ur(ie,X){lt(X,!1);let N=At(X,"cutoffDate",8),$=At(X,"callback",8);function j(){$()(!0)}function Q(){$()(!1)}ct();var h=Rr(),J=a(h),A=a(J),z=a(A),q=i(a(z),2);t(z);var x=i(z,2),te=a(x),I=a(te),re=a(I);t(I),t(te),Fa(2),t(x);var P=i(x,2),ce=a(P),F=i(ce,2);t(P),t(A),t(J),t(h),M(()=>T(re,`Are you sure you want to delete all events that occurred before ${N()??""}?`)),ee("click",q,Q),ee("click",ce,Q),ee("click",F,j),l(ie,h),it()}var Fr=u('<button class="btn btn-sm btn-outline-secondary w-100"><i class="bi bi-clock-history me-1"></i> </button>'),Lr=u('<button class="btn btn-sm btn-outline-danger" type="button"><!></button>'),Br=u('<div class="d-flex align-items-center justify-content-end ms-auto"><button class="btn btn-sm btn-primary" type="button" data-bs-toggle="offcanvas" aria-label="Edit past event"><i class="bi bi-pencil-square"></i></button></div>'),Wr=u('<div class="d-flex flex-row align-items-start gap-3 w-100"><div class="flex-grow-1"><!></div> <!></div>'),Nr=u('<li class="list-group-item py-3"><div class="d-flex flex-column flex-md-row gap-3"><div class="event-date-column d-flex flex-column align-items-start text-nowrap svelte-1ichfmm"><strong> </strong> <small class="text-muted"> </small></div> <div class="d-flex flex-column gap-3 flex-grow-1"></div></div></li>'),jr=u('<li class="list-group-item py-3 text-muted">No events scheduled this week.</li>'),zr=u('<li class="list-group-item list-group-item-light text-uppercase small fw-lighter p-0"><button><span class="d-flex align-items-center gap-2"><i></i> <span class="text-muted"> </span></span> <span> </span></button></li> <!>',1),qr=u('<li class="list-group-item bg-secondary text-white fw-semibold"> </li> <!>',1),Hr=u('<button class="btn btn-outline-secondary btn-sm">Reset</button>'),Qr=u('<div class="d-flex gap-2"><button class="btn btn-primary btn-sm">More</button> <button class="btn btn-outline-primary btn-sm">All</button></div>'),Kr=u('<div class="card-footer d-flex align-items-center justify-content-between"><small> </small> <!></div>'),Vr=u('<ul class="list-group list-group-flush border-top-0"></ul> <!>',1),Yr=u('<div class="card-body text-muted small">No past events available.</div>'),Xr=u('<div class="card"><div class="card-header"><div class="d-flex justify-content-between align-items-center gap-3 flex-wrap fw-lighter"><span>Past Events</span> <div class="d-flex gap-2"><!> <button class="btn btn-sm btn-outline-secondary">Hide</button></div></div></div> <!></div>'),Jr=u('<div class="d-flex flex-column gap-4"><!></div>'),Zr=u("<!> <!> <!> <!>",1);function Gr(ie,X){lt(X,!1);const N=()=>G(Z,"$weeksExpanded",x),$=()=>G(ae,"$allPastEvents",x),j=()=>G(S,"$currentUser",x),Q=()=>G(fe,"$userOrganizations",x),h=()=>G(L,"$currentUserHasPermission",x),J=()=>G(se,"$currentUserIsRoot",x),A=()=>G(R,"$currentUserIsAdmin",x),z=()=>G(Ee,"$ready",x),q=()=>G(oe,"$searchQuery",x),[x,te]=Wt(),I=_(),re=_(),P=_(),ce=_(),F=_(),$e=_(),de=_(),ve=_(),ke=_(),{stores:{currentUserHasPermission:L,currentUser:S,currentUserIsAdmin:R,currentUserIsRoot:se,userOrganizations:fe}}=aa(),{stores:{ready:Ee,dbData:U,weeksExpanded:Z,searchQuery:oe},actions:{reload:V}}=Nt(),qe={title:"Event",description:"",location:"",event_type:"calendar_event",is_public:!0};let Ke=At(X,"formId",24,ea),gt=_(!1),Ve=_(!1),tt=_(),dt=_(!1),vt=_(!1),Ye=_(!1),Xe=_(new Set),We=_(!1),yt=_(""),at=_({...qe}),Je=_(!1),d=_(""),y=_(!1),p=_({deleted:0,skipped:0});const K=4,be=4;let ue=_(K),Me=_(!1);const B=Jt();let o=_({});function v(n){return e(I).includes(n)}function b(n){const f=e(o)[n]??v(n);c(o,{...e(o),[n]:!f})}const k=n=>{c(yt,"Event Item"),c(at,{...n,category:n?.meta_data?.category})},ae=tr(U,n=>{const f=Jt();return(n??[]).filter(r=>!(r.event_type!=="calendar_event"||!r.start_time||ne(r.start_time)>=f||r.recurrence_rule&&(!r.recurrence_end_date||r.recurrence_end_date&&ne(r.recurrence_end_date)>=f)))}),De=n=>Ba(n,{currentUserId:e(tt),isPrivileged:e(Ve),canEditOwnOrgEvents:e(Ye),userOrganizations:e(Xe)});let _e=_(!1);function W(){c(ue,e(ue)+be)}function Ie(){c(ue,520),c(Me,!0)}function Ce(){c(ue,K),c(Me,!1)}const Ne=()=>{if(!e(gt)||e(We)||!ar(se)||!e(ve))return;const n=Jt();c(d,he(n,"MMM d, yyyy")),c(Je,!0)};async function je(n){if(c(Je,!1),!n)return;const f=Jt();c(We,!0);try{const r=await pr(f);await V(),c(p,r),c(y,!0)}catch(r){console.error("Failed to delete past events",r),alert("Failed to delete past events. Please try again.")}finally{c(We,!1)}}function rt(){c(y,!1)}xa(async()=>{await V()}),D(()=>($(),e(ue)),()=>{c(P,($()??[]).filter(n=>{if(!n.start_time)return!1;const f=ne(n.start_time),r=wr(B,e(ue));return f>=r&&f<B}))}),D(()=>(e(P),he),()=>{c(F,(()=>{const n=new Map;for(const f of e(P)){if(!f.start_time)continue;const r=ne(f.start_time),m=ha(r,{weekStartsOn:1}),w=Zt(r,{weekStartsOn:1}),H=he(m,"yyyy-MM-dd"),me=`${he(m,"MMM d")} – ${he(w,"MMM d")}`;let le=n.get(H);le||(le={key:H,label:me,days:new Map},n.set(H,le));const Pe=he(r,"yyyy-MM-dd");let pe=le.days.get(Pe);pe||(pe={key:Pe,displayDay:he(r,"EEE"),displayDate:he(r,"MMM d"),events:[]},le.days.set(Pe,pe)),pe.events.push(f)}return Array.from(n.values()).sort((f,r)=>f.key<r.key?1:-1).map(f=>({key:f.key,label:f.label,days:Array.from(f.days.values()).sort((r,m)=>r.key<m.key?1:-1).map(r=>({...r,events:r.events.slice().sort((m,w)=>{const H=m.is_all_day?0:1,me=w.is_all_day?0:1;if(H!==me)return H-me;const le=m.start_time?ne(m.start_time).getTime():Number.MAX_SAFE_INTEGER,Pe=w.start_time?ne(w.start_time).getTime():Number.MAX_SAFE_INTEGER;return le-Pe})}))}))})())}),D(()=>e(F),()=>{c(I,(()=>{if(e(F).length===0)return[];const n=[];return e(F)[0]&&n.push(e(F)[0].key),e(F)[1]&&n.push(e(F)[1].key),n})())}),D(()=>(N(),e(o)),()=>{c(re,n=>N()?!0:e(o)[n]!==void 0?e(o)[n]:v(n))}),D(()=>e(P),()=>{c(ce,e(P).length)}),D(()=>(e(F),he),()=>{c($e,e(F).reduce((n,f)=>{const r=ne(f.key),m=Zt(r,{weekStartsOn:1}),w=he(m,"yyyy-MM"),H=he(m,"MMMM yyyy");return n[w]||(n[w]={label:H,weeks:[]}),n[w].weeks.push(f),n},{}))}),D(()=>j(),()=>{c(tt,j()?.id)}),D(()=>Q(),()=>{c(Xe,Q())}),D(()=>e(tt),()=>{c(vt,!!e(tt))}),D(()=>(e(Xe),Gt),()=>{c(dt,e(Xe).has(Gt.Bishopric))}),D(()=>(h(),xe),()=>{c(Ye,h()(xe.EditOwnOrgEvents))}),D(()=>(J(),A(),e(dt),h(),xe),()=>{c(Ve,J()||A()||e(dt)||h()(xe.EditAllEvents))}),D(()=>(e(Ve),h(),e(Ye),e(vt)),()=>{c(gt,e(Ve)||h()(xe.CreateEvents)||e(Ye)||e(vt))}),D(()=>(h(),xe),()=>{c(de,h()(xe.DeleteEvents))}),D(()=>e(P),()=>{c(ve,e(P).length>0)}),D(()=>($(),e(P)),()=>{c(ke,$().length>e(P).length)}),Bt(),ct();var st=Zr(),nt=we(st);ta(nt,{get title(){return e(yt)},get id(){return Ke()},children:(n,f)=>{$a(n,{get eventItem(){return e(at)},get drawerId(){return Ke()},name:"past-event-item-form",get canDelete(){return e(de)}})},$$slots:{default:!0}});var Te=i(nt,2);{var ht=n=>{var f=mt(),r=we(f);{var m=H=>{var me=mt(),le=we(me);{var Pe=Se=>{var Re=Fr(),ze=i(a(Re));t(Re),M(()=>T(ze,` Show Past Events (${$(),s(()=>$().length)??""})`)),ee("click",Re,()=>c(_e,!0)),l(Se,Re)},pe=Se=>{var Re=Xr(),ze=a(Re),jt=a(ze),St=i(a(jt),2),Ot=a(St);{var ra=Ue=>{var Le=Lr(),ut=a(Le);{var Ct=ge=>{var Fe=Dt("Deleting…");l(ge,Fe)},_t=ge=>{var Fe=Dt();M(()=>T(Fe,`Delete All (${e(ce)??""})`)),l(ge,Fe)};g(ut,ge=>{e(We)?ge(Ct):ge(_t,!1)})}t(Le),M(()=>Le.disabled=e(We)),ee("click",Le,Ne),l(Ue,Le)};g(Ot,Ue=>{J()&&e(ve)&&Ue(ra)})}var Mt=i(Ot,2);t(St),t(jt),t(ze);var zt=i(ze,2);{var sa=Ue=>{var Le=Vr(),ut=we(Le);Ze(ut,5,()=>(e($e),s(()=>Object.entries(e($e)))),([ge,Fe])=>ge,(ge,Fe)=>{var pt=sr(()=>nr(e(Fe),2));let ot=()=>e(pt)[1];var ft=qr(),He=we(ft),$t=a(He,!0);t(He);var Qe=i(He,2);Ze(Qe,1,()=>(ot(),s(()=>ot().weeks)),Be=>Be.key,(Be,ye)=>{const E=Ae(()=>(O(ne),e(ye),s(()=>ne(e(ye).key)))),C=Ae(()=>(O(Zt),O(e(E)),s(()=>Zt(e(E),{weekStartsOn:1})))),Oe=Ae(()=>(O(Ta),O(e(C)),s(()=>Ta(e(C))))),bt=Ae(()=>(O(Ra),O(e(C)),O(e(Oe)),s(()=>Ra(e(C),e(Oe),{weekStartsOn:1})+1))),oa=Ae(()=>(e(re),e(ye),s(()=>e(re)(e(ye).key)))),qt=Ae(()=>(e(ye),s(()=>e(ye).days.reduce((Pt,Ht)=>Pt+Ht.events.length,0))));var ka=zr(),la=we(ka),Tt=a(la);let Ea;var ia=a(Tt),Da=a(ia),Aa=i(Da,2),ja=a(Aa);t(Aa),t(ia);var ca=i(ia,2);let Ia;var za=a(ca,!0);t(ca),t(Tt),t(la);var qa=i(la,2);{var Ha=Pt=>{var Ht=mt(),Qa=we(Ht);{var Ka=kt=>{var Qt=mt(),Ya=we(Qt);Ze(Ya,1,()=>(e(ye),s(()=>e(ye).days)),da=>da.key,(da,Et)=>{var va=Nr(),Sa=a(va),ua=a(Sa),_a=a(ua),Xa=a(_a,!0);t(_a);var Oa=i(_a,2),Ja=a(Oa,!0);t(Oa),t(ua);var Ma=i(ua,2);Ze(Ma,5,()=>(e(Et),s(()=>e(Et).events)),Rt=>Rt.id??`${Rt.start_time}-${Rt.meta_data?.recurring_instance_index??0}`,(Rt,Kt)=>{var pa=Wr(),fa=a(pa),Za=a(fa);yr(Za,{get item(){return e(Kt)},showDate:!1,get searchQuery(){return q()}}),t(fa);var Ga=i(fa,2);{var er=ba=>{var ma=Br(),ga=a(ma);t(ma),M(()=>{et(ga,"data-bs-target",`#${Ke()??""}`),et(ga,"aria-controls",Ke())}),ee("click",ga,()=>k(e(Kt))),l(ba,ma)};g(Ga,ba=>{e(Kt),s(()=>De(e(Kt)))&&ba(er)})}t(pa),l(Rt,pa)}),t(Ma),t(Sa),t(va),M(()=>{T(Xa,(e(Et),s(()=>e(Et).displayDay))),T(Ja,(e(Et),s(()=>e(Et).displayDate)))}),l(da,va)}),l(kt,Qt)},Va=kt=>{var Qt=jr();l(kt,Qt)};g(Qa,kt=>{e(ye),s(()=>e(ye).days.length)?kt(Ka):kt(Va,!1)})}l(Pt,Ht)};g(qa,Pt=>{e(oa)&&Pt(Ha)})}M(()=>{Ea=Ge(Tt,1,"week-header w-100 d-flex justify-content-between align-items-center border-0 bg-transparent p-2 text-start svelte-1ichfmm",null,Ea,{"text-muted":e(qt)===0}),et(Tt,"title",e(oa)?"Click to collapse week":"Click to expand week"),Ge(Da,1,`bi ${e(oa)?"bi-chevron-up":"bi-chevron-down"}`),T(ja,`Week ${e(bt)??""} [${e(qt)??""} Event${e(qt)===1?"":"s"}]`),Ia=Ge(ca,1,"",null,Ia,{"opacity-50":e(qt)===0}),T(za,(e(ye),s(()=>e(ye).label)))}),ee("click",Tt,()=>b(e(ye).key)),l(Be,ka)}),M(()=>T($t,(ot(),s(()=>ot().label)))),l(ge,ft)}),t(ut);var Ct=i(ut,2);{var _t=ge=>{var Fe=Kr(),pt=a(Fe),ot=a(pt);t(pt);var ft=i(pt,2);{var He=Qe=>{var Be=Hr();ee("click",Be,Ce),l(Qe,Be)},$t=Qe=>{var Be=Qr(),ye=a(Be),E=i(ye,2);t(Be),ee("click",ye,W),ee("click",E,Ie),l(Qe,Be)};g(ft,Qe=>{e(Me)?Qe(He):Qe($t,!1)})}t(Fe),M(()=>T(ot,`Showing ${e(P),s(()=>e(P)?.length??0)??""} of ${$(),s(()=>$()?.length??0)??""}`)),l(ge,Fe)};g(Ct,ge=>{(e(ke)||e(Me))&&ge(_t)})}l(Ue,Le)},na=Ue=>{var Le=Yr();l(Ue,Le)};g(zt,Ue=>{e(F),s(()=>e(F).length)?Ue(sa):Ue(na,!1)})}t(Re),ee("click",Mt,()=>c(_e,!1)),l(Se,Re)};g(le,Se=>{e(_e)?Se(pe,!1):Se(Pe)})}l(H,me)},w=H=>{var me=Jr(),le=a(me);Wa(le,{}),t(me),l(H,me)};g(r,H=>{z()?H(m):H(w,!1)})}l(n,f)};g(Te,n=>{J()&&n(ht)})}var wt=i(Te,2);{var xt=n=>{Ur(n,{get cutoffDate(){return e(d)},callback:je})};g(wt,n=>{e(Je)&&n(xt)})}var It=i(wt,2);{var Y=n=>{Pr(n,{get deleted(){return e(p),s(()=>e(p).deleted)},get skipped(){return e(p),s(()=>e(p).skipped)},callback:rt})};g(It,n=>{e(y)&&n(Y)})}l(ie,st),it(),te()}var es=u("<span> </span>"),ts=u('<span class="badge bg-secondary">All Day</span>'),as=u('<span class="result-time svelte-1xkw8oa"> </span>'),rs=u('<span class="result-date svelte-1xkw8oa"> </span> <!>',1),ss=u('<span class="result-location svelte-1xkw8oa"><i class="bi bi-geo-alt"></i> <!></span>'),ns=u('<div class="result-thumbnail-container svelte-1xkw8oa"><img class="result-thumbnail svelte-1xkw8oa"/></div>'),os=u('<button type="button" class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>'),ls=u('<li class="list-group-item list-group-item-action d-flex align-items-center gap-3"><span></span> <button type="button" class="result-details-button svelte-1xkw8oa"><div class="result-header svelte-1xkw8oa"><div class="result-title svelte-1xkw8oa"><!></div> <span class="result-type-badge badge bg-secondary-subtle text-secondary-emphasis svelte-1xkw8oa"> </span></div> <div class="result-meta svelte-1xkw8oa"><!> <!> <!></div></button> <!> <div class="result-actions svelte-1xkw8oa"><!></div></li>'),is=u('<div class="unified-search-results svelte-1xkw8oa"><div class="search-results-header svelte-1xkw8oa"><h6 class="search-results-title svelte-1xkw8oa"> </h6></div> <ul class="list-group list-group-flush"></ul></div>'),cs=u('<div class="no-search-results svelte-1xkw8oa"> </div>'),ds=u("<!> <!> <!>",1);function vs(ie,X){lt(X,!1);const N=()=>G(re,"$currentUser",q),$=()=>G($e,"$userOrganizations",q),j=()=>G(P,"$currentUserHasPermission",q),Q=()=>G(F,"$currentUserIsRoot",q),h=()=>G(ce,"$currentUserIsAdmin",q),J=()=>G(de,"$calendarEvents",q),A=()=>G(ke,"$searchQuery",q),z=()=>G(ve,"$announcements",q),[q,x]=Wt(),te=_(),I=_(),{stores:{currentUser:re,currentUserHasPermission:P,currentUserIsAdmin:ce,currentUserIsRoot:F,userOrganizations:$e}}=aa(),{stores:{calendarEvents:de,announcements:ve,searchQuery:ke}}=Nt(),L=ea(),S=ea();let R=_(!1),se=_(),fe=_(!1),Ee=_(!1),U=_(new Set),Z=_(""),oe=_({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),V=_({title:"",description:"",location:"",event_type:"calendar_event",is_public:!0}),qe=_(!1);const Ke=d=>Ba(d,{currentUserId:e(se),isPrivileged:e(R),canEditOwnOrgEvents:e(Ee),userOrganizations:e(U)}),gt=d=>d.startsWith("image/"),Ve=async d=>{const y=d.itemType==="announcement"?"announcement":"calendar_event";if(c(Z,`${d.itemType==="announcement"?"Announcement":"Event"} Form`),d?.meta_data?.recurring_instance&&d?.meta_data?.recurring_parent_id){const{getCalendarEvent:p}=await wa(async()=>{const{getCalendarEvent:be}=await import("../chunks/BOsxNJ5s.js").then(ue=>ue.x);return{getCalendarEvent:be}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),K=await p(d.meta_data.recurring_parent_id);if(K){c(oe,{...K,category:K?.meta_data?.category,event_type:y,start_time:d.start_time,end_time:d.end_time,meta_data:{...K.meta_data,recurring_instance:!0,recurring_parent_id:d.meta_data.recurring_parent_id,recurring_instance_index:d.meta_data.recurring_instance_index}});return}}c(oe,{...d,category:d?.meta_data?.category,event_type:y})},tt=async d=>{if(d?.meta_data?.recurring_instance&&d?.meta_data?.recurring_parent_id){const{getCalendarEvent:p}=await wa(async()=>{const{getCalendarEvent:be}=await import("../chunks/BOsxNJ5s.js").then(ue=>ue.x);return{getCalendarEvent:be}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url),K=await p(d.meta_data.recurring_parent_id);K?c(V,{...K,start_time:d.start_time,end_time:d.end_time,meta_data:{...K.meta_data,recurring_instance:!0,recurring_parent_id:d.meta_data.recurring_parent_id,recurring_instance_index:d.meta_data.recurring_instance_index}}):c(V,d)}else c(V,d);const y=document.getElementById(S);y&&new window.bootstrap.Offcanvas(y).show()},dt=async d=>{await Ve(d);const y=document.getElementById(L);y&&new window.bootstrap.Offcanvas(y).show()},vt=async()=>{const d=document.getElementById(S);if(d){const y=window.bootstrap.Offcanvas.getInstance(d);y&&y.hide()}await Ve(e(V)),setTimeout(()=>{const y=document.getElementById(L);y&&new window.bootstrap.Offcanvas(y).show()},300)};D(()=>N(),()=>{c(se,N()?.id)}),D(()=>$(),()=>{c(U,$())}),D(()=>(e(U),Gt),()=>{c(fe,e(U).has(Gt.Bishopric))}),D(()=>(j(),xe),()=>{c(Ee,j()(xe.EditOwnOrgEvents))}),D(()=>(Q(),h(),e(fe),j(),xe),()=>{c(R,Q()||h()||e(fe)||j()(xe.EditAllEvents))}),D(()=>(j(),xe),()=>{c(qe,j()(xe.DeleteEvents))}),D(()=>(J(),ne),()=>{c(te,(J()??[]).filter(d=>d.start_time?ne(d.start_time)>=new Date:!1))}),D(()=>(A(),e(te),z(),ne),()=>{c(I,A()?[...e(te).filter(d=>{const y=A().toLowerCase(),p=(d.title||"").toLowerCase(),K=(d.description||"").replace(/<[^>]*>/g,"").toLowerCase(),be=(d.location||"").toLowerCase();return p.includes(y)||K.includes(y)||be.includes(y)}).map(d=>({...d,itemType:"event"})),...(z()??[]).filter(d=>{const y=A().toLowerCase(),p=(d.title||"").toLowerCase(),K=(d.description||"").replace(/<[^>]*>/g,"").toLowerCase(),be=(d.location||"").toLowerCase();return p.includes(y)||K.includes(y)||be.includes(y)}).map(d=>({...d,itemType:"announcement"}))].sort((d,y)=>{const p=d.start_time?ne(d.start_time).getTime():0,K=y.start_time?ne(y.start_time).getTime():0;return p===0&&K!==0?-1:p!==0&&K===0?1:p-K}):[])}),Bt(),ct();var Ye=ds(),Xe=we(Ye);ta(Xe,{get title(){return e(Z)},get id(){return L},children:(d,y)=>{$a(d,{get eventItem(){return e(oe)},get drawerId(){return L},name:"unified-search-form",get canDelete(){return e(qe)}})},$$slots:{default:!0}});var We=i(Xe,2);ta(We,{title:"Details",get id(){return S},children:(d,y)=>{{let p=Ae(()=>(e(V),s(()=>Ke(e(V)))));fr(d,{get event(){return e(V)},get canEdit(){return e(p)},onEdit:vt})}},$$slots:{default:!0}});var yt=i(We,2);{var at=d=>{var y=is(),p=a(y),K=a(p),be=a(K);t(K),t(p);var ue=i(p,2);Ze(ue,5,()=>e(I),Me=>Me.id??Me.start_time??Math.random(),(Me,B)=>{const o=Ae(()=>(e(B),s(()=>e(B).attachments?.find(r=>gt(r.type))))),v=Ae(()=>(O(Lt),e(B),s(()=>Lt(e(B)?.meta_data?.category??"")))),b=Ae(()=>(e(B),s(()=>e(B).itemType==="event")));var k=ls(),ae=a(k),De=i(ae,2),_e=a(De),W=a(_e),Ie=a(W);Ca(Ie,()=>(O(Vt),e(B),A(),s(()=>Vt(e(B).title,A())))),t(W);var Ce=i(W,2),Ne=a(Ce,!0);t(Ce),t(_e);var je=i(_e,2),rt=a(je);{var st=r=>{var m=es(),w=a(m,!0);t(m),M(()=>{Ge(m,1,`badge rounded-pill bg-color-${O(e(v)),s(()=>e(v).color_number)??""}`,"svelte-1xkw8oa"),T(w,(O(e(v)),s(()=>e(v).label)))}),l(r,m)};g(rt,r=>{O(e(v)),s(()=>e(v)?.label)&&r(st)})}var nt=i(rt,2);{var Te=r=>{var m=rs(),w=we(m),H=a(w,!0);t(w);var me=i(w,2);{var le=pe=>{var Se=ts();l(pe,Se)},Pe=pe=>{var Se=as(),Re=a(Se,!0);t(Se),M(ze=>T(Re,ze),[()=>(O(he),O(ne),e(B),s(()=>he(ne(e(B).start_time),"h:mm a")))]),l(pe,Se)};g(me,pe=>{e(B),s(()=>e(B).is_all_day)?pe(le):pe(Pe,!1)})}M(pe=>T(H,pe),[()=>(O(he),O(ne),e(B),s(()=>he(ne(e(B).start_time),"MMM d, yyyy")))]),l(r,m)};g(nt,r=>{e(B),s(()=>e(B).start_time)&&r(Te)})}var ht=i(nt,2);{var wt=r=>{var m=ss(),w=i(a(m),2);Ca(w,()=>(O(Vt),e(B),A(),s(()=>Vt(e(B).location,A())))),t(m),l(r,m)};g(ht,r=>{e(B),s(()=>e(B).location)&&r(wt)})}t(je),t(De);var xt=i(De,2);{var It=r=>{var m=ns(),w=a(m);t(m),M(()=>{et(w,"src",(O(e(o)),s(()=>e(o).url))),et(w,"alt",(O(e(o)),s(()=>e(o).name)))}),l(r,m)};g(xt,r=>{e(o)&&r(It)})}var Y=i(xt,2),n=a(Y);{var f=r=>{var m=os();M(()=>et(m,"title",`Edit ${e(b)?"event":"announcement"}`)),ee("click",m,Na(()=>dt(e(B)))),l(r,m)};g(n,r=>{e(B),s(()=>Ke(e(B)))&&r(f)})}t(Y),t(k),M(()=>{Ge(ae,1,`result-color-indicator bg-color-${O(e(v)),s(()=>e(v)?.color_number??0)??""}`,"svelte-1xkw8oa"),T(Ne,e(b)?"Event":"Announcement")}),ee("click",De,()=>tt(e(B))),l(Me,k)}),t(ue),t(y),M(()=>T(be,`${e(I),s(()=>e(I).length)??""} result${e(I),s(()=>e(I).length===1?"":"s")??""} matching "${A()??""}"`)),l(d,y)},Je=d=>{var y=mt(),p=we(y);{var K=be=>{var ue=cs(),Me=a(ue);t(ue),M(()=>T(Me,`No results match your search for "${A()??""}"`)),l(be,ue)};g(p,be=>{A()&&be(K)},!0)}l(d,y)};g(yt,d=>{A(),e(I),s(()=>A()&&e(I).length>0)?d(at):d(Je,!1)})}l(ie,Ye),it(),x()}var us=u("<!> <!> <!>",1),_s=u('<div class="d-flex flex-column gap-4"><!> <!></div>');function Ua(ie,X){lt(X,!1);const N=()=>G(Q,"$searchQuery",$),[$,j]=Wt(),{stores:{searchQuery:Q}}=Nt();ct();var h=_s(),J=a(h);Ir(J,{});var A=i(J,2);{var z=x=>{vs(x,{})},q=x=>{var te=us(),I=we(te);br(I,{});var re=i(I,2);mr(re,{});var P=i(re,2);Gr(P,{}),l(x,te)};g(A,x=>{N()?x(z):x(q,!1)})}t(h),l(ie,h),it(),j()}var ps=u('<div class="d-flex justify-content-center align-items-center py-5"><!></div>'),fs=u('<button type="button" role="tab"> </button>'),bs=u("<option> </option>"),ms=u('<div class="py-5 text-center text-muted"><!></div>'),gs=u('<div class="description-preview text-muted small mb-1 svelte-9fakr"> </div>'),ys=u("<span> </span>"),hs=u('<span class="badge rounded-pill bg-secondary-subtle text-secondary-emphasis">Uncategorized</span>'),ws=u('<span><i class="bi bi-geo-alt"></i> </span>'),xs=u('<span><i class="bi bi-arrow-repeat"></i> </span>'),$s=u('<span><i class="bi bi-calendar3"></i> </span>'),ks=u('<span class="text-muted small"> </span>'),Es=u('<div class="submission-card text-start svelte-9fakr" role="button" tabindex="0"><div class="d-flex justify-content-between align-items-start gap-3 mb-1"><div class="fw-semibold"> </div> <div class="d-flex align-items-center gap-2"><span class="badge bg-light text-dark"> </span> <button class="btn btn-sm btn-outline-primary" type="button"><i class="bi bi-pencil-square"></i></button></div></div> <!> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><!> <!> <!></div> <div class="d-flex flex-wrap align-items-center gap-2 small text-muted mb-1"><span><i class="bi bi-clock"></i> </span> <!></div> <div class="d-flex flex-wrap align-items-center gap-2"><span><i></i> </span> <!></div></div>'),Ds=u('<div class="d-flex flex-column gap-3"></div>'),As=u('<div class="my-submissions-page d-flex flex-column gap-4 svelte-9fakr"><div class="card"><div class="card-header d-flex flex-column gap-3"><div class="d-flex flex-md-row align-items-center justify-content-between gap-2"><div class="mb-0">My Submissions</div> <button class="btn btn-outline-secondary btn-sm"><!></button></div> <div class="submissions-status-tabs nav nav-pills gap-2" role="tablist"></div></div> <div class="card-body d-flex flex-column gap-3"><div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3"><div class="input-group input-group-sm my-submissions-search svelte-9fakr"><input class="form-control svelte-9fakr" type="search" placeholder="Search title, category, or location"/></div> <div class="type-filter-select svelte-9fakr"><select class="form-select form-select-sm"></select></div></div> <!></div></div></div>'),Is=u('<div class="text-muted">Select a submission to edit.</div>'),Ss=u("<!> <!>",1);function Os(ie,X){lt(X,!1);const N=()=>G(F,"$currentUserStore",h),$=()=>G($e,"$currentUserHasPermission",h),j=()=>G(P,"$dbData",h),Q=()=>G(re,"$ready",h),[h,J]=Wt(),A=_(),z=_(),q=_(),x=_(),te=_(),I=_(),{stores:{ready:re,dbData:P},actions:{reload:ce}}=Nt(),{stores:{currentUser:F,currentUserHasPermission:$e}}=aa();let de=_(!1),ve=_([]),ke=_([]),L=_(null);const S=ea();let R=null;const se={approved:"var(--bs-success)",pending:"var(--bs-warning)",needs_review:"var(--bs-info)",published:"var(--bs-primary)"},fe={pending:{text:"Awaiting Approval",class:"bg-warning-subtle text-warning-emphasis",icon:"bi-hourglass-split"},needs_review:{text:"Changes Suggested",class:"bg-info-subtle text-info-emphasis",icon:"bi-pencil"},approved:{text:"Approved — Awaiting Publish",class:"bg-success-subtle text-success-emphasis",icon:"bi-check-circle"},published:{text:"Published",class:"bg-primary-subtle text-primary-emphasis",icon:"bi-globe"}},Ee={pending:"Pending",needs_review:"Changes Suggested",approved:"Approved",published:"Published"},U=[{value:"pending",label:Ee.pending},{value:"needs_review",label:Ee.needs_review},{value:"approved",label:Ee.approved},{value:"published",label:Ee.published}],Z=[{value:"all",label:"Events & Announcements"},{value:"events",label:"Events only"},{value:"announcements",label:"Announcements only"}],oe=()=>({search:"",typeFilter:"all"});let V=_({pending:oe(),needs_review:oe(),approved:oe(),published:oe()});xa(async()=>{c(de,!0),await ce(),c(de,!1),typeof window<"u"&&(R=(await wa(()=>import("../chunks/DO0djbQe.js").then(v=>v.o),__vite__mapDeps([27,28]),import.meta.url)).default)});const qe=o=>{const v=o.meta_data?.submitted_at??o.created_at;if(!v)return 0;try{return ne(v).getTime()}catch(b){return console.warn("Failed to parse submission timestamp",b),0}},Ke=o=>{const v=o.meta_data?.submitted_at??o.created_at;if(!v)return"—";try{return he(ne(v),"MMM d, yyyy 'at' h:mm a")}catch(b){return console.warn("Failed to format submission timestamp",b),"—"}},gt=o=>{if(!o.start_time)return"—";try{return he(ne(o.start_time),"MMM d, yyyy 'at' h:mm a")}catch(v){return console.warn("Failed to format event date",v),"—"}},Ve=o=>o.replace(/<[^>]*>/g,""),tt=(o,v)=>o.length<=v?o:o.substring(0,v).trimEnd()+"…",dt=o=>o.description?tt(Ve(o.description).trim(),120):"",vt=o=>{try{const b=Ft.fromString(o).origOptions,k=b.interval||1,ae=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],De=["","1st","2nd","3rd","4th","5th"];if(b.freq===Ft.DAILY)return k===1?"Repeats daily":`Repeats every ${k} days`;if(b.freq===Ft.WEEKLY){if(b.byweekday){const W=(Array.isArray(b.byweekday)?b.byweekday:[b.byweekday]).map(Ie=>{const Ce=typeof Ie=="number"?Ie:Ie.weekday,Ne=Ce===6?0:Ce+1;return ae[Ne]});return k===1?W.length===1?`Repeats every ${W[0]}`:`Repeats on ${W.join(", ")}`:`Repeats every ${k} weeks on ${W.join(", ")}`}return k===1?"Repeats weekly":`Repeats every ${k} weeks`}if(b.freq===Ft.MONTHLY){if(b.byweekday){const W=(Array.isArray(b.byweekday)?b.byweekday:[b.byweekday])[0];if(W&&typeof W=="object"&&"n"in W&&"weekday"in W){const Ie=W.weekday,Ce=Ie===6?0:Ie+1,Ne=W.n,je=De[Ne]||`${Ne}th`;return k===1?`Repeats on the ${je} ${ae[Ce]} of the month`:`Repeats on the ${je} ${ae[Ce]} every ${k} months`}}if(b.bymonthday){const _e=Array.isArray(b.bymonthday)?b.bymonthday[0]:b.bymonthday,W=_e===1?"st":_e===2?"nd":_e===3?"rd":"th";return k===1?`Repeats on the ${_e}${W} of the month`:`Repeats on the ${_e}${W} every ${k} months`}return k===1?"Repeats monthly":`Repeats every ${k} months`}return b.freq===Ft.YEARLY?k===1?"Repeats yearly":`Repeats every ${k} years`:"Repeats"}catch{return"Repeats"}},Ye=(o,v)=>{const b=v.trim().toLowerCase();if(!b)return!0;const k=o.meta_data?.category?Lt(o.meta_data.category)?.label??"":"";return[o.title??"",o.description??"",o.location??"",k??""].join(" ").toLowerCase().includes(b)},Xe=(o,v)=>v==="all"?!0:v==="events"?o.event_type==="calendar_event":o.event_type==="announcement";function We(o,v){c(V,{...e(V),[o]:{...e(V)[o],...v}})}const yt=o=>{const v=new Set,b=[];for(const k of o){const ae=k.meta_data?.recurring_parent_id;if(k.meta_data?.recurring_instance&&ae!=null){if(v.has(ae))continue;v.add(ae)}b.push(k)}return b},at=o=>o.meta_data?.recurring_parent_id!=null?`recurring-${o.meta_data.recurring_parent_id}`:`id-${o.id}`,Je=o=>{c(L,o);const v=document.getElementById(S);v&&R&&R.getOrCreateInstance(v).show()},d=(o,v)=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),Je(v))},y=async()=>{c(de,!0),await ce(),c(de,!1)};let p=_("pending");D(()=>N(),()=>{c(A,N())}),D(()=>($(),xe),()=>{c(z,$()(xe.DeleteEvents)||$()(xe.DeleteOwnEvents))}),D(()=>(j(),e(A)),()=>{c(ve,yt((j()??[]).filter(o=>{const v=o.meta_data?.submitted_by_user_id;return v&&e(A)?.id&&v===e(A).id}).sort((o,v)=>qe(o)-qe(v))))}),D(()=>e(p),()=>{c(q,`type-filter-select-submissions-${e(p)}`)}),D(()=>(e(ve),Yt),()=>{c(x,U.reduce((o,v)=>(o[v.value]=e(ve).filter(b=>Yt(b)===v.value),o),{}))}),D(()=>(e(V),e(x)),()=>{c(te,U.reduce((o,v)=>{const b=e(V)[v.value],k=(e(x)[v.value]??[]).filter(ae=>Xe(ae,b.typeFilter));return o[v.value]=k.filter(ae=>Ye(ae,b.search)),o},{}))}),D(()=>(e(te),e(p)),()=>{c(ke,e(te)[e(p)]??[])}),D(()=>(e(L),e(ve)),()=>{e(L)&&!e(ve).some(o=>at(o)===at(e(L)))&&c(L,null)}),D(()=>e(L),()=>{c(I,e(L)?{...e(L),id:e(L).id??e(L).meta_data?.recurring_parent_id,category:e(L).meta_data?.category}:null)}),Bt(),ct();var K=Ss(),be=we(K);{var ue=o=>{var v=ps(),b=a(v);Wa(b,{}),t(v),l(o,v)},Me=o=>{var v=As(),b=a(v),k=a(b),ae=a(k),De=i(a(ae),2),_e=a(De);{var W=Y=>{var n=Dt("Refreshing…");l(Y,n)},Ie=Y=>{var n=Dt("Refresh");l(Y,n)};g(_e,Y=>{e(de)?Y(W):Y(Ie,!1)})}t(De),t(ae);var Ce=i(ae,2);Ze(Ce,5,()=>U,ya,(Y,n)=>{var f=fs(),r=a(f);t(f),M(()=>{Ge(f,1,(e(p),e(n),s(()=>`nav-link ${e(p)===e(n).value?"active":""}`)),"svelte-9fakr"),et(f,"aria-selected",(e(p),e(n),s(()=>e(p)===e(n).value))),T(r,`${e(n),s(()=>e(n).label)??""} (${e(x),e(n),s(()=>(e(x)[e(n).value]??[]).length)??""})`)}),ee("click",f,()=>c(p,e(n).value)),l(Y,f)}),t(Ce),t(k);var Ne=i(k,2),je=a(Ne),rt=a(je),st=a(rt);La(st),t(rt);var nt=i(rt,2),Te=a(nt);Ze(Te,5,()=>Z,ya,(Y,n)=>{var f=bs(),r=a(f,!0);t(f);var m={};M(()=>{T(r,(e(n),s(()=>e(n).label))),m!==(m=(e(n),s(()=>e(n).value)))&&(f.value=(f.__value=(e(n),s(()=>e(n).value)))??"")}),l(Y,f)}),t(Te);var ht;ir(Te),t(nt),t(je);var wt=i(je,2);{var xt=Y=>{var n=ms(),f=a(n);{var r=w=>{var H=Dt("You haven't submitted any events or announcements yet.");l(w,H)},m=w=>{var H=Dt();M(me=>T(H,`No ${me??""} submissions match your current filters.`),[()=>(e(p),s(()=>Ee[e(p)].toLowerCase()))]),l(w,H)};g(f,w=>{e(ve),s(()=>e(ve).length===0)?w(r):w(m,!1)})}t(n),l(Y,n)},It=Y=>{var n=Ds();Ze(n,5,()=>e(ke),f=>at(f),(f,r)=>{const m=Ae(()=>(O(Yt),e(r),s(()=>Yt(e(r))))),w=Ae(()=>(O(e(m)),s(()=>fe[e(m)]))),H=Ae(()=>(e(r),O(Lt),s(()=>e(r).meta_data?.category?Lt(e(r).meta_data.category):null))),me=Ae(()=>(e(r),s(()=>dt(e(r)))));var le=Es(),Pe=a(le),pe=a(Pe),Se=a(pe,!0);t(pe);var Re=i(pe,2),ze=a(Re),jt=a(ze,!0);t(ze);var St=i(ze,2);t(Re),t(Pe);var Ot=i(Pe,2);{var ra=E=>{var C=gs(),Oe=a(C,!0);t(C),M(()=>T(Oe,e(me))),l(E,C)};g(Ot,E=>{e(me)&&E(ra)})}var Mt=i(Ot,2),zt=a(Mt);{var sa=E=>{var C=ys(),Oe=a(C,!0);t(C),M(()=>{Ge(C,1,`badge rounded-pill bg-color-${O(e(H)),s(()=>e(H).color_number)??""}`,"svelte-9fakr"),T(Oe,(O(e(H)),s(()=>e(H).label)))}),l(E,C)},na=E=>{var C=hs();l(E,C)};g(zt,E=>{e(H)?E(sa):E(na,!1)})}var Ue=i(zt,2);{var Le=E=>{var C=ws(),Oe=i(a(C));t(C),M(()=>T(Oe,` ${e(r),s(()=>e(r).location)??""}`)),l(E,C)};g(Ue,E=>{e(r),s(()=>e(r).location)&&E(Le)})}var ut=i(Ue,2);{var Ct=E=>{var C=xs(),Oe=i(a(C));t(C),M(bt=>T(Oe,` ${bt??""}`),[()=>(e(r),s(()=>vt(e(r).recurrence_rule)))]),l(E,C)};g(ut,E=>{e(r),s(()=>e(r).recurrence_rule)&&E(Ct)})}t(Mt);var _t=i(Mt,2),ge=a(_t),Fe=i(a(ge));t(ge);var pt=i(ge,2);{var ot=E=>{var C=$s(),Oe=i(a(C));t(C),M(bt=>T(Oe,` Event ${bt??""}`),[()=>(e(r),s(()=>gt(e(r))))]),l(E,C)};g(pt,E=>{e(r),s(()=>e(r).event_type==="calendar_event")&&E(ot)})}t(_t);var ft=i(_t,2),He=a(ft),$t=a(He),Qe=i($t,1,!0);t(He);var Be=i(He,2);{var ye=E=>{var C=ks(),Oe=a(C);t(C),M(bt=>T(Oe,`Approvals: ${bt??""} of 3`),[()=>(O(Xt),e(r),s(()=>Xt(e(r))))]),l(E,C)};g(Be,E=>{O(Xt),e(r),s(()=>Xt(e(r))>0)&&E(ye)})}t(ft),t(le),M(E=>{vr(le,`border-left: 4px solid ${O(e(m)),s(()=>se[e(m)])??""}`),T(Se,(e(r),s(()=>e(r).title))),T(jt,(e(r),s(()=>e(r).event_type==="calendar_event"?"Event":"Announcement"))),et(St,"aria-label",(e(r),s(()=>`Edit ${e(r).title}`))),T(Fe,` Submitted ${E??""}`),Ge(He,1,(O(e(w)),s(()=>`badge ${e(w).class}`)),"svelte-9fakr"),Ge($t,1,(O(e(w)),s(()=>`bi ${e(w).icon} me-1`)),"svelte-9fakr"),T(Qe,(O(e(w)),s(()=>e(w).text)))},[()=>(e(r),s(()=>Ke(e(r))))]),ee("click",St,Na(()=>Je(e(r)))),ee("click",le,()=>Je(e(r))),ee("keydown",le,E=>d(E,e(r))),l(f,le)}),t(n),l(Y,n)};g(wt,Y=>{e(ke),s(()=>e(ke).length===0)?Y(xt):Y(It,!1)})}t(Ne),t(b),t(v),M(()=>{De.disabled=e(de),cr(st,(e(V),e(p),s(()=>e(V)[e(p)].search))),et(Te,"id",e(q)),ht!==(ht=(e(V),e(p),s(()=>e(V)[e(p)].typeFilter)))&&(Te.value=(Te.__value=(e(V),e(p),s(()=>e(V)[e(p)].typeFilter)))??"",dr(Te,(e(V),e(p),s(()=>e(V)[e(p)].typeFilter))))}),ee("click",De,y),ee("input",st,Y=>We(e(p),{search:Y.currentTarget.value})),ee("change",Te,Y=>We(e(p),{typeFilter:Y.currentTarget.value})),l(o,v)};g(be,o=>{Q()?o(Me,!1):o(ue)})}var B=i(be,2);{let o=Ae(()=>(e(L),s(()=>e(L)?`Edit: ${e(L).title}`:"Submission Details")));ta(B,{get id(){return S},get title(){return e(o)},children:(v,b)=>{var k=mt(),ae=we(k);{var De=W=>{$a(W,{get eventItem(){return e(I)},get drawerId(){return S},name:"my-submission-form",get canDelete(){return e(z)},canCreate:!1})},_e=W=>{var Ie=Is();l(W,Ie)};g(ae,W=>{e(I)?W(De):W(_e,!1)})}l(v,k)},$$slots:{default:!0}})}l(ie,K),it(),J()}var Ms=u('<button class="nav-link" id="approvals-tab" data-bs-toggle="tab" data-bs-target="#approvals-pane" type="button" role="tab" aria-controls="approvals-pane" aria-selected="false">Approvals</button>'),Cs=u('<button class="nav-link" id="my-submissions-tab" data-bs-toggle="tab" data-bs-target="#my-submissions-pane" type="button" role="tab" aria-controls="my-submissions-pane" aria-selected="false">My Submissions</button>'),Ts=u('<div class="tab-pane fade" id="approvals-pane" role="tabpanel" aria-labelledby="approvals-tab"><!></div>'),Ps=u('<div class="tab-pane fade" id="my-submissions-pane" role="tabpanel" aria-labelledby="my-submissions-tab"><!></div>'),Rs=u('<nav class="d-print-none"><div class="nav nav-tabs" role="tablist"><button class="nav-link active" id="calendar-tab" data-bs-toggle="tab" data-bs-target="#calendar-pane" type="button" role="tab" aria-controls="calendar-pane" aria-selected="true">All</button> <!> <!></div></nav> <div class="tab-content mt-3"><div class="tab-pane fade show active" id="calendar-pane" role="tabpanel" aria-labelledby="calendar-tab"><!></div> <!> <!></div>',1);function on(ie,X){lt(X,!1);const N=_(),{stores:{currentUserHasPermission:$,authenticated:j}}=aa();let Q=_(!1),h=_(!1);xa(()=>{const J=$.subscribe(z=>{const q=z(xe.ManageWardBusiness);c(Q,q)}),A=j.subscribe(z=>{c(h,z)});return()=>{J(),A()}}),D(()=>(e(Q),e(h)),()=>{c(N,e(Q)||e(h))}),Bt(),ct(),or(ie,{pageTitle:"Calendar",children:(J,A)=>{var z=mt(),q=we(z);{var x=I=>{var re=Rs(),P=we(re),ce=a(P),F=i(a(ce),2);{var $e=U=>{var Z=Ms();l(U,Z)};g(F,U=>{e(Q)&&U($e)})}var de=i(F,2);{var ve=U=>{var Z=Cs();l(U,Z)};g(de,U=>{e(h)&&U(ve)})}t(ce),t(P);var ke=i(P,2),L=a(ke),S=a(L);Ua(S,{}),t(L);var R=i(L,2);{var se=U=>{var Z=Ts(),oe=a(Z);hr(oe,{}),t(Z),l(U,Z)};g(R,U=>{e(Q)&&U(se)})}var fe=i(R,2);{var Ee=U=>{var Z=Ps(),oe=a(Z);Os(oe,{}),t(Z),l(U,Z)};g(fe,U=>{e(h)&&U(Ee)})}t(ke),l(I,re)},te=I=>{Ua(I,{})};g(q,I=>{e(N)?I(x):I(te,!1)})}l(J,z)},$$slots:{default:!0}}),it()}export{on as component,nn as universal};
