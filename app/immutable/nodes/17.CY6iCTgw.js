import{s as G,d as w,i as I,A as q,x as O,r as ee,n as V,b as d,p as n,c as h,e as H,w as x,g as y,h as _,j as P,a as te,f as se,t as re,y as U,z as D,B as le,S as Y}from"../chunks/Dvm0vAjZ.js";import{S as J,i as K,t as B,a as z,g as ae,e as ne,d as Q,m as W,c as X,b as Z}from"../chunks/C0L9un44.js";import{g as oe}from"../chunks/D0QH3NT1.js";import{g as $}from"../chunks/8H_U7C9I.js";import{g as ie}from"../chunks/Dbrxt59H.js";import{L as ce}from"../chunks/myPzA-gB.js";const{window:ue}=oe;function fe(c){let e,t,r='<img src="/assets/logo.png" alt="logo" class="logo svelte-1n4t3wo"/> <h1 class="mb-0 h4">Lehi Tolutaha</h1>',s,i,a="Reset Password",u,l,o="Enter your new password below.",f,b,p=c[4]&&F(c);function E(m,g){return!m[7]&&m[6]?he:m[7]?me:pe}let v=E(c),k=v(c);return{c(){e=_("div"),t=_("a"),t.innerHTML=r,s=P(),i=_("h2"),i.textContent=a,u=P(),l=_("p"),l.textContent=o,f=P(),p&&p.c(),b=P(),k.c(),this.h()},l(m){e=h(m,"DIV",{class:!0});var g=H(e);t=h(g,"A",{href:!0,class:!0,"data-svelte-h":!0}),x(t)!=="svelte-1inzn7"&&(t.innerHTML=r),s=y(g),i=h(g,"H2",{class:!0,"data-svelte-h":!0}),x(i)!=="svelte-cqi3lg"&&(i.textContent=a),u=y(g),l=h(g,"P",{class:!0,"data-svelte-h":!0}),x(l)!=="svelte-xg6fe6"&&(l.textContent=o),f=y(g),p&&p.l(g),b=y(g),k.l(g),g.forEach(w),this.h()},h(){n(t,"href","/home"),n(t,"class","header-content d-flex align-items-center gap-2 text-decoration-none svelte-1n4t3wo"),n(i,"class","h5"),n(l,"class","text-muted small"),n(e,"class","container d-flex flex-column gap-3 mt-5 mb-5 svelte-1n4t3wo")},m(m,g){I(m,e,g),d(e,t),d(e,s),d(e,i),d(e,u),d(e,l),d(e,f),p&&p.m(e,null),d(e,b),k.m(e,null)},p(m,g){m[4]?p?p.p(m,g):(p=F(m),p.c(),p.m(e,b)):p&&(p.d(1),p=null),v===(v=E(m))&&k?k.p(m,g):(k.d(1),k=v(m),k&&(k.c(),k.m(e,null)))},i:V,o:V,d(m){m&&w(e),p&&p.d(),k.d()}}}function de(c){let e,t;return e=new ce({props:{message:"Resetting your password..."}}),{c(){Z(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},p:V,i(r){t||(z(e.$$.fragment,r),t=!0)},o(r){B(e.$$.fragment,r),t=!1},d(r){Q(e,r)}}}function F(c){let e,t,r,s,i,a,u;return{c(){e=_("div"),t=_("i"),s=P(),i=_("div"),a=re(c[4]),this.h()},l(l){e=h(l,"DIV",{class:!0,role:!0});var o=H(e);t=h(o,"I",{class:!0}),H(t).forEach(w),s=y(o),i=h(o,"DIV",{});var f=H(i);a=se(f,c[4]),f.forEach(w),o.forEach(w),this.h()},h(){n(t,"class",r="bi "+(c[5]==="success"?"bi-check-circle-fill":"bi-exclamation-triangle-fill")),n(e,"class",u="alert "+(c[5]==="success"?"alert-success":"alert-danger")+" d-flex align-items-center gap-2"),n(e,"role","alert")},m(l,o){I(l,e,o),d(e,t),d(e,s),d(e,i),d(i,a)},p(l,o){o&32&&r!==(r="bi "+(l[5]==="success"?"bi-check-circle-fill":"bi-exclamation-triangle-fill"))&&n(t,"class",r),o&16&&te(a,l[4]),o&32&&u!==(u="alert "+(l[5]==="success"?"alert-success":"alert-danger")+" d-flex align-items-center gap-2")&&n(e,"class",u)},d(l){l&&w(e)}}}function pe(c){let e,t=`<i class="bi bi-exclamation-triangle-fill"></i> <div><strong>Invalid Link</strong><br/>
					This password reset link is invalid or has expired. Please request a new one.</div>`,r,s,i='<a href="/auth/forgot-password" class="btn btn-primary">Request New Reset Link</a> <a href="/auth/login" class="btn btn-link">Back to Login</a>';return{c(){e=_("div"),e.innerHTML=t,r=P(),s=_("div"),s.innerHTML=i,this.h()},l(a){e=h(a,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),x(e)!=="svelte-1pqrn7e"&&(e.innerHTML=t),r=y(a),s=h(a,"DIV",{class:!0,"data-svelte-h":!0}),x(s)!=="svelte-1k7gy3m"&&(s.innerHTML=i),this.h()},h(){n(e,"class","alert alert-danger d-flex align-items-center gap-2"),n(e,"role","alert"),n(s,"class","d-flex flex-column gap-2")},m(a,u){I(a,e,u),I(a,r,u),I(a,s,u)},p:V,d(a){a&&(w(e),w(r),w(s))}}}function me(c){let e,t=`<i class="bi bi-check-circle-fill"></i> <div><strong>Success!</strong><br/>
					Your password has been reset. Redirecting to login page...</div>`,r,s,i="Go to Login";return{c(){e=_("div"),e.innerHTML=t,r=P(),s=_("a"),s.textContent=i,this.h()},l(a){e=h(a,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),x(e)!=="svelte-lz9zsl"&&(e.innerHTML=t),r=y(a),s=h(a,"A",{href:!0,class:!0,"data-svelte-h":!0}),x(s)!=="svelte-14g8ff3"&&(s.textContent=i),this.h()},h(){n(e,"class","alert alert-success d-flex align-items-center gap-2"),n(e,"role","alert"),n(s,"href","/auth/login"),n(s,"class","btn btn-primary")},m(a,u){I(a,e,u),I(a,r,u),I(a,s,u)},p:V,d(a){a&&(w(e),w(r),w(s))}}}function he(c){let e,t,r,s="New Password",i,a,u,l="Minimum 8 characters",o,f,b,p="Confirm New Password",E,v,k,m,g='<a href="/auth/login" class="btn-link btn">Back to login</a> <button type="submit" class="btn btn-primary">Reset Password</button>',A,C;function j(L,T){return L[3]?be:_e}let N=j(c),M=N(c);return{c(){e=_("form"),t=_("div"),r=_("label"),r.textContent=s,i=P(),M.c(),a=P(),u=_("small"),u.textContent=l,o=P(),f=_("div"),b=_("label"),b.textContent=p,E=P(),v=_("input"),k=P(),m=_("div"),m.innerHTML=g,this.h()},l(L){e=h(L,"FORM",{class:!0});var T=H(e);t=h(T,"DIV",{});var R=H(t);r=h(R,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),x(r)!=="svelte-zgutjk"&&(r.textContent=s),i=y(R),M.l(R),a=y(R),u=h(R,"SMALL",{class:!0,"data-svelte-h":!0}),x(u)!=="svelte-txew5q"&&(u.textContent=l),R.forEach(w),o=y(T),f=h(T,"DIV",{});var S=H(f);b=h(S,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),x(b)!=="svelte-1gm0keu"&&(b.textContent=p),E=y(S),v=h(S,"INPUT",{type:!0,class:!0,placeholder:!0,id:!0,"aria-describedby":!0}),S.forEach(w),k=y(T),m=h(T,"DIV",{class:!0,"data-svelte-h":!0}),x(m)!=="svelte-1mycn63"&&(m.innerHTML=g),T.forEach(w),this.h()},h(){n(r,"for","newPassword"),n(r,"class","form-label"),n(u,"class","text-muted"),n(b,"for","confirmPassword"),n(b,"class","form-label"),n(v,"type","password"),n(v,"class","form-control"),n(v,"placeholder","Re-enter password"),n(v,"id","confirmPassword"),n(v,"aria-describedby","confirmPassword"),v.required=!0,n(m,"class","d-flex justify-content-between align-items-center"),n(e,"class","d-flex gap-3 flex-column")},m(L,T){I(L,e,T),d(e,t),d(t,r),d(t,i),M.m(t,null),d(t,a),d(t,u),d(e,o),d(e,f),d(f,b),d(f,E),d(f,v),D(v,c[2]),d(e,k),d(e,m),A||(C=[q(v,"input",c[14]),q(e,"submit",le(c[8]))],A=!0)},p(L,T){N===(N=j(L))&&M?M.p(L,T):(M.d(1),M=N(L),M&&(M.c(),M.m(t,a))),T&4&&v.value!==L[2]&&D(v,L[2])},d(L){L&&w(e),M.d(),A=!1,U(C)}}}function _e(c){let e,t,r,s,i='<i class="bi bi-eye"></i>',a,u;return{c(){e=_("div"),t=_("input"),r=P(),s=_("button"),s.innerHTML=i,this.h()},l(l){e=h(l,"DIV",{class:!0});var o=H(e);t=h(o,"INPUT",{type:!0,class:!0,placeholder:!0,id:!0,"aria-describedby":!0}),r=y(o),s=h(o,"BUTTON",{type:!0,class:!0,"aria-label":!0,"data-svelte-h":!0}),x(s)!=="svelte-19z8vub"&&(s.innerHTML=i),o.forEach(w),this.h()},h(){n(t,"type","password"),n(t,"class","form-control"),n(t,"placeholder","At least 8 characters"),n(t,"id","newPassword"),n(t,"aria-describedby","newPassword"),t.required=!0,n(s,"type","button"),n(s,"class","input-group-text"),n(s,"aria-label","Show password"),n(e,"class","input-group")},m(l,o){I(l,e,o),d(e,t),D(t,c[1]),d(e,r),d(e,s),a||(u=[q(t,"input",c[13]),Y(c[11].call(null,t)),q(s,"click",c[9])],a=!0)},p(l,o){o&2&&t.value!==l[1]&&D(t,l[1])},d(l){l&&w(e),a=!1,U(u)}}}function be(c){let e,t,r,s,i='<i class="bi bi-eye-slash"></i>',a,u;return{c(){e=_("div"),t=_("input"),r=P(),s=_("button"),s.innerHTML=i,this.h()},l(l){e=h(l,"DIV",{class:!0});var o=H(e);t=h(o,"INPUT",{type:!0,class:!0,placeholder:!0,id:!0,"aria-describedby":!0}),r=y(o),s=h(o,"BUTTON",{type:!0,class:!0,"aria-label":!0,"data-svelte-h":!0}),x(s)!=="svelte-16xxt7g"&&(s.innerHTML=i),o.forEach(w),this.h()},h(){n(t,"type","text"),n(t,"class","form-control"),n(t,"placeholder","At least 8 characters"),n(t,"id","newPassword"),n(t,"aria-describedby","newPassword"),t.required=!0,n(s,"type","button"),n(s,"class","input-group-text"),n(s,"aria-label","Hide password"),n(e,"class","input-group")},m(l,o){I(l,e,o),d(e,t),D(t,c[1]),d(e,r),d(e,s),a||(u=[q(t,"input",c[12]),Y(c[11].call(null,t)),q(s,"click",c[9])],a=!0)},p(l,o){o&2&&t.value!==l[1]&&D(t,l[1])},d(l){l&&w(e),a=!1,U(u)}}}function ge(c){let e,t,r,s,i,a;const u=[de,fe],l=[];function o(f,b){return f[0]?0:1}return e=o(c),t=l[e]=u[e](c),{c(){t.c(),r=O()},l(f){t.l(f),r=O()},m(f,b){l[e].m(f,b),I(f,r,b),s=!0,i||(a=q(ue,"keydown",c[10]),i=!0)},p(f,[b]){let p=e;e=o(f),e===p?l[e].p(f,b):(ae(),B(l[p],1,1,()=>{l[p]=null}),ne(),t=l[e],t?t.p(f,b):(t=l[e]=u[e](f),t.c()),z(t,1),t.m(r.parentNode,r))},i(f){s||(z(t),s=!0)},o(f){B(t),s=!1},d(f){f&&w(r),l[e].d(f),i=!1,a()}}}function we(c,e,t){const{actions:{resetPassword:r}}=$();let s=!1,i="",a="",u=!1,l="",o="error",f="",b=!1;ee(()=>{const C=new URLSearchParams(window.location.search);t(6,f=C.get("token")||""),f||(t(4,l="Invalid or missing reset token. Please request a new password reset."),t(5,o="error"))});const p=async()=>{if(t(0,s=!0),t(4,l=""),t(5,o="error"),!i||!a){t(4,l="Password and confirmation are required"),t(0,s=!1);return}if(i!==a){t(4,l="Passwords do not match"),t(0,s=!1);return}if(i.length<8){t(4,l="Password must be at least 8 characters"),t(0,s=!1);return}if(!f){t(4,l="Invalid reset token. Please request a new password reset."),t(0,s=!1);return}const C=await r(f,i);C.success?(t(5,o="success"),t(4,l=C.message||"Password has been reset successfully!"),t(7,b=!0),setTimeout(()=>{ie("/auth/login")},3e3)):(t(5,o="error"),t(4,l=C.error||"Failed to reset password"),t(0,s=!1))},E=()=>{t(3,u=!u)},v=C=>{C.key==="Enter"&&!b&&p()},k=C=>{C.focus()};function m(){i=this.value,t(1,i)}function g(){i=this.value,t(1,i)}function A(){a=this.value,t(2,a)}return[s,i,a,u,l,o,f,b,p,E,v,k,m,g,A]}class ve extends J{constructor(e){super(),K(this,e,we,ge,G,{})}}function ke(c){let e,t;return e=new ve({}),{c(){Z(e.$$.fragment)},l(r){X(e.$$.fragment,r)},m(r,s){W(e,r,s),t=!0},p:V,i(r){t||(z(e.$$.fragment,r),t=!0)},o(r){B(e.$$.fragment,r),t=!1},d(r){Q(e,r)}}}function ye(c){const{stores:{pageName:e}}=$();return e.set("Auth - Reset Password"),[]}class Me extends J{constructor(e){super(),K(this,e,ye,ke,G,{})}}export{Me as component};
